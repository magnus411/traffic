{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.504989464683312, "policy_loss": 0.08516538780601657, "vf_loss": 29.60634306346808, "vf_explained_var": 0.004280449438923346, "kl": 0.0, "entropy": 18.65190305544188, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 605.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 82.2606338674638, "num_env_steps_trained_throughput_per_sec": 82.2606338674638, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 145877.796, "restore_workers_time_ms": 0.0, "training_step_time_ms": 145877.796, "sample_time_ms": 114688.326, "load_time_ms": 10.996, "load_throughput": 1091272.018, "learn_time_ms": 31169.471, "learn_throughput": 384.992, "synch_weights_time_ms": 8.004}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 1, "trial_id": "befd4_00000", "date": "2025-01-22_18-59-49", "timestamp": 1737601189, "time_this_iter_s": 145.88079714775085, "time_total_s": 145.88079714775085, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 145.88079714775085, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 3.3747368421052633, "ram_util_percent": 34.83894736842105, "gpu_util_percent0": 0.08794736842105264, "vram_util_percent0": 0.07152857730263161}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.637439241874702, "policy_loss": 0.0026166243347700616, "vf_loss": 30.0, "vf_explained_var": 0.00017666580067674813, "kl": 0.0, "entropy": 36.51774069925692, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 1814.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 69.0611203998989, "num_env_steps_trained_throughput_per_sec": 69.0611203998989, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 159818.462, "restore_workers_time_ms": 0.0, "training_step_time_ms": 159818.462, "sample_time_ms": 127960.519, "load_time_ms": 11.496, "load_throughput": 1043878.547, "learn_time_ms": 31836.945, "learn_throughput": 376.921, "synch_weights_time_ms": 9.003}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 2, "trial_id": "befd4_00000", "date": "2025-01-22_19-02-43", "timestamp": 1737601363, "time_this_iter_s": 173.7621238231659, "time_total_s": 319.64292097091675, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 319.64292097091675, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 5.133035714285714, "ram_util_percent": 36.317410714285714, "gpu_util_percent0": 0.09450892857142858, "vram_util_percent0": 0.08482535226004465}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.65708425283629, "policy_loss": 0.008794902950968991, "vf_loss": 30.0, "vf_explained_var": 3.552072002830537e-05, "kl": 0.0, "entropy": 35.17106340659168, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 3023.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 61.72328773905405, "num_env_steps_trained_throughput_per_sec": 61.72328773905405, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 171351.003, "restore_workers_time_ms": 0.0, "training_step_time_ms": 171351.003, "sample_time_ms": 139761.194, "load_time_ms": 11.665, "load_throughput": 1028730.082, "learn_time_ms": 31568.809, "learn_throughput": 380.122, "synch_weights_time_ms": 8.336}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 3, "trial_id": "befd4_00000", "date": "2025-01-22_19-05-58", "timestamp": 1737601558, "time_this_iter_s": 194.41808605194092, "time_total_s": 514.0610070228577, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 514.0610070228577, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 8.97609561752988, "ram_util_percent": 37.52430278884462, "gpu_util_percent0": 0.08466135458167331, "vram_util_percent0": 0.09712906187749004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.658808918803857, "policy_loss": 0.006765056315214798, "vf_loss": 30.0, "vf_explained_var": 4.374502708933588e-05, "kl": 0.0, "entropy": 34.7956179957236, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 4232.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 56.032783517800716, "num_env_steps_trained_throughput_per_sec": 56.032783517800716, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 182053.588, "restore_workers_time_ms": 0.0, "training_step_time_ms": 182053.337, "sample_time_ms": 150298.81, "load_time_ms": 11.498, "load_throughput": 1043672.912, "learn_time_ms": 31733.778, "learn_throughput": 378.146, "synch_weights_time_ms": 8.253}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 4, "trial_id": "befd4_00000", "date": "2025-01-22_19-09-32", "timestamp": 1737601772, "time_this_iter_s": 214.1653425693512, "time_total_s": 728.2263495922089, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 728.2263495922089, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 9.47797833935018, "ram_util_percent": 37.69963898916967, "gpu_util_percent0": 0.08194945848375453, "vram_util_percent0": 0.09442090196299638}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.660095475151877, "policy_loss": 0.006925790312617548, "vf_loss": 30.0, "vf_explained_var": 3.19360602089351e-06, "kl": 0.0, "entropy": 34.68302954712419, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 5441.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 53.50951916147161, "num_env_steps_trained_throughput_per_sec": 53.50951916147161, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 190494.703, "restore_workers_time_ms": 0.0, "training_step_time_ms": 190494.503, "sample_time_ms": 158501.412, "load_time_ms": 11.598, "load_throughput": 1034617.288, "learn_time_ms": 31972.388, "learn_throughput": 375.324, "synch_weights_time_ms": 7.905}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 5, "trial_id": "befd4_00000", "date": "2025-01-22_19-13-16", "timestamp": 1737601996, "time_this_iter_s": 224.26216340065002, "time_total_s": 952.4885129928589, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 952.4885129928589, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 9.036678200692043, "ram_util_percent": 38.27785467128028, "gpu_util_percent0": 0.06598615916955017, "vram_util_percent0": 0.09877203179065744}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.660116118375086, "policy_loss": 0.007875084926314942, "vf_loss": 30.0, "vf_explained_var": 8.759417742909826e-06, "kl": 0.0, "entropy": 34.77589685962258, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 6650.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.450870288127106, "num_env_steps_trained_throughput_per_sec": 52.450870288127106, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 196876.507, "restore_workers_time_ms": 0.0, "training_step_time_ms": 196876.34, "sample_time_ms": 164957.107, "load_time_ms": 11.999, "load_throughput": 1000082.42, "learn_time_ms": 31898.315, "learn_throughput": 376.195, "synch_weights_time_ms": 7.921}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 6, "trial_id": "befd4_00000", "date": "2025-01-22_19-17-05", "timestamp": 1737602225, "time_this_iter_s": 228.78852534294128, "time_total_s": 1181.2770383358002, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1181.2770383358002, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 8.703728813559323, "ram_util_percent": 38.37220338983051, "gpu_util_percent0": 0.066, "vram_util_percent0": 0.09732421875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.65892099170669, "policy_loss": 0.006721125119130803, "vf_loss": 30.0, "vf_explained_var": 1.0351832983807358e-05, "kl": 0.0, "entropy": 34.78001465335969, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 7859.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 51.50473809604814, "num_env_steps_trained_throughput_per_sec": 51.50473809604814, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 202035.331, "restore_workers_time_ms": 0.0, "training_step_time_ms": 202035.188, "sample_time_ms": 169950.807, "load_time_ms": 11.999, "load_throughput": 1000103.711, "learn_time_ms": 32063.594, "learn_throughput": 374.256, "synch_weights_time_ms": 7.789}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 7, "trial_id": "befd4_00000", "date": "2025-01-22_19-20-58", "timestamp": 1737602458, "time_this_iter_s": 232.99127388000488, "time_total_s": 1414.268312215805, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1414.268312215805, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 11.064333333333332, "ram_util_percent": 38.44199999999999, "gpu_util_percent0": 0.05446666666666668, "vram_util_percent0": 0.10145117187499998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.658415560095246, "policy_loss": 0.0065769560333122585, "vf_loss": 30.0, "vf_explained_var": 6.6604862733751014e-06, "kl": 0.0, "entropy": 34.816138492328655, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 9068.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 51.48712657395266, "num_env_steps_trained_throughput_per_sec": 51.48712657395266, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 205914.411, "restore_workers_time_ms": 0.0, "training_step_time_ms": 205914.285, "sample_time_ms": 173695.84, "load_time_ms": 11.999, "load_throughput": 1000087.388, "learn_time_ms": 32197.632, "learn_throughput": 372.698, "synch_weights_time_ms": 7.816}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 8, "trial_id": "befd4_00000", "date": "2025-01-22_19-24-51", "timestamp": 1737602691, "time_this_iter_s": 233.07096600532532, "time_total_s": 1647.3392782211304, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1647.3392782211304, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 11.974418604651161, "ram_util_percent": 38.509302325581395, "gpu_util_percent0": 0.055847176079734225, "vram_util_percent0": 0.10146484374999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.656266132793316, "policy_loss": 0.005506559657942075, "vf_loss": 30.0, "vf_explained_var": 1.3395170222835367e-05, "kl": 0.0, "entropy": 34.924041205343876, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 10277.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 51.00156616901688, "num_env_steps_trained_throughput_per_sec": 51.00156616901688, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 108000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 209178.02, "restore_workers_time_ms": 0.0, "training_step_time_ms": 209177.908, "sample_time_ms": 176826.815, "load_time_ms": 11.889, "load_throughput": 1009313.247, "learn_time_ms": 32330.48, "learn_throughput": 371.167, "synch_weights_time_ms": 7.837}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "training_iteration": 9, "trial_id": "befd4_00000", "date": "2025-01-22_19-28-46", "timestamp": 1737602926, "time_this_iter_s": 235.2898952960968, "time_total_s": 1882.6291735172272, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1882.6291735172272, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 11.069636963696372, "ram_util_percent": 38.355445544554456, "gpu_util_percent0": 0.05485148514851485, "vram_util_percent0": 0.10146484374999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.65572663394748, "policy_loss": 0.005531933599261827, "vf_loss": 30.0, "vf_explained_var": 1.5582054286480345e-05, "kl": 0.0, "entropy": 34.980530144854754, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 11486.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 50.864367818043426, "num_env_steps_trained_throughput_per_sec": 50.864367818043426, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 211852.372, "restore_workers_time_ms": 0.0, "training_step_time_ms": 211852.271, "sample_time_ms": 179335.182, "load_time_ms": 11.9, "load_throughput": 1008405.737, "learn_time_ms": 32496.437, "learn_throughput": 369.271, "synch_weights_time_ms": 7.953}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 10, "trial_id": "befd4_00000", "date": "2025-01-22_19-32-42", "timestamp": 1737603162, "time_this_iter_s": 235.92453837394714, "time_total_s": 2118.5537118911743, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2118.5537118911743, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 10.799342105263158, "ram_util_percent": 38.39769736842105, "gpu_util_percent0": 0.053980263157894746, "vram_util_percent0": 0.10146484374999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.656115698360825, "policy_loss": 0.0059941895768305204, "vf_loss": 30.0, "vf_explained_var": 8.414953182905148e-06, "kl": 0.0, "entropy": 34.98784909749248, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 12695.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 50.80826068146419, "num_env_steps_trained_throughput_per_sec": 50.80826068146419, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 132000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 220882.799, "restore_workers_time_ms": 0.0, "training_step_time_ms": 220882.698, "sample_time_ms": 188053.038, "load_time_ms": 11.9, "load_throughput": 1008383.514, "learn_time_ms": 32808.309, "learn_throughput": 365.761, "synch_weights_time_ms": 8.653}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "training_iteration": 11, "trial_id": "befd4_00000", "date": "2025-01-22_19-36-39", "timestamp": 1737603399, "time_this_iter_s": 236.18406796455383, "time_total_s": 2354.737779855728, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2354.737779855728, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 10.52, "ram_util_percent": 38.52918032786884, "gpu_util_percent0": 0.05527868852459016, "vram_util_percent0": 0.10146484375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.655169554048573, "policy_loss": -0.00474341401046125, "vf_loss": 29.894544369529555, "vf_explained_var": 0.006282032374215579, "kl": 0.0, "entropy": 23.463138321591764, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 13904.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": -799469.6508991551, "episode_reward_min": -803946.1641247631, "episode_reward_mean": -801752.8251254577, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 144000, "policy_reward_min": {"default_policy": -803946.1641247631}, "policy_reward_max": {"default_policy": -799469.6508991551}, "policy_reward_mean": {"default_policy": -801752.8251254577}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9638313626033628, "mean_inference_ms": 4.472261499311829, "mean_action_processing_ms": 0.787430067595315, "mean_env_wait_ms": 103.74575390504566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10007619857788086, "StateBufferConnector_ms": 0.03755390644073486, "ViewRequirementAgentConnector_ms": 0.1373201608657837}, "num_episodes": 8, "episode_return_max": -799469.6508991551, "episode_return_min": -803946.1641247631, "episode_return_mean": -801752.8251254577, "episodes_this_iter": 8}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 71.75527002569304, "num_env_steps_trained_throughput_per_sec": 71.75527002569304, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 220230.396, "restore_workers_time_ms": 0.0, "training_step_time_ms": 220230.296, "sample_time_ms": 187520.792, "load_time_ms": 11.801, "load_throughput": 1016895.469, "learn_time_ms": 32688.352, "learn_throughput": 367.103, "synch_weights_time_ms": 8.453}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 12, "trial_id": "befd4_00000", "date": "2025-01-22_19-39-26", "timestamp": 1737603566, "time_this_iter_s": 167.23810410499573, "time_total_s": 2521.975883960724, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2521.975883960724, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 4.780092592592593, "ram_util_percent": 37.98425925925926, "gpu_util_percent0": 0.07416666666666669, "vram_util_percent0": 0.10146484375000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.567673832252066, "policy_loss": -0.009711675459905731, "vf_loss": 29.951004384863563, "vf_explained_var": 0.008744737942224697, "kl": 0.0, "entropy": 37.36188592902879, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 15113.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "env_runners": {"episode_reward_max": -799469.6508991551, "episode_reward_min": -803946.1641247631, "episode_reward_mean": -801752.8251254577, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 144000, "policy_reward_min": {"default_policy": -803946.1641247631}, "policy_reward_max": {"default_policy": -799469.6508991551}, "policy_reward_mean": {"default_policy": -801752.8251254577}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9638313626033628, "mean_inference_ms": 4.472261499311829, "mean_action_processing_ms": 0.787430067595315, "mean_env_wait_ms": 103.74575390504566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10007619857788086, "StateBufferConnector_ms": 0.03755390644073486, "ViewRequirementAgentConnector_ms": 0.1373201608657837}, "num_episodes": 0, "episode_return_max": -799469.6508991551, "episode_return_min": -803946.1641247631, "episode_return_mean": -801752.8251254577, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 73.41410155515221, "num_env_steps_trained_throughput_per_sec": 73.41410155515221, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 156000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 217134.421, "restore_workers_time_ms": 0.0, "training_step_time_ms": 217134.321, "sample_time_ms": 184385.801, "load_time_ms": 11.7, "load_throughput": 1025629.673, "learn_time_ms": 32726.869, "learn_throughput": 366.671, "synch_weights_time_ms": 8.953}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "training_iteration": 13, "trial_id": "befd4_00000", "date": "2025-01-22_19-42-10", "timestamp": 1737603730, "time_this_iter_s": 163.4593369960785, "time_total_s": 2685.4352209568024, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2685.4352209568024, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 3.1876777251184834, "ram_util_percent": 37.905687203791466, "gpu_util_percent0": 0.07654028436018959, "vram_util_percent0": 0.10146484375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.658788699961775, "policy_loss": 0.005034236599459344, "vf_loss": 30.0, "vf_explained_var": -0.0005655537665235395, "kl": 0.0, "entropy": 34.62455577866118, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 16322.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "env_runners": {"episode_reward_max": -799469.6508991551, "episode_reward_min": -803946.1641247631, "episode_reward_mean": -801752.8251254577, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 144000, "policy_reward_min": {"default_policy": -803946.1641247631}, "policy_reward_max": {"default_policy": -799469.6508991551}, "policy_reward_mean": {"default_policy": -801752.8251254577}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9638313626033628, "mean_inference_ms": 4.472261499311829, "mean_action_processing_ms": 0.787430067595315, "mean_env_wait_ms": 103.74575390504566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10007619857788086, "StateBufferConnector_ms": 0.03755390644073486, "ViewRequirementAgentConnector_ms": 0.1373201608657837}, "num_episodes": 0, "episode_return_max": -799469.6508991551, "episode_return_min": -803946.1641247631, "episode_return_mean": -801752.8251254577, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 64.82292578668033, "num_env_steps_trained_throughput_per_sec": 64.82292578668033, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 168000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 214230.256, "restore_workers_time_ms": 0.0, "training_step_time_ms": 214230.256, "sample_time_ms": 181581.772, "load_time_ms": 11.8, "load_throughput": 1016926.288, "learn_time_ms": 32626.732, "learn_throughput": 367.797, "synch_weights_time_ms": 8.852}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "training_iteration": 14, "trial_id": "befd4_00000", "date": "2025-01-22_19-45-15", "timestamp": 1737603915, "time_this_iter_s": 185.12169122695923, "time_total_s": 2870.5569121837616, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2870.5569121837616, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 5.757142857142857, "ram_util_percent": 38.07605042016807, "gpu_util_percent0": 0.06609243697478993, "vram_util_percent0": 0.10146484375000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.66364884199043, "policy_loss": 0.00585757965349875, "vf_loss": 30.0, "vf_explained_var": -0.0003084447681657335, "kl": 0.0, "entropy": 34.22086705601442, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 17531.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "env_runners": {"episode_reward_max": -799469.6508991551, "episode_reward_min": -803946.1641247631, "episode_reward_mean": -801752.8251254577, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 144000, "policy_reward_min": {"default_policy": -803946.1641247631}, "policy_reward_max": {"default_policy": -799469.6508991551}, "policy_reward_mean": {"default_policy": -801752.8251254577}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9638313626033628, "mean_inference_ms": 4.472261499311829, "mean_action_processing_ms": 0.787430067595315, "mean_env_wait_ms": 103.74575390504566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10007619857788086, "StateBufferConnector_ms": 0.03755390644073486, "ViewRequirementAgentConnector_ms": 0.1373201608657837}, "num_episodes": 0, "episode_return_max": -799469.6508991551, "episode_return_min": -803946.1641247631, "episode_return_mean": -801752.8251254577, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 59.17501066076452, "num_env_steps_trained_throughput_per_sec": 59.17501066076452, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 180000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 212083.17, "restore_workers_time_ms": 0.0, "training_step_time_ms": 212083.17, "sample_time_ms": 179549.259, "load_time_ms": 11.8, "load_throughput": 1016967.383, "learn_time_ms": 32512.21, "learn_throughput": 369.092, "synch_weights_time_ms": 8.901}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "training_iteration": 15, "trial_id": "befd4_00000", "date": "2025-01-22_19-48-38", "timestamp": 1737604118, "time_this_iter_s": 202.79130101203918, "time_total_s": 3073.348213195801, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3073.348213195801, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 8.850000000000001, "ram_util_percent": 38.19045801526717, "gpu_util_percent0": 0.06183206106870229, "vram_util_percent0": 0.10131053196564886}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.663855627610527, "policy_loss": 0.006265207376358823, "vf_loss": 30.0, "vf_explained_var": -0.00021630141042893933, "kl": 0.0, "entropy": 34.24096119946147, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 18740.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": -799469.6508991551, "episode_reward_min": -803946.1641247631, "episode_reward_mean": -801752.8251254577, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 144000, "policy_reward_min": {"default_policy": -803946.1641247631}, "policy_reward_max": {"default_policy": -799469.6508991551}, "policy_reward_mean": {"default_policy": -801752.8251254577}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9638313626033628, "mean_inference_ms": 4.472261499311829, "mean_action_processing_ms": 0.787430067595315, "mean_env_wait_ms": 103.74575390504566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10007619857788086, "StateBufferConnector_ms": 0.03755390644073486, "ViewRequirementAgentConnector_ms": 0.1373201608657837}, "num_episodes": 0, "episode_return_max": -799469.6508991551, "episode_return_min": -803946.1641247631, "episode_return_mean": -801752.8251254577, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 54.94478350689638, "num_env_steps_trained_throughput_per_sec": 54.94478350689638, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 211044.725, "restore_workers_time_ms": 0.0, "training_step_time_ms": 211044.725, "sample_time_ms": 178411.498, "load_time_ms": 11.6, "load_throughput": 1034517.34, "learn_time_ms": 32611.626, "learn_throughput": 367.967, "synch_weights_time_ms": 8.901}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 16, "trial_id": "befd4_00000", "date": "2025-01-22_19-52-16", "timestamp": 1737604336, "time_this_iter_s": 218.41008114814758, "time_total_s": 3291.7582943439484, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3291.7582943439484, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 8.679787234042552, "ram_util_percent": 38.21914893617021, "gpu_util_percent0": 0.056631205673758865, "vram_util_percent0": 0.1002403313386525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.663262817660474, "policy_loss": 0.005251456973373249, "vf_loss": 30.0, "vf_explained_var": -0.0002542447215570114, "kl": 0.0, "entropy": 34.19886174292679, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 19949.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "env_runners": {"episode_reward_max": -799469.6508991551, "episode_reward_min": -803946.1641247631, "episode_reward_mean": -801752.8251254577, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 144000, "policy_reward_min": {"default_policy": -803946.1641247631}, "policy_reward_max": {"default_policy": -799469.6508991551}, "policy_reward_mean": {"default_policy": -801752.8251254577}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9638313626033628, "mean_inference_ms": 4.472261499311829, "mean_action_processing_ms": 0.787430067595315, "mean_env_wait_ms": 103.74575390504566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10007619857788086, "StateBufferConnector_ms": 0.03755390644073486, "ViewRequirementAgentConnector_ms": 0.1373201608657837}, "num_episodes": 0, "episode_return_max": -799469.6508991551, "episode_return_min": -803946.1641247631, "episode_return_mean": -801752.8251254577, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 53.04387427773205, "num_env_steps_trained_throughput_per_sec": 53.04387427773205, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 204000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 210368.68, "restore_workers_time_ms": 0.0, "training_step_time_ms": 210368.68, "sample_time_ms": 177862.295, "load_time_ms": 11.6, "load_throughput": 1034519.467, "learn_time_ms": 32484.884, "learn_throughput": 369.403, "synch_weights_time_ms": 8.902}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "training_iteration": 17, "trial_id": "befd4_00000", "date": "2025-01-22_19-56-02", "timestamp": 1737604562, "time_this_iter_s": 226.2313311100006, "time_total_s": 3517.989625453949, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3517.989625453949, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 8.615463917525773, "ram_util_percent": 38.32164948453608, "gpu_util_percent0": 0.05467353951890033, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.663720093846223, "policy_loss": 0.005304897473655129, "vf_loss": 30.0, "vf_explained_var": -0.0002800836062214412, "kl": 0.0, "entropy": 34.158480982626635, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 21158.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "env_runners": {"episode_reward_max": -799469.6508991551, "episode_reward_min": -803946.1641247631, "episode_reward_mean": -801752.8251254577, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 144000, "policy_reward_min": {"default_policy": -803946.1641247631}, "policy_reward_max": {"default_policy": -799469.6508991551}, "policy_reward_mean": {"default_policy": -801752.8251254577}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9638313626033628, "mean_inference_ms": 4.472261499311829, "mean_action_processing_ms": 0.787430067595315, "mean_env_wait_ms": 103.74575390504566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10007619857788086, "StateBufferConnector_ms": 0.03755390644073486, "ViewRequirementAgentConnector_ms": 0.1373201608657837}, "num_episodes": 0, "episode_return_max": -799469.6508991551, "episode_return_min": -803946.1641247631, "episode_return_mean": -801752.8251254577, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.185172759936464, "num_env_steps_trained_throughput_per_sec": 52.185172759936464, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 216000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 210056.92, "restore_workers_time_ms": 0.0, "training_step_time_ms": 210056.92, "sample_time_ms": 177649.1, "load_time_ms": 11.599, "load_throughput": 1034530.099, "learn_time_ms": 32386.318, "learn_throughput": 370.527, "synch_weights_time_ms": 8.802}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "training_iteration": 18, "trial_id": "befd4_00000", "date": "2025-01-22_19-59-52", "timestamp": 1737604792, "time_this_iter_s": 229.9523730278015, "time_total_s": 3747.9419984817505, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3747.9419984817505, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 8.623905723905725, "ram_util_percent": 38.388888888888886, "gpu_util_percent0": 0.05457912457912458, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.664802537070905, "policy_loss": 0.004819156437175544, "vf_loss": 30.0, "vf_explained_var": -0.0002351525502327161, "kl": 0.0, "entropy": 34.00165933020555, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 22367.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "env_runners": {"episode_reward_max": -799469.6508991551, "episode_reward_min": -803946.1641247631, "episode_reward_mean": -801752.8251254577, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 144000, "policy_reward_min": {"default_policy": -803946.1641247631}, "policy_reward_max": {"default_policy": -799469.6508991551}, "policy_reward_mean": {"default_policy": -801752.8251254577}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9638313626033628, "mean_inference_ms": 4.472261499311829, "mean_action_processing_ms": 0.787430067595315, "mean_env_wait_ms": 103.74575390504566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10007619857788086, "StateBufferConnector_ms": 0.03755390644073486, "ViewRequirementAgentConnector_ms": 0.1373201608657837}, "num_episodes": 0, "episode_return_max": -799469.6508991551, "episode_return_min": -803946.1641247631, "episode_return_mean": -801752.8251254577, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 51.72444485070846, "num_env_steps_trained_throughput_per_sec": 51.72444485070846, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 228000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 209728.094, "restore_workers_time_ms": 0.0, "training_step_time_ms": 209728.094, "sample_time_ms": 177449.667, "load_time_ms": 11.699, "load_throughput": 1025757.177, "learn_time_ms": 32256.526, "learn_throughput": 372.018, "synch_weights_time_ms": 8.802}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "training_iteration": 19, "trial_id": "befd4_00000", "date": "2025-01-22_20-03-44", "timestamp": 1737605024, "time_this_iter_s": 232.0016222000122, "time_total_s": 3979.9436206817627, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3979.9436206817627, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 8.532775919732442, "ram_util_percent": 38.4066889632107, "gpu_util_percent0": 0.052508361204013386, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.662652775312477, "policy_loss": 0.0029241927183788607, "vf_loss": 30.0, "vf_explained_var": -0.00029660119213675346, "kl": 0.0, "entropy": 34.027142000158925, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 23576.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": -799469.6508991551, "episode_reward_min": -803946.1641247631, "episode_reward_mean": -801752.8251254577, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 144000, "policy_reward_min": {"default_policy": -803946.1641247631}, "policy_reward_max": {"default_policy": -799469.6508991551}, "policy_reward_mean": {"default_policy": -801752.8251254577}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9638313626033628, "mean_inference_ms": 4.472261499311829, "mean_action_processing_ms": 0.787430067595315, "mean_env_wait_ms": 103.74575390504566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10007619857788086, "StateBufferConnector_ms": 0.03755390644073486, "ViewRequirementAgentConnector_ms": 0.1373201608657837}, "num_episodes": 0, "episode_return_max": -799469.6508991551, "episode_return_min": -803946.1641247631, "episode_return_mean": -801752.8251254577, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 51.97451566304475, "num_env_steps_trained_throughput_per_sec": 51.97451566304475, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 209224.178, "restore_workers_time_ms": 0.0, "training_step_time_ms": 209224.178, "sample_time_ms": 177142.397, "load_time_ms": 11.699, "load_throughput": 1025727.911, "learn_time_ms": 32059.981, "learn_throughput": 374.298, "synch_weights_time_ms": 8.601}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 20, "trial_id": "befd4_00000", "date": "2025-01-22_20-07-35", "timestamp": 1737605255, "time_this_iter_s": 230.88438200950623, "time_total_s": 4210.828002691269, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4210.828002691269, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 8.52020202020202, "ram_util_percent": 38.41077441077441, "gpu_util_percent0": 0.05306397306397307, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.66399689604173, "policy_loss": 0.0047781049058987545, "vf_loss": 30.0, "vf_explained_var": -0.00023534053411239231, "kl": 0.0, "entropy": 34.07811821305722, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 24785.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "env_runners": {"episode_reward_max": -799469.6508991551, "episode_reward_min": -803946.1641247631, "episode_reward_mean": -801752.8251254577, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 144000, "policy_reward_min": {"default_policy": -803946.1641247631}, "policy_reward_max": {"default_policy": -799469.6508991551}, "policy_reward_mean": {"default_policy": -801752.8251254577}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9638313626033628, "mean_inference_ms": 4.472261499311829, "mean_action_processing_ms": 0.787430067595315, "mean_env_wait_ms": 103.74575390504566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10007619857788086, "StateBufferConnector_ms": 0.03755390644073486, "ViewRequirementAgentConnector_ms": 0.1373201608657837}, "num_episodes": 0, "episode_return_max": -799469.6508991551, "episode_return_min": -803946.1641247631, "episode_return_mean": -801752.8251254577, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.182730107540465, "num_env_steps_trained_throughput_per_sec": 52.182730107540465, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 252000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 208602.085, "restore_workers_time_ms": 0.0, "training_step_time_ms": 208602.085, "sample_time_ms": 176786.045, "load_time_ms": 11.799, "load_throughput": 1017037.251, "learn_time_ms": 31794.94, "learn_throughput": 377.419, "synch_weights_time_ms": 7.801}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "training_iteration": 21, "trial_id": "befd4_00000", "date": "2025-01-22_20-11-25", "timestamp": 1737605485, "time_this_iter_s": 229.96413350105286, "time_total_s": 4440.792136192322, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4440.792136192322, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 8.34040404040404, "ram_util_percent": 38.439057239057234, "gpu_util_percent0": 0.05333333333333333, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.664813487366075, "policy_loss": 0.004920710787189411, "vf_loss": 30.0, "vf_explained_var": -0.00029485831091086466, "kl": 0.0, "entropy": 34.01072271014167, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 25994.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "env_runners": {"episode_reward_max": -799469.6508991551, "episode_reward_min": -803946.1641247631, "episode_reward_mean": -801752.8251254577, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 144000, "policy_reward_min": {"default_policy": -803946.1641247631}, "policy_reward_max": {"default_policy": -799469.6508991551}, "policy_reward_mean": {"default_policy": -801752.8251254577}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9638313626033628, "mean_inference_ms": 4.472261499311829, "mean_action_processing_ms": 0.787430067595315, "mean_env_wait_ms": 103.74575390504566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10007619857788086, "StateBufferConnector_ms": 0.03755390644073486, "ViewRequirementAgentConnector_ms": 0.1373201608657837}, "num_episodes": 0, "episode_return_max": -799469.6508991551, "episode_return_min": -803946.1641247631, "episode_return_mean": -801752.8251254577, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.07636840316448, "num_env_steps_trained_throughput_per_sec": 52.07636840316448, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 264000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 214921.656, "restore_workers_time_ms": 0.0, "training_step_time_ms": 214921.656, "sample_time_ms": 183059.473, "load_time_ms": 11.899, "load_throughput": 1008488.579, "learn_time_ms": 31840.981, "learn_throughput": 376.873, "synch_weights_time_ms": 7.703}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "training_iteration": 22, "trial_id": "befd4_00000", "date": "2025-01-22_20-15-16", "timestamp": 1737605716, "time_this_iter_s": 230.43281412124634, "time_total_s": 4671.224950313568, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4671.224950313568, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 8.316161616161615, "ram_util_percent": 38.490235690235686, "gpu_util_percent0": 0.0536026936026936, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.69319371175332, "policy_loss": -0.0038570683785368333, "vf_loss": 29.95793819348609, "vf_explained_var": -0.0010398764369702713, "kl": 0.0, "entropy": 26.088741089510858, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 27203.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "env_runners": {"episode_reward_max": -799469.6508991551, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -802119.5212337753, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 288000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -799469.6508991551}, "policy_reward_mean": {"default_policy": -802119.5212337753}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9632709083447775, "mean_inference_ms": 4.459275050954853, "mean_action_processing_ms": 0.7833247341643523, "mean_env_wait_ms": 104.20226750038734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11877566576004028, "StateBufferConnector_ms": 0.02502650022506714, "ViewRequirementAgentConnector_ms": 0.12491047382354736}, "num_episodes": 8, "episode_return_max": -799469.6508991551, "episode_return_min": -804649.9336273633, "episode_return_mean": -802119.5212337753, "episodes_this_iter": 8}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 62.79191498862401, "num_env_steps_trained_throughput_per_sec": 62.79191498862401, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 276000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 217686.763, "restore_workers_time_ms": 0.0, "training_step_time_ms": 217686.763, "sample_time_ms": 185755.579, "load_time_ms": 11.899, "load_throughput": 1008496.662, "learn_time_ms": 31910.682, "learn_throughput": 376.05, "synch_weights_time_ms": 7.203}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "training_iteration": 23, "trial_id": "befd4_00000", "date": "2025-01-22_20-18-27", "timestamp": 1737605907, "time_this_iter_s": 191.1114044189453, "time_total_s": 4862.336354732513, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4862.336354732513, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 6.578861788617886, "ram_util_percent": 38.171951219512195, "gpu_util_percent0": 0.06467479674796749, "vram_util_percent0": 0.10029296875000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.279808012881094, "policy_loss": -0.012948249838784079, "vf_loss": 29.65325542320586, "vf_explained_var": 0.034936792205640166, "kl": 0.0, "entropy": 36.04991880342722, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 28412.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": -799469.6508991551, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -802119.5212337753, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 288000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -799469.6508991551}, "policy_reward_mean": {"default_policy": -802119.5212337753}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9632709083447775, "mean_inference_ms": 4.459275050954853, "mean_action_processing_ms": 0.7833247341643523, "mean_env_wait_ms": 104.20226750038734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11877566576004028, "StateBufferConnector_ms": 0.02502650022506714, "ViewRequirementAgentConnector_ms": 0.12491047382354736}, "num_episodes": 0, "episode_return_max": -799469.6508991551, "episode_return_min": -804649.9336273633, "episode_return_mean": -802119.5212337753, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 74.29609398175022, "num_env_steps_trained_throughput_per_sec": 74.29609398175022, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 215326.383, "restore_workers_time_ms": 0.0, "training_step_time_ms": 215326.383, "sample_time_ms": 183325.591, "load_time_ms": 11.899, "load_throughput": 1008472.414, "learn_time_ms": 31980.39, "learn_throughput": 375.23, "synch_weights_time_ms": 7.204}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 24, "trial_id": "befd4_00000", "date": "2025-01-22_20-21-08", "timestamp": 1737606068, "time_this_iter_s": 161.5188925266266, "time_total_s": 5023.85524725914, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5023.85524725914, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 3.6230769230769235, "ram_util_percent": 37.88461538461538, "gpu_util_percent0": 0.07442307692307691, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.64410222907812, "policy_loss": 0.0052161311639844134, "vf_loss": 30.0, "vf_explained_var": -0.002320444712074854, "kl": 0.0, "entropy": 36.11139069360776, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 29621.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "env_runners": {"episode_reward_max": -799469.6508991551, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -802119.5212337753, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 288000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -799469.6508991551}, "policy_reward_mean": {"default_policy": -802119.5212337753}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9632709083447775, "mean_inference_ms": 4.459275050954853, "mean_action_processing_ms": 0.7833247341643523, "mean_env_wait_ms": 104.20226750038734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11877566576004028, "StateBufferConnector_ms": 0.02502650022506714, "ViewRequirementAgentConnector_ms": 0.12491047382354736}, "num_episodes": 0, "episode_return_max": -799469.6508991551, "episode_return_min": -804649.9336273633, "episode_return_mean": -802119.5212337753, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 65.13430883008714, "num_env_steps_trained_throughput_per_sec": 65.13430883008714, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 300000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 213471.023, "restore_workers_time_ms": 0.0, "training_step_time_ms": 213471.023, "sample_time_ms": 181451.956, "load_time_ms": 11.9, "load_throughput": 1008442.105, "learn_time_ms": 31998.565, "learn_throughput": 375.017, "synch_weights_time_ms": 7.303}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "training_iteration": 25, "trial_id": "befd4_00000", "date": "2025-01-22_20-24-13", "timestamp": 1737606253, "time_this_iter_s": 184.23870706558228, "time_total_s": 5208.093954324722, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5208.093954324722, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 5.023949579831933, "ram_util_percent": 37.98823529411765, "gpu_util_percent0": 0.06701680672268907, "vram_util_percent0": 0.10029296875000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.643251658866383, "policy_loss": 0.003897077472521511, "vf_loss": 30.0, "vf_explained_var": -0.00030720174756298585, "kl": 0.0, "entropy": 36.06454247536987, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 30830.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "env_runners": {"episode_reward_max": -799469.6508991551, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -802119.5212337753, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 288000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -799469.6508991551}, "policy_reward_mean": {"default_policy": -802119.5212337753}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9632709083447775, "mean_inference_ms": 4.459275050954853, "mean_action_processing_ms": 0.7833247341643523, "mean_env_wait_ms": 104.20226750038734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11877566576004028, "StateBufferConnector_ms": 0.02502650022506714, "ViewRequirementAgentConnector_ms": 0.12491047382354736}, "num_episodes": 0, "episode_return_max": -799469.6508991551, "episode_return_min": -804649.9336273633, "episode_return_mean": -802119.5212337753, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 58.8528376618794, "num_env_steps_trained_throughput_per_sec": 58.8528376618794, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 312000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 212020.756, "restore_workers_time_ms": 0.0, "training_step_time_ms": 212020.756, "sample_time_ms": 180029.141, "load_time_ms": 11.9, "load_throughput": 1008434.023, "learn_time_ms": 31970.612, "learn_throughput": 375.345, "synch_weights_time_ms": 7.804}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "training_iteration": 26, "trial_id": "befd4_00000", "date": "2025-01-22_20-27-37", "timestamp": 1737606457, "time_this_iter_s": 203.90140771865845, "time_total_s": 5411.995362043381, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5411.995362043381, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 9.040684410646389, "ram_util_percent": 38.16653992395438, "gpu_util_percent0": 0.062433460076045645, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.64179602844642, "policy_loss": 0.004449224088732323, "vf_loss": 30.0, "vf_explained_var": -0.00018413186171904785, "kl": 0.0, "entropy": 36.26532224429551, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 32039.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "env_runners": {"episode_reward_max": -799469.6508991551, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -802119.5212337753, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 288000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -799469.6508991551}, "policy_reward_mean": {"default_policy": -802119.5212337753}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9632709083447775, "mean_inference_ms": 4.459275050954853, "mean_action_processing_ms": 0.7833247341643523, "mean_env_wait_ms": 104.20226750038734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11877566576004028, "StateBufferConnector_ms": 0.02502650022506714, "ViewRequirementAgentConnector_ms": 0.12491047382354736}, "num_episodes": 0, "episode_return_max": -799469.6508991551, "episode_return_min": -804649.9336273633, "episode_return_mean": -802119.5212337753, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 55.392851215531884, "num_env_steps_trained_throughput_per_sec": 55.392851215531884, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 324000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 211061.42, "restore_workers_time_ms": 0.0, "training_step_time_ms": 211061.42, "sample_time_ms": 178927.57, "load_time_ms": 11.9, "load_throughput": 1008395.636, "learn_time_ms": 32112.746, "learn_throughput": 373.683, "synch_weights_time_ms": 7.804}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "training_iteration": 27, "trial_id": "befd4_00000", "date": "2025-01-22_20-31-13", "timestamp": 1737606673, "time_this_iter_s": 216.6374547481537, "time_total_s": 5628.632816791534, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5628.632816791534, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 8.798566308243727, "ram_util_percent": 38.24695340501792, "gpu_util_percent0": 0.05842293906810037, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.64236669958476, "policy_loss": 0.004722818454944762, "vf_loss": 30.0, "vf_explained_var": -0.00015128945594390037, "kl": 0.0, "entropy": 36.235611630827066, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 33248.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": -799469.6508991551, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -802119.5212337753, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 288000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -799469.6508991551}, "policy_reward_mean": {"default_policy": -802119.5212337753}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9632709083447775, "mean_inference_ms": 4.459275050954853, "mean_action_processing_ms": 0.7833247341643523, "mean_env_wait_ms": 104.20226750038734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11877566576004028, "StateBufferConnector_ms": 0.02502650022506714, "ViewRequirementAgentConnector_ms": 0.12491047382354736}, "num_episodes": 0, "episode_return_max": -799469.6508991551, "episode_return_min": -804649.9336273633, "episode_return_mean": -802119.5212337753, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 53.46281193811016, "num_env_steps_trained_throughput_per_sec": 53.46281193811016, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 210511.891, "restore_workers_time_ms": 0.0, "training_step_time_ms": 210511.891, "sample_time_ms": 178331.43, "load_time_ms": 11.9, "load_throughput": 1008407.758, "learn_time_ms": 32159.458, "learn_throughput": 373.141, "synch_weights_time_ms": 7.903}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 28, "trial_id": "befd4_00000", "date": "2025-01-22_20-34-58", "timestamp": 1737606898, "time_this_iter_s": 224.45808339118958, "time_total_s": 5853.090900182724, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5853.090900182724, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 8.706574394463667, "ram_util_percent": 38.403114186851205, "gpu_util_percent0": 0.05584775086505191, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.64315837389975, "policy_loss": 0.005430878126936771, "vf_loss": 30.0, "vf_explained_var": 5.9149499961026354e-05, "kl": 0.0, "entropy": 36.227249177060315, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 34457.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "env_runners": {"episode_reward_max": -799469.6508991551, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -802119.5212337753, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 288000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -799469.6508991551}, "policy_reward_mean": {"default_policy": -802119.5212337753}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9632709083447775, "mean_inference_ms": 4.459275050954853, "mean_action_processing_ms": 0.7833247341643523, "mean_env_wait_ms": 104.20226750038734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11877566576004028, "StateBufferConnector_ms": 0.02502650022506714, "ViewRequirementAgentConnector_ms": 0.12491047382354736}, "num_episodes": 0, "episode_return_max": -799469.6508991551, "episode_return_min": -804649.9336273633, "episode_return_mean": -802119.5212337753, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.601356998254204, "num_env_steps_trained_throughput_per_sec": 52.601356998254204, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 348000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 210125.128, "restore_workers_time_ms": 0.0, "training_step_time_ms": 210125.128, "sample_time_ms": 177968.922, "load_time_ms": 11.999, "load_throughput": 1000056.588, "learn_time_ms": 32135.404, "learn_throughput": 373.42, "synch_weights_time_ms": 7.803}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "training_iteration": 29, "trial_id": "befd4_00000", "date": "2025-01-22_20-38-46", "timestamp": 1737607126, "time_this_iter_s": 228.13399744033813, "time_total_s": 6081.224897623062, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6081.224897623062, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 8.68231292517007, "ram_util_percent": 38.47517006802721, "gpu_util_percent0": 0.05377551020408164, "vram_util_percent0": 0.10029296875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.64121327112291, "policy_loss": 0.004917433030897177, "vf_loss": 30.0, "vf_explained_var": 6.836652755737305e-05, "kl": 0.0, "entropy": 36.37041267035321, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 35666.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": -799469.6508991551, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -802119.5212337753, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 288000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -799469.6508991551}, "policy_reward_mean": {"default_policy": -802119.5212337753}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9632709083447775, "mean_inference_ms": 4.459275050954853, "mean_action_processing_ms": 0.7833247341643523, "mean_env_wait_ms": 104.20226750038734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11877566576004028, "StateBufferConnector_ms": 0.02502650022506714, "ViewRequirementAgentConnector_ms": 0.12491047382354736}, "num_episodes": 0, "episode_return_max": -799469.6508991551, "episode_return_min": -804649.9336273633, "episode_return_mean": -802119.5212337753, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.44355116911249, "num_env_steps_trained_throughput_per_sec": 52.44355116911249, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 209918.636, "restore_workers_time_ms": 0.0, "training_step_time_ms": 209918.636, "sample_time_ms": 177785.624, "load_time_ms": 12.0, "load_throughput": 1000032.744, "learn_time_ms": 32112.208, "learn_throughput": 373.69, "synch_weights_time_ms": 7.804}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 30, "trial_id": "befd4_00000", "date": "2025-01-22_20-42-35", "timestamp": 1737607355, "time_this_iter_s": 228.82145810127258, "time_total_s": 6310.046355724335, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6310.046355724335, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 8.678983050847458, "ram_util_percent": 38.457288135593224, "gpu_util_percent0": 0.053593220338983054, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.640721168865145, "policy_loss": 0.005138057010591868, "vf_loss": 30.0, "vf_explained_var": 0.00011764645477875488, "kl": 0.0, "entropy": 36.44169369958668, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 36875.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "env_runners": {"episode_reward_max": -799469.6508991551, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -802119.5212337753, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 288000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -799469.6508991551}, "policy_reward_mean": {"default_policy": -802119.5212337753}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9632709083447775, "mean_inference_ms": 4.459275050954853, "mean_action_processing_ms": 0.7833247341643523, "mean_env_wait_ms": 104.20226750038734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11877566576004028, "StateBufferConnector_ms": 0.02502650022506714, "ViewRequirementAgentConnector_ms": 0.12491047382354736}, "num_episodes": 0, "episode_return_max": -799469.6508991551, "episode_return_min": -804649.9336273633, "episode_return_mean": -802119.5212337753, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.65573838894532, "num_env_steps_trained_throughput_per_sec": 52.65573838894532, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 372000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 209712.061, "restore_workers_time_ms": 0.0, "training_step_time_ms": 209712.061, "sample_time_ms": 177546.994, "load_time_ms": 12.0, "load_throughput": 1000016.849, "learn_time_ms": 32144.164, "learn_throughput": 373.318, "synch_weights_time_ms": 7.904}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "training_iteration": 31, "trial_id": "befd4_00000", "date": "2025-01-22_20-46-23", "timestamp": 1737607583, "time_this_iter_s": 227.89838981628418, "time_total_s": 6537.944745540619, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6537.944745540619, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 8.678231292517006, "ram_util_percent": 38.427891156462586, "gpu_util_percent0": 0.052823129251700685, "vram_util_percent0": 0.10029296875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.639594332850404, "policy_loss": 0.0037542950944332567, "vf_loss": 30.0, "vf_explained_var": 3.4010341287743856e-05, "kl": 0.0, "entropy": 36.41599275890316, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 38084.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": -799469.6508991551, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -802119.5212337753, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 288000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -799469.6508991551}, "policy_reward_mean": {"default_policy": -802119.5212337753}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9632709083447775, "mean_inference_ms": 4.459275050954853, "mean_action_processing_ms": 0.7833247341643523, "mean_env_wait_ms": 104.20226750038734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11877566576004028, "StateBufferConnector_ms": 0.02502650022506714, "ViewRequirementAgentConnector_ms": 0.12491047382354736}, "num_episodes": 0, "episode_return_max": -799469.6508991551, "episode_return_min": -804649.9336273633, "episode_return_mean": -802119.5212337753, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.13183987997967, "num_env_steps_trained_throughput_per_sec": 52.13183987997967, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 209687.541, "restore_workers_time_ms": 0.0, "training_step_time_ms": 209687.541, "sample_time_ms": 177498.193, "load_time_ms": 12.0, "load_throughput": 999979.099, "learn_time_ms": 32168.447, "learn_throughput": 373.036, "synch_weights_time_ms": 7.901}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 32, "trial_id": "befd4_00000", "date": "2025-01-22_20-50-13", "timestamp": 1737607813, "time_this_iter_s": 230.1886215209961, "time_total_s": 6768.133367061615, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6768.133367061615, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 8.58310810810811, "ram_util_percent": 38.46554054054054, "gpu_util_percent0": 0.05358108108108108, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.639052415505432, "policy_loss": 0.004455176175158314, "vf_loss": 30.0, "vf_explained_var": 0.00019353711969897805, "kl": 0.0, "entropy": 36.54027584823722, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 39293.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "env_runners": {"episode_reward_max": -799469.6508991551, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -802119.5212337753, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 288000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -799469.6508991551}, "policy_reward_mean": {"default_policy": -802119.5212337753}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9632709083447775, "mean_inference_ms": 4.459275050954853, "mean_action_processing_ms": 0.7833247341643523, "mean_env_wait_ms": 104.20226750038734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11877566576004028, "StateBufferConnector_ms": 0.02502650022506714, "ViewRequirementAgentConnector_ms": 0.12491047382354736}, "num_episodes": 0, "episode_return_max": -799469.6508991551, "episode_return_min": -804649.9336273633, "episode_return_mean": -802119.5212337753, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.336860872339265, "num_env_steps_trained_throughput_per_sec": 52.336860872339265, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 396000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 213505.192, "restore_workers_time_ms": 0.0, "training_step_time_ms": 213505.192, "sample_time_ms": 181346.77, "load_time_ms": 12.1, "load_throughput": 991713.62, "learn_time_ms": 32137.421, "learn_throughput": 373.396, "synch_weights_time_ms": 8.001}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "training_iteration": 33, "trial_id": "befd4_00000", "date": "2025-01-22_20-54-02", "timestamp": 1737608042, "time_this_iter_s": 229.28690457344055, "time_total_s": 6997.4202716350555, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6997.4202716350555, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 8.380743243243243, "ram_util_percent": 38.46756756756757, "gpu_util_percent0": 0.05334459459459459, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.674232580722908, "policy_loss": 0.0018500418728101934, "vf_loss": 30.0, "vf_explained_var": -0.004277057347956327, "kl": 0.0, "entropy": 32.76174186220634, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 40502.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "env_runners": {"episode_reward_max": -799062.9912408941, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -801523.7028436383, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 432000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -799062.9912408941}, "policy_reward_mean": {"default_policy": -801523.7028436383}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9633993200948895, "mean_inference_ms": 4.450592972974963, "mean_action_processing_ms": 0.7815446173684775, "mean_env_wait_ms": 104.47169715523101, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10835925738016765, "StateBufferConnector_ms": 0.033342838287353516, "ViewRequirementAgentConnector_ms": 0.13395249843597412}, "num_episodes": 8, "episode_return_max": -799062.9912408941, "episode_return_min": -804649.9336273633, "episode_return_mean": -801523.7028436383, "episodes_this_iter": 8}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 56.85005424168114, "num_env_steps_trained_throughput_per_sec": 56.85005424168114, "timesteps_total": 408000, "num_env_steps_sampled_lifetime": 408000, "num_agent_steps_sampled_lifetime": 408000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 218461.762, "restore_workers_time_ms": 0.0, "training_step_time_ms": 218461.762, "sample_time_ms": 186244.457, "load_time_ms": 12.2, "load_throughput": 983585.583, "learn_time_ms": 32196.203, "learn_throughput": 372.715, "synch_weights_time_ms": 8.001}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "done": false, "training_iteration": 34, "trial_id": "befd4_00000", "date": "2025-01-22_20-57-34", "timestamp": 1737608254, "time_this_iter_s": 211.0855929851532, "time_total_s": 7208.505864620209, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7208.505864620209, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 7.650735294117647, "ram_util_percent": 38.273529411764706, "gpu_util_percent0": 0.059411764705882365, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.276344345067532, "policy_loss": -0.02935334019874422, "vf_loss": 29.612583942902393, "vf_explained_var": 0.05117094166718602, "kl": 0.0, "entropy": 30.688627020596865, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 41711.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "env_runners": {"episode_reward_max": -799062.9912408941, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -801523.7028436383, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 432000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -799062.9912408941}, "policy_reward_mean": {"default_policy": -801523.7028436383}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9633993200948895, "mean_inference_ms": 4.450592972974963, "mean_action_processing_ms": 0.7815446173684775, "mean_env_wait_ms": 104.47169715523101, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10835925738016765, "StateBufferConnector_ms": 0.033342838287353516, "ViewRequirementAgentConnector_ms": 0.13395249843597412}, "num_episodes": 0, "episode_return_max": -799062.9912408941, "episode_return_min": -804649.9336273633, "episode_return_mean": -801523.7028436383, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 77.36448355126306, "num_env_steps_trained_throughput_per_sec": 77.36448355126306, "timesteps_total": 420000, "num_env_steps_sampled_lifetime": 420000, "num_agent_steps_sampled_lifetime": 420000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 215549.285, "restore_workers_time_ms": 0.0, "training_step_time_ms": 215549.285, "sample_time_ms": 183336.057, "load_time_ms": 12.2, "load_throughput": 983577.894, "learn_time_ms": 32192.126, "learn_throughput": 372.762, "synch_weights_time_ms": 7.901}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "done": false, "training_iteration": 35, "trial_id": "befd4_00000", "date": "2025-01-22_21-00-09", "timestamp": 1737608409, "time_this_iter_s": 155.112934589386, "time_total_s": 7363.618799209595, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7363.618799209595, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 3.5555000000000003, "ram_util_percent": 37.8375, "gpu_util_percent0": 0.0799, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.64250964345372, "policy_loss": 0.00329854644409776, "vf_loss": 30.0, "vf_explained_var": 0.0008503797135144053, "kl": 0.0, "entropy": 36.07888736835287, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 42920.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": -799062.9912408941, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -801523.7028436383, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 432000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -799062.9912408941}, "policy_reward_mean": {"default_policy": -801523.7028436383}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9633993200948895, "mean_inference_ms": 4.450592972974963, "mean_action_processing_ms": 0.7815446173684775, "mean_env_wait_ms": 104.47169715523101, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10835925738016765, "StateBufferConnector_ms": 0.033342838287353516, "ViewRequirementAgentConnector_ms": 0.13395249843597412}, "num_episodes": 0, "episode_return_max": -799062.9912408941, "episode_return_min": -804649.9336273633, "episode_return_mean": -801523.7028436383, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 66.67103319155798, "num_env_steps_trained_throughput_per_sec": 66.67103319155798, "timesteps_total": 432000, "num_env_steps_sampled_lifetime": 432000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 213158.265, "restore_workers_time_ms": 0.0, "training_step_time_ms": 213158.265, "sample_time_ms": 180988.011, "load_time_ms": 12.2, "load_throughput": 983608.649, "learn_time_ms": 32149.652, "learn_throughput": 373.254, "synch_weights_time_ms": 7.301}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 36, "trial_id": "befd4_00000", "date": "2025-01-22_21-03-09", "timestamp": 1737608589, "time_this_iter_s": 179.99120712280273, "time_total_s": 7543.6100063323975, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7543.6100063323975, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 3.9465517241379304, "ram_util_percent": 37.988362068965515, "gpu_util_percent0": 0.06788793103448276, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.646866696644064, "policy_loss": 0.004506064679033013, "vf_loss": 30.0, "vf_explained_var": 0.0002511027827550795, "kl": 0.0, "entropy": 35.76393536046283, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 44129.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "env_runners": {"episode_reward_max": -799062.9912408941, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -801523.7028436383, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 432000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -799062.9912408941}, "policy_reward_mean": {"default_policy": -801523.7028436383}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9633993200948895, "mean_inference_ms": 4.450592972974963, "mean_action_processing_ms": 0.7815446173684775, "mean_env_wait_ms": 104.47169715523101, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10835925738016765, "StateBufferConnector_ms": 0.033342838287353516, "ViewRequirementAgentConnector_ms": 0.13395249843597412}, "num_episodes": 0, "episode_return_max": -799062.9912408941, "episode_return_min": -804649.9336273633, "episode_return_mean": -801523.7028436383, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 60.250500593980696, "num_env_steps_trained_throughput_per_sec": 60.250500593980696, "timesteps_total": 444000, "num_env_steps_sampled_lifetime": 444000, "num_agent_steps_sampled_lifetime": 444000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 444000, "timers": {"training_iteration_time_ms": 211411.667, "restore_workers_time_ms": 0.0, "training_step_time_ms": 211411.667, "sample_time_ms": 179374.041, "load_time_ms": 12.1, "load_throughput": 991737.069, "learn_time_ms": 32016.925, "learn_throughput": 374.802, "synch_weights_time_ms": 7.401}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "done": false, "training_iteration": 37, "trial_id": "befd4_00000", "date": "2025-01-22_21-06-28", "timestamp": 1737608788, "time_this_iter_s": 199.17147064208984, "time_total_s": 7742.781476974487, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7742.781476974487, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 8.554863813229574, "ram_util_percent": 38.11517509727627, "gpu_util_percent0": 0.060739299610894935, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.645144452330886, "policy_loss": 0.004121710369910357, "vf_loss": 30.0, "vf_explained_var": 0.0004173184446898051, "kl": 0.0, "entropy": 35.89772446398108, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 45338.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "env_runners": {"episode_reward_max": -799062.9912408941, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -801523.7028436383, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 432000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -799062.9912408941}, "policy_reward_mean": {"default_policy": -801523.7028436383}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9633993200948895, "mean_inference_ms": 4.450592972974963, "mean_action_processing_ms": 0.7815446173684775, "mean_env_wait_ms": 104.47169715523101, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10835925738016765, "StateBufferConnector_ms": 0.033342838287353516, "ViewRequirementAgentConnector_ms": 0.13395249843597412}, "num_episodes": 0, "episode_return_max": -799062.9912408941, "episode_return_min": -804649.9336273633, "episode_return_mean": -801523.7028436383, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 56.1428459339371, "num_env_steps_trained_throughput_per_sec": 56.1428459339371, "timesteps_total": 456000, "num_env_steps_sampled_lifetime": 456000, "num_agent_steps_sampled_lifetime": 456000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 210340.208, "restore_workers_time_ms": 0.0, "training_step_time_ms": 210340.208, "sample_time_ms": 178363.497, "load_time_ms": 12.1, "load_throughput": 991733.161, "learn_time_ms": 31955.958, "learn_throughput": 375.517, "synch_weights_time_ms": 7.252}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "done": false, "training_iteration": 38, "trial_id": "befd4_00000", "date": "2025-01-22_21-10-02", "timestamp": 1737609002, "time_this_iter_s": 213.74350142478943, "time_total_s": 7956.524978399277, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7956.524978399277, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 8.833454545454545, "ram_util_percent": 38.23709090909091, "gpu_util_percent0": 0.057600000000000005, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.646990207328198, "policy_loss": 0.004741492538695201, "vf_loss": 30.0, "vf_explained_var": 1.174788321218183e-05, "kl": 0.0, "entropy": 35.77512829435867, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 46547.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "env_runners": {"episode_reward_max": -799062.9912408941, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -801523.7028436383, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 432000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -799062.9912408941}, "policy_reward_mean": {"default_policy": -801523.7028436383}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9633993200948895, "mean_inference_ms": 4.450592972974963, "mean_action_processing_ms": 0.7815446173684775, "mean_env_wait_ms": 104.47169715523101, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10835925738016765, "StateBufferConnector_ms": 0.033342838287353516, "ViewRequirementAgentConnector_ms": 0.13395249843597412}, "num_episodes": 0, "episode_return_max": -799062.9912408941, "episode_return_min": -804649.9336273633, "episode_return_mean": -801523.7028436383, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 53.503232349932006, "num_env_steps_trained_throughput_per_sec": 53.503232349932006, "timesteps_total": 468000, "num_env_steps_sampled_lifetime": 468000, "num_agent_steps_sampled_lifetime": 468000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 209955.66, "restore_workers_time_ms": 0.0, "training_step_time_ms": 209955.66, "sample_time_ms": 177977.848, "load_time_ms": 12.0, "load_throughput": 999989.033, "learn_time_ms": 31956.76, "learn_throughput": 375.507, "synch_weights_time_ms": 7.552}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "training_iteration": 39, "trial_id": "befd4_00000", "date": "2025-01-22_21-13-46", "timestamp": 1737609226, "time_this_iter_s": 224.28751420974731, "time_total_s": 8180.812492609024, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8180.812492609024, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 8.47854671280277, "ram_util_percent": 38.4204152249135, "gpu_util_percent0": 0.0557439446366782, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.644207357275672, "policy_loss": 0.002582543990994604, "vf_loss": 30.0, "vf_explained_var": 0.0002367742501377961, "kl": 0.0, "entropy": 35.83751888606448, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 47756.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": -799062.9912408941, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -801523.7028436383, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 432000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -799062.9912408941}, "policy_reward_mean": {"default_policy": -801523.7028436383}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9633993200948895, "mean_inference_ms": 4.450592972974963, "mean_action_processing_ms": 0.7815446173684775, "mean_env_wait_ms": 104.47169715523101, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10835925738016765, "StateBufferConnector_ms": 0.033342838287353516, "ViewRequirementAgentConnector_ms": 0.13395249843597412}, "num_episodes": 0, "episode_return_max": -799062.9912408941, "episode_return_min": -804649.9336273633, "episode_return_mean": -801523.7028436383, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.19656676329961, "num_env_steps_trained_throughput_per_sec": 52.19656676329961, "timesteps_total": 480000, "num_env_steps_sampled_lifetime": 480000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 210063.932, "restore_workers_time_ms": 0.0, "training_step_time_ms": 210063.932, "sample_time_ms": 177984.062, "load_time_ms": 11.999, "load_throughput": 1000044.666, "learn_time_ms": 32058.718, "learn_throughput": 374.313, "synch_weights_time_ms": 7.552}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 40, "trial_id": "befd4_00000", "date": "2025-01-22_21-17-36", "timestamp": 1737609456, "time_this_iter_s": 229.90317678451538, "time_total_s": 8410.71566939354, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8410.71566939354, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 8.324662162162163, "ram_util_percent": 38.5043918918919, "gpu_util_percent0": 0.05442567567567569, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.646347410329813, "policy_loss": 0.00523677541942908, "vf_loss": 30.0, "vf_explained_var": 7.264997665304305e-05, "kl": 0.0, "entropy": 35.88893812446184, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 48965.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "env_runners": {"episode_reward_max": -799062.9912408941, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -801523.7028436383, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 432000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -799062.9912408941}, "policy_reward_mean": {"default_policy": -801523.7028436383}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9633993200948895, "mean_inference_ms": 4.450592972974963, "mean_action_processing_ms": 0.7815446173684775, "mean_env_wait_ms": 104.47169715523101, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10835925738016765, "StateBufferConnector_ms": 0.033342838287353516, "ViewRequirementAgentConnector_ms": 0.13395249843597412}, "num_episodes": 0, "episode_return_max": -799062.9912408941, "episode_return_min": -804649.9336273633, "episode_return_mean": -801523.7028436383, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.02323418208378, "num_env_steps_trained_throughput_per_sec": 52.02323418208378, "timesteps_total": 492000, "num_env_steps_sampled_lifetime": 492000, "num_agent_steps_sampled_lifetime": 492000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 492000, "timers": {"training_iteration_time_ms": 210341.01, "restore_workers_time_ms": 0.0, "training_step_time_ms": 210341.01, "sample_time_ms": 178296.28, "load_time_ms": 11.999, "load_throughput": 1000050.627, "learn_time_ms": 32023.577, "learn_throughput": 374.724, "synch_weights_time_ms": 7.553}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "done": false, "training_iteration": 41, "trial_id": "befd4_00000", "date": "2025-01-22_21-21-27", "timestamp": 1737609687, "time_this_iter_s": 230.66916608810425, "time_total_s": 8641.384835481644, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8641.384835481644, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 8.338926174496644, "ram_util_percent": 38.5, "gpu_util_percent0": 0.05338926174496645, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.641383955949983, "policy_loss": 0.0006543608972412974, "vf_loss": 30.0, "vf_explained_var": 0.0001893801764085137, "kl": 0.0, "entropy": 35.92703403255188, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 50174.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "env_runners": {"episode_reward_max": -799062.9912408941, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -801523.7028436383, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 432000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -799062.9912408941}, "policy_reward_mean": {"default_policy": -801523.7028436383}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9633993200948895, "mean_inference_ms": 4.450592972974963, "mean_action_processing_ms": 0.7815446173684775, "mean_env_wait_ms": 104.47169715523101, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10835925738016765, "StateBufferConnector_ms": 0.033342838287353516, "ViewRequirementAgentConnector_ms": 0.13395249843597412}, "num_episodes": 0, "episode_return_max": -799062.9912408941, "episode_return_min": -804649.9336273633, "episode_return_mean": -801523.7028436383, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 51.98551507254698, "num_env_steps_trained_throughput_per_sec": 51.98551507254698, "timesteps_total": 504000, "num_env_steps_sampled_lifetime": 504000, "num_agent_steps_sampled_lifetime": 504000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 210405.801, "restore_workers_time_ms": 0.0, "training_step_time_ms": 210405.801, "sample_time_ms": 178393.236, "load_time_ms": 11.999, "load_throughput": 1000092.356, "learn_time_ms": 31991.513, "learn_throughput": 375.099, "synch_weights_time_ms": 7.653}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "training_iteration": 42, "trial_id": "befd4_00000", "date": "2025-01-22_21-25-18", "timestamp": 1737609918, "time_this_iter_s": 230.83652901649475, "time_total_s": 8872.221364498138, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8872.221364498138, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 8.32996632996633, "ram_util_percent": 38.499326599326594, "gpu_util_percent0": 0.05393939393939394, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.644846599884918, "policy_loss": 0.004513093183314732, "vf_loss": 30.0, "vf_explained_var": 1.3777596384558036e-06, "kl": 0.0, "entropy": 35.96665002650915, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 51383.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "env_runners": {"episode_reward_max": -799062.9912408941, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -801523.7028436383, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 432000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -799062.9912408941}, "policy_reward_mean": {"default_policy": -801523.7028436383}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9633993200948895, "mean_inference_ms": 4.450592972974963, "mean_action_processing_ms": 0.7815446173684775, "mean_env_wait_ms": 104.47169715523101, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10835925738016765, "StateBufferConnector_ms": 0.033342838287353516, "ViewRequirementAgentConnector_ms": 0.13395249843597412}, "num_episodes": 0, "episode_return_max": -799062.9912408941, "episode_return_min": -804649.9336273633, "episode_return_mean": -801523.7028436383, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 51.847194963233314, "num_env_steps_trained_throughput_per_sec": 51.847194963233314, "timesteps_total": 516000, "num_env_steps_sampled_lifetime": 516000, "num_agent_steps_sampled_lifetime": 516000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 516000, "timers": {"training_iteration_time_ms": 210622.346, "restore_workers_time_ms": 0.0, "training_step_time_ms": 210622.346, "sample_time_ms": 178597.378, "load_time_ms": 12.099, "load_throughput": 991826.967, "learn_time_ms": 32003.816, "learn_throughput": 374.955, "synch_weights_time_ms": 7.553}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "done": false, "training_iteration": 43, "trial_id": "befd4_00000", "date": "2025-01-22_21-29-09", "timestamp": 1737610149, "time_this_iter_s": 231.4523549079895, "time_total_s": 9103.673719406128, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9103.673719406128, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 8.381270903010034, "ram_util_percent": 38.5247491638796, "gpu_util_percent0": 0.05274247491638795, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.643272346263092, "policy_loss": 0.0039721381402981985, "vf_loss": 30.0, "vf_explained_var": -2.961990949632315e-07, "kl": 0.0, "entropy": 36.069980006064135, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 52592.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": -799062.9912408941, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -801523.7028436383, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 432000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -799062.9912408941}, "policy_reward_mean": {"default_policy": -801523.7028436383}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9633993200948895, "mean_inference_ms": 4.450592972974963, "mean_action_processing_ms": 0.7815446173684775, "mean_env_wait_ms": 104.47169715523101, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10835925738016765, "StateBufferConnector_ms": 0.033342838287353516, "ViewRequirementAgentConnector_ms": 0.13395249843597412}, "num_episodes": 0, "episode_return_max": -799062.9912408941, "episode_return_min": -804649.9336273633, "episode_return_mean": -801523.7028436383, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.199669009137835, "num_env_steps_trained_throughput_per_sec": 52.199669009137835, "timesteps_total": 528000, "num_env_steps_sampled_lifetime": 528000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 212502.838, "restore_workers_time_ms": 0.0, "training_step_time_ms": 212502.838, "sample_time_ms": 180582.399, "load_time_ms": 12.198, "load_throughput": 983733.609, "learn_time_ms": 31899.19, "learn_throughput": 376.185, "synch_weights_time_ms": 7.551}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 44, "trial_id": "befd4_00000", "date": "2025-01-22_21-32-59", "timestamp": 1737610379, "time_this_iter_s": 229.8895206451416, "time_total_s": 9333.56324005127, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9333.56324005127, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 8.358783783783784, "ram_util_percent": 38.509797297297304, "gpu_util_percent0": 0.05189189189189188, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.64330061099271, "policy_loss": 0.004930980873314973, "vf_loss": 30.0, "vf_explained_var": 5.1231104248905106e-05, "kl": 0.0, "entropy": 36.1630377189693, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 53801.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "env_runners": {"episode_reward_max": -798883.7827245467, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -801521.6149422065, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 576000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -798883.7827245467}, "policy_reward_mean": {"default_policy": -801521.6149422065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9636523030617367, "mean_inference_ms": 4.4460269546277456, "mean_action_processing_ms": 0.7807845333505894, "mean_env_wait_ms": 104.70980341787713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11873394250869751, "StateBufferConnector_ms": 0.028133392333984375, "ViewRequirementAgentConnector_ms": 0.11920109391212463}, "num_episodes": 8, "episode_return_max": -798883.7827245467, "episode_return_min": -804649.9336273633, "episode_return_mean": -801521.6149422065, "episodes_this_iter": 8}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 51.83430314425331, "num_env_steps_trained_throughput_per_sec": 51.83430314425331, "timesteps_total": 540000, "num_env_steps_sampled_lifetime": 540000, "num_agent_steps_sampled_lifetime": 540000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 220142.537, "restore_workers_time_ms": 0.0, "training_step_time_ms": 220142.537, "sample_time_ms": 188216.895, "load_time_ms": 12.198, "load_throughput": 983781.679, "learn_time_ms": 31904.495, "learn_throughput": 376.123, "synch_weights_time_ms": 7.55}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "training_iteration": 45, "trial_id": "befd4_00000", "date": "2025-01-22_21-36-51", "timestamp": 1737610611, "time_this_iter_s": 231.5109224319458, "time_total_s": 9565.074162483215, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9565.074162483215, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 8.307382550335571, "ram_util_percent": 38.40906040268456, "gpu_util_percent0": 0.05281879194630872, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.21689685540716, "policy_loss": -0.03375083071890698, "vf_loss": 29.498586610489586, "vf_explained_var": 0.03733412405002995, "kl": 0.0, "entropy": 24.79389162592103, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 55010.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "env_runners": {"episode_reward_max": -798883.7827245467, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -801521.6149422065, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 576000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -798883.7827245467}, "policy_reward_mean": {"default_policy": -801521.6149422065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9636523030617367, "mean_inference_ms": 4.4460269546277456, "mean_action_processing_ms": 0.7807845333505894, "mean_env_wait_ms": 104.70980341787713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11873394250869751, "StateBufferConnector_ms": 0.028133392333984375, "ViewRequirementAgentConnector_ms": 0.11920109391212463}, "num_episodes": 0, "episode_return_max": -798883.7827245467, "episode_return_min": -804649.9336273633, "episode_return_mean": -801521.6149422065, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 79.47084928404186, "num_env_steps_trained_throughput_per_sec": 79.47084928404186, "timesteps_total": 552000, "num_env_steps_sampled_lifetime": 552000, "num_agent_steps_sampled_lifetime": 552000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 217243.592, "restore_workers_time_ms": 0.0, "training_step_time_ms": 217243.592, "sample_time_ms": 185280.782, "load_time_ms": 12.298, "load_throughput": 975776.942, "learn_time_ms": 31941.564, "learn_throughput": 375.686, "synch_weights_time_ms": 7.548}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "done": false, "training_iteration": 46, "trial_id": "befd4_00000", "date": "2025-01-22_21-39-22", "timestamp": 1737610762, "time_this_iter_s": 151.00176286697388, "time_total_s": 9716.07592535019, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9716.07592535019, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 3.5210256410256404, "ram_util_percent": 37.85846153846153, "gpu_util_percent0": 0.08087179487179488, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.611106654846342, "policy_loss": -0.002019410948303734, "vf_loss": 30.0, "vf_explained_var": 0.00012594890357838672, "kl": 0.0, "entropy": 38.68739703472633, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 56219.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "env_runners": {"episode_reward_max": -798883.7827245467, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -801521.6149422065, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 576000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -798883.7827245467}, "policy_reward_mean": {"default_policy": -801521.6149422065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9636523030617367, "mean_inference_ms": 4.4460269546277456, "mean_action_processing_ms": 0.7807845333505894, "mean_env_wait_ms": 104.70980341787713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11873394250869751, "StateBufferConnector_ms": 0.028133392333984375, "ViewRequirementAgentConnector_ms": 0.11920109391212463}, "num_episodes": 0, "episode_return_max": -798883.7827245467, "episode_return_min": -804649.9336273633, "episode_return_mean": -801521.6149422065, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 69.20981628505854, "num_env_steps_trained_throughput_per_sec": 69.20981628505854, "timesteps_total": 564000, "num_env_steps_sampled_lifetime": 564000, "num_agent_steps_sampled_lifetime": 564000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 564000, "timers": {"training_iteration_time_ms": 214665.326, "restore_workers_time_ms": 0.0, "training_step_time_ms": 214665.326, "sample_time_ms": 182672.699, "load_time_ms": 12.397, "load_throughput": 967938.645, "learn_time_ms": 31970.883, "learn_throughput": 375.342, "synch_weights_time_ms": 8.147}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "done": false, "training_iteration": 47, "trial_id": "befd4_00000", "date": "2025-01-22_21-42-15", "timestamp": 1737610935, "time_this_iter_s": 173.38980841636658, "time_total_s": 9889.465733766556, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9889.465733766556, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 3.377232142857143, "ram_util_percent": 37.971875000000004, "gpu_util_percent0": 0.07415178571428571, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.6220209454583, "policy_loss": 0.004378029788521521, "vf_loss": 30.0, "vf_explained_var": -0.0001880075440513289, "kl": 0.0, "entropy": 38.23570829822171, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 57428.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": -798883.7827245467, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -801521.6149422065, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 576000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -798883.7827245467}, "policy_reward_mean": {"default_policy": -801521.6149422065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9636523030617367, "mean_inference_ms": 4.4460269546277456, "mean_action_processing_ms": 0.7807845333505894, "mean_env_wait_ms": 104.70980341787713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11873394250869751, "StateBufferConnector_ms": 0.028133392333984375, "ViewRequirementAgentConnector_ms": 0.11920109391212463}, "num_episodes": 0, "episode_return_max": -798883.7827245467, "episode_return_min": -804649.9336273633, "episode_return_mean": -801521.6149422065, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 61.56979328802869, "num_env_steps_trained_throughput_per_sec": 61.56979328802869, "timesteps_total": 576000, "num_env_steps_sampled_lifetime": 576000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 212781.353, "restore_workers_time_ms": 0.0, "training_step_time_ms": 212781.353, "sample_time_ms": 180794.226, "load_time_ms": 12.497, "load_throughput": 960212.449, "learn_time_ms": 31965.233, "learn_throughput": 375.408, "synch_weights_time_ms": 8.197}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 48, "trial_id": "befd4_00000", "date": "2025-01-22_21-45-30", "timestamp": 1737611130, "time_this_iter_s": 194.9027705192566, "time_total_s": 10084.368504285812, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10084.368504285812, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 7.34382470119522, "ram_util_percent": 38.1003984063745, "gpu_util_percent0": 0.06342629482071714, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.62018617388628, "policy_loss": 0.005097951169986188, "vf_loss": 30.0, "vf_explained_var": 1.5016968729478253e-05, "kl": 0.0, "entropy": 38.49117193229934, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 58637.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "env_runners": {"episode_reward_max": -798883.7827245467, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -801521.6149422065, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 576000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -798883.7827245467}, "policy_reward_mean": {"default_policy": -801521.6149422065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9636523030617367, "mean_inference_ms": 4.4460269546277456, "mean_action_processing_ms": 0.7807845333505894, "mean_env_wait_ms": 104.70980341787713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11873394250869751, "StateBufferConnector_ms": 0.028133392333984375, "ViewRequirementAgentConnector_ms": 0.11920109391212463}, "num_episodes": 0, "episode_return_max": -798883.7827245467, "episode_return_min": -804649.9336273633, "episode_return_mean": -801521.6149422065, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 57.04243142700279, "num_env_steps_trained_throughput_per_sec": 57.04243142700279, "timesteps_total": 588000, "num_env_steps_sampled_lifetime": 588000, "num_agent_steps_sampled_lifetime": 588000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 588000, "timers": {"training_iteration_time_ms": 211389.773, "restore_workers_time_ms": 0.0, "training_step_time_ms": 211389.773, "sample_time_ms": 179352.166, "load_time_ms": 12.597, "load_throughput": 952608.62, "learn_time_ms": 32015.913, "learn_throughput": 374.814, "synch_weights_time_ms": 7.897}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "done": false, "training_iteration": 49, "trial_id": "befd4_00000", "date": "2025-01-22_21-49-00", "timestamp": 1737611340, "time_this_iter_s": 210.37171387672424, "time_total_s": 10294.740218162537, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10294.740218162537, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 8.79557195571956, "ram_util_percent": 38.245387453874535, "gpu_util_percent0": 0.058339483394833955, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.62183492927141, "policy_loss": 0.005610822540506832, "vf_loss": 30.0, "vf_explained_var": 0.00010378302573368903, "kl": 0.0, "entropy": 38.37759193376237, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 59846.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "env_runners": {"episode_reward_max": -798883.7827245467, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -801521.6149422065, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 576000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -798883.7827245467}, "policy_reward_mean": {"default_policy": -801521.6149422065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9636523030617367, "mean_inference_ms": 4.4460269546277456, "mean_action_processing_ms": 0.7807845333505894, "mean_env_wait_ms": 104.70980341787713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11873394250869751, "StateBufferConnector_ms": 0.028133392333984375, "ViewRequirementAgentConnector_ms": 0.11920109391212463}, "num_episodes": 0, "episode_return_max": -798883.7827245467, "episode_return_min": -804649.9336273633, "episode_return_mean": -801521.6149422065, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 54.32233748369169, "num_env_steps_trained_throughput_per_sec": 54.32233748369169, "timesteps_total": 600000, "num_env_steps_sampled_lifetime": 600000, "num_agent_steps_sampled_lifetime": 600000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 210490.115, "restore_workers_time_ms": 0.0, "training_step_time_ms": 210490.115, "sample_time_ms": 178525.314, "load_time_ms": 12.597, "load_throughput": 952590.591, "learn_time_ms": 31943.209, "learn_throughput": 375.667, "synch_weights_time_ms": 7.895}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "training_iteration": 50, "trial_id": "befd4_00000", "date": "2025-01-22_21-52-41", "timestamp": 1737611561, "time_this_iter_s": 220.90660119056702, "time_total_s": 10515.646819353104, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10515.646819353104, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 8.54140350877193, "ram_util_percent": 38.35087719298246, "gpu_util_percent0": 0.05494736842105263, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.622474069335027, "policy_loss": 0.004765292236733969, "vf_loss": 30.0, "vf_explained_var": 0.0005499031348500595, "kl": 0.0, "entropy": 38.2291256736585, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 61055.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "env_runners": {"episode_reward_max": -798883.7827245467, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -801521.6149422065, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 576000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -798883.7827245467}, "policy_reward_mean": {"default_policy": -801521.6149422065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9636523030617367, "mean_inference_ms": 4.4460269546277456, "mean_action_processing_ms": 0.7807845333505894, "mean_env_wait_ms": 104.70980341787713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11873394250869751, "StateBufferConnector_ms": 0.028133392333984375, "ViewRequirementAgentConnector_ms": 0.11920109391212463}, "num_episodes": 0, "episode_return_max": -798883.7827245467, "episode_return_min": -804649.9336273633, "episode_return_mean": -801521.6149422065, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.757859894877626, "num_env_steps_trained_throughput_per_sec": 52.757859894877626, "timesteps_total": 612000, "num_env_steps_sampled_lifetime": 612000, "num_agent_steps_sampled_lifetime": 612000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 210168.924, "restore_workers_time_ms": 0.0, "training_step_time_ms": 210168.924, "sample_time_ms": 178174.449, "load_time_ms": 12.548, "load_throughput": 956317.282, "learn_time_ms": 31972.833, "learn_throughput": 375.319, "synch_weights_time_ms": 7.994}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "done": false, "training_iteration": 51, "trial_id": "befd4_00000", "date": "2025-01-22_21-56-29", "timestamp": 1737611789, "time_this_iter_s": 227.45726013183594, "time_total_s": 10743.10407948494, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10743.10407948494, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 8.378156996587032, "ram_util_percent": 38.45972696245734, "gpu_util_percent0": 0.05430034129692833, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.624974783241896, "policy_loss": 0.004974480952552964, "vf_loss": 30.0, "vf_explained_var": 0.00024526345029756786, "kl": 0.0, "entropy": 37.99997223379989, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 62264.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": -798883.7827245467, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -801521.6149422065, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 576000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -798883.7827245467}, "policy_reward_mean": {"default_policy": -801521.6149422065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9636523030617367, "mean_inference_ms": 4.4460269546277456, "mean_action_processing_ms": 0.7807845333505894, "mean_env_wait_ms": 104.70980341787713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11873394250869751, "StateBufferConnector_ms": 0.028133392333984375, "ViewRequirementAgentConnector_ms": 0.11920109391212463}, "num_episodes": 0, "episode_return_max": -798883.7827245467, "episode_return_min": -804649.9336273633, "episode_return_mean": -801521.6149422065, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 51.8341936583714, "num_env_steps_trained_throughput_per_sec": 51.8341936583714, "timesteps_total": 624000, "num_env_steps_sampled_lifetime": 624000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 210236.312, "restore_workers_time_ms": 0.0, "training_step_time_ms": 210236.312, "sample_time_ms": 178177.86, "load_time_ms": 12.548, "load_throughput": 956310.014, "learn_time_ms": 32036.81, "learn_throughput": 374.569, "synch_weights_time_ms": 7.994}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 52, "trial_id": "befd4_00000", "date": "2025-01-22_22-00-20", "timestamp": 1737612020, "time_this_iter_s": 231.51040887832642, "time_total_s": 10974.614488363266, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10974.614488363266, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 8.306020066889632, "ram_util_percent": 38.510702341137126, "gpu_util_percent0": 0.05408026755852842, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.621485370165853, "policy_loss": 0.0038087092789862156, "vf_loss": 30.0, "vf_explained_var": 0.0002249500986167081, "kl": 0.0, "entropy": 38.23233284015514, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 63473.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "env_runners": {"episode_reward_max": -798883.7827245467, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -801521.6149422065, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 576000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -798883.7827245467}, "policy_reward_mean": {"default_policy": -801521.6149422065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9636523030617367, "mean_inference_ms": 4.4460269546277456, "mean_action_processing_ms": 0.7807845333505894, "mean_env_wait_ms": 104.70980341787713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11873394250869751, "StateBufferConnector_ms": 0.028133392333984375, "ViewRequirementAgentConnector_ms": 0.11920109391212463}, "num_episodes": 0, "episode_return_max": -798883.7827245467, "episode_return_min": -804649.9336273633, "episode_return_mean": -801521.6149422065, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.12896715884312, "num_env_steps_trained_throughput_per_sec": 52.12896715884312, "timesteps_total": 636000, "num_env_steps_sampled_lifetime": 636000, "num_agent_steps_sampled_lifetime": 636000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 636000, "timers": {"training_iteration_time_ms": 210111.207, "restore_workers_time_ms": 0.0, "training_step_time_ms": 210111.207, "sample_time_ms": 178030.889, "load_time_ms": 12.499, "load_throughput": 960053.104, "learn_time_ms": 32058.527, "learn_throughput": 374.315, "synch_weights_time_ms": 8.193}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "done": false, "training_iteration": 53, "trial_id": "befd4_00000", "date": "2025-01-22_22-04-11", "timestamp": 1737612251, "time_this_iter_s": 230.2013111114502, "time_total_s": 11204.815799474716, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11204.815799474716, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 8.317171717171716, "ram_util_percent": 38.511447811447816, "gpu_util_percent0": 0.05393939393939395, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.623149949129797, "policy_loss": 0.004988569522860427, "vf_loss": 30.0, "vf_explained_var": 7.401472088519555e-05, "kl": 0.0, "entropy": 38.1838625962326, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 64682.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "env_runners": {"episode_reward_max": -798883.7827245467, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -801521.6149422065, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 576000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -798883.7827245467}, "policy_reward_mean": {"default_policy": -801521.6149422065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9636523030617367, "mean_inference_ms": 4.4460269546277456, "mean_action_processing_ms": 0.7807845333505894, "mean_env_wait_ms": 104.70980341787713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11873394250869751, "StateBufferConnector_ms": 0.028133392333984375, "ViewRequirementAgentConnector_ms": 0.11920109391212463}, "num_episodes": 0, "episode_return_max": -798883.7827245467, "episode_return_min": -804649.9336273633, "episode_return_mean": -801521.6149422065, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.21092711870298, "num_env_steps_trained_throughput_per_sec": 52.21092711870298, "timesteps_total": 648000, "num_env_steps_sampled_lifetime": 648000, "num_agent_steps_sampled_lifetime": 648000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 210106.25, "restore_workers_time_ms": 0.0, "training_step_time_ms": 210106.25, "sample_time_ms": 177972.244, "load_time_ms": 12.3, "load_throughput": 975618.062, "learn_time_ms": 32112.314, "learn_throughput": 373.688, "synch_weights_time_ms": 8.193}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "training_iteration": 54, "trial_id": "befd4_00000", "date": "2025-01-22_22-08-01", "timestamp": 1737612481, "time_this_iter_s": 229.83894562721252, "time_total_s": 11434.654745101929, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11434.654745101929, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 8.398986486486487, "ram_util_percent": 38.51216216216216, "gpu_util_percent0": 0.052601351351351355, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.620046533564086, "policy_loss": 0.0030242641594313315, "vf_loss": 30.0, "vf_explained_var": 9.783533015854601e-05, "kl": 0.0, "entropy": 38.29777604474619, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 65891.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "env_runners": {"episode_reward_max": -798883.7827245467, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -801521.6149422065, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 576000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -798883.7827245467}, "policy_reward_mean": {"default_policy": -801521.6149422065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9636523030617367, "mean_inference_ms": 4.4460269546277456, "mean_action_processing_ms": 0.7807845333505894, "mean_env_wait_ms": 104.70980341787713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11873394250869751, "StateBufferConnector_ms": 0.028133392333984375, "ViewRequirementAgentConnector_ms": 0.11920109391212463}, "num_episodes": 0, "episode_return_max": -798883.7827245467, "episode_return_min": -804649.9336273633, "episode_return_mean": -801521.6149422065, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.13323615676556, "num_env_steps_trained_throughput_per_sec": 52.13323615676556, "timesteps_total": 660000, "num_env_steps_sampled_lifetime": 660000, "num_agent_steps_sampled_lifetime": 660000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 660000, "timers": {"training_iteration_time_ms": 209973.504, "restore_workers_time_ms": 0.0, "training_step_time_ms": 209973.504, "sample_time_ms": 177815.956, "load_time_ms": 12.3, "load_throughput": 975601.042, "learn_time_ms": 32135.654, "learn_throughput": 373.417, "synch_weights_time_ms": 8.294}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "done": false, "training_iteration": 55, "trial_id": "befd4_00000", "date": "2025-01-22_22-11-51", "timestamp": 1737612711, "time_this_iter_s": 230.18245911598206, "time_total_s": 11664.83720421791, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11664.83720421791, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 8.43918918918919, "ram_util_percent": 38.56418918918919, "gpu_util_percent0": 0.053175675675675674, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.619946679366926, "policy_loss": 0.00496148945096606, "vf_loss": 30.0, "vf_explained_var": 3.9494757419583024e-05, "kl": 0.0, "entropy": 38.50148153502257, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 67100.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": -798883.7827245467, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -801521.6149422065, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 576000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -798883.7827245467}, "policy_reward_mean": {"default_policy": -801521.6149422065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9636523030617367, "mean_inference_ms": 4.4460269546277456, "mean_action_processing_ms": 0.7807845333505894, "mean_env_wait_ms": 104.70980341787713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11873394250869751, "StateBufferConnector_ms": 0.028133392333984375, "ViewRequirementAgentConnector_ms": 0.11920109391212463}, "num_episodes": 0, "episode_return_max": -798883.7827245467, "episode_return_min": -804649.9336273633, "episode_return_mean": -801521.6149422065, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.353060282345155, "num_env_steps_trained_throughput_per_sec": 52.353060282345155, "timesteps_total": 672000, "num_env_steps_sampled_lifetime": 672000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 217794.924, "restore_workers_time_ms": 0.0, "training_step_time_ms": 217794.924, "sample_time_ms": 185670.653, "load_time_ms": 12.2, "load_throughput": 983581.738, "learn_time_ms": 32102.475, "learn_throughput": 373.803, "synch_weights_time_ms": 8.296}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 56, "trial_id": "befd4_00000", "date": "2025-01-22_22-15-40", "timestamp": 1737612940, "time_this_iter_s": 229.21596240997314, "time_total_s": 11894.053166627884, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11894.053166627884, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 8.416216216216215, "ram_util_percent": 38.59560810810811, "gpu_util_percent0": 0.05429054054054054, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.541858600524954, "policy_loss": -0.008193895171455749, "vf_loss": 29.796855929668922, "vf_explained_var": 0.0006481519506626429, "kl": 0.0, "entropy": 24.680344904228317, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 68309.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "env_runners": {"episode_reward_max": -798711.3841966455, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -801123.202200519, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 720000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -798711.3841966455}, "policy_reward_mean": {"default_policy": -801123.202200519}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9635653278759222, "mean_inference_ms": 4.4434188062134545, "mean_action_processing_ms": 0.7804132242480847, "mean_env_wait_ms": 104.75623622271625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10249197483062744, "StateBufferConnector_ms": 0.027511119842529297, "ViewRequirementAgentConnector_ms": 0.13787627220153809}, "num_episodes": 8, "episode_return_max": -798711.3841966455, "episode_return_min": -804649.9336273633, "episode_return_mean": -801123.202200519, "episodes_this_iter": 8}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 70.40093949740083, "num_env_steps_trained_throughput_per_sec": 70.40093949740083, "timesteps_total": 684000, "num_env_steps_sampled_lifetime": 684000, "num_agent_steps_sampled_lifetime": 684000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 217501.57, "restore_workers_time_ms": 0.0, "training_step_time_ms": 217501.57, "sample_time_ms": 185357.384, "load_time_ms": 12.2, "load_throughput": 983575.972, "learn_time_ms": 32122.888, "learn_throughput": 373.565, "synch_weights_time_ms": 7.598}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "done": false, "training_iteration": 57, "trial_id": "befd4_00000", "date": "2025-01-22_22-18-30", "timestamp": 1737613110, "time_this_iter_s": 170.45526909828186, "time_total_s": 12064.508435726166, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12064.508435726166, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 5.242465753424657, "ram_util_percent": 38.11780821917808, "gpu_util_percent0": 0.0728310502283105, "vram_util_percent0": 0.10029296875000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.332708226244147, "policy_loss": -0.007734990131026758, "vf_loss": 29.73840579087326, "vf_explained_var": 0.03318384878885854, "kl": 0.0, "entropy": 39.79626007332498, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 69518.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "env_runners": {"episode_reward_max": -798711.3841966455, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -801123.202200519, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 720000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -798711.3841966455}, "policy_reward_mean": {"default_policy": -801123.202200519}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9635653278759222, "mean_inference_ms": 4.4434188062134545, "mean_action_processing_ms": 0.7804132242480847, "mean_env_wait_ms": 104.75623622271625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10249197483062744, "StateBufferConnector_ms": 0.027511119842529297, "ViewRequirementAgentConnector_ms": 0.13787627220153809}, "num_episodes": 0, "episode_return_max": -798711.3841966455, "episode_return_min": -804649.9336273633, "episode_return_mean": -801123.202200519, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 71.08911742928495, "num_env_steps_trained_throughput_per_sec": 71.08911742928495, "timesteps_total": 696000, "num_env_steps_sampled_lifetime": 696000, "num_agent_steps_sampled_lifetime": 696000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 696000, "timers": {"training_iteration_time_ms": 214891.714, "restore_workers_time_ms": 0.0, "training_step_time_ms": 214891.714, "sample_time_ms": 182603.383, "load_time_ms": 12.101, "load_throughput": 991682.357, "learn_time_ms": 32267.235, "learn_throughput": 371.894, "synch_weights_time_ms": 7.596}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "done": false, "training_iteration": 58, "trial_id": "befd4_00000", "date": "2025-01-22_22-21-19", "timestamp": 1737613279, "time_this_iter_s": 168.80520915985107, "time_total_s": 12233.313644886017, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12233.313644886017, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 3.3660550458715592, "ram_util_percent": 38.03073394495413, "gpu_util_percent0": 0.0743119266055046, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.618644927334845, "policy_loss": 0.00328533888799874, "vf_loss": 30.0, "vf_explained_var": 0.0017826074997781228, "kl": 0.0, "entropy": 38.46403987433321, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 70727.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "env_runners": {"episode_reward_max": -798711.3841966455, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -801123.202200519, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 720000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -798711.3841966455}, "policy_reward_mean": {"default_policy": -801123.202200519}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9635653278759222, "mean_inference_ms": 4.4434188062134545, "mean_action_processing_ms": 0.7804132242480847, "mean_env_wait_ms": 104.75623622271625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10249197483062744, "StateBufferConnector_ms": 0.027511119842529297, "ViewRequirementAgentConnector_ms": 0.13787627220153809}, "num_episodes": 0, "episode_return_max": -798711.3841966455, "episode_return_min": -804649.9336273633, "episode_return_mean": -801123.202200519, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 63.50308484049515, "num_env_steps_trained_throughput_per_sec": 63.50308484049515, "timesteps_total": 708000, "num_env_steps_sampled_lifetime": 708000, "num_agent_steps_sampled_lifetime": 708000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 708000, "timers": {"training_iteration_time_ms": 212751.462, "restore_workers_time_ms": 0.0, "training_step_time_ms": 212751.462, "sample_time_ms": 180492.928, "load_time_ms": 11.901, "load_throughput": 1008328.969, "learn_time_ms": 32237.738, "learn_throughput": 372.235, "synch_weights_time_ms": 7.596}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "done": false, "training_iteration": 59, "trial_id": "befd4_00000", "date": "2025-01-22_22-24-28", "timestamp": 1737613468, "time_this_iter_s": 188.9701964855194, "time_total_s": 12422.283841371536, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12422.283841371536, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 6.144262295081966, "ram_util_percent": 38.14303278688524, "gpu_util_percent0": 0.06381147540983606, "vram_util_percent0": 0.10029296875000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.62150130102317, "policy_loss": 0.006338192370309624, "vf_loss": 30.0, "vf_explained_var": 0.0003439711577839059, "kl": 0.0, "entropy": 38.48368822197169, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 71936.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": -798711.3841966455, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -801123.202200519, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 720000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -798711.3841966455}, "policy_reward_mean": {"default_policy": -801123.202200519}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9635653278759222, "mean_inference_ms": 4.4434188062134545, "mean_action_processing_ms": 0.7804132242480847, "mean_env_wait_ms": 104.75623622271625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10249197483062744, "StateBufferConnector_ms": 0.027511119842529297, "ViewRequirementAgentConnector_ms": 0.13787627220153809}, "num_episodes": 0, "episode_return_max": -798711.3841966455, "episode_return_min": -804649.9336273633, "episode_return_mean": -801123.202200519, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 58.23705044822322, "num_env_steps_trained_throughput_per_sec": 58.23705044822322, "timesteps_total": 720000, "num_env_steps_sampled_lifetime": 720000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 211266.541, "restore_workers_time_ms": 0.0, "training_step_time_ms": 211266.541, "sample_time_ms": 179012.626, "load_time_ms": 11.901, "load_throughput": 1008337.05, "learn_time_ms": 32233.017, "learn_throughput": 372.289, "synch_weights_time_ms": 7.698}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 60, "trial_id": "befd4_00000", "date": "2025-01-22_22-27-54", "timestamp": 1737613674, "time_this_iter_s": 206.0573923587799, "time_total_s": 12628.341233730316, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12628.341233730316, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 8.85811320754717, "ram_util_percent": 38.27509433962264, "gpu_util_percent0": 0.060641509433962265, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.618780727717777, "policy_loss": 0.004576840283113437, "vf_loss": 30.0, "vf_explained_var": 5.19861457168415e-05, "kl": 0.0, "entropy": 38.57961231859584, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 73145.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "env_runners": {"episode_reward_max": -798711.3841966455, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -801123.202200519, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 720000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -798711.3841966455}, "policy_reward_mean": {"default_policy": -801123.202200519}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9635653278759222, "mean_inference_ms": 4.4434188062134545, "mean_action_processing_ms": 0.7804132242480847, "mean_env_wait_ms": 104.75623622271625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10249197483062744, "StateBufferConnector_ms": 0.027511119842529297, "ViewRequirementAgentConnector_ms": 0.13787627220153809}, "num_episodes": 0, "episode_return_max": -798711.3841966455, "episode_return_min": -804649.9336273633, "episode_return_mean": -801123.202200519, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 54.716219834615124, "num_env_steps_trained_throughput_per_sec": 54.716219834615124, "timesteps_total": 732000, "num_env_steps_sampled_lifetime": 732000, "num_agent_steps_sampled_lifetime": 732000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 732000, "timers": {"training_iteration_time_ms": 210452.455, "restore_workers_time_ms": 0.0, "training_step_time_ms": 210452.455, "sample_time_ms": 178205.361, "load_time_ms": 12.001, "load_throughput": 999911.555, "learn_time_ms": 32226.295, "learn_throughput": 372.367, "synch_weights_time_ms": 7.598}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "done": false, "training_iteration": 61, "trial_id": "befd4_00000", "date": "2025-01-22_22-31-34", "timestamp": 1737613894, "time_this_iter_s": 219.31639575958252, "time_total_s": 12847.657629489899, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12847.657629489899, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 8.59434628975265, "ram_util_percent": 38.384805653710245, "gpu_util_percent0": 0.05696113074204948, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.61608909752075, "policy_loss": 0.0028875847497294026, "vf_loss": 30.0, "vf_explained_var": -7.338273416776317e-05, "kl": 0.0, "entropy": 38.679847057837904, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 74354.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "env_runners": {"episode_reward_max": -798711.3841966455, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -801123.202200519, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 720000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -798711.3841966455}, "policy_reward_mean": {"default_policy": -801123.202200519}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9635653278759222, "mean_inference_ms": 4.4434188062134545, "mean_action_processing_ms": 0.7804132242480847, "mean_env_wait_ms": 104.75623622271625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10249197483062744, "StateBufferConnector_ms": 0.027511119842529297, "ViewRequirementAgentConnector_ms": 0.13787627220153809}, "num_episodes": 0, "episode_return_max": -798711.3841966455, "episode_return_min": -804649.9336273633, "episode_return_mean": -801123.202200519, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.779682130725675, "num_env_steps_trained_throughput_per_sec": 52.779682130725675, "timesteps_total": 744000, "num_env_steps_sampled_lifetime": 744000, "num_agent_steps_sampled_lifetime": 744000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 744000, "timers": {"training_iteration_time_ms": 210037.735, "restore_workers_time_ms": 0.0, "training_step_time_ms": 210037.735, "sample_time_ms": 177787.097, "load_time_ms": 12.101, "load_throughput": 991643.28, "learn_time_ms": 32229.641, "learn_throughput": 372.328, "synch_weights_time_ms": 7.496}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "done": false, "training_iteration": 62, "trial_id": "befd4_00000", "date": "2025-01-22_22-35-21", "timestamp": 1737614121, "time_this_iter_s": 227.36321592330933, "time_total_s": 13075.020845413208, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13075.020845413208, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 8.36245733788396, "ram_util_percent": 38.47679180887372, "gpu_util_percent0": 0.05341296928327645, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.617369185606243, "policy_loss": 0.00409357549855293, "vf_loss": 30.0, "vf_explained_var": 0.00030431824345742505, "kl": 0.0, "entropy": 38.67244059118582, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 75563.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "env_runners": {"episode_reward_max": -798711.3841966455, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -801123.202200519, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 720000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -798711.3841966455}, "policy_reward_mean": {"default_policy": -801123.202200519}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9635653278759222, "mean_inference_ms": 4.4434188062134545, "mean_action_processing_ms": 0.7804132242480847, "mean_env_wait_ms": 104.75623622271625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10249197483062744, "StateBufferConnector_ms": 0.027511119842529297, "ViewRequirementAgentConnector_ms": 0.13787627220153809}, "num_episodes": 0, "episode_return_max": -798711.3841966455, "episode_return_min": -804649.9336273633, "episode_return_mean": -801123.202200519, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 51.90428133899574, "num_env_steps_trained_throughput_per_sec": 51.90428133899574, "timesteps_total": 756000, "num_env_steps_sampled_lifetime": 756000, "num_agent_steps_sampled_lifetime": 756000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 210137.385, "restore_workers_time_ms": 0.0, "training_step_time_ms": 210137.385, "sample_time_ms": 177840.625, "load_time_ms": 12.05, "load_throughput": 995834.135, "learn_time_ms": 32276.013, "learn_throughput": 371.793, "synch_weights_time_ms": 7.397}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "done": false, "training_iteration": 63, "trial_id": "befd4_00000", "date": "2025-01-22_22-39-12", "timestamp": 1737614352, "time_this_iter_s": 231.1977984905243, "time_total_s": 13306.218643903732, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13306.218643903732, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 8.38288590604027, "ram_util_percent": 38.555704697986585, "gpu_util_percent0": 0.05406040268456377, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.6171752166117, "policy_loss": 0.003850865677750929, "vf_loss": 30.0, "vf_explained_var": 0.00025336953408467664, "kl": 0.0, "entropy": 38.66756375157409, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 76772.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": -798711.3841966455, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -801123.202200519, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 720000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -798711.3841966455}, "policy_reward_mean": {"default_policy": -801123.202200519}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9635653278759222, "mean_inference_ms": 4.4434188062134545, "mean_action_processing_ms": 0.7804132242480847, "mean_env_wait_ms": 104.75623622271625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10249197483062744, "StateBufferConnector_ms": 0.027511119842529297, "ViewRequirementAgentConnector_ms": 0.13787627220153809}, "num_episodes": 0, "episode_return_max": -798711.3841966455, "episode_return_min": -804649.9336273633, "episode_return_mean": -801123.202200519, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.07483169229336, "num_env_steps_trained_throughput_per_sec": 52.07483169229336, "timesteps_total": 768000, "num_env_steps_sampled_lifetime": 768000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 210197.452, "restore_workers_time_ms": 0.0, "training_step_time_ms": 210197.352, "sample_time_ms": 177838.246, "load_time_ms": 12.1, "load_throughput": 991711.666, "learn_time_ms": 32338.308, "learn_throughput": 371.077, "synch_weights_time_ms": 7.398}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 64, "trial_id": "befd4_00000", "date": "2025-01-22_22-43-03", "timestamp": 1737614583, "time_this_iter_s": 230.44061660766602, "time_total_s": 13536.659260511398, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13536.659260511398, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 8.35993265993266, "ram_util_percent": 38.584848484848486, "gpu_util_percent0": 0.05461279461279462, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.61939397895504, "policy_loss": 0.00475874108418736, "vf_loss": 30.0, "vf_explained_var": -1.6963610085107948e-05, "kl": 0.0, "entropy": 38.536478523778165, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 77981.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "env_runners": {"episode_reward_max": -798711.3841966455, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -801123.202200519, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 720000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -798711.3841966455}, "policy_reward_mean": {"default_policy": -801123.202200519}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9635653278759222, "mean_inference_ms": 4.4434188062134545, "mean_action_processing_ms": 0.7804132242480847, "mean_env_wait_ms": 104.75623622271625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10249197483062744, "StateBufferConnector_ms": 0.027511119842529297, "ViewRequirementAgentConnector_ms": 0.13787627220153809}, "num_episodes": 0, "episode_return_max": -798711.3841966455, "episode_return_min": -804649.9336273633, "episode_return_mean": -801123.202200519, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.02080499889573, "num_env_steps_trained_throughput_per_sec": 52.02080499889573, "timesteps_total": 780000, "num_env_steps_sampled_lifetime": 780000, "num_agent_steps_sampled_lifetime": 780000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 780000, "timers": {"training_iteration_time_ms": 210247.2, "restore_workers_time_ms": 0.0, "training_step_time_ms": 210247.1, "sample_time_ms": 177928.194, "load_time_ms": 12.201, "load_throughput": 983514.469, "learn_time_ms": 32298.106, "learn_throughput": 371.539, "synch_weights_time_ms": 7.398}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "done": false, "training_iteration": 65, "trial_id": "befd4_00000", "date": "2025-01-22_22-46-54", "timestamp": 1737614814, "time_this_iter_s": 230.67993545532227, "time_total_s": 13767.33919596672, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13767.33919596672, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 8.355555555555556, "ram_util_percent": 38.58417508417509, "gpu_util_percent0": 0.05138047138047138, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.617710156121266, "policy_loss": 0.003720594134036917, "vf_loss": 30.0, "vf_explained_var": 0.00022178242480685832, "kl": 0.0, "entropy": 38.60104224029112, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 79190.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "env_runners": {"episode_reward_max": -798711.3841966455, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -801123.202200519, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 720000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -798711.3841966455}, "policy_reward_mean": {"default_policy": -801123.202200519}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9635653278759222, "mean_inference_ms": 4.4434188062134545, "mean_action_processing_ms": 0.7804132242480847, "mean_env_wait_ms": 104.75623622271625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10249197483062744, "StateBufferConnector_ms": 0.027511119842529297, "ViewRequirementAgentConnector_ms": 0.13787627220153809}, "num_episodes": 0, "episode_return_max": -798711.3841966455, "episode_return_min": -804649.9336273633, "episode_return_mean": -801123.202200519, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 50.948482190958615, "num_env_steps_trained_throughput_per_sec": 50.948482190958615, "timesteps_total": 792000, "num_env_steps_sampled_lifetime": 792000, "num_agent_steps_sampled_lifetime": 792000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 210879.108, "restore_workers_time_ms": 0.1, "training_step_time_ms": 210878.907, "sample_time_ms": 178570.382, "load_time_ms": 12.201, "load_throughput": 983545.22, "learn_time_ms": 32287.826, "learn_throughput": 371.657, "synch_weights_time_ms": 7.498}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "training_iteration": 66, "trial_id": "befd4_00000", "date": "2025-01-22_22-50-49", "timestamp": 1737615049, "time_this_iter_s": 235.5360414981842, "time_total_s": 14002.875237464905, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14002.875237464905, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 10.393421052631577, "ram_util_percent": 40.019407894736844, "gpu_util_percent0": 0.0530921052631579, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.619103369385474, "policy_loss": 0.004720854194722361, "vf_loss": 30.0, "vf_explained_var": 0.00015138776170211553, "kl": 0.0, "entropy": 38.561743882197405, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 80399.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "env_runners": {"episode_reward_max": -798711.3841966455, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -801123.202200519, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 720000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -798711.3841966455}, "policy_reward_mean": {"default_policy": -801123.202200519}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9635653278759222, "mean_inference_ms": 4.4434188062134545, "mean_action_processing_ms": 0.7804132242480847, "mean_env_wait_ms": 104.75623622271625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10249197483062744, "StateBufferConnector_ms": 0.027511119842529297, "ViewRequirementAgentConnector_ms": 0.13787627220153809}, "num_episodes": 0, "episode_return_max": -798711.3841966455, "episode_return_min": -804649.9336273633, "episode_return_mean": -801123.202200519, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000, "num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.0159665041455, "num_env_steps_trained_throughput_per_sec": 52.0159665041455, "timesteps_total": 804000, "num_env_steps_sampled_lifetime": 804000, "num_agent_steps_sampled_lifetime": 804000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 804000, "timers": {"training_iteration_time_ms": 216903.72, "restore_workers_time_ms": 0.1, "training_step_time_ms": 216903.52, "sample_time_ms": 184631.916, "load_time_ms": 12.201, "load_throughput": 983547.141, "learn_time_ms": 32250.855, "learn_throughput": 372.083, "synch_weights_time_ms": 7.397}, "counters": {"num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "done": false, "training_iteration": 67, "trial_id": "befd4_00000", "date": "2025-01-22_22-54-40", "timestamp": 1737615280, "time_this_iter_s": 230.7014021873474, "time_total_s": 14233.576639652252, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14233.576639652252, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 8.293265993265994, "ram_util_percent": 39.52828282828283, "gpu_util_percent0": 0.05404040404040404, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.66046229820788, "policy_loss": -0.009120676367612197, "vf_loss": 29.95776888119277, "vf_explained_var": -0.012721753150002832, "kl": 0.0, "entropy": 28.81858898569869, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 81608.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": -798514.9432456958, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800892.3161681248, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 864000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -798514.9432456958}, "policy_reward_mean": {"default_policy": -800892.3161681248}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9636006253593195, "mean_inference_ms": 4.441985314020652, "mean_action_processing_ms": 0.7800751215372076, "mean_env_wait_ms": 104.83471428335845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1062472661336263, "StateBufferConnector_ms": 0.03126859664916992, "ViewRequirementAgentConnector_ms": 0.12529542048772177}, "num_episodes": 8, "episode_return_max": -798514.9432456958, "episode_return_min": -804649.9336273633, "episode_return_mean": -800892.3161681248, "episodes_this_iter": 8}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 63.11649435978537, "num_env_steps_trained_throughput_per_sec": 63.11649435978537, "timesteps_total": 816000, "num_env_steps_sampled_lifetime": 816000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 219035.962, "restore_workers_time_ms": 0.1, "training_step_time_ms": 219035.762, "sample_time_ms": 186941.948, "load_time_ms": 12.301, "load_throughput": 975559.441, "learn_time_ms": 32072.963, "learn_throughput": 374.147, "synch_weights_time_ms": 7.399}, "counters": {"num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 68, "trial_id": "befd4_00000", "date": "2025-01-22_22-57-50", "timestamp": 1737615470, "time_this_iter_s": 190.1286256313324, "time_total_s": 14423.705265283585, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14423.705265283585, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 6.442448979591838, "ram_util_percent": 39.179591836734694, "gpu_util_percent0": 0.062081632653061235, "vram_util_percent0": 0.10029296875000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.170403038005972, "policy_loss": -0.01319619437958506, "vf_loss": 29.551882086754635, "vf_explained_var": 0.07057328249818536, "kl": 0.0, "entropy": 36.82828875589804, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 82817.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "env_runners": {"episode_reward_max": -798514.9432456958, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800892.3161681248, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 864000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -798514.9432456958}, "policy_reward_mean": {"default_policy": -800892.3161681248}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9636006253593195, "mean_inference_ms": 4.441985314020652, "mean_action_processing_ms": 0.7800751215372076, "mean_env_wait_ms": 104.83471428335845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1062472661336263, "StateBufferConnector_ms": 0.03126859664916992, "ViewRequirementAgentConnector_ms": 0.12529542048772177}, "num_episodes": 0, "episode_return_max": -798514.9432456958, "episode_return_min": -804649.9336273633, "episode_return_mean": -800892.3161681248, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 74.01680112548206, "num_env_steps_trained_throughput_per_sec": 74.01680112548206, "timesteps_total": 828000, "num_env_steps_sampled_lifetime": 828000, "num_agent_steps_sampled_lifetime": 828000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 828000, "timers": {"training_iteration_time_ms": 216351.778, "restore_workers_time_ms": 0.1, "training_step_time_ms": 216351.577, "sample_time_ms": 184297.322, "load_time_ms": 12.4, "load_throughput": 967706.018, "learn_time_ms": 32033.206, "learn_throughput": 374.611, "synch_weights_time_ms": 7.398}, "counters": {"num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "done": false, "training_iteration": 69, "trial_id": "befd4_00000", "date": "2025-01-22_23-00-32", "timestamp": 1737615632, "time_this_iter_s": 162.12835216522217, "time_total_s": 14585.833617448807, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14585.833617448807, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 3.472727272727273, "ram_util_percent": 38.89090909090908, "gpu_util_percent0": 0.07531100478468901, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.6243345530394, "policy_loss": 0.0007402063127856692, "vf_loss": 30.0, "vf_explained_var": -0.010534710978751739, "kl": 0.0, "entropy": 37.640562879437745, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 84026.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "env_runners": {"episode_reward_max": -798514.9432456958, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800892.3161681248, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 864000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -798514.9432456958}, "policy_reward_mean": {"default_policy": -800892.3161681248}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9636006253593195, "mean_inference_ms": 4.441985314020652, "mean_action_processing_ms": 0.7800751215372076, "mean_env_wait_ms": 104.83471428335845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1062472661336263, "StateBufferConnector_ms": 0.03126859664916992, "ViewRequirementAgentConnector_ms": 0.12529542048772177}, "num_episodes": 0, "episode_return_max": -798514.9432456958, "episode_return_min": -804649.9336273633, "episode_return_mean": -800892.3161681248, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 65.1305193511092, "num_env_steps_trained_throughput_per_sec": 65.1305193511092, "timesteps_total": 840000, "num_env_steps_sampled_lifetime": 840000, "num_agent_steps_sampled_lifetime": 840000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 214170.881, "restore_workers_time_ms": 0.1, "training_step_time_ms": 214170.68, "sample_time_ms": 182145.895, "load_time_ms": 12.4, "load_throughput": 967707.878, "learn_time_ms": 32003.737, "learn_throughput": 374.956, "synch_weights_time_ms": 7.296}, "counters": {"num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "training_iteration": 70, "trial_id": "befd4_00000", "date": "2025-01-22_23-03-37", "timestamp": 1737615817, "time_this_iter_s": 184.24841928482056, "time_total_s": 14770.082036733627, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14770.082036733627, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 4.700420168067227, "ram_util_percent": 39.032773109243706, "gpu_util_percent0": 0.06697478991596639, "vram_util_percent0": 0.10029296875000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.632214602209302, "policy_loss": 0.0036613590171063015, "vf_loss": 30.0, "vf_explained_var": -0.003561068803836138, "kl": 0.0, "entropy": 37.144676979954724, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 85235.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "env_runners": {"episode_reward_max": -798514.9432456958, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800892.3161681248, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 864000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -798514.9432456958}, "policy_reward_mean": {"default_policy": -800892.3161681248}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9636006253593195, "mean_inference_ms": 4.441985314020652, "mean_action_processing_ms": 0.7800751215372076, "mean_env_wait_ms": 104.83471428335845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1062472661336263, "StateBufferConnector_ms": 0.03126859664916992, "ViewRequirementAgentConnector_ms": 0.12529542048772177}, "num_episodes": 0, "episode_return_max": -798514.9432456958, "episode_return_min": -804649.9336273633, "episode_return_mean": -800892.3161681248, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000, "num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 59.404176171353136, "num_env_steps_trained_throughput_per_sec": 59.404176171353136, "timesteps_total": 852000, "num_env_steps_sampled_lifetime": 852000, "num_agent_steps_sampled_lifetime": 852000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 852000, "timers": {"training_iteration_time_ms": 212440.141, "restore_workers_time_ms": 0.1, "training_step_time_ms": 212439.941, "sample_time_ms": 180409.048, "load_time_ms": 12.349, "load_throughput": 971735.978, "learn_time_ms": 32009.897, "learn_throughput": 374.884, "synch_weights_time_ms": 7.195}, "counters": {"num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "done": false, "training_iteration": 71, "trial_id": "befd4_00000", "date": "2025-01-22_23-06-59", "timestamp": 1737616019, "time_this_iter_s": 202.00999879837036, "time_total_s": 14972.092035531998, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14972.092035531998, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 8.889999999999999, "ram_util_percent": 39.150769230769235, "gpu_util_percent0": 0.06030769230769231, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.63172479855117, "policy_loss": 0.0030142302055611307, "vf_loss": 30.0, "vf_explained_var": -0.0019348750339252482, "kl": 0.0, "entropy": 37.1289429928864, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 86444.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": -798514.9432456958, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800892.3161681248, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 864000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -798514.9432456958}, "policy_reward_mean": {"default_policy": -800892.3161681248}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9636006253593195, "mean_inference_ms": 4.441985314020652, "mean_action_processing_ms": 0.7800751215372076, "mean_env_wait_ms": 104.83471428335845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1062472661336263, "StateBufferConnector_ms": 0.03126859664916992, "ViewRequirementAgentConnector_ms": 0.12529542048772177}, "num_episodes": 0, "episode_return_max": -798514.9432456958, "episode_return_min": -804649.9336273633, "episode_return_mean": -800892.3161681248, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 55.451510532483354, "num_env_steps_trained_throughput_per_sec": 55.451510532483354, "timesteps_total": 864000, "num_env_steps_sampled_lifetime": 864000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 211344.648, "restore_workers_time_ms": 0.1, "training_step_time_ms": 211344.447, "sample_time_ms": 179363.711, "load_time_ms": 12.249, "load_throughput": 979674.283, "learn_time_ms": 31959.941, "learn_throughput": 375.47, "synch_weights_time_ms": 7.195}, "counters": {"num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 72, "trial_id": "befd4_00000", "date": "2025-01-22_23-10-35", "timestamp": 1737616235, "time_this_iter_s": 216.40928292274475, "time_total_s": 15188.501318454742, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15188.501318454742, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 8.6, "ram_util_percent": 39.26702508960574, "gpu_util_percent0": 0.05702508960573477, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.63161915604786, "policy_loss": 0.003494015870950161, "vf_loss": 30.0, "vf_explained_var": -0.0007556618196694095, "kl": 0.0, "entropy": 37.187486689577824, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 87653.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "env_runners": {"episode_reward_max": -798514.9432456958, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800892.3161681248, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 864000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -798514.9432456958}, "policy_reward_mean": {"default_policy": -800892.3161681248}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9636006253593195, "mean_inference_ms": 4.441985314020652, "mean_action_processing_ms": 0.7800751215372076, "mean_env_wait_ms": 104.83471428335845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1062472661336263, "StateBufferConnector_ms": 0.03126859664916992, "ViewRequirementAgentConnector_ms": 0.12529542048772177}, "num_episodes": 0, "episode_return_max": -798514.9432456958, "episode_return_min": -804649.9336273633, "episode_return_mean": -800892.3161681248, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000, "num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 53.400473570832034, "num_env_steps_trained_throughput_per_sec": 53.400473570832034, "timesteps_total": 876000, "num_env_steps_sampled_lifetime": 876000, "num_agent_steps_sampled_lifetime": 876000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 876000, "timers": {"training_iteration_time_ms": 210696.879, "restore_workers_time_ms": 0.1, "training_step_time_ms": 210696.678, "sample_time_ms": 178805.374, "load_time_ms": 12.249, "load_throughput": 979681.911, "learn_time_ms": 31870.408, "learn_throughput": 376.525, "synch_weights_time_ms": 7.197}, "counters": {"num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "done": false, "training_iteration": 73, "trial_id": "befd4_00000", "date": "2025-01-22_23-14-20", "timestamp": 1737616460, "time_this_iter_s": 224.72010827064514, "time_total_s": 15413.221426725388, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15413.221426725388, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 8.465862068965517, "ram_util_percent": 39.44586206896552, "gpu_util_percent0": 0.055482758620689666, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.630245035201483, "policy_loss": 0.0022590091533656945, "vf_loss": 30.0, "vf_explained_var": 0.0005517421525997796, "kl": 0.0, "entropy": 37.201395847266916, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 88862.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "env_runners": {"episode_reward_max": -798514.9432456958, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800892.3161681248, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 864000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -798514.9432456958}, "policy_reward_mean": {"default_policy": -800892.3161681248}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9636006253593195, "mean_inference_ms": 4.441985314020652, "mean_action_processing_ms": 0.7800751215372076, "mean_env_wait_ms": 104.83471428335845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1062472661336263, "StateBufferConnector_ms": 0.03126859664916992, "ViewRequirementAgentConnector_ms": 0.12529542048772177}, "num_episodes": 0, "episode_return_max": -798514.9432456958, "episode_return_min": -804649.9336273633, "episode_return_mean": -800892.3161681248, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000, "num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.1836857267367, "num_env_steps_trained_throughput_per_sec": 52.1836857267367, "timesteps_total": 888000, "num_env_steps_sampled_lifetime": 888000, "num_agent_steps_sampled_lifetime": 888000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 888000, "timers": {"training_iteration_time_ms": 210648.81, "restore_workers_time_ms": 0.1, "training_step_time_ms": 210648.709, "sample_time_ms": 178795.203, "load_time_ms": 12.198, "load_throughput": 983735.532, "learn_time_ms": 31832.762, "learn_throughput": 376.97, "synch_weights_time_ms": 7.295}, "counters": {"num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "done": false, "training_iteration": 74, "trial_id": "befd4_00000", "date": "2025-01-22_23-18-10", "timestamp": 1737616690, "time_this_iter_s": 229.95992469787598, "time_total_s": 15643.181351423264, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15643.181351423264, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 8.356756756756756, "ram_util_percent": 39.50777027027027, "gpu_util_percent0": 0.052668918918918915, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.631911955360938, "policy_loss": 0.0041671017318890054, "vf_loss": 30.0, "vf_explained_var": 4.6512920862391926e-05, "kl": 0.0, "entropy": 37.22551003796094, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 90071.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "env_runners": {"episode_reward_max": -798514.9432456958, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800892.3161681248, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 864000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -798514.9432456958}, "policy_reward_mean": {"default_policy": -800892.3161681248}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9636006253593195, "mean_inference_ms": 4.441985314020652, "mean_action_processing_ms": 0.7800751215372076, "mean_env_wait_ms": 104.83471428335845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1062472661336263, "StateBufferConnector_ms": 0.03126859664916992, "ViewRequirementAgentConnector_ms": 0.12529542048772177}, "num_episodes": 0, "episode_return_max": -798514.9432456958, "episode_return_min": -804649.9336273633, "episode_return_mean": -800892.3161681248, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 51.6627378199789, "num_env_steps_trained_throughput_per_sec": 51.6627378199789, "timesteps_total": 900000, "num_env_steps_sampled_lifetime": 900000, "num_agent_steps_sampled_lifetime": 900000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 210808.689, "restore_workers_time_ms": 0.1, "training_step_time_ms": 210808.588, "sample_time_ms": 178893.079, "load_time_ms": 12.098, "load_throughput": 991926.655, "learn_time_ms": 31894.867, "learn_throughput": 376.236, "synch_weights_time_ms": 7.194}, "counters": {"num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "done": false, "training_iteration": 75, "trial_id": "befd4_00000", "date": "2025-01-22_23-22-02", "timestamp": 1737616922, "time_this_iter_s": 232.2797293663025, "time_total_s": 15875.461080789566, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15875.461080789566, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 8.331666666666667, "ram_util_percent": 39.50033333333334, "gpu_util_percent0": 0.05373333333333333, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.631057150803684, "policy_loss": 0.0026245616111408294, "vf_loss": 30.0, "vf_explained_var": -3.68456292290447e-05, "kl": 0.0, "entropy": 37.156737632846124, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 91280.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": -798514.9432456958, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800892.3161681248, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 864000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -798514.9432456958}, "policy_reward_mean": {"default_policy": -800892.3161681248}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9636006253593195, "mean_inference_ms": 4.441985314020652, "mean_action_processing_ms": 0.7800751215372076, "mean_env_wait_ms": 104.83471428335845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1062472661336263, "StateBufferConnector_ms": 0.03126859664916992, "ViewRequirementAgentConnector_ms": 0.12529542048772177}, "num_episodes": 0, "episode_return_max": -798514.9432456958, "episode_return_min": -804649.9336273633, "episode_return_mean": -800892.3161681248, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.014906014581285, "num_env_steps_trained_throughput_per_sec": 52.014906014581285, "timesteps_total": 912000, "num_env_steps_sampled_lifetime": 912000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 210325.794, "restore_workers_time_ms": 0.0, "training_step_time_ms": 210325.794, "sample_time_ms": 178413.219, "load_time_ms": 12.098, "load_throughput": 991907.107, "learn_time_ms": 31891.933, "learn_throughput": 376.271, "synch_weights_time_ms": 7.094}, "counters": {"num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 76, "trial_id": "befd4_00000", "date": "2025-01-22_23-25-53", "timestamp": 1737617153, "time_this_iter_s": 230.70609784126282, "time_total_s": 16106.167178630829, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16106.167178630829, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 8.2989898989899, "ram_util_percent": 39.499326599326594, "gpu_util_percent0": 0.0527946127946128, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.631480203570167, "policy_loss": 0.0029303749747469567, "vf_loss": 30.0, "vf_explained_var": 0.00032959647963518344, "kl": 0.0, "entropy": 37.14501763336712, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 92489.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "env_runners": {"episode_reward_max": -798514.9432456958, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800892.3161681248, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 864000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -798514.9432456958}, "policy_reward_mean": {"default_policy": -800892.3161681248}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9636006253593195, "mean_inference_ms": 4.441985314020652, "mean_action_processing_ms": 0.7800751215372076, "mean_env_wait_ms": 104.83471428335845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1062472661336263, "StateBufferConnector_ms": 0.03126859664916992, "ViewRequirementAgentConnector_ms": 0.12529542048772177}, "num_episodes": 0, "episode_return_max": -798514.9432456958, "episode_return_min": -804649.9336273633, "episode_return_mean": -800892.3161681248, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000, "num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 51.799753239324986, "num_env_steps_trained_throughput_per_sec": 51.799753239324986, "timesteps_total": 924000, "num_env_steps_sampled_lifetime": 924000, "num_agent_steps_sampled_lifetime": 924000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 924000, "timers": {"training_iteration_time_ms": 210422.088, "restore_workers_time_ms": 0.0, "training_step_time_ms": 210422.088, "sample_time_ms": 178562.462, "load_time_ms": 12.098, "load_throughput": 991907.107, "learn_time_ms": 31839.135, "learn_throughput": 376.895, "synch_weights_time_ms": 7.194}, "counters": {"num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "done": false, "training_iteration": 77, "trial_id": "befd4_00000", "date": "2025-01-22_23-29-45", "timestamp": 1737617385, "time_this_iter_s": 231.6643340587616, "time_total_s": 16337.83151268959, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16337.83151268959, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 8.329096989966555, "ram_util_percent": 39.50033444816054, "gpu_util_percent0": 0.053478260869565225, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.63089904280316, "policy_loss": 0.003681465077488949, "vf_loss": 30.0, "vf_explained_var": 0.0007303399523000662, "kl": 0.0, "entropy": 37.278243799264814, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 93698.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "env_runners": {"episode_reward_max": -798514.9432456958, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800892.3161681248, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 864000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -798514.9432456958}, "policy_reward_mean": {"default_policy": -800892.3161681248}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9636006253593195, "mean_inference_ms": 4.441985314020652, "mean_action_processing_ms": 0.7800751215372076, "mean_env_wait_ms": 104.83471428335845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1062472661336263, "StateBufferConnector_ms": 0.03126859664916992, "ViewRequirementAgentConnector_ms": 0.12529542048772177}, "num_episodes": 0, "episode_return_max": -798514.9432456958, "episode_return_min": -804649.9336273633, "episode_return_mean": -800892.3161681248, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 51.73464719177911, "num_env_steps_trained_throughput_per_sec": 51.73464719177911, "timesteps_total": 936000, "num_env_steps_sampled_lifetime": 936000, "num_agent_steps_sampled_lifetime": 936000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 214604.913, "restore_workers_time_ms": 0.0, "training_step_time_ms": 214604.913, "sample_time_ms": 182691.491, "load_time_ms": 11.998, "load_throughput": 1000165.887, "learn_time_ms": 31892.931, "learn_throughput": 376.259, "synch_weights_time_ms": 7.194}, "counters": {"num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "training_iteration": 78, "trial_id": "befd4_00000", "date": "2025-01-22_23-33-37", "timestamp": 1737617617, "time_this_iter_s": 231.9558687210083, "time_total_s": 16569.7873814106, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16569.7873814106, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 8.35953177257525, "ram_util_percent": 39.508361204013376, "gpu_util_percent0": 0.051371237458193976, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.65461540853218, "policy_loss": -0.004098254777460279, "vf_loss": 29.994119992820167, "vf_explained_var": -0.012130240402111246, "kl": 0.0, "entropy": 33.540633289157306, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 94907.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800400.3377064684, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1008000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800400.3377064684}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9636600195995769, "mean_inference_ms": 4.440989867786639, "mean_action_processing_ms": 0.7798911491537032, "mean_env_wait_ms": 104.91482006202736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10534524917602539, "StateBufferConnector_ms": 0.03750494548252651, "ViewRequirementAgentConnector_ms": 0.13236190591539657}, "num_episodes": 8, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800400.3377064684, "episodes_this_iter": 8}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000, "num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 57.03430898420176, "num_env_steps_trained_throughput_per_sec": 57.03430898420176, "timesteps_total": 948000, "num_env_steps_sampled_lifetime": 948000, "num_agent_steps_sampled_lifetime": 948000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 948000, "timers": {"training_iteration_time_ms": 219432.345, "restore_workers_time_ms": 0.0, "training_step_time_ms": 219432.345, "sample_time_ms": 187508.908, "load_time_ms": 11.998, "load_throughput": 1000153.963, "learn_time_ms": 31903.044, "learn_throughput": 376.14, "synch_weights_time_ms": 7.196}, "counters": {"num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "done": false, "training_iteration": 79, "trial_id": "befd4_00000", "date": "2025-01-22_23-37-07", "timestamp": 1737617827, "time_this_iter_s": 210.40367364883423, "time_total_s": 16780.191055059433, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16780.191055059433, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 7.522878228782288, "ram_util_percent": 39.30590405904059, "gpu_util_percent0": 0.0577859778597786, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.25975539567946, "policy_loss": -0.02835790920814667, "vf_loss": 29.602755391173762, "vf_explained_var": 0.0805445372614612, "kl": 0.0, "entropy": 31.464209136142525, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 96116.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800400.3377064684, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1008000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800400.3377064684}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9636600195995769, "mean_inference_ms": 4.440989867786639, "mean_action_processing_ms": 0.7798911491537032, "mean_env_wait_ms": 104.91482006202736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10534524917602539, "StateBufferConnector_ms": 0.03750494548252651, "ViewRequirementAgentConnector_ms": 0.13236190591539657}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800400.3377064684, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 76.536395205919, "num_env_steps_trained_throughput_per_sec": 76.536395205919, "timesteps_total": 960000, "num_env_steps_sampled_lifetime": 960000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 216686.618, "restore_workers_time_ms": 0.0, "training_step_time_ms": 216686.618, "sample_time_ms": 184693.001, "load_time_ms": 11.998, "load_throughput": 1000148.0, "learn_time_ms": 31973.323, "learn_throughput": 375.313, "synch_weights_time_ms": 7.197}, "counters": {"num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 80, "trial_id": "befd4_00000", "date": "2025-01-22_23-39-44", "timestamp": 1737617984, "time_this_iter_s": 156.7911515235901, "time_total_s": 16936.982206583023, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16936.982206583023, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 3.488118811881189, "ram_util_percent": 38.89405940594059, "gpu_util_percent0": 0.08059405940594062, "vram_util_percent0": 0.10029296875000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.604472415125795, "policy_loss": 0.003067990402922934, "vf_loss": 30.0, "vf_explained_var": -0.00612170850076983, "kl": 0.0, "entropy": 39.859560307833256, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 97325.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800400.3377064684, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1008000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800400.3377064684}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9636600195995769, "mean_inference_ms": 4.440989867786639, "mean_action_processing_ms": 0.7798911491537032, "mean_env_wait_ms": 104.91482006202736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10534524917602539, "StateBufferConnector_ms": 0.03750494548252651, "ViewRequirementAgentConnector_ms": 0.13236190591539657}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800400.3377064684, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 66.86318849735326, "num_env_steps_trained_throughput_per_sec": 66.86318849735326, "timesteps_total": 972000, "num_env_steps_sampled_lifetime": 972000, "num_agent_steps_sampled_lifetime": 972000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 972000, "timers": {"training_iteration_time_ms": 214433.113, "restore_workers_time_ms": 0.0, "training_step_time_ms": 214433.113, "sample_time_ms": 182285.695, "load_time_ms": 12.098, "load_throughput": 991893.424, "learn_time_ms": 32126.923, "learn_throughput": 373.519, "synch_weights_time_ms": 7.298}, "counters": {"num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "done": false, "training_iteration": 81, "trial_id": "befd4_00000", "date": "2025-01-22_23-42-43", "timestamp": 1737618163, "time_this_iter_s": 179.47395205497742, "time_total_s": 17116.456158638, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17116.456158638, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 3.631168831168831, "ram_util_percent": 39.02987012987015, "gpu_util_percent0": 0.0690909090909091, "vram_util_percent0": 0.10029296875000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.60796385860522, "policy_loss": 0.00415304846710366, "vf_loss": 30.0, "vf_explained_var": -0.004079658695249344, "kl": 0.0, "entropy": 39.618917627705336, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 98534.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800400.3377064684, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1008000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800400.3377064684}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9636600195995769, "mean_inference_ms": 4.440989867786639, "mean_action_processing_ms": 0.7798911491537032, "mean_env_wait_ms": 104.91482006202736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10534524917602539, "StateBufferConnector_ms": 0.03750494548252651, "ViewRequirementAgentConnector_ms": 0.13236190591539657}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800400.3377064684, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000, "num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 60.54670382092395, "num_env_steps_trained_throughput_per_sec": 60.54670382092395, "timesteps_total": 984000, "num_env_steps_sampled_lifetime": 984000, "num_agent_steps_sampled_lifetime": 984000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 984000, "timers": {"training_iteration_time_ms": 212611.995, "restore_workers_time_ms": 0.0, "training_step_time_ms": 212611.995, "sample_time_ms": 180438.356, "load_time_ms": 12.149, "load_throughput": 987741.418, "learn_time_ms": 32152.992, "learn_throughput": 373.216, "synch_weights_time_ms": 7.298}, "counters": {"num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "done": false, "training_iteration": 82, "trial_id": "befd4_00000", "date": "2025-01-22_23-46-02", "timestamp": 1737618362, "time_this_iter_s": 198.19710993766785, "time_total_s": 17314.65326857567, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17314.65326857567, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 8.469921875, "ram_util_percent": 39.151953125, "gpu_util_percent0": 0.060703125, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.607847858993743, "policy_loss": 0.004206264778244486, "vf_loss": 30.0, "vf_explained_var": -0.0025548775201991534, "kl": 0.0, "entropy": 39.635838148118644, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 99743.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800400.3377064684, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1008000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800400.3377064684}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9636600195995769, "mean_inference_ms": 4.440989867786639, "mean_action_processing_ms": 0.7798911491537032, "mean_env_wait_ms": 104.91482006202736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10534524917602539, "StateBufferConnector_ms": 0.03750494548252651, "ViewRequirementAgentConnector_ms": 0.13236190591539657}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800400.3377064684, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000, "num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 56.33785424679992, "num_env_steps_trained_throughput_per_sec": 56.33785424679992, "timesteps_total": 996000, "num_env_steps_sampled_lifetime": 996000, "num_agent_steps_sampled_lifetime": 996000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 996000, "timers": {"training_iteration_time_ms": 211440.35, "restore_workers_time_ms": 0.0, "training_step_time_ms": 211440.35, "sample_time_ms": 179231.537, "load_time_ms": 12.149, "load_throughput": 987729.787, "learn_time_ms": 32188.267, "learn_throughput": 372.807, "synch_weights_time_ms": 7.197}, "counters": {"num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "done": false, "training_iteration": 83, "trial_id": "befd4_00000", "date": "2025-01-22_23-49-35", "timestamp": 1737618575, "time_this_iter_s": 213.0036585330963, "time_total_s": 17527.656927108765, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17527.656927108765, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 8.700000000000001, "ram_util_percent": 39.294160583941604, "gpu_util_percent0": 0.057116788321167886, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.608664858922968, "policy_loss": 0.004582769706586455, "vf_loss": 30.0, "vf_explained_var": -0.0023448804471983805, "kl": 0.0, "entropy": 39.59178751021796, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 100952.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800400.3377064684, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1008000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800400.3377064684}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9636600195995769, "mean_inference_ms": 4.440989867786639, "mean_action_processing_ms": 0.7798911491537032, "mean_env_wait_ms": 104.91482006202736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10534524917602539, "StateBufferConnector_ms": 0.03750494548252651, "ViewRequirementAgentConnector_ms": 0.13236190591539657}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800400.3377064684, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 53.79643045083697, "num_env_steps_trained_throughput_per_sec": 53.79643045083697, "timesteps_total": 1008000, "num_env_steps_sampled_lifetime": 1008000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 210750.97, "restore_workers_time_ms": 0.0, "training_step_time_ms": 210750.97, "sample_time_ms": 178574.878, "load_time_ms": 12.149, "load_throughput": 987723.972, "learn_time_ms": 32155.546, "learn_throughput": 373.186, "synch_weights_time_ms": 7.196}, "counters": {"num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 84, "trial_id": "befd4_00000", "date": "2025-01-22_23-53-18", "timestamp": 1737618798, "time_this_iter_s": 223.0661268234253, "time_total_s": 17750.72305393219, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17750.72305393219, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 8.502083333333335, "ram_util_percent": 39.391666666666666, "gpu_util_percent0": 0.055972222222222215, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.60652263978969, "policy_loss": 0.0038203027398256944, "vf_loss": 30.0, "vf_explained_var": -0.001919782487097804, "kl": 0.0, "entropy": 39.729767334766876, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 102161.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800400.3377064684, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1008000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800400.3377064684}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9636600195995769, "mean_inference_ms": 4.440989867786639, "mean_action_processing_ms": 0.7798911491537032, "mean_env_wait_ms": 104.91482006202736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10534524917602539, "StateBufferConnector_ms": 0.03750494548252651, "ViewRequirementAgentConnector_ms": 0.13236190591539657}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800400.3377064684, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000, "num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.38425897420071, "num_env_steps_trained_throughput_per_sec": 52.38425897420071, "timesteps_total": 1020000, "num_env_steps_sampled_lifetime": 1020000, "num_agent_steps_sampled_lifetime": 1020000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1020000, "timers": {"training_iteration_time_ms": 210431.042, "restore_workers_time_ms": 0.0, "training_step_time_ms": 210430.942, "sample_time_ms": 178240.79, "load_time_ms": 12.249, "load_throughput": 979659.028, "learn_time_ms": 32169.506, "learn_throughput": 373.024, "synch_weights_time_ms": 7.198}, "counters": {"num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "done": false, "training_iteration": 85, "trial_id": "befd4_00000", "date": "2025-01-22_23-57-07", "timestamp": 1737619027, "time_this_iter_s": 229.0794379711151, "time_total_s": 17979.802491903305, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17979.802491903305, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 8.466779661016949, "ram_util_percent": 39.50677966101695, "gpu_util_percent0": 0.05274576271186441, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.607529467447815, "policy_loss": 0.004933188260341104, "vf_loss": 30.0, "vf_explained_var": -0.0009910499783366844, "kl": 0.0, "entropy": 39.74037090897856, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 103370.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800400.3377064684, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1008000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800400.3377064684}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9636600195995769, "mean_inference_ms": 4.440989867786639, "mean_action_processing_ms": 0.7798911491537032, "mean_env_wait_ms": 104.91482006202736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10534524917602539, "StateBufferConnector_ms": 0.03750494548252651, "ViewRequirementAgentConnector_ms": 0.13236190591539657}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800400.3377064684, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000, "num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 51.973176015546485, "num_env_steps_trained_throughput_per_sec": 51.973176015546485, "timesteps_total": 1032000, "num_env_steps_sampled_lifetime": 1032000, "num_agent_steps_sampled_lifetime": 1032000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1032000, "timers": {"training_iteration_time_ms": 210449.566, "restore_workers_time_ms": 0.0, "training_step_time_ms": 210449.466, "sample_time_ms": 178202.451, "load_time_ms": 12.249, "load_throughput": 979636.147, "learn_time_ms": 32226.369, "learn_throughput": 372.366, "synch_weights_time_ms": 7.196}, "counters": {"num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "done": false, "training_iteration": 86, "trial_id": "befd4_00000", "date": "2025-01-23_00-00-58", "timestamp": 1737619258, "time_this_iter_s": 230.89133429527283, "time_total_s": 18210.693826198578, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18210.693826198578, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 8.290604026845637, "ram_util_percent": 39.513758389261746, "gpu_util_percent0": 0.05375838926174496, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.603745936164195, "policy_loss": 0.0020524546676573426, "vf_loss": 30.0, "vf_explained_var": -0.0006908094518139305, "kl": 0.0, "entropy": 39.83064903278209, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 104579.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800400.3377064684, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1008000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800400.3377064684}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9636600195995769, "mean_inference_ms": 4.440989867786639, "mean_action_processing_ms": 0.7798911491537032, "mean_env_wait_ms": 104.91482006202736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10534524917602539, "StateBufferConnector_ms": 0.03750494548252651, "ViewRequirementAgentConnector_ms": 0.13236190591539657}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800400.3377064684, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.384743121416314, "num_env_steps_trained_throughput_per_sec": 52.384743121416314, "timesteps_total": 1044000, "num_env_steps_sampled_lifetime": 1044000, "num_agent_steps_sampled_lifetime": 1044000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1044000, "timers": {"training_iteration_time_ms": 210190.866, "restore_workers_time_ms": 0.0, "training_step_time_ms": 210190.766, "sample_time_ms": 177909.929, "load_time_ms": 12.249, "load_throughput": 979655.215, "learn_time_ms": 32260.192, "learn_throughput": 371.975, "synch_weights_time_ms": 7.295}, "counters": {"num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "done": false, "training_iteration": 87, "trial_id": "befd4_00000", "date": "2025-01-23_00-04-47", "timestamp": 1737619487, "time_this_iter_s": 229.07732772827148, "time_total_s": 18439.77115392685, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18439.77115392685, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 7.638305084745763, "ram_util_percent": 39.53864406779661, "gpu_util_percent0": 0.05376271186440679, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.60669097237788, "policy_loss": 0.003207161794574523, "vf_loss": 30.0, "vf_explained_var": -0.000873985223478281, "kl": 0.0, "entropy": 39.65161616827852, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 105788.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800400.3377064684, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1008000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800400.3377064684}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9636600195995769, "mean_inference_ms": 4.440989867786639, "mean_action_processing_ms": 0.7798911491537032, "mean_env_wait_ms": 104.91482006202736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10534524917602539, "StateBufferConnector_ms": 0.03750494548252651, "ViewRequirementAgentConnector_ms": 0.13236190591539657}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800400.3377064684, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.38174002650294, "num_env_steps_trained_throughput_per_sec": 52.38174002650294, "timesteps_total": 1056000, "num_env_steps_sampled_lifetime": 1056000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 209904.325, "restore_workers_time_ms": 0.0, "training_step_time_ms": 209904.225, "sample_time_ms": 177626.057, "load_time_ms": 12.35, "load_throughput": 971698.457, "learn_time_ms": 32257.423, "learn_throughput": 372.007, "synch_weights_time_ms": 7.294}, "counters": {"num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 88, "trial_id": "befd4_00000", "date": "2025-01-23_00-08-36", "timestamp": 1737619716, "time_this_iter_s": 229.09045314788818, "time_total_s": 18668.861607074738, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18668.861607074738, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 7.6264406779661025, "ram_util_percent": 39.54847457627119, "gpu_util_percent0": 0.053389830508474574, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.607714118989072, "policy_loss": 0.003203541792257449, "vf_loss": 30.0, "vf_explained_var": -0.00020112978514804636, "kl": 0.0, "entropy": 39.54894407728273, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 106997.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800400.3377064684, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1008000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800400.3377064684}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9636600195995769, "mean_inference_ms": 4.440989867786639, "mean_action_processing_ms": 0.7798911491537032, "mean_env_wait_ms": 104.91482006202736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10534524917602539, "StateBufferConnector_ms": 0.03750494548252651, "ViewRequirementAgentConnector_ms": 0.13236190591539657}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800400.3377064684, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000, "num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.052280210644184, "num_env_steps_trained_throughput_per_sec": 52.052280210644184, "timesteps_total": 1068000, "num_env_steps_sampled_lifetime": 1068000, "num_agent_steps_sampled_lifetime": 1068000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1068000, "timers": {"training_iteration_time_ms": 211918.103, "restore_workers_time_ms": 0.0, "training_step_time_ms": 211918.003, "sample_time_ms": 179609.705, "load_time_ms": 12.349, "load_throughput": 971700.333, "learn_time_ms": 32287.555, "learn_throughput": 371.66, "synch_weights_time_ms": 7.393}, "counters": {"num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "done": false, "training_iteration": 89, "trial_id": "befd4_00000", "date": "2025-01-23_00-12-27", "timestamp": 1737619947, "time_this_iter_s": 230.5404496192932, "time_total_s": 18899.40205669403, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18899.40205669403, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 7.661616161616162, "ram_util_percent": 39.598653198653196, "gpu_util_percent0": 0.053232323232323235, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.607197301657955, "policy_loss": 0.004388559766797806, "vf_loss": 30.0, "vf_explained_var": -0.0010266608201934839, "kl": 0.0, "entropy": 39.71912380877953, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 108206.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800384.6914363571, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1152000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800384.6914363571}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9637558307286339, "mean_inference_ms": 4.439976054679326, "mean_action_processing_ms": 0.7797676674161617, "mean_env_wait_ms": 104.98472529799267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10155141353607178, "StateBufferConnector_ms": 0.03750249743461609, "ViewRequirementAgentConnector_ms": 0.1361466944217682}, "num_episodes": 8, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800384.6914363571, "episodes_this_iter": 8}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.05355287777782, "num_env_steps_trained_throughput_per_sec": 52.05355287777782, "timesteps_total": 1080000, "num_env_steps_sampled_lifetime": 1080000, "num_agent_steps_sampled_lifetime": 1080000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 219292.469, "restore_workers_time_ms": 0.0, "training_step_time_ms": 219292.369, "sample_time_ms": 187050.739, "load_time_ms": 12.45, "load_throughput": 963877.291, "learn_time_ms": 32220.786, "learn_throughput": 372.43, "synch_weights_time_ms": 7.392}, "counters": {"num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "training_iteration": 90, "trial_id": "befd4_00000", "date": "2025-01-23_00-16-17", "timestamp": 1737620177, "time_this_iter_s": 230.53481364250183, "time_total_s": 19129.936870336533, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19129.936870336533, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 7.878114478114479, "ram_util_percent": 39.41010101010101, "gpu_util_percent0": 0.05195286195286196, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.25557814125585, "policy_loss": -0.03874373147410485, "vf_loss": 29.552239314695345, "vf_explained_var": -0.025402798102452204, "kl": 0.0, "entropy": 25.791739082809713, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 109415.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800384.6914363571, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1152000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800384.6914363571}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9637558307286339, "mean_inference_ms": 4.439976054679326, "mean_action_processing_ms": 0.7797676674161617, "mean_env_wait_ms": 104.98472529799267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10155141353607178, "StateBufferConnector_ms": 0.03750249743461609, "ViewRequirementAgentConnector_ms": 0.1361466944217682}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800384.6914363571, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000, "num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 79.28755222108833, "num_env_steps_trained_throughput_per_sec": 79.28755222108833, "timesteps_total": 1092000, "num_env_steps_sampled_lifetime": 1092000, "num_agent_steps_sampled_lifetime": 1092000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1092000, "timers": {"training_iteration_time_ms": 216480.158, "restore_workers_time_ms": 0.0, "training_step_time_ms": 216480.058, "sample_time_ms": 184318.862, "load_time_ms": 12.35, "load_throughput": 971666.567, "learn_time_ms": 32140.452, "learn_throughput": 373.361, "synch_weights_time_ms": 7.293}, "counters": {"num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "done": false, "training_iteration": 91, "trial_id": "befd4_00000", "date": "2025-01-23_00-18-49", "timestamp": 1737620329, "time_this_iter_s": 151.3513629436493, "time_total_s": 19281.288233280182, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19281.288233280182, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 3.73265306122449, "ram_util_percent": 38.83316326530612, "gpu_util_percent0": 0.08362244897959184, "vram_util_percent0": 0.10029296875000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.604910190288837, "policy_loss": -0.006012958536853566, "vf_loss": 30.0, "vf_explained_var": -0.053109730690150736, "kl": 0.0, "entropy": 38.90768886657664, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 110624.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800384.6914363571, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1152000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800384.6914363571}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9637558307286339, "mean_inference_ms": 4.439976054679326, "mean_action_processing_ms": 0.7797676674161617, "mean_env_wait_ms": 104.98472529799267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10155141353607178, "StateBufferConnector_ms": 0.03750249743461609, "ViewRequirementAgentConnector_ms": 0.1361466944217682}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800384.6914363571, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 68.6098798481728, "num_env_steps_trained_throughput_per_sec": 68.6098798481728, "timesteps_total": 1104000, "num_env_steps_sampled_lifetime": 1104000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 214150.939, "restore_workers_time_ms": 0.0, "training_step_time_ms": 214150.839, "sample_time_ms": 181951.608, "load_time_ms": 12.299, "load_throughput": 975674.799, "learn_time_ms": 32178.538, "learn_throughput": 372.919, "synch_weights_time_ms": 7.394}, "counters": {"num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 92, "trial_id": "befd4_00000", "date": "2025-01-23_00-21-43", "timestamp": 1737620503, "time_this_iter_s": 174.90492010116577, "time_total_s": 19456.193153381348, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19456.193153381348, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 3.6742222222222223, "ram_util_percent": 38.93688888888889, "gpu_util_percent0": 0.07133333333333333, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.619131021996587, "policy_loss": 0.0024995823337629476, "vf_loss": 30.0, "vf_explained_var": -0.02325183739831765, "kl": 0.0, "entropy": 38.33685554207801, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 111833.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800384.6914363571, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1152000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800384.6914363571}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9637558307286339, "mean_inference_ms": 4.439976054679326, "mean_action_processing_ms": 0.7797676674161617, "mean_env_wait_ms": 104.98472529799267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10155141353607178, "StateBufferConnector_ms": 0.03750249743461609, "ViewRequirementAgentConnector_ms": 0.1361466944217682}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800384.6914363571, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 61.49498854551307, "num_env_steps_trained_throughput_per_sec": 61.49498854551307, "timesteps_total": 1116000, "num_env_steps_sampled_lifetime": 1116000, "num_agent_steps_sampled_lifetime": 1116000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1116000, "timers": {"training_iteration_time_ms": 212364.659, "restore_workers_time_ms": 0.0, "training_step_time_ms": 212364.559, "sample_time_ms": 180083.633, "load_time_ms": 12.199, "load_throughput": 983691.311, "learn_time_ms": 32260.231, "learn_throughput": 371.975, "synch_weights_time_ms": 7.396}, "counters": {"num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "done": false, "training_iteration": 93, "trial_id": "befd4_00000", "date": "2025-01-23_00-24-59", "timestamp": 1737620699, "time_this_iter_s": 195.1408519744873, "time_total_s": 19651.334005355835, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19651.334005355835, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 7.483665338645419, "ram_util_percent": 39.04860557768924, "gpu_util_percent0": 0.06410358565737054, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.621387155121077, "policy_loss": 0.0035569531992509207, "vf_loss": 30.0, "vf_explained_var": -0.010457199895746753, "kl": 0.0, "entropy": 38.216979074912, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 113042.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800384.6914363571, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1152000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800384.6914363571}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9637558307286339, "mean_inference_ms": 4.439976054679326, "mean_action_processing_ms": 0.7797676674161617, "mean_env_wait_ms": 104.98472529799267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10155141353607178, "StateBufferConnector_ms": 0.03750249743461609, "ViewRequirementAgentConnector_ms": 0.1361466944217682}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800384.6914363571, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000, "num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 57.20041441928704, "num_env_steps_trained_throughput_per_sec": 57.20041441928704, "timesteps_total": 1128000, "num_env_steps_sampled_lifetime": 1128000, "num_agent_steps_sampled_lifetime": 1128000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1128000, "timers": {"training_iteration_time_ms": 211037.215, "restore_workers_time_ms": 0.0, "training_step_time_ms": 211037.115, "sample_time_ms": 178678.41, "load_time_ms": 12.199, "load_throughput": 983714.382, "learn_time_ms": 32337.91, "learn_throughput": 371.081, "synch_weights_time_ms": 7.296}, "counters": {"num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "done": false, "training_iteration": 94, "trial_id": "befd4_00000", "date": "2025-01-23_00-28-28", "timestamp": 1737620908, "time_this_iter_s": 209.79168581962585, "time_total_s": 19861.12569117546, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19861.12569117546, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 7.631365313653136, "ram_util_percent": 39.18154981549816, "gpu_util_percent0": 0.06114391143911439, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.622481408446557, "policy_loss": 0.003795879798254955, "vf_loss": 30.0, "vf_explained_var": -0.0038446084934389228, "kl": 0.0, "entropy": 38.13144901234617, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 114251.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800384.6914363571, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1152000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800384.6914363571}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9637558307286339, "mean_inference_ms": 4.439976054679326, "mean_action_processing_ms": 0.7797676674161617, "mean_env_wait_ms": 104.98472529799267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10155141353607178, "StateBufferConnector_ms": 0.03750249743461609, "ViewRequirementAgentConnector_ms": 0.1361466944217682}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800384.6914363571, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000, "num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 54.56166327244539, "num_env_steps_trained_throughput_per_sec": 54.56166327244539, "timesteps_total": 1140000, "num_env_steps_sampled_lifetime": 1140000, "num_agent_steps_sampled_lifetime": 1140000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1140000, "timers": {"training_iteration_time_ms": 210123.035, "restore_workers_time_ms": 0.0, "training_step_time_ms": 210123.035, "sample_time_ms": 177785.548, "load_time_ms": 12.099, "load_throughput": 991838.694, "learn_time_ms": 32316.892, "learn_throughput": 371.323, "synch_weights_time_ms": 7.295}, "counters": {"num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "done": false, "training_iteration": 95, "trial_id": "befd4_00000", "date": "2025-01-23_00-32-08", "timestamp": 1737621128, "time_this_iter_s": 219.93764114379883, "time_total_s": 20081.06333231926, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20081.06333231926, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 7.451590106007067, "ram_util_percent": 39.27703180212014, "gpu_util_percent0": 0.05561837455830388, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.621981656285136, "policy_loss": 0.004164582261672387, "vf_loss": 30.0, "vf_explained_var": -0.005417890051754178, "kl": 0.0, "entropy": 38.218292409866876, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 115460.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800384.6914363571, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1152000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800384.6914363571}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9637558307286339, "mean_inference_ms": 4.439976054679326, "mean_action_processing_ms": 0.7797676674161617, "mean_env_wait_ms": 104.98472529799267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10155141353607178, "StateBufferConnector_ms": 0.03750249743461609, "ViewRequirementAgentConnector_ms": 0.1361466944217682}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800384.6914363571, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.994187925080965, "num_env_steps_trained_throughput_per_sec": 52.994187925080965, "timesteps_total": 1152000, "num_env_steps_sampled_lifetime": 1152000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 209678.194, "restore_workers_time_ms": 0.0, "training_step_time_ms": 209678.194, "sample_time_ms": 177392.011, "load_time_ms": 12.098, "load_throughput": 991860.194, "learn_time_ms": 32265.586, "learn_throughput": 371.913, "synch_weights_time_ms": 7.296}, "counters": {"num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 96, "trial_id": "befd4_00000", "date": "2025-01-23_00-35-55", "timestamp": 1737621355, "time_this_iter_s": 226.44292211532593, "time_total_s": 20307.506254434586, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20307.506254434586, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 7.365753424657535, "ram_util_percent": 39.37842465753425, "gpu_util_percent0": 0.05332191780821918, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.62092407800818, "policy_loss": 0.004757361669891427, "vf_loss": 30.0, "vf_explained_var": -0.003442575312331257, "kl": 0.0, "entropy": 38.383326812062606, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 116669.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800384.6914363571, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1152000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800384.6914363571}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9637558307286339, "mean_inference_ms": 4.439976054679326, "mean_action_processing_ms": 0.7797676674161617, "mean_env_wait_ms": 104.98472529799267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10155141353607178, "StateBufferConnector_ms": 0.03750249743461609, "ViewRequirementAgentConnector_ms": 0.1361466944217682}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800384.6914363571, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000, "num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.66895259318996, "num_env_steps_trained_throughput_per_sec": 52.66895259318996, "timesteps_total": 1164000, "num_env_steps_sampled_lifetime": 1164000, "num_agent_steps_sampled_lifetime": 1164000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1164000, "timers": {"training_iteration_time_ms": 209554.582, "restore_workers_time_ms": 0.0, "training_step_time_ms": 209554.582, "sample_time_ms": 177243.075, "load_time_ms": 12.099, "load_throughput": 991834.785, "learn_time_ms": 32290.908, "learn_throughput": 371.622, "synch_weights_time_ms": 7.298}, "counters": {"num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "done": false, "training_iteration": 97, "trial_id": "befd4_00000", "date": "2025-01-23_00-39-43", "timestamp": 1737621583, "time_this_iter_s": 227.84120798110962, "time_total_s": 20535.347462415695, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20535.347462415695, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 7.338775510204083, "ram_util_percent": 39.434013605442175, "gpu_util_percent0": 0.052789115646258516, "vram_util_percent0": 0.10029296875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.617778082343545, "policy_loss": 0.0026373689650651144, "vf_loss": 30.0, "vf_explained_var": -0.0010467951607368918, "kl": 0.0, "entropy": 38.48592902058112, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 117878.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800384.6914363571, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1152000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800384.6914363571}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9637558307286339, "mean_inference_ms": 4.439976054679326, "mean_action_processing_ms": 0.7797676674161617, "mean_env_wait_ms": 104.98472529799267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10155141353607178, "StateBufferConnector_ms": 0.03750249743461609, "ViewRequirementAgentConnector_ms": 0.1361466944217682}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800384.6914363571, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000, "num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.77418621396144, "num_env_steps_trained_throughput_per_sec": 52.77418621396144, "timesteps_total": 1176000, "num_env_steps_sampled_lifetime": 1176000, "num_agent_steps_sampled_lifetime": 1176000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1176000, "timers": {"training_iteration_time_ms": 209384.225, "restore_workers_time_ms": 0.0, "training_step_time_ms": 209384.225, "sample_time_ms": 177118.153, "load_time_ms": 12.098, "load_throughput": 991860.194, "learn_time_ms": 32245.622, "learn_throughput": 372.144, "synch_weights_time_ms": 7.35}, "counters": {"num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "done": false, "training_iteration": 98, "trial_id": "befd4_00000", "date": "2025-01-23_00-43-30", "timestamp": 1737621810, "time_this_iter_s": 227.38789224624634, "time_total_s": 20762.73535466194, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20762.73535466194, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 7.374061433447099, "ram_util_percent": 39.42764505119454, "gpu_util_percent0": 0.052491467576791816, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.618966081302162, "policy_loss": 0.003704974518717568, "vf_loss": 30.0, "vf_explained_var": -0.002919480660614443, "kl": 0.0, "entropy": 38.47389119592356, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 119087.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800384.6914363571, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1152000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800384.6914363571}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9637558307286339, "mean_inference_ms": 4.439976054679326, "mean_action_processing_ms": 0.7797676674161617, "mean_env_wait_ms": 104.98472529799267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10155141353607178, "StateBufferConnector_ms": 0.03750249743461609, "ViewRequirementAgentConnector_ms": 0.1361466944217682}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800384.6914363571, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.619323938492904, "num_env_steps_trained_throughput_per_sec": 52.619323938492904, "timesteps_total": 1188000, "num_env_steps_sampled_lifetime": 1188000, "num_agent_steps_sampled_lifetime": 1188000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1188000, "timers": {"training_iteration_time_ms": 209135.79, "restore_workers_time_ms": 0.0, "training_step_time_ms": 209135.79, "sample_time_ms": 176866.363, "load_time_ms": 12.098, "load_throughput": 991860.194, "learn_time_ms": 32248.775, "learn_throughput": 372.107, "synch_weights_time_ms": 7.451}, "counters": {"num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "done": false, "training_iteration": 99, "trial_id": "befd4_00000", "date": "2025-01-23_00-47-18", "timestamp": 1737622038, "time_this_iter_s": 228.05609679222107, "time_total_s": 20990.791451454163, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20990.791451454163, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 7.3146258503401365, "ram_util_percent": 39.44115646258503, "gpu_util_percent0": 0.052993197278911566, "vram_util_percent0": 0.10029296875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.61896725032229, "policy_loss": 0.0038691615890726954, "vf_loss": 30.0, "vf_explained_var": -0.002069726771219788, "kl": 0.0, "entropy": 38.49019144782358, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 120296.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800384.6914363571, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1152000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800384.6914363571}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9637558307286339, "mean_inference_ms": 4.439976054679326, "mean_action_processing_ms": 0.7797676674161617, "mean_env_wait_ms": 104.98472529799267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10155141353607178, "StateBufferConnector_ms": 0.03750249743461609, "ViewRequirementAgentConnector_ms": 0.1361466944217682}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800384.6914363571, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.39553014824412, "num_env_steps_trained_throughput_per_sec": 52.39553014824412, "timesteps_total": 1200000, "num_env_steps_sampled_lifetime": 1200000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 208985.326, "restore_workers_time_ms": 0.0, "training_step_time_ms": 208985.326, "sample_time_ms": 176645.337, "load_time_ms": 11.998, "load_throughput": 1000140.051, "learn_time_ms": 32319.339, "learn_throughput": 371.295, "synch_weights_time_ms": 7.451}, "counters": {"num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 100, "trial_id": "befd4_00000", "date": "2025-01-23_00-51-07", "timestamp": 1737622267, "time_this_iter_s": 229.03016710281372, "time_total_s": 21219.821618556976, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 21219.821618556976, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 7.36542372881356, "ram_util_percent": 39.482711864406774, "gpu_util_percent0": 0.0527457627118644, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.61804953007978, "policy_loss": 0.0026692540266969366, "vf_loss": 30.0, "vf_explained_var": -0.0009911961551536896, "kl": 0.0, "entropy": 38.46197815509351, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 121505.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800384.6914363571, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1152000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800384.6914363571}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9637558307286339, "mean_inference_ms": 4.439976054679326, "mean_action_processing_ms": 0.7797676674161617, "mean_env_wait_ms": 104.98472529799267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10155141353607178, "StateBufferConnector_ms": 0.03750249743461609, "ViewRequirementAgentConnector_ms": 0.1361466944217682}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800384.6914363571, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000, "num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.279264639116526, "num_env_steps_trained_throughput_per_sec": 52.279264639116526, "timesteps_total": 1212000, "num_env_steps_sampled_lifetime": 1212000, "num_agent_steps_sampled_lifetime": 1212000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1212000, "timers": {"training_iteration_time_ms": 216804.193, "restore_workers_time_ms": 0.0, "training_step_time_ms": 216804.193, "sample_time_ms": 184548.344, "load_time_ms": 11.998, "load_throughput": 1000134.089, "learn_time_ms": 32235.299, "learn_throughput": 372.263, "synch_weights_time_ms": 7.449}, "counters": {"num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "done": false, "training_iteration": 101, "trial_id": "befd4_00000", "date": "2025-01-23_00-54-57", "timestamp": 1737622497, "time_this_iter_s": 229.5395085811615, "time_total_s": 21449.361127138138, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 21449.361127138138, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 7.305743243243243, "ram_util_percent": 39.48547297297298, "gpu_util_percent0": 0.05368243243243243, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.51265720496797, "policy_loss": -0.0047257127497588635, "vf_loss": 29.77814178529902, "vf_explained_var": -0.07528529949085687, "kl": 0.0, "entropy": 26.075885081705326, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 122714.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800082.068576778, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1296000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800082.068576778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9637630723863863, "mean_inference_ms": 4.438677395496931, "mean_action_processing_ms": 0.7796056161719636, "mean_env_wait_ms": 105.00053463106077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09304748641120063, "StateBufferConnector_ms": 0.0333355532752143, "ViewRequirementAgentConnector_ms": 0.13919141557481554}, "num_episodes": 8, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800082.068576778, "episodes_this_iter": 8}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 70.7780097069572, "num_env_steps_trained_throughput_per_sec": 70.7780097069572, "timesteps_total": 1224000, "num_env_steps_sampled_lifetime": 1224000, "num_agent_steps_sampled_lifetime": 1224000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1224000, "timers": {"training_iteration_time_ms": 216268.419, "restore_workers_time_ms": 0.0, "training_step_time_ms": 216268.419, "sample_time_ms": 184103.615, "load_time_ms": 11.999, "load_throughput": 1000092.356, "learn_time_ms": 32144.254, "learn_throughput": 373.317, "synch_weights_time_ms": 7.349}, "counters": {"num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "done": false, "training_iteration": 102, "trial_id": "befd4_00000", "date": "2025-01-23_00-57-47", "timestamp": 1737622667, "time_this_iter_s": 169.54817843437195, "time_total_s": 21618.90930557251, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 21618.90930557251, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 3.942009132420091, "ram_util_percent": 39.05707762557076, "gpu_util_percent0": 0.0712785388127854, "vram_util_percent0": 0.10029296875000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.210225260681707, "policy_loss": -0.008341986152926587, "vf_loss": 29.634913003572855, "vf_explained_var": 0.05158530916430124, "kl": 0.0, "entropy": 41.63457703886198, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 123923.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800082.068576778, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1296000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800082.068576778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9637630723863863, "mean_inference_ms": 4.438677395496931, "mean_action_processing_ms": 0.7796056161719636, "mean_env_wait_ms": 105.00053463106077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09304748641120063, "StateBufferConnector_ms": 0.0333355532752143, "ViewRequirementAgentConnector_ms": 0.13919141557481554}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800082.068576778, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000, "num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 72.23059611748675, "num_env_steps_trained_throughput_per_sec": 72.23059611748675, "timesteps_total": 1236000, "num_env_steps_sampled_lifetime": 1236000, "num_agent_steps_sampled_lifetime": 1236000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1236000, "timers": {"training_iteration_time_ms": 213368.092, "restore_workers_time_ms": 0.0, "training_step_time_ms": 213368.092, "sample_time_ms": 181308.494, "load_time_ms": 12.099, "load_throughput": 991813.286, "learn_time_ms": 32039.049, "learn_throughput": 374.543, "synch_weights_time_ms": 7.449}, "counters": {"num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "done": false, "training_iteration": 103, "trial_id": "befd4_00000", "date": "2025-01-23_01-00-33", "timestamp": 1737622833, "time_this_iter_s": 166.13758373260498, "time_total_s": 21785.046889305115, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 21785.046889305115, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 1.9457943925233643, "ram_util_percent": 38.93084112149532, "gpu_util_percent0": 0.07341121495327105, "vram_util_percent0": 0.10029296875000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.59169101793969, "policy_loss": 0.0046931098102044235, "vf_loss": 30.0, "vf_explained_var": -0.009418630126688084, "kl": 0.0, "entropy": 41.3002088466294, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 125132.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800082.068576778, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1296000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800082.068576778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9637630723863863, "mean_inference_ms": 4.438677395496931, "mean_action_processing_ms": 0.7796056161719636, "mean_env_wait_ms": 105.00053463106077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09304748641120063, "StateBufferConnector_ms": 0.0333355532752143, "ViewRequirementAgentConnector_ms": 0.13919141557481554}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800082.068576778, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 63.655131357257176, "num_env_steps_trained_throughput_per_sec": 63.655131357257176, "timesteps_total": 1248000, "num_env_steps_sampled_lifetime": 1248000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 211240.806, "restore_workers_time_ms": 0.0, "training_step_time_ms": 211240.806, "sample_time_ms": 179234.03, "load_time_ms": 12.099, "load_throughput": 991785.925, "learn_time_ms": 31986.126, "learn_throughput": 375.163, "synch_weights_time_ms": 7.549}, "counters": {"num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 104, "trial_id": "befd4_00000", "date": "2025-01-23_01-03-41", "timestamp": 1737623021, "time_this_iter_s": 188.5188250541687, "time_total_s": 21973.565714359283, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 21973.565714359283, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 4.836213991769546, "ram_util_percent": 39.07201646090535, "gpu_util_percent0": 0.06477366255144033, "vram_util_percent0": 0.10029296875000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.59243899677488, "policy_loss": 0.004917533887970832, "vf_loss": 30.0, "vf_explained_var": -0.0037256017807991274, "kl": 0.0, "entropy": 41.2478516912342, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 126341.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800082.068576778, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1296000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800082.068576778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9637630723863863, "mean_inference_ms": 4.438677395496931, "mean_action_processing_ms": 0.7796056161719636, "mean_env_wait_ms": 105.00053463106077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09304748641120063, "StateBufferConnector_ms": 0.0333355532752143, "ViewRequirementAgentConnector_ms": 0.13919141557481554}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800082.068576778, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 58.53313164606219, "num_env_steps_trained_throughput_per_sec": 58.53313164606219, "timesteps_total": 1260000, "num_env_steps_sampled_lifetime": 1260000, "num_agent_steps_sampled_lifetime": 1260000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1260000, "timers": {"training_iteration_time_ms": 209748.551, "restore_workers_time_ms": 0.0, "training_step_time_ms": 209748.551, "sample_time_ms": 177782.433, "load_time_ms": 12.099, "load_throughput": 991793.742, "learn_time_ms": 31945.468, "learn_throughput": 375.64, "synch_weights_time_ms": 7.55}, "counters": {"num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "done": false, "training_iteration": 105, "trial_id": "befd4_00000", "date": "2025-01-23_01-07-06", "timestamp": 1737623226, "time_this_iter_s": 205.0150966644287, "time_total_s": 22178.580811023712, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 22178.580811023712, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 7.701136363636364, "ram_util_percent": 39.182196969696975, "gpu_util_percent0": 0.059734848484848474, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.59176556545412, "policy_loss": 0.0036438029841808764, "vf_loss": 30.0, "vf_explained_var": -0.0026304645909071955, "kl": 0.0, "entropy": 41.18782323643232, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 127550.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800082.068576778, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1296000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800082.068576778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9637630723863863, "mean_inference_ms": 4.438677395496931, "mean_action_processing_ms": 0.7796056161719636, "mean_env_wait_ms": 105.00053463106077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09304748641120063, "StateBufferConnector_ms": 0.0333355532752143, "ViewRequirementAgentConnector_ms": 0.13919141557481554}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800082.068576778, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000, "num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 55.197006036076964, "num_env_steps_trained_throughput_per_sec": 55.197006036076964, "timesteps_total": 1272000, "num_env_steps_sampled_lifetime": 1272000, "num_agent_steps_sampled_lifetime": 1272000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1272000, "timers": {"training_iteration_time_ms": 208844.868, "restore_workers_time_ms": 0.0, "training_step_time_ms": 208844.868, "sample_time_ms": 176821.295, "load_time_ms": 12.199, "load_throughput": 983662.474, "learn_time_ms": 32002.871, "learn_throughput": 374.966, "synch_weights_time_ms": 7.602}, "counters": {"num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "done": false, "training_iteration": 106, "trial_id": "befd4_00000", "date": "2025-01-23_01-10-44", "timestamp": 1737623444, "time_this_iter_s": 217.40709853172302, "time_total_s": 22395.987909555435, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 22395.987909555435, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 7.491428571428573, "ram_util_percent": 39.307857142857145, "gpu_util_percent0": 0.056, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.591625242020296, "policy_loss": 0.004598985251264201, "vf_loss": 30.0, "vf_explained_var": -0.0016146452590588994, "kl": 0.0, "entropy": 41.297373822940294, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 128759.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800082.068576778, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1296000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800082.068576778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9637630723863863, "mean_inference_ms": 4.438677395496931, "mean_action_processing_ms": 0.7796056161719636, "mean_env_wait_ms": 105.00053463106077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09304748641120063, "StateBufferConnector_ms": 0.0333355532752143, "ViewRequirementAgentConnector_ms": 0.13919141557481554}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800082.068576778, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000, "num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 53.30653790132366, "num_env_steps_trained_throughput_per_sec": 53.30653790132366, "timesteps_total": 1284000, "num_env_steps_sampled_lifetime": 1284000, "num_agent_steps_sampled_lifetime": 1284000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1284000, "timers": {"training_iteration_time_ms": 208572.357, "restore_workers_time_ms": 0.0, "training_step_time_ms": 208572.357, "sample_time_ms": 176543.656, "load_time_ms": 12.199, "load_throughput": 983660.551, "learn_time_ms": 32008.001, "learn_throughput": 374.906, "synch_weights_time_ms": 7.5}, "counters": {"num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "done": false, "training_iteration": 107, "trial_id": "befd4_00000", "date": "2025-01-23_01-14-29", "timestamp": 1737623669, "time_this_iter_s": 225.1170997619629, "time_total_s": 22621.105009317398, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 22621.105009317398, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 7.4237931034482765, "ram_util_percent": 39.4703448275862, "gpu_util_percent0": 0.05413793103448276, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.593612276492188, "policy_loss": 0.005333594145904995, "vf_loss": 30.0, "vf_explained_var": -0.0009470785127581398, "kl": 0.0, "entropy": 41.17213478435456, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 129968.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800082.068576778, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1296000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800082.068576778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9637630723863863, "mean_inference_ms": 4.438677395496931, "mean_action_processing_ms": 0.7796056161719636, "mean_env_wait_ms": 105.00053463106077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09304748641120063, "StateBufferConnector_ms": 0.0333355532752143, "ViewRequirementAgentConnector_ms": 0.13919141557481554}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800082.068576778, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.431002320559976, "num_env_steps_trained_throughput_per_sec": 52.431002320559976, "timesteps_total": 1296000, "num_env_steps_sampled_lifetime": 1296000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 208721.19, "restore_workers_time_ms": 0.0, "training_step_time_ms": 208721.19, "sample_time_ms": 176666.304, "load_time_ms": 12.1, "load_throughput": 991768.336, "learn_time_ms": 32034.137, "learn_throughput": 374.6, "synch_weights_time_ms": 7.448}, "counters": {"num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 108, "trial_id": "befd4_00000", "date": "2025-01-23_01-18-18", "timestamp": 1737623898, "time_this_iter_s": 228.87522292137146, "time_total_s": 22849.98023223877, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 22849.98023223877, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 7.375254237288135, "ram_util_percent": 39.51050847457627, "gpu_util_percent0": 0.05420338983050847, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.59195325865639, "policy_loss": 0.0046237463838705055, "vf_loss": 30.0, "vf_explained_var": 7.978739868618419e-05, "kl": 0.0, "entropy": 41.26704843109358, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 131177.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800082.068576778, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1296000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800082.068576778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9637630723863863, "mean_inference_ms": 4.438677395496931, "mean_action_processing_ms": 0.7796056161719636, "mean_env_wait_ms": 105.00053463106077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09304748641120063, "StateBufferConnector_ms": 0.0333355532752143, "ViewRequirementAgentConnector_ms": 0.13919141557481554}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800082.068576778, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000, "num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.301882888953465, "num_env_steps_trained_throughput_per_sec": 52.301882888953465, "timesteps_total": 1308000, "num_env_steps_sampled_lifetime": 1308000, "num_agent_steps_sampled_lifetime": 1308000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1308000, "timers": {"training_iteration_time_ms": 208859.604, "restore_workers_time_ms": 0.0, "training_step_time_ms": 208859.604, "sample_time_ms": 176789.568, "load_time_ms": 12.1, "load_throughput": 991760.519, "learn_time_ms": 32049.488, "learn_throughput": 374.421, "synch_weights_time_ms": 7.249}, "counters": {"num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "done": false, "training_iteration": 109, "trial_id": "befd4_00000", "date": "2025-01-23_01-22-07", "timestamp": 1737624127, "time_this_iter_s": 229.4402482509613, "time_total_s": 23079.42048048973, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23079.42048048973, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 7.35304054054054, "ram_util_percent": 39.50067567567568, "gpu_util_percent0": 0.05351351351351352, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.58982300896404, "policy_loss": 0.0032537031003618357, "vf_loss": 30.0, "vf_explained_var": -0.0003274673760874001, "kl": 0.0, "entropy": 41.34306993318847, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 132386.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800082.068576778, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1296000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800082.068576778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9637630723863863, "mean_inference_ms": 4.438677395496931, "mean_action_processing_ms": 0.7796056161719636, "mean_env_wait_ms": 105.00053463106077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09304748641120063, "StateBufferConnector_ms": 0.0333355532752143, "ViewRequirementAgentConnector_ms": 0.13919141557481554}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800082.068576778, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000, "num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.01763500280101, "num_env_steps_trained_throughput_per_sec": 52.01763500280101, "timesteps_total": 1320000, "num_env_steps_sampled_lifetime": 1320000, "num_agent_steps_sampled_lifetime": 1320000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1320000, "timers": {"training_iteration_time_ms": 209025.987, "restore_workers_time_ms": 0.0, "training_step_time_ms": 209025.987, "sample_time_ms": 176965.952, "load_time_ms": 12.051, "load_throughput": 995775.029, "learn_time_ms": 32039.536, "learn_throughput": 374.537, "synch_weights_time_ms": 7.249}, "counters": {"num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "done": false, "training_iteration": 110, "trial_id": "befd4_00000", "date": "2025-01-23_01-25-58", "timestamp": 1737624358, "time_this_iter_s": 230.69399619102478, "time_total_s": 23310.114476680756, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23310.114476680756, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 7.245791245791246, "ram_util_percent": 39.50404040404041, "gpu_util_percent0": 0.05158249158249159, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.59065729650808, "policy_loss": 0.004809482699465022, "vf_loss": 30.0, "vf_explained_var": 0.0002113788260025264, "kl": 0.0, "entropy": 41.41521701544548, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 133595.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800082.068576778, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1296000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800082.068576778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9637630723863863, "mean_inference_ms": 4.438677395496931, "mean_action_processing_ms": 0.7796056161719636, "mean_env_wait_ms": 105.00053463106077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09304748641120063, "StateBufferConnector_ms": 0.0333355532752143, "ViewRequirementAgentConnector_ms": 0.13919141557481554}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800082.068576778, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.06729498113273, "num_env_steps_trained_throughput_per_sec": 52.06729498113273, "timesteps_total": 1332000, "num_env_steps_sampled_lifetime": 1332000, "num_agent_steps_sampled_lifetime": 1332000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1332000, "timers": {"training_iteration_time_ms": 209119.433, "restore_workers_time_ms": 0.0, "training_step_time_ms": 209119.433, "sample_time_ms": 176975.088, "load_time_ms": 12.051, "load_throughput": 995794.73, "learn_time_ms": 32123.845, "learn_throughput": 373.554, "synch_weights_time_ms": 7.25}, "counters": {"num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "done": false, "training_iteration": 111, "trial_id": "befd4_00000", "date": "2025-01-23_01-29-49", "timestamp": 1737624589, "time_this_iter_s": 230.47396755218506, "time_total_s": 23540.58844423294, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23540.58844423294, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 7.28956228956229, "ram_util_percent": 39.5003367003367, "gpu_util_percent0": 0.05484848484848485, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.590100418545177, "policy_loss": 0.004925268776930493, "vf_loss": 30.0, "vf_explained_var": 0.0005822481450411384, "kl": 0.0, "entropy": 41.48248652607276, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 134804.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800082.068576778, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1296000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800082.068576778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9637630723863863, "mean_inference_ms": 4.438677395496931, "mean_action_processing_ms": 0.7796056161719636, "mean_env_wait_ms": 105.00053463106077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09304748641120063, "StateBufferConnector_ms": 0.0333355532752143, "ViewRequirementAgentConnector_ms": 0.13919141557481554}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800082.068576778, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.28205988805173, "num_env_steps_trained_throughput_per_sec": 52.28205988805173, "timesteps_total": 1344000, "num_env_steps_sampled_lifetime": 1344000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 215117.438, "restore_workers_time_ms": 0.0, "training_step_time_ms": 215117.438, "sample_time_ms": 182933.533, "load_time_ms": 12.15, "load_throughput": 987652.259, "learn_time_ms": 32163.408, "learn_throughput": 373.095, "synch_weights_time_ms": 7.249}, "counters": {"num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 112, "trial_id": "befd4_00000", "date": "2025-01-23_01-33-38", "timestamp": 1737624818, "time_this_iter_s": 229.52823781967163, "time_total_s": 23770.116682052612, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23770.116682052612, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 7.30168918918919, "ram_util_percent": 39.505405405405405, "gpu_util_percent0": 0.05388513513513513, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.64094642689644, "policy_loss": -0.007727592616558469, "vf_loss": 29.958977482356346, "vf_explained_var": -0.06727333912877034, "kl": 0.0, "entropy": 31.030350627536315, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 136013.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800031.577312192, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1440000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800031.577312192}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9637677936502238, "mean_inference_ms": 4.437282776978458, "mean_action_processing_ms": 0.7793963064485455, "mean_env_wait_ms": 105.01891057599839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09374558925628662, "StateBufferConnector_ms": 0.036256611347198486, "ViewRequirementAgentConnector_ms": 0.13778477907180786}, "num_episodes": 8, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800031.577312192, "episodes_this_iter": 8}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000, "num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 63.5602984687824, "num_env_steps_trained_throughput_per_sec": 63.5602984687824, "timesteps_total": 1356000, "num_env_steps_sampled_lifetime": 1356000, "num_agent_steps_sampled_lifetime": 1356000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1356000, "timers": {"training_iteration_time_ms": 217383.69, "restore_workers_time_ms": 0.0, "training_step_time_ms": 217383.69, "sample_time_ms": 185202.592, "load_time_ms": 12.25, "load_throughput": 979592.294, "learn_time_ms": 32160.4, "learn_throughput": 373.13, "synch_weights_time_ms": 7.149}, "counters": {"num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "done": false, "training_iteration": 113, "trial_id": "befd4_00000", "date": "2025-01-23_01-36-47", "timestamp": 1737625007, "time_this_iter_s": 188.8010995388031, "time_total_s": 23958.917781591415, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23958.917781591415, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 5.337704918032787, "ram_util_percent": 39.18319672131146, "gpu_util_percent0": 0.0659016393442623, "vram_util_percent0": 0.10029296875000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.07930402227233, "policy_loss": -0.012472945035144846, "vf_loss": 29.46982540228428, "vf_explained_var": 0.10054318494694207, "kl": 0.0, "entropy": 37.80484338828214, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 137222.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800031.577312192, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1440000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800031.577312192}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9637677936502238, "mean_inference_ms": 4.437282776978458, "mean_action_processing_ms": 0.7793963064485455, "mean_env_wait_ms": 105.01891057599839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09374558925628662, "StateBufferConnector_ms": 0.036256611347198486, "ViewRequirementAgentConnector_ms": 0.13778477907180786}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800031.577312192, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 74.15801032849498, "num_env_steps_trained_throughput_per_sec": 74.15801032849498, "timesteps_total": 1368000, "num_env_steps_sampled_lifetime": 1368000, "num_agent_steps_sampled_lifetime": 1368000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1368000, "timers": {"training_iteration_time_ms": 214713.77, "restore_workers_time_ms": 0.0, "training_step_time_ms": 214713.77, "sample_time_ms": 182556.638, "load_time_ms": 12.25, "load_throughput": 979598.014, "learn_time_ms": 32136.633, "learn_throughput": 373.406, "synch_weights_time_ms": 6.951}, "counters": {"num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "done": false, "training_iteration": 114, "trial_id": "befd4_00000", "date": "2025-01-23_01-39-29", "timestamp": 1737625169, "time_this_iter_s": 161.81963562965393, "time_total_s": 24120.73741722107, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24120.73741722107, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 1.991346153846154, "ram_util_percent": 38.92596153846153, "gpu_util_percent0": 0.07548076923076923, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.61953750654525, "policy_loss": 0.00045592168683449626, "vf_loss": 30.0, "vf_explained_var": -0.039474454174562364, "kl": 0.0, "entropy": 38.09184469439157, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 138431.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800031.577312192, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1440000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800031.577312192}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9637677936502238, "mean_inference_ms": 4.437282776978458, "mean_action_processing_ms": 0.7793963064485455, "mean_env_wait_ms": 105.01891057599839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09374558925628662, "StateBufferConnector_ms": 0.036256611347198486, "ViewRequirementAgentConnector_ms": 0.13778477907180786}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800031.577312192, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000, "num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 64.52144414523525, "num_env_steps_trained_throughput_per_sec": 64.52144414523525, "timesteps_total": 1380000, "num_env_steps_sampled_lifetime": 1380000, "num_agent_steps_sampled_lifetime": 1380000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1380000, "timers": {"training_iteration_time_ms": 212811.029, "restore_workers_time_ms": 0.0, "training_step_time_ms": 212811.029, "sample_time_ms": 180607.822, "load_time_ms": 12.25, "load_throughput": 979582.762, "learn_time_ms": 32182.707, "learn_throughput": 372.871, "synch_weights_time_ms": 6.951}, "counters": {"num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "done": false, "training_iteration": 115, "trial_id": "befd4_00000", "date": "2025-01-23_01-42-35", "timestamp": 1737625355, "time_this_iter_s": 185.98768210411072, "time_total_s": 24306.72509932518, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24306.72509932518, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 3.4541666666666666, "ram_util_percent": 39.05458333333333, "gpu_util_percent0": 0.06720833333333334, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.625749843587947, "policy_loss": 0.0036995323964936168, "vf_loss": 30.0, "vf_explained_var": -0.01414320580322354, "kl": 0.0, "entropy": 37.79497007775445, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 139640.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800031.577312192, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1440000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800031.577312192}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9637677936502238, "mean_inference_ms": 4.437282776978458, "mean_action_processing_ms": 0.7793963064485455, "mean_env_wait_ms": 105.01891057599839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09374558925628662, "StateBufferConnector_ms": 0.036256611347198486, "ViewRequirementAgentConnector_ms": 0.13778477907180786}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800031.577312192, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 58.73463434616811, "num_env_steps_trained_throughput_per_sec": 58.73463434616811, "timesteps_total": 1392000, "num_env_steps_sampled_lifetime": 1392000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 211501.594, "restore_workers_time_ms": 0.0, "training_step_time_ms": 211501.594, "sample_time_ms": 179317.868, "load_time_ms": 12.15, "load_throughput": 987652.259, "learn_time_ms": 32163.18, "learn_throughput": 373.097, "synch_weights_time_ms": 6.999}, "counters": {"num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 116, "trial_id": "befd4_00000", "date": "2025-01-23_01-45-59", "timestamp": 1737625559, "time_this_iter_s": 204.31275391578674, "time_total_s": 24511.037853240967, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24511.037853240967, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 7.6574144486692015, "ram_util_percent": 39.1809885931559, "gpu_util_percent0": 0.05920152091254754, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.62641768065043, "policy_loss": 0.003087371661704468, "vf_loss": 30.0, "vf_explained_var": -0.009271403745346763, "kl": 0.0, "entropy": 37.666967398278274, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 140849.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800031.577312192, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1440000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800031.577312192}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9637677936502238, "mean_inference_ms": 4.437282776978458, "mean_action_processing_ms": 0.7793963064485455, "mean_env_wait_ms": 105.01891057599839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09374558925628662, "StateBufferConnector_ms": 0.036256611347198486, "ViewRequirementAgentConnector_ms": 0.13778477907180786}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800031.577312192, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 55.10360486227047, "num_env_steps_trained_throughput_per_sec": 55.10360486227047, "timesteps_total": 1404000, "num_env_steps_sampled_lifetime": 1404000, "num_agent_steps_sampled_lifetime": 1404000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1404000, "timers": {"training_iteration_time_ms": 210767.444, "restore_workers_time_ms": 0.0, "training_step_time_ms": 210767.444, "sample_time_ms": 178594.738, "load_time_ms": 12.15, "load_throughput": 987632.879, "learn_time_ms": 32152.158, "learn_throughput": 373.225, "synch_weights_time_ms": 7.001}, "counters": {"num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "done": false, "training_iteration": 117, "trial_id": "befd4_00000", "date": "2025-01-23_01-49-37", "timestamp": 1737625777, "time_this_iter_s": 217.77460074424744, "time_total_s": 24728.812453985214, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24728.812453985214, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 7.431316725978647, "ram_util_percent": 39.33309608540925, "gpu_util_percent0": 0.05555160142348755, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.62554017880221, "policy_loss": 0.0018527229109315264, "vf_loss": 30.0, "vf_explained_var": -0.004998768628185894, "kl": 0.0, "entropy": 37.63125854725676, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 142058.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800031.577312192, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1440000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800031.577312192}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9637677936502238, "mean_inference_ms": 4.437282776978458, "mean_action_processing_ms": 0.7793963064485455, "mean_env_wait_ms": 105.01891057599839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09374558925628662, "StateBufferConnector_ms": 0.036256611347198486, "ViewRequirementAgentConnector_ms": 0.13778477907180786}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800031.577312192, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000, "num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 53.13383821262717, "num_env_steps_trained_throughput_per_sec": 53.13383821262717, "timesteps_total": 1416000, "num_env_steps_sampled_lifetime": 1416000, "num_agent_steps_sampled_lifetime": 1416000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1416000, "timers": {"training_iteration_time_ms": 210464.7, "restore_workers_time_ms": 0.0, "training_step_time_ms": 210464.7, "sample_time_ms": 178201.351, "load_time_ms": 12.15, "load_throughput": 987683.269, "learn_time_ms": 32242.9, "learn_throughput": 372.175, "synch_weights_time_ms": 7.0}, "counters": {"num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "done": false, "training_iteration": 118, "trial_id": "befd4_00000", "date": "2025-01-23_01-53-23", "timestamp": 1737626003, "time_this_iter_s": 225.84778118133545, "time_total_s": 24954.66023516655, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24954.66023516655, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 7.328178694158075, "ram_util_percent": 39.40378006872852, "gpu_util_percent0": 0.054707903780068734, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.626204967893184, "policy_loss": 0.0027765460571195586, "vf_loss": 30.0, "vf_explained_var": -0.002490256077203995, "kl": 0.0, "entropy": 37.65715996937085, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 143267.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800031.577312192, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1440000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800031.577312192}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9637677936502238, "mean_inference_ms": 4.437282776978458, "mean_action_processing_ms": 0.7793963064485455, "mean_env_wait_ms": 105.01891057599839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09374558925628662, "StateBufferConnector_ms": 0.036256611347198486, "ViewRequirementAgentConnector_ms": 0.13778477907180786}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800031.577312192, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000, "num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.440745291642344, "num_env_steps_trained_throughput_per_sec": 52.440745291642344, "timesteps_total": 1428000, "num_env_steps_sampled_lifetime": 1428000, "num_agent_steps_sampled_lifetime": 1428000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1428000, "timers": {"training_iteration_time_ms": 210403.945, "restore_workers_time_ms": 0.0, "training_step_time_ms": 210403.945, "sample_time_ms": 178201.019, "load_time_ms": 12.15, "load_throughput": 987673.578, "learn_time_ms": 32181.678, "learn_throughput": 372.883, "synch_weights_time_ms": 7.699}, "counters": {"num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "done": false, "training_iteration": 119, "trial_id": "befd4_00000", "date": "2025-01-23_01-57-12", "timestamp": 1737626232, "time_this_iter_s": 228.83269786834717, "time_total_s": 25183.492933034897, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25183.492933034897, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 7.332542372881355, "ram_util_percent": 39.49593220338983, "gpu_util_percent0": 0.05233898305084746, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.625395185598368, "policy_loss": 0.002556777177910059, "vf_loss": 30.0, "vf_explained_var": 2.018837419987908e-05, "kl": 0.0, "entropy": 37.71615550101937, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 144476.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800031.577312192, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1440000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800031.577312192}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9637677936502238, "mean_inference_ms": 4.437282776978458, "mean_action_processing_ms": 0.7793963064485455, "mean_env_wait_ms": 105.01891057599839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09374558925628662, "StateBufferConnector_ms": 0.036256611347198486, "ViewRequirementAgentConnector_ms": 0.13778477907180786}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800031.577312192, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.3164558062905, "num_env_steps_trained_throughput_per_sec": 52.3164558062905, "timesteps_total": 1440000, "num_env_steps_sampled_lifetime": 1440000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 210272.179, "restore_workers_time_ms": 0.0, "training_step_time_ms": 210272.179, "sample_time_ms": 178111.805, "load_time_ms": 12.299, "load_throughput": 975710.735, "learn_time_ms": 32138.976, "learn_throughput": 373.378, "synch_weights_time_ms": 7.699}, "counters": {"num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 120, "trial_id": "befd4_00000", "date": "2025-01-23_02-01-01", "timestamp": 1737626461, "time_this_iter_s": 229.37633085250854, "time_total_s": 25412.869263887405, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25412.869263887405, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 7.302033898305084, "ram_util_percent": 39.51118644067796, "gpu_util_percent0": 0.053796610169491534, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.624977231715906, "policy_loss": 0.0029880821741840088, "vf_loss": 30.0, "vf_explained_var": -0.0010620373354360425, "kl": 0.0, "entropy": 37.80108434016099, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 145685.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800031.577312192, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1440000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800031.577312192}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9637677936502238, "mean_inference_ms": 4.437282776978458, "mean_action_processing_ms": 0.7793963064485455, "mean_env_wait_ms": 105.01891057599839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09374558925628662, "StateBufferConnector_ms": 0.036256611347198486, "ViewRequirementAgentConnector_ms": 0.13778477907180786}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800031.577312192, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000, "num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.1542610563465, "num_env_steps_trained_throughput_per_sec": 52.1542610563465, "timesteps_total": 1452000, "num_env_steps_sampled_lifetime": 1452000, "num_agent_steps_sampled_lifetime": 1452000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1452000, "timers": {"training_iteration_time_ms": 210233.749, "restore_workers_time_ms": 0.0, "training_step_time_ms": 210233.749, "sample_time_ms": 178130.258, "load_time_ms": 12.299, "load_throughput": 975686.147, "learn_time_ms": 32082.092, "learn_throughput": 374.04, "synch_weights_time_ms": 7.7}, "counters": {"num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "done": false, "training_iteration": 121, "trial_id": "befd4_00000", "date": "2025-01-23_02-04-51", "timestamp": 1737626691, "time_this_iter_s": 230.0896623134613, "time_total_s": 25642.958926200867, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25642.958926200867, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 7.298653198653198, "ram_util_percent": 39.51313131313132, "gpu_util_percent0": 0.05252525252525253, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.62556281929868, "policy_loss": 0.0019304583617928996, "vf_loss": 30.0, "vf_explained_var": 0.00011888942608072109, "kl": 0.0, "entropy": 37.636764550031565, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 146894.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800031.577312192, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1440000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800031.577312192}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9637677936502238, "mean_inference_ms": 4.437282776978458, "mean_action_processing_ms": 0.7793963064485455, "mean_env_wait_ms": 105.01891057599839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09374558925628662, "StateBufferConnector_ms": 0.036256611347198486, "ViewRequirementAgentConnector_ms": 0.13778477907180786}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800031.577312192, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000, "num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 51.980452622966986, "num_env_steps_trained_throughput_per_sec": 51.980452622966986, "timesteps_total": 1464000, "num_env_steps_sampled_lifetime": 1464000, "num_agent_steps_sampled_lifetime": 1464000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1464000, "timers": {"training_iteration_time_ms": 210366.926, "restore_workers_time_ms": 0.0, "training_step_time_ms": 210366.926, "sample_time_ms": 178262.657, "load_time_ms": 12.25, "load_throughput": 979571.323, "learn_time_ms": 32082.917, "learn_throughput": 374.031, "synch_weights_time_ms": 7.701}, "counters": {"num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "done": false, "training_iteration": 122, "trial_id": "befd4_00000", "date": "2025-01-23_02-08-42", "timestamp": 1737626922, "time_this_iter_s": 230.8590066432953, "time_total_s": 25873.817932844162, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25873.817932844162, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 7.302356902356902, "ram_util_percent": 39.51178451178451, "gpu_util_percent0": 0.05228956228956229, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.624977441540032, "policy_loss": 0.0012192225362566307, "vf_loss": 30.0, "vf_explained_var": -0.00029161081913584415, "kl": 0.0, "entropy": 37.624180852923146, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 148103.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "env_runners": {"episode_reward_max": -788359.327673963, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -800031.577312192, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1440000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -788359.327673963}, "policy_reward_mean": {"default_policy": -800031.577312192}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9637677936502238, "mean_inference_ms": 4.437282776978458, "mean_action_processing_ms": 0.7793963064485455, "mean_env_wait_ms": 105.01891057599839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09374558925628662, "StateBufferConnector_ms": 0.036256611347198486, "ViewRequirementAgentConnector_ms": 0.13778477907180786}, "num_episodes": 0, "episode_return_max": -788359.327673963, "episode_return_min": -804649.9336273633, "episode_return_mean": -800031.577312192, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 51.867621991844565, "num_env_steps_trained_throughput_per_sec": 51.867621991844565, "timesteps_total": 1476000, "num_env_steps_sampled_lifetime": 1476000, "num_agent_steps_sampled_lifetime": 1476000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1476000, "timers": {"training_iteration_time_ms": 214623.037, "restore_workers_time_ms": 0.0, "training_step_time_ms": 214623.037, "sample_time_ms": 182500.908, "load_time_ms": 12.15, "load_throughput": 987650.321, "learn_time_ms": 32100.879, "learn_throughput": 373.822, "synch_weights_time_ms": 7.7}, "counters": {"num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "done": false, "training_iteration": 123, "trial_id": "befd4_00000", "date": "2025-01-23_02-12-34", "timestamp": 1737627154, "time_this_iter_s": 231.3612072467804, "time_total_s": 26105.179140090942, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 26105.179140090942, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 7.696979865771811, "ram_util_percent": 39.56342281879195, "gpu_util_percent0": 0.05389261744966443, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.649923461838338, "policy_loss": 0.003279368772893232, "vf_loss": 29.988312908201003, "vf_explained_var": -0.03906204889784971, "kl": 0.0, "entropy": 34.16688153445967, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 149312.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": -785485.9750667393, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -799701.810653465, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1584000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -785485.9750667393}, "policy_reward_mean": {"default_policy": -799701.810653465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.963782455319162, "mean_inference_ms": 4.435925639146077, "mean_action_processing_ms": 0.7791949932838914, "mean_env_wait_ms": 105.0457315919724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09431432593952525, "StateBufferConnector_ms": 0.03296055577018044, "ViewRequirementAgentConnector_ms": 0.13661980628967285}, "num_episodes": 8, "episode_return_max": -785485.9750667393, "episode_return_min": -804649.9336273633, "episode_return_mean": -799701.810653465, "episodes_this_iter": 8}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 56.8686409540816, "num_env_steps_trained_throughput_per_sec": 56.8686409540816, "timesteps_total": 1488000, "num_env_steps_sampled_lifetime": 1488000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 219542.633, "restore_workers_time_ms": 0.0, "training_step_time_ms": 219542.633, "sample_time_ms": 187369.764, "load_time_ms": 12.15, "load_throughput": 987654.197, "learn_time_ms": 32151.521, "learn_throughput": 373.233, "synch_weights_time_ms": 7.799}, "counters": {"num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 124, "trial_id": "befd4_00000", "date": "2025-01-23_02-16-05", "timestamp": 1737627365, "time_this_iter_s": 211.0166027545929, "time_total_s": 26316.195742845535, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 26316.195742845535, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 6.69264705882353, "ram_util_percent": 39.369852941176475, "gpu_util_percent0": 0.05889705882352941, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.317815496667148, "policy_loss": -0.031205988999046353, "vf_loss": 29.67912442197082, "vf_explained_var": -0.017708339900197424, "kl": 0.0, "entropy": 33.0102977342503, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 150521.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "env_runners": {"episode_reward_max": -785485.9750667393, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -799701.810653465, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1584000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -785485.9750667393}, "policy_reward_mean": {"default_policy": -799701.810653465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.963782455319162, "mean_inference_ms": 4.435925639146077, "mean_action_processing_ms": 0.7791949932838914, "mean_env_wait_ms": 105.0457315919724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09431432593952525, "StateBufferConnector_ms": 0.03296055577018044, "ViewRequirementAgentConnector_ms": 0.13661980628967285}, "num_episodes": 0, "episode_return_max": -785485.9750667393, "episode_return_min": -804649.9336273633, "episode_return_mean": -799701.810653465, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000, "num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 76.7031318656999, "num_env_steps_trained_throughput_per_sec": 76.7031318656999, "timesteps_total": 1500000, "num_env_steps_sampled_lifetime": 1500000, "num_agent_steps_sampled_lifetime": 1500000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1500000, "timers": {"training_iteration_time_ms": 216588.898, "restore_workers_time_ms": 0.1, "training_step_time_ms": 216588.798, "sample_time_ms": 184433.037, "load_time_ms": 12.15, "load_throughput": 987667.764, "learn_time_ms": 32134.413, "learn_throughput": 373.431, "synch_weights_time_ms": 7.798}, "counters": {"num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "done": false, "training_iteration": 125, "trial_id": "befd4_00000", "date": "2025-01-23_02-18-41", "timestamp": 1737627521, "time_this_iter_s": 156.451327085495, "time_total_s": 26472.64706993103, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 26472.64706993103, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 2.6485148514851486, "ram_util_percent": 38.93861386138614, "gpu_util_percent0": 0.0785148514851485, "vram_util_percent0": 0.10029296875000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.6272822838366, "policy_loss": -0.00038604877081856046, "vf_loss": 30.0, "vf_explained_var": -0.04268726536417126, "kl": 0.0, "entropy": 37.23316443469329, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 151730.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "env_runners": {"episode_reward_max": -785485.9750667393, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -799701.810653465, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1584000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -785485.9750667393}, "policy_reward_mean": {"default_policy": -799701.810653465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.963782455319162, "mean_inference_ms": 4.435925639146077, "mean_action_processing_ms": 0.7791949932838914, "mean_env_wait_ms": 105.0457315919724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09431432593952525, "StateBufferConnector_ms": 0.03296055577018044, "ViewRequirementAgentConnector_ms": 0.13661980628967285}, "num_episodes": 0, "episode_return_max": -785485.9750667393, "episode_return_min": -804649.9336273633, "episode_return_mean": -799701.810653465, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000, "num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 66.9752004315952, "num_env_steps_trained_throughput_per_sec": 66.9752004315952, "timesteps_total": 1512000, "num_env_steps_sampled_lifetime": 1512000, "num_agent_steps_sampled_lifetime": 1512000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1512000, "timers": {"training_iteration_time_ms": 214075.102, "restore_workers_time_ms": 0.1, "training_step_time_ms": 214075.002, "sample_time_ms": 181955.424, "load_time_ms": 12.15, "load_throughput": 987665.825, "learn_time_ms": 32098.331, "learn_throughput": 373.851, "synch_weights_time_ms": 7.698}, "counters": {"num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "done": false, "training_iteration": 126, "trial_id": "befd4_00000", "date": "2025-01-23_02-21-40", "timestamp": 1737627700, "time_this_iter_s": 179.17379450798035, "time_total_s": 26651.82086443901, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 26651.82086443901, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 2.7502164502164503, "ram_util_percent": 39.06406926406928, "gpu_util_percent0": 0.06744588744588745, "vram_util_percent0": 0.10029296875000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.642409248131184, "policy_loss": 0.003052228185093235, "vf_loss": 30.0, "vf_explained_var": -0.0262545677035973, "kl": 0.0, "entropy": 36.06429809967874, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 152939.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1524000, "num_env_steps_trained": 1524000, "num_agent_steps_sampled": 1524000, "num_agent_steps_trained": 1524000}, "env_runners": {"episode_reward_max": -785485.9750667393, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -799701.810653465, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1584000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -785485.9750667393}, "policy_reward_mean": {"default_policy": -799701.810653465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.963782455319162, "mean_inference_ms": 4.435925639146077, "mean_action_processing_ms": 0.7791949932838914, "mean_env_wait_ms": 105.0457315919724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09431432593952525, "StateBufferConnector_ms": 0.03296055577018044, "ViewRequirementAgentConnector_ms": 0.13661980628967285}, "num_episodes": 0, "episode_return_max": -785485.9750667393, "episode_return_min": -804649.9336273633, "episode_return_mean": -799701.810653465, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1524000, "num_agent_steps_trained": 1524000, "num_env_steps_sampled": 1524000, "num_env_steps_trained": 1524000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 60.69649410186931, "num_env_steps_trained_throughput_per_sec": 60.69649410186931, "timesteps_total": 1524000, "num_env_steps_sampled_lifetime": 1524000, "num_agent_steps_sampled_lifetime": 1524000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1524000, "timers": {"training_iteration_time_ms": 212068.442, "restore_workers_time_ms": 0.1, "training_step_time_ms": 212068.342, "sample_time_ms": 179984.034, "load_time_ms": 12.15, "load_throughput": 987687.145, "learn_time_ms": 32063.062, "learn_throughput": 374.262, "synch_weights_time_ms": 7.696}, "counters": {"num_env_steps_sampled": 1524000, "num_env_steps_trained": 1524000, "num_agent_steps_sampled": 1524000, "num_agent_steps_trained": 1524000}, "done": false, "training_iteration": 127, "trial_id": "befd4_00000", "date": "2025-01-23_02-24-58", "timestamp": 1737627898, "time_this_iter_s": 197.7080054283142, "time_total_s": 26849.528869867325, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 26849.528869867325, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 7.732156862745099, "ram_util_percent": 39.16941176470588, "gpu_util_percent0": 0.06129411764705883, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.6443059288637, "policy_loss": 0.003459447910092506, "vf_loss": 30.0, "vf_explained_var": -0.011848712381594826, "kl": 0.0, "entropy": 35.91535149062341, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 154148.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1536000, "num_env_steps_trained": 1536000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": -785485.9750667393, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -799701.810653465, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1584000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -785485.9750667393}, "policy_reward_mean": {"default_policy": -799701.810653465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.963782455319162, "mean_inference_ms": 4.435925639146077, "mean_action_processing_ms": 0.7791949932838914, "mean_env_wait_ms": 105.0457315919724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09431432593952525, "StateBufferConnector_ms": 0.03296055577018044, "ViewRequirementAgentConnector_ms": 0.13661980628967285}, "num_episodes": 0, "episode_return_max": -785485.9750667393, "episode_return_min": -804649.9336273633, "episode_return_mean": -799701.810653465, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 1536000, "num_env_steps_trained": 1536000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 56.31573351489597, "num_env_steps_trained_throughput_per_sec": 56.31573351489597, "timesteps_total": 1536000, "num_env_steps_sampled_lifetime": 1536000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 210792.397, "restore_workers_time_ms": 0.1, "training_step_time_ms": 210792.297, "sample_time_ms": 178818.281, "load_time_ms": 12.15, "load_throughput": 987661.949, "learn_time_ms": 31952.769, "learn_throughput": 375.554, "synch_weights_time_ms": 7.697}, "counters": {"num_env_steps_sampled": 1536000, "num_env_steps_trained": 1536000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 128, "trial_id": "befd4_00000", "date": "2025-01-23_02-28-31", "timestamp": 1737628111, "time_this_iter_s": 213.0883207321167, "time_total_s": 27062.61719059944, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 27062.61719059944, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 7.986181818181818, "ram_util_percent": 39.29781818181819, "gpu_util_percent0": 0.057272727272727274, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.6446042751063, "policy_loss": 0.0033246040516791016, "vf_loss": 30.0, "vf_explained_var": -0.008283049583040653, "kl": 0.0, "entropy": 35.87203114795921, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 155357.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1548000, "num_env_steps_trained": 1548000, "num_agent_steps_sampled": 1548000, "num_agent_steps_trained": 1548000}, "env_runners": {"episode_reward_max": -785485.9750667393, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -799701.810653465, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1584000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -785485.9750667393}, "policy_reward_mean": {"default_policy": -799701.810653465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.963782455319162, "mean_inference_ms": 4.435925639146077, "mean_action_processing_ms": 0.7791949932838914, "mean_env_wait_ms": 105.0457315919724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09431432593952525, "StateBufferConnector_ms": 0.03296055577018044, "ViewRequirementAgentConnector_ms": 0.13661980628967285}, "num_episodes": 0, "episode_return_max": -785485.9750667393, "episode_return_min": -804649.9336273633, "episode_return_mean": -799701.810653465, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1548000, "num_agent_steps_trained": 1548000, "num_env_steps_sampled": 1548000, "num_env_steps_trained": 1548000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 53.806014429650595, "num_env_steps_trained_throughput_per_sec": 53.806014429650595, "timesteps_total": 1548000, "num_env_steps_sampled_lifetime": 1548000, "num_agent_steps_sampled_lifetime": 1548000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1548000, "timers": {"training_iteration_time_ms": 210211.766, "restore_workers_time_ms": 0.1, "training_step_time_ms": 210211.666, "sample_time_ms": 178162.996, "load_time_ms": 12.15, "load_throughput": 987671.64, "learn_time_ms": 32028.224, "learn_throughput": 374.67, "synch_weights_time_ms": 6.996}, "counters": {"num_env_steps_sampled": 1548000, "num_env_steps_trained": 1548000, "num_agent_steps_sampled": 1548000, "num_agent_steps_trained": 1548000}, "done": false, "training_iteration": 129, "trial_id": "befd4_00000", "date": "2025-01-23_02-32-14", "timestamp": 1737628334, "time_this_iter_s": 223.02738690376282, "time_total_s": 27285.644577503204, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 27285.644577503204, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 7.753310104529616, "ram_util_percent": 39.437282229965156, "gpu_util_percent0": 0.05439024390243903, "vram_util_percent0": 0.10029296875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.643428744118108, "policy_loss": 0.0012971643478639663, "vf_loss": 30.0, "vf_explained_var": -0.005716543290317305, "kl": 0.0, "entropy": 35.78684541151679, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 156566.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1560000, "num_env_steps_trained": 1560000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "env_runners": {"episode_reward_max": -785485.9750667393, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -799701.810653465, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1584000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -785485.9750667393}, "policy_reward_mean": {"default_policy": -799701.810653465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.963782455319162, "mean_inference_ms": 4.435925639146077, "mean_action_processing_ms": 0.7791949932838914, "mean_env_wait_ms": 105.0457315919724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09431432593952525, "StateBufferConnector_ms": 0.03296055577018044, "ViewRequirementAgentConnector_ms": 0.13661980628967285}, "num_episodes": 0, "episode_return_max": -785485.9750667393, "episode_return_min": -804649.9336273633, "episode_return_mean": -799701.810653465, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000, "num_env_steps_sampled": 1560000, "num_env_steps_trained": 1560000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.41105105215603, "num_env_steps_trained_throughput_per_sec": 52.41105105215603, "timesteps_total": 1560000, "num_env_steps_sampled_lifetime": 1560000, "num_agent_steps_sampled_lifetime": 1560000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1560000, "timers": {"training_iteration_time_ms": 210170.367, "restore_workers_time_ms": 0.1, "training_step_time_ms": 210170.267, "sample_time_ms": 178150.131, "load_time_ms": 12.15, "load_throughput": 987658.073, "learn_time_ms": 31999.792, "learn_throughput": 375.002, "synch_weights_time_ms": 6.996}, "counters": {"num_env_steps_sampled": 1560000, "num_env_steps_trained": 1560000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "done": false, "training_iteration": 130, "trial_id": "befd4_00000", "date": "2025-01-23_02-36-03", "timestamp": 1737628563, "time_this_iter_s": 228.96234583854675, "time_total_s": 27514.60692334175, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 27514.60692334175, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 7.6661016949152545, "ram_util_percent": 39.5135593220339, "gpu_util_percent0": 0.0512542372881356, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.642715608708812, "policy_loss": 0.0010762857974216502, "vf_loss": 30.0, "vf_explained_var": -0.0024219842564477912, "kl": 0.0, "entropy": 35.83606704667741, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 157775.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1572000, "num_env_steps_trained": 1572000, "num_agent_steps_sampled": 1572000, "num_agent_steps_trained": 1572000}, "env_runners": {"episode_reward_max": -785485.9750667393, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -799701.810653465, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1584000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -785485.9750667393}, "policy_reward_mean": {"default_policy": -799701.810653465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.963782455319162, "mean_inference_ms": 4.435925639146077, "mean_action_processing_ms": 0.7791949932838914, "mean_env_wait_ms": 105.0457315919724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09431432593952525, "StateBufferConnector_ms": 0.03296055577018044, "ViewRequirementAgentConnector_ms": 0.13661980628967285}, "num_episodes": 0, "episode_return_max": -785485.9750667393, "episode_return_min": -804649.9336273633, "episode_return_mean": -799701.810653465, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1572000, "num_agent_steps_trained": 1572000, "num_env_steps_sampled": 1572000, "num_env_steps_trained": 1572000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 51.93167382823098, "num_env_steps_trained_throughput_per_sec": 51.93167382823098, "timesteps_total": 1572000, "num_env_steps_sampled_lifetime": 1572000, "num_agent_steps_sampled_lifetime": 1572000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1572000, "timers": {"training_iteration_time_ms": 210268.986, "restore_workers_time_ms": 0.1, "training_step_time_ms": 210268.886, "sample_time_ms": 178219.193, "load_time_ms": 12.15, "load_throughput": 987667.764, "learn_time_ms": 32029.35, "learn_throughput": 374.656, "synch_weights_time_ms": 7.094}, "counters": {"num_env_steps_sampled": 1572000, "num_env_steps_trained": 1572000, "num_agent_steps_sampled": 1572000, "num_agent_steps_trained": 1572000}, "done": false, "training_iteration": 131, "trial_id": "befd4_00000", "date": "2025-01-23_02-39-54", "timestamp": 1737628794, "time_this_iter_s": 231.07685160636902, "time_total_s": 27745.68377494812, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 27745.68377494812, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 7.647651006711409, "ram_util_percent": 39.553355704697985, "gpu_util_percent0": 0.05406040268456375, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.6437621798961, "policy_loss": 0.002451149406292105, "vf_loss": 30.0, "vf_explained_var": -0.0025391112781931687, "kl": 0.0, "entropy": 35.86889947081914, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 158984.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1584000, "num_env_steps_trained": 1584000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": -785485.9750667393, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -799701.810653465, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1584000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -785485.9750667393}, "policy_reward_mean": {"default_policy": -799701.810653465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.963782455319162, "mean_inference_ms": 4.435925639146077, "mean_action_processing_ms": 0.7791949932838914, "mean_env_wait_ms": 105.0457315919724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09431432593952525, "StateBufferConnector_ms": 0.03296055577018044, "ViewRequirementAgentConnector_ms": 0.13661980628967285}, "num_episodes": 0, "episode_return_max": -785485.9750667393, "episode_return_min": -804649.9336273633, "episode_return_mean": -799701.810653465, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 1584000, "num_env_steps_trained": 1584000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.352291760950536, "num_env_steps_trained_throughput_per_sec": 52.352291760950536, "timesteps_total": 1584000, "num_env_steps_sampled_lifetime": 1584000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 210105.017, "restore_workers_time_ms": 0.2, "training_step_time_ms": 210104.817, "sample_time_ms": 178085.351, "load_time_ms": 12.399, "load_throughput": 967849.303, "learn_time_ms": 31998.876, "learn_throughput": 375.013, "synch_weights_time_ms": 7.093}, "counters": {"num_env_steps_sampled": 1584000, "num_env_steps_trained": 1584000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 132, "trial_id": "befd4_00000", "date": "2025-01-23_02-43-44", "timestamp": 1737629024, "time_this_iter_s": 229.2193262577057, "time_total_s": 27974.903101205826, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 27974.903101205826, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 7.675593220338984, "ram_util_percent": 39.54983050847458, "gpu_util_percent0": 0.051661016949152545, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.643952250579254, "policy_loss": 0.0019005340846783864, "vf_loss": 30.0, "vf_explained_var": -0.0009848768302879618, "kl": 0.0, "entropy": 35.79482791007699, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 160193.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1596000, "num_env_steps_trained": 1596000, "num_agent_steps_sampled": 1596000, "num_agent_steps_trained": 1596000}, "env_runners": {"episode_reward_max": -785485.9750667393, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -799701.810653465, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1584000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -785485.9750667393}, "policy_reward_mean": {"default_policy": -799701.810653465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.963782455319162, "mean_inference_ms": 4.435925639146077, "mean_action_processing_ms": 0.7791949932838914, "mean_env_wait_ms": 105.0457315919724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09431432593952525, "StateBufferConnector_ms": 0.03296055577018044, "ViewRequirementAgentConnector_ms": 0.13661980628967285}, "num_episodes": 0, "episode_return_max": -785485.9750667393, "episode_return_min": -804649.9336273633, "episode_return_mean": -799701.810653465, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1596000, "num_agent_steps_trained": 1596000, "num_env_steps_sampled": 1596000, "num_env_steps_trained": 1596000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.321697594028564, "num_env_steps_trained_throughput_per_sec": 52.321697594028564, "timesteps_total": 1596000, "num_env_steps_sampled_lifetime": 1596000, "num_agent_steps_sampled_lifetime": 1596000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1596000, "timers": {"training_iteration_time_ms": 209904.232, "restore_workers_time_ms": 0.2, "training_step_time_ms": 209904.032, "sample_time_ms": 177853.825, "load_time_ms": 12.399, "load_throughput": 967838.136, "learn_time_ms": 32029.715, "learn_throughput": 374.652, "synch_weights_time_ms": 7.194}, "counters": {"num_env_steps_sampled": 1596000, "num_env_steps_trained": 1596000, "num_agent_steps_sampled": 1596000, "num_agent_steps_trained": 1596000}, "done": false, "training_iteration": 133, "trial_id": "befd4_00000", "date": "2025-01-23_02-47-33", "timestamp": 1737629253, "time_this_iter_s": 229.35435342788696, "time_total_s": 28204.257454633713, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28204.257454633713, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 7.727702702702703, "ram_util_percent": 39.57804054054054, "gpu_util_percent0": 0.05469594594594595, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.643348943112407, "policy_loss": 0.0025124410929957927, "vf_loss": 30.0, "vf_explained_var": -0.0008280056877704176, "kl": 0.0, "entropy": 35.91634961136912, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 161402.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1608000, "num_env_steps_trained": 1608000, "num_agent_steps_sampled": 1608000, "num_agent_steps_trained": 1608000}, "env_runners": {"episode_reward_max": -785485.9750667393, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -799701.810653465, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1584000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -785485.9750667393}, "policy_reward_mean": {"default_policy": -799701.810653465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.963782455319162, "mean_inference_ms": 4.435925639146077, "mean_action_processing_ms": 0.7791949932838914, "mean_env_wait_ms": 105.0457315919724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09431432593952525, "StateBufferConnector_ms": 0.03296055577018044, "ViewRequirementAgentConnector_ms": 0.13661980628967285}, "num_episodes": 0, "episode_return_max": -785485.9750667393, "episode_return_min": -804649.9336273633, "episode_return_mean": -799701.810653465, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1608000, "num_agent_steps_trained": 1608000, "num_env_steps_sampled": 1608000, "num_env_steps_trained": 1608000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.298092901771646, "num_env_steps_trained_throughput_per_sec": 52.298092901771646, "timesteps_total": 1608000, "num_env_steps_sampled_lifetime": 1608000, "num_agent_steps_sampled_lifetime": 1608000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1608000, "timers": {"training_iteration_time_ms": 211748.359, "restore_workers_time_ms": 0.2, "training_step_time_ms": 211748.159, "sample_time_ms": 179733.237, "load_time_ms": 12.399, "load_throughput": 967836.275, "learn_time_ms": 31994.429, "learn_throughput": 375.065, "synch_weights_time_ms": 7.194}, "counters": {"num_env_steps_sampled": 1608000, "num_env_steps_trained": 1608000, "num_agent_steps_sampled": 1608000, "num_agent_steps_trained": 1608000}, "done": false, "training_iteration": 134, "trial_id": "befd4_00000", "date": "2025-01-23_02-51-23", "timestamp": 1737629483, "time_this_iter_s": 229.4578733444214, "time_total_s": 28433.715327978134, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28433.715327978134, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 7.7304054054054046, "ram_util_percent": 39.57804054054054, "gpu_util_percent0": 0.053614864864864865, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.644040182664238, "policy_loss": 0.003812331117757398, "vf_loss": 30.0, "vf_explained_var": 0.00044932628683653423, "kl": 0.0, "entropy": 35.977219495623444, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 162611.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1620000, "num_env_steps_trained": 1620000, "num_agent_steps_sampled": 1620000, "num_agent_steps_trained": 1620000}, "env_runners": {"episode_reward_max": -785485.9750667393, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -799547.3686478869, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1728000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -785485.9750667393}, "policy_reward_mean": {"default_policy": -799547.3686478869}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9638217248608898, "mean_inference_ms": 4.434676129219796, "mean_action_processing_ms": 0.7790079436275165, "mean_env_wait_ms": 105.074925511343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09270732601483662, "StateBufferConnector_ms": 0.032288829485575356, "ViewRequirementAgentConnector_ms": 0.13251950343449911}, "num_episodes": 8, "episode_return_max": -785485.9750667393, "episode_return_min": -804649.9336273633, "episode_return_mean": -799547.3686478869, "episodes_this_iter": 8}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1620000, "num_agent_steps_trained": 1620000, "num_env_steps_sampled": 1620000, "num_env_steps_trained": 1620000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.04843464804722, "num_env_steps_trained_throughput_per_sec": 52.04843464804722, "timesteps_total": 1620000, "num_env_steps_sampled_lifetime": 1620000, "num_agent_steps_sampled_lifetime": 1620000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1620000, "timers": {"training_iteration_time_ms": 219159.075, "restore_workers_time_ms": 0.1, "training_step_time_ms": 219158.975, "sample_time_ms": 187180.609, "load_time_ms": 12.499, "load_throughput": 960098.887, "learn_time_ms": 31957.674, "learn_throughput": 375.497, "synch_weights_time_ms": 7.293}, "counters": {"num_env_steps_sampled": 1620000, "num_env_steps_trained": 1620000, "num_agent_steps_sampled": 1620000, "num_agent_steps_trained": 1620000}, "done": false, "training_iteration": 135, "trial_id": "befd4_00000", "date": "2025-01-23_02-55-13", "timestamp": 1737629713, "time_this_iter_s": 230.5574815273285, "time_total_s": 28664.272809505463, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28664.272809505463, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 7.624579124579125, "ram_util_percent": 39.429966329966334, "gpu_util_percent0": 0.05262626262626263, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.139064078887106, "policy_loss": -0.034121787891167814, "vf_loss": 29.441801702216996, "vf_explained_var": -0.019622703343999594, "kl": 0.0, "entropy": 26.861588245388692, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 163820.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1632000, "num_env_steps_trained": 1632000, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000}, "env_runners": {"episode_reward_max": -785485.9750667393, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -799547.3686478869, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1728000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -785485.9750667393}, "policy_reward_mean": {"default_policy": -799547.3686478869}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9638217248608898, "mean_inference_ms": 4.434676129219796, "mean_action_processing_ms": 0.7790079436275165, "mean_env_wait_ms": 105.074925511343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09270732601483662, "StateBufferConnector_ms": 0.032288829485575356, "ViewRequirementAgentConnector_ms": 0.13251950343449911}, "num_episodes": 0, "episode_return_max": -785485.9750667393, "episode_return_min": -804649.9336273633, "episode_return_mean": -799547.3686478869, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000, "num_env_steps_sampled": 1632000, "num_env_steps_trained": 1632000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 79.51340916167074, "num_env_steps_trained_throughput_per_sec": 79.51340916167074, "timesteps_total": 1632000, "num_env_steps_sampled_lifetime": 1632000, "num_agent_steps_sampled_lifetime": 1632000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1632000, "timers": {"training_iteration_time_ms": 216333.789, "restore_workers_time_ms": 0.1, "training_step_time_ms": 216333.689, "sample_time_ms": 184368.077, "load_time_ms": 12.55, "load_throughput": 956166.493, "learn_time_ms": 31944.869, "learn_throughput": 375.647, "synch_weights_time_ms": 7.292}, "counters": {"num_env_steps_sampled": 1632000, "num_env_steps_trained": 1632000, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000}, "done": false, "training_iteration": 136, "trial_id": "befd4_00000", "date": "2025-01-23_02-57-44", "timestamp": 1737629864, "time_this_iter_s": 150.92093896865845, "time_total_s": 28815.19374847412, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28815.19374847412, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 2.6304123711340206, "ram_util_percent": 38.89432989690721, "gpu_util_percent0": 0.0793298969072165, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.583674045117853, "policy_loss": -0.004099217785030875, "vf_loss": 30.0, "vf_explained_var": -0.10624262584547449, "kl": 0.0, "entropy": 41.22267375532707, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 165029.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1644000, "num_env_steps_trained": 1644000, "num_agent_steps_sampled": 1644000, "num_agent_steps_trained": 1644000}, "env_runners": {"episode_reward_max": -785485.9750667393, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -799547.3686478869, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1728000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -785485.9750667393}, "policy_reward_mean": {"default_policy": -799547.3686478869}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9638217248608898, "mean_inference_ms": 4.434676129219796, "mean_action_processing_ms": 0.7790079436275165, "mean_env_wait_ms": 105.074925511343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09270732601483662, "StateBufferConnector_ms": 0.032288829485575356, "ViewRequirementAgentConnector_ms": 0.13251950343449911}, "num_episodes": 0, "episode_return_max": -785485.9750667393, "episode_return_min": -804649.9336273633, "episode_return_mean": -799547.3686478869, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1644000, "num_agent_steps_trained": 1644000, "num_env_steps_sampled": 1644000, "num_env_steps_trained": 1644000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 69.10570124841726, "num_env_steps_trained_throughput_per_sec": 69.10570124841726, "timesteps_total": 1644000, "num_env_steps_sampled_lifetime": 1644000, "num_agent_steps_sampled_lifetime": 1644000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1644000, "timers": {"training_iteration_time_ms": 213927.993, "restore_workers_time_ms": 0.1, "training_step_time_ms": 213927.893, "sample_time_ms": 181942.373, "load_time_ms": 12.65, "load_throughput": 948622.78, "learn_time_ms": 31964.675, "learn_throughput": 375.414, "synch_weights_time_ms": 7.293}, "counters": {"num_env_steps_sampled": 1644000, "num_env_steps_trained": 1644000, "num_agent_steps_sampled": 1644000, "num_agent_steps_trained": 1644000}, "done": false, "training_iteration": 137, "trial_id": "befd4_00000", "date": "2025-01-23_03-00-38", "timestamp": 1737630038, "time_this_iter_s": 173.65103268623352, "time_total_s": 28988.844781160355, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28988.844781160355, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 2.585267857142857, "ram_util_percent": 39.00892857142857, "gpu_util_percent0": 0.07049107142857142, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.59773782425621, "policy_loss": 0.003222709936085962, "vf_loss": 30.0, "vf_explained_var": -0.0656630807518466, "kl": 0.0, "entropy": 40.54848853806211, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 166238.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1656000, "num_env_steps_trained": 1656000, "num_agent_steps_sampled": 1656000, "num_agent_steps_trained": 1656000}, "env_runners": {"episode_reward_max": -785485.9750667393, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -799547.3686478869, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1728000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -785485.9750667393}, "policy_reward_mean": {"default_policy": -799547.3686478869}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9638217248608898, "mean_inference_ms": 4.434676129219796, "mean_action_processing_ms": 0.7790079436275165, "mean_env_wait_ms": 105.074925511343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09270732601483662, "StateBufferConnector_ms": 0.032288829485575356, "ViewRequirementAgentConnector_ms": 0.13251950343449911}, "num_episodes": 0, "episode_return_max": -785485.9750667393, "episode_return_min": -804649.9336273633, "episode_return_mean": -799547.3686478869, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1656000, "num_agent_steps_trained": 1656000, "num_env_steps_sampled": 1656000, "num_env_steps_trained": 1656000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 61.23027293602072, "num_env_steps_trained_throughput_per_sec": 61.23027293602072, "timesteps_total": 1656000, "num_env_steps_sampled_lifetime": 1656000, "num_agent_steps_sampled_lifetime": 1656000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1656000, "timers": {"training_iteration_time_ms": 212217.71, "restore_workers_time_ms": 0.1, "training_step_time_ms": 212217.61, "sample_time_ms": 180135.289, "load_time_ms": 12.65, "load_throughput": 948603.113, "learn_time_ms": 32061.477, "learn_throughput": 374.281, "synch_weights_time_ms": 7.292}, "counters": {"num_env_steps_sampled": 1656000, "num_env_steps_trained": 1656000, "num_agent_steps_sampled": 1656000, "num_agent_steps_trained": 1656000}, "done": false, "training_iteration": 138, "trial_id": "befd4_00000", "date": "2025-01-23_03-03-54", "timestamp": 1737630234, "time_this_iter_s": 195.98548245429993, "time_total_s": 29184.830263614655, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29184.830263614655, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 6.65494071146245, "ram_util_percent": 39.16403162055336, "gpu_util_percent0": 0.06316205533596839, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.597669186525053, "policy_loss": 0.0015504726534593786, "vf_loss": 30.0, "vf_explained_var": -0.027854442202029296, "kl": 0.0, "entropy": 40.38812910573753, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 167447.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1668000, "num_env_steps_trained": 1668000, "num_agent_steps_sampled": 1668000, "num_agent_steps_trained": 1668000}, "env_runners": {"episode_reward_max": -785485.9750667393, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -799547.3686478869, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1728000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -785485.9750667393}, "policy_reward_mean": {"default_policy": -799547.3686478869}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9638217248608898, "mean_inference_ms": 4.434676129219796, "mean_action_processing_ms": 0.7790079436275165, "mean_env_wait_ms": 105.074925511343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09270732601483662, "StateBufferConnector_ms": 0.032288829485575356, "ViewRequirementAgentConnector_ms": 0.13251950343449911}, "num_episodes": 0, "episode_return_max": -785485.9750667393, "episode_return_min": -804649.9336273633, "episode_return_mean": -799547.3686478869, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1668000, "num_agent_steps_trained": 1668000, "num_env_steps_sampled": 1668000, "num_env_steps_trained": 1668000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 56.82314576498757, "num_env_steps_trained_throughput_per_sec": 56.82314576498757, "timesteps_total": 1668000, "num_env_steps_sampled_lifetime": 1668000, "num_agent_steps_sampled_lifetime": 1668000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1668000, "timers": {"training_iteration_time_ms": 211033.525, "restore_workers_time_ms": 0.1, "training_step_time_ms": 211033.425, "sample_time_ms": 178920.93, "load_time_ms": 12.65, "load_throughput": 948606.689, "learn_time_ms": 32091.552, "learn_throughput": 373.93, "synch_weights_time_ms": 7.393}, "counters": {"num_env_steps_sampled": 1668000, "num_env_steps_trained": 1668000, "num_agent_steps_sampled": 1668000, "num_agent_steps_trained": 1668000}, "done": false, "training_iteration": 139, "trial_id": "befd4_00000", "date": "2025-01-23_03-07-25", "timestamp": 1737630445, "time_this_iter_s": 211.1845498085022, "time_total_s": 29396.014813423157, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29396.014813423157, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 7.976838235294117, "ram_util_percent": 39.27132352941176, "gpu_util_percent0": 0.059816176470588234, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.600022430356816, "policy_loss": 0.0038396467487855426, "vf_loss": 30.0, "vf_explained_var": -0.01474594497996189, "kl": 0.0, "entropy": 40.38171862530452, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 168656.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1680000, "num_env_steps_trained": 1680000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "env_runners": {"episode_reward_max": -785485.9750667393, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -799547.3686478869, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1728000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -785485.9750667393}, "policy_reward_mean": {"default_policy": -799547.3686478869}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9638217248608898, "mean_inference_ms": 4.434676129219796, "mean_action_processing_ms": 0.7790079436275165, "mean_env_wait_ms": 105.074925511343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09270732601483662, "StateBufferConnector_ms": 0.032288829485575356, "ViewRequirementAgentConnector_ms": 0.13251950343449911}, "num_episodes": 0, "episode_return_max": -785485.9750667393, "episode_return_min": -804649.9336273633, "episode_return_mean": -799547.3686478869, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000, "num_env_steps_sampled": 1680000, "num_env_steps_trained": 1680000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 54.02317023521636, "num_env_steps_trained_throughput_per_sec": 54.02317023521636, "timesteps_total": 1680000, "num_env_steps_sampled_lifetime": 1680000, "num_agent_steps_sampled_lifetime": 1680000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1680000, "timers": {"training_iteration_time_ms": 210350.282, "restore_workers_time_ms": 0.1, "training_step_time_ms": 210350.182, "sample_time_ms": 178127.98, "load_time_ms": 12.55, "load_throughput": 956193.74, "learn_time_ms": 32201.258, "learn_throughput": 372.656, "synch_weights_time_ms": 7.394}, "counters": {"num_env_steps_sampled": 1680000, "num_env_steps_trained": 1680000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "done": false, "training_iteration": 140, "trial_id": "befd4_00000", "date": "2025-01-23_03-11-07", "timestamp": 1737630667, "time_this_iter_s": 222.12992238998413, "time_total_s": 29618.14473581314, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29618.14473581314, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 7.889510489510489, "ram_util_percent": 39.43601398601399, "gpu_util_percent0": 0.05391608391608391, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.597282482238718, "policy_loss": 0.0013246403173585882, "vf_loss": 30.0, "vf_explained_var": -0.0115980650394588, "kl": 0.0, "entropy": 40.40421995947043, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 169865.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1692000, "num_env_steps_trained": 1692000, "num_agent_steps_sampled": 1692000, "num_agent_steps_trained": 1692000}, "env_runners": {"episode_reward_max": -785485.9750667393, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -799547.3686478869, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1728000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -785485.9750667393}, "policy_reward_mean": {"default_policy": -799547.3686478869}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9638217248608898, "mean_inference_ms": 4.434676129219796, "mean_action_processing_ms": 0.7790079436275165, "mean_env_wait_ms": 105.074925511343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09270732601483662, "StateBufferConnector_ms": 0.032288829485575356, "ViewRequirementAgentConnector_ms": 0.13251950343449911}, "num_episodes": 0, "episode_return_max": -785485.9750667393, "episode_return_min": -804649.9336273633, "episode_return_mean": -799547.3686478869, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1692000, "num_agent_steps_trained": 1692000, "num_env_steps_sampled": 1692000, "num_env_steps_trained": 1692000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.58093960767427, "num_env_steps_trained_throughput_per_sec": 52.58093960767427, "timesteps_total": 1692000, "num_env_steps_sampled_lifetime": 1692000, "num_agent_steps_sampled_lifetime": 1692000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1692000, "timers": {"training_iteration_time_ms": 210064.955, "restore_workers_time_ms": 0.1, "training_step_time_ms": 210064.854, "sample_time_ms": 177855.01, "load_time_ms": 12.55, "load_throughput": 956202.823, "learn_time_ms": 32188.7, "learn_throughput": 372.802, "synch_weights_time_ms": 7.295}, "counters": {"num_env_steps_sampled": 1692000, "num_env_steps_trained": 1692000, "num_agent_steps_sampled": 1692000, "num_agent_steps_trained": 1692000}, "done": false, "training_iteration": 141, "trial_id": "befd4_00000", "date": "2025-01-23_03-14-56", "timestamp": 1737630896, "time_this_iter_s": 228.22257661819458, "time_total_s": 29846.367312431335, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29846.367312431335, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 7.712244897959183, "ram_util_percent": 39.74693877551021, "gpu_util_percent0": 0.05476190476190477, "vram_util_percent0": 0.10029296875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.598353885243608, "policy_loss": 0.0032452050876873796, "vf_loss": 30.0, "vf_explained_var": -0.006028501182868522, "kl": 0.0, "entropy": 40.489130491851476, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 171074.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1704000, "num_env_steps_trained": 1704000, "num_agent_steps_sampled": 1704000, "num_agent_steps_trained": 1704000}, "env_runners": {"episode_reward_max": -785485.9750667393, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -799547.3686478869, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1728000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -785485.9750667393}, "policy_reward_mean": {"default_policy": -799547.3686478869}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9638217248608898, "mean_inference_ms": 4.434676129219796, "mean_action_processing_ms": 0.7790079436275165, "mean_env_wait_ms": 105.074925511343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09270732601483662, "StateBufferConnector_ms": 0.032288829485575356, "ViewRequirementAgentConnector_ms": 0.13251950343449911}, "num_episodes": 0, "episode_return_max": -785485.9750667393, "episode_return_min": -804649.9336273633, "episode_return_mean": -799547.3686478869, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1704000, "num_agent_steps_trained": 1704000, "num_env_steps_sampled": 1704000, "num_env_steps_trained": 1704000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.19553121161115, "num_env_steps_trained_throughput_per_sec": 52.19553121161115, "timesteps_total": 1704000, "num_env_steps_sampled_lifetime": 1704000, "num_agent_steps_sampled_lifetime": 1704000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1704000, "timers": {"training_iteration_time_ms": 210133.796, "restore_workers_time_ms": 0.0, "training_step_time_ms": 210133.796, "sample_time_ms": 177887.269, "load_time_ms": 12.249, "load_throughput": 979641.867, "learn_time_ms": 32225.581, "learn_throughput": 372.375, "synch_weights_time_ms": 7.396}, "counters": {"num_env_steps_sampled": 1704000, "num_env_steps_trained": 1704000, "num_agent_steps_sampled": 1704000, "num_agent_steps_trained": 1704000}, "done": false, "training_iteration": 142, "trial_id": "befd4_00000", "date": "2025-01-23_03-18-46", "timestamp": 1737631126, "time_this_iter_s": 229.90773820877075, "time_total_s": 30076.275050640106, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30076.275050640106, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 7.651178451178452, "ram_util_percent": 39.766666666666666, "gpu_util_percent0": 0.05427609427609427, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.598054456750255, "policy_loss": 0.002950499196304971, "vf_loss": 30.0, "vf_explained_var": -0.004459763578978129, "kl": 0.0, "entropy": 40.48960472908367, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 172283.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1716000, "num_env_steps_trained": 1716000, "num_agent_steps_sampled": 1716000, "num_agent_steps_trained": 1716000}, "env_runners": {"episode_reward_max": -785485.9750667393, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -799547.3686478869, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1728000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -785485.9750667393}, "policy_reward_mean": {"default_policy": -799547.3686478869}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9638217248608898, "mean_inference_ms": 4.434676129219796, "mean_action_processing_ms": 0.7790079436275165, "mean_env_wait_ms": 105.074925511343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09270732601483662, "StateBufferConnector_ms": 0.032288829485575356, "ViewRequirementAgentConnector_ms": 0.13251950343449911}, "num_episodes": 0, "episode_return_max": -785485.9750667393, "episode_return_min": -804649.9336273633, "episode_return_mean": -799547.3686478869, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1716000, "num_agent_steps_trained": 1716000, "num_env_steps_sampled": 1716000, "num_env_steps_trained": 1716000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.15271742136262, "num_env_steps_trained_throughput_per_sec": 52.15271742136262, "timesteps_total": 1716000, "num_env_steps_sampled_lifetime": 1716000, "num_agent_steps_sampled_lifetime": 1716000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1716000, "timers": {"training_iteration_time_ms": 210208.108, "restore_workers_time_ms": 0.0, "training_step_time_ms": 210208.108, "sample_time_ms": 177980.607, "load_time_ms": 12.249, "load_throughput": 979636.147, "learn_time_ms": 32206.557, "learn_throughput": 372.595, "synch_weights_time_ms": 7.295}, "counters": {"num_env_steps_sampled": 1716000, "num_env_steps_trained": 1716000, "num_agent_steps_sampled": 1716000, "num_agent_steps_trained": 1716000}, "done": false, "training_iteration": 143, "trial_id": "befd4_00000", "date": "2025-01-23_03-22-36", "timestamp": 1737631356, "time_this_iter_s": 230.0964810848236, "time_total_s": 30306.37153172493, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30306.37153172493, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 7.747635135135136, "ram_util_percent": 39.68310810810811, "gpu_util_percent0": 0.05337837837837838, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.59805178583112, "policy_loss": 0.0031686334896176387, "vf_loss": 30.0, "vf_explained_var": -0.006202525102569605, "kl": 0.0, "entropy": 40.51168639922162, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 173492.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1728000, "num_env_steps_trained": 1728000, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000}, "env_runners": {"episode_reward_max": -785485.9750667393, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -799547.3686478869, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1728000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -785485.9750667393}, "policy_reward_mean": {"default_policy": -799547.3686478869}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9638217248608898, "mean_inference_ms": 4.434676129219796, "mean_action_processing_ms": 0.7790079436275165, "mean_env_wait_ms": 105.074925511343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09270732601483662, "StateBufferConnector_ms": 0.032288829485575356, "ViewRequirementAgentConnector_ms": 0.13251950343449911}, "num_episodes": 0, "episode_return_max": -785485.9750667393, "episode_return_min": -804649.9336273633, "episode_return_mean": -799547.3686478869, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000, "num_env_steps_sampled": 1728000, "num_env_steps_trained": 1728000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.185267934245374, "num_env_steps_trained_throughput_per_sec": 52.185267934245374, "timesteps_total": 1728000, "num_env_steps_sampled_lifetime": 1728000, "num_agent_steps_sampled_lifetime": 1728000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1728000, "timers": {"training_iteration_time_ms": 210257.716, "restore_workers_time_ms": 0.0, "training_step_time_ms": 210257.716, "sample_time_ms": 178034.335, "load_time_ms": 12.249, "load_throughput": 979634.24, "learn_time_ms": 32202.438, "learn_throughput": 372.643, "synch_weights_time_ms": 7.395}, "counters": {"num_env_steps_sampled": 1728000, "num_env_steps_trained": 1728000, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000}, "done": false, "training_iteration": 144, "trial_id": "befd4_00000", "date": "2025-01-23_03-26-26", "timestamp": 1737631586, "time_this_iter_s": 229.9539520740509, "time_total_s": 30536.32548379898, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30536.32548379898, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 7.671043771043772, "ram_util_percent": 39.57542087542088, "gpu_util_percent0": 0.05552188552188553, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.598414371386355, "policy_loss": 0.002931015653808419, "vf_loss": 30.0, "vf_explained_var": -0.004604320470906172, "kl": 0.0, "entropy": 40.451665586435276, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 174701.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1740000, "num_env_steps_trained": 1740000, "num_agent_steps_sampled": 1740000, "num_agent_steps_trained": 1740000}, "env_runners": {"episode_reward_max": -785485.9750667393, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -799547.3686478869, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1728000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -785485.9750667393}, "policy_reward_mean": {"default_policy": -799547.3686478869}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9638217248608898, "mean_inference_ms": 4.434676129219796, "mean_action_processing_ms": 0.7790079436275165, "mean_env_wait_ms": 105.074925511343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09270732601483662, "StateBufferConnector_ms": 0.032288829485575356, "ViewRequirementAgentConnector_ms": 0.13251950343449911}, "num_episodes": 0, "episode_return_max": -785485.9750667393, "episode_return_min": -804649.9336273633, "episode_return_mean": -799547.3686478869, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1740000, "num_agent_steps_trained": 1740000, "num_env_steps_sampled": 1740000, "num_env_steps_trained": 1740000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.13838150289329, "num_env_steps_trained_throughput_per_sec": 52.13838150289329, "timesteps_total": 1740000, "num_env_steps_sampled_lifetime": 1740000, "num_agent_steps_sampled_lifetime": 1740000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1740000, "timers": {"training_iteration_time_ms": 210217.942, "restore_workers_time_ms": 0.0, "training_step_time_ms": 210217.942, "sample_time_ms": 177955.23, "load_time_ms": 12.25, "load_throughput": 979628.52, "learn_time_ms": 32241.869, "learn_throughput": 372.187, "synch_weights_time_ms": 7.295}, "counters": {"num_env_steps_sampled": 1740000, "num_env_steps_trained": 1740000, "num_agent_steps_sampled": 1740000, "num_agent_steps_trained": 1740000}, "done": false, "training_iteration": 145, "trial_id": "befd4_00000", "date": "2025-01-23_03-30-16", "timestamp": 1737631816, "time_this_iter_s": 230.15974044799805, "time_total_s": 30766.48522424698, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30766.48522424698, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 7.683108108108107, "ram_util_percent": 39.57702702702703, "gpu_util_percent0": 0.0527027027027027, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.599576320600864, "policy_loss": 0.004484546736708547, "vf_loss": 30.0, "vf_explained_var": -0.0038314688491663525, "kl": 0.0, "entropy": 40.49081970227465, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 175910.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1752000, "num_env_steps_trained": 1752000, "num_agent_steps_sampled": 1752000, "num_agent_steps_trained": 1752000}, "env_runners": {"episode_reward_max": -785485.9750667393, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -799547.3686478869, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1728000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -785485.9750667393}, "policy_reward_mean": {"default_policy": -799547.3686478869}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-799469.6508991551, -799519.8577605196, -803854.105696461, -803946.1641247631, -803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9638217248608898, "mean_inference_ms": 4.434676129219796, "mean_action_processing_ms": 0.7790079436275165, "mean_env_wait_ms": 105.074925511343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09270732601483662, "StateBufferConnector_ms": 0.032288829485575356, "ViewRequirementAgentConnector_ms": 0.13251950343449911}, "num_episodes": 0, "episode_return_max": -785485.9750667393, "episode_return_min": -804649.9336273633, "episode_return_mean": -799547.3686478869, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1752000, "num_agent_steps_trained": 1752000, "num_env_steps_sampled": 1752000, "num_env_steps_trained": 1752000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.055922289914044, "num_env_steps_trained_throughput_per_sec": 52.055922289914044, "timesteps_total": 1752000, "num_env_steps_sampled_lifetime": 1752000, "num_agent_steps_sampled_lifetime": 1752000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1752000, "timers": {"training_iteration_time_ms": 218178.28, "restore_workers_time_ms": 0.1, "training_step_time_ms": 218178.18, "sample_time_ms": 185844.691, "load_time_ms": 12.198, "load_throughput": 983745.145, "learn_time_ms": 32312.598, "learn_throughput": 371.372, "synch_weights_time_ms": 7.295}, "counters": {"num_env_steps_sampled": 1752000, "num_env_steps_trained": 1752000, "num_agent_steps_sampled": 1752000, "num_agent_steps_trained": 1752000}, "done": false, "training_iteration": 146, "trial_id": "befd4_00000", "date": "2025-01-23_03-34-06", "timestamp": 1737632046, "time_this_iter_s": 230.5253188610077, "time_total_s": 30997.010543107986, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30997.010543107986, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 7.698653198653199, "ram_util_percent": 39.57441077441078, "gpu_util_percent0": 0.05164983164983165, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.31522333888203, "policy_loss": -0.0037635167686282554, "vf_loss": 29.584517722685934, "vf_explained_var": -0.13386497466006095, "kl": 0.0, "entropy": 26.5530820945948, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 177119.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1764000, "num_env_steps_trained": 1764000, "num_agent_steps_sampled": 1764000, "num_agent_steps_trained": 1764000}, "env_runners": {"episode_reward_max": -785485.9750667393, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -799610.8405637273, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -785485.9750667393}, "policy_reward_mean": {"default_policy": -799610.8405637273}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9639325595052225, "mean_inference_ms": 4.432051338481814, "mean_action_processing_ms": 0.7785080445711897, "mean_env_wait_ms": 105.12452517797894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08899426460266113, "StateBufferConnector_ms": 0.03399944305419922, "ViewRequirementAgentConnector_ms": 0.13420343399047852}, "num_episodes": 8, "episode_return_max": -785485.9750667393, "episode_return_min": -804649.9336273633, "episode_return_mean": -799610.8405637273, "episodes_this_iter": 8}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1764000, "num_agent_steps_trained": 1764000, "num_env_steps_sampled": 1764000, "num_env_steps_trained": 1764000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 70.42144718613926, "num_env_steps_trained_throughput_per_sec": 70.42144718613926, "timesteps_total": 1764000, "num_env_steps_sampled_lifetime": 1764000, "num_agent_steps_sampled_lifetime": 1764000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1764000, "timers": {"training_iteration_time_ms": 217853.84, "restore_workers_time_ms": 0.1, "training_step_time_ms": 217853.74, "sample_time_ms": 185458.794, "load_time_ms": 12.199, "load_throughput": 983681.699, "learn_time_ms": 32373.955, "learn_throughput": 370.668, "synch_weights_time_ms": 7.295}, "counters": {"num_env_steps_sampled": 1764000, "num_env_steps_trained": 1764000, "num_agent_steps_sampled": 1764000, "num_agent_steps_trained": 1764000}, "done": false, "training_iteration": 147, "trial_id": "befd4_00000", "date": "2025-01-23_03-36-57", "timestamp": 1737632217, "time_this_iter_s": 170.4056305885315, "time_total_s": 31167.416173696518, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 31167.416173696518, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 4.3936363636363645, "ram_util_percent": 39.095909090909075, "gpu_util_percent0": 0.07286363636363637, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.348302186472147, "policy_loss": -0.006398721229103205, "vf_loss": 29.782778644482885, "vf_explained_var": 0.05046236672807667, "kl": 0.0, "entropy": 42.8077758744889, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 178328.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1776000, "num_env_steps_trained": 1776000, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000}, "env_runners": {"episode_reward_max": -785485.9750667393, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -799610.8405637273, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -785485.9750667393}, "policy_reward_mean": {"default_policy": -799610.8405637273}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9639325595052225, "mean_inference_ms": 4.432051338481814, "mean_action_processing_ms": 0.7785080445711897, "mean_env_wait_ms": 105.12452517797894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08899426460266113, "StateBufferConnector_ms": 0.03399944305419922, "ViewRequirementAgentConnector_ms": 0.13420343399047852}, "num_episodes": 0, "episode_return_max": -785485.9750667393, "episode_return_min": -804649.9336273633, "episode_return_mean": -799610.8405637273, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000, "num_env_steps_sampled": 1776000, "num_env_steps_trained": 1776000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 71.62815475116322, "num_env_steps_trained_throughput_per_sec": 71.62815475116322, "timesteps_total": 1776000, "num_env_steps_sampled_lifetime": 1776000, "num_agent_steps_sampled_lifetime": 1776000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1776000, "timers": {"training_iteration_time_ms": 215008.88, "restore_workers_time_ms": 0.1, "training_step_time_ms": 215008.78, "sample_time_ms": 182707.328, "load_time_ms": 12.199, "load_throughput": 983695.156, "learn_time_ms": 32280.461, "learn_throughput": 371.742, "synch_weights_time_ms": 7.394}, "counters": {"num_env_steps_sampled": 1776000, "num_env_steps_trained": 1776000, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000}, "done": false, "training_iteration": 148, "trial_id": "befd4_00000", "date": "2025-01-23_03-39-44", "timestamp": 1737632384, "time_this_iter_s": 167.53588819503784, "time_total_s": 31334.952061891556, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 31334.952061891556, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 2.4995370370370376, "ram_util_percent": 38.99861111111112, "gpu_util_percent0": 0.07300925925925926, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.573549797556634, "policy_loss": 0.00232773088997213, "vf_loss": 30.0, "vf_explained_var": -0.028509941990460315, "kl": 0.0, "entropy": 42.877792105978436, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 179537.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1788000, "num_env_steps_trained": 1788000, "num_agent_steps_sampled": 1788000, "num_agent_steps_trained": 1788000}, "env_runners": {"episode_reward_max": -785485.9750667393, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -799610.8405637273, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -785485.9750667393}, "policy_reward_mean": {"default_policy": -799610.8405637273}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9639325595052225, "mean_inference_ms": 4.432051338481814, "mean_action_processing_ms": 0.7785080445711897, "mean_env_wait_ms": 105.12452517797894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08899426460266113, "StateBufferConnector_ms": 0.03399944305419922, "ViewRequirementAgentConnector_ms": 0.13420343399047852}, "num_episodes": 0, "episode_return_max": -785485.9750667393, "episode_return_min": -804649.9336273633, "episode_return_mean": -799610.8405637273, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1788000, "num_agent_steps_trained": 1788000, "num_env_steps_sampled": 1788000, "num_env_steps_trained": 1788000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 63.306298823187774, "num_env_steps_trained_throughput_per_sec": 63.306298823187774, "timesteps_total": 1788000, "num_env_steps_sampled_lifetime": 1788000, "num_agent_steps_sampled_lifetime": 1788000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1788000, "timers": {"training_iteration_time_ms": 212846.184, "restore_workers_time_ms": 0.1, "training_step_time_ms": 212846.084, "sample_time_ms": 180590.02, "load_time_ms": 12.198, "load_throughput": 983781.679, "learn_time_ms": 32235.176, "learn_throughput": 372.264, "synch_weights_time_ms": 7.293}, "counters": {"num_env_steps_sampled": 1788000, "num_env_steps_trained": 1788000, "num_agent_steps_sampled": 1788000, "num_agent_steps_trained": 1788000}, "done": false, "training_iteration": 149, "trial_id": "befd4_00000", "date": "2025-01-23_03-42-54", "timestamp": 1737632574, "time_this_iter_s": 189.55858540534973, "time_total_s": 31524.510647296906, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 31524.510647296906, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 5.3856557377049175, "ram_util_percent": 39.13934426229508, "gpu_util_percent0": 0.06524590163934427, "vram_util_percent0": 0.10029296875000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.57379450297139, "policy_loss": 0.00323426969676002, "vf_loss": 30.0, "vf_explained_var": -0.020970852095002077, "kl": 0.0, "entropy": 42.94397179009601, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 180746.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1800000, "num_env_steps_trained": 1800000, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000}, "env_runners": {"episode_reward_max": -785485.9750667393, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -799610.8405637273, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -785485.9750667393}, "policy_reward_mean": {"default_policy": -799610.8405637273}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9639325595052225, "mean_inference_ms": 4.432051338481814, "mean_action_processing_ms": 0.7785080445711897, "mean_env_wait_ms": 105.12452517797894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08899426460266113, "StateBufferConnector_ms": 0.03399944305419922, "ViewRequirementAgentConnector_ms": 0.13420343399047852}, "num_episodes": 0, "episode_return_max": -785485.9750667393, "episode_return_min": -804649.9336273633, "episode_return_mean": -799610.8405637273, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000, "num_env_steps_sampled": 1800000, "num_env_steps_trained": 1800000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 57.99973275363402, "num_env_steps_trained_throughput_per_sec": 57.99973275363402, "timesteps_total": 1800000, "num_env_steps_sampled_lifetime": 1800000, "num_agent_steps_sampled_lifetime": 1800000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1800000, "timers": {"training_iteration_time_ms": 211323.244, "restore_workers_time_ms": 0.1, "training_step_time_ms": 211323.044, "sample_time_ms": 179139.843, "load_time_ms": 12.198, "load_throughput": 983748.991, "learn_time_ms": 32162.411, "learn_throughput": 373.106, "synch_weights_time_ms": 7.292}, "counters": {"num_env_steps_sampled": 1800000, "num_env_steps_trained": 1800000, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000}, "done": false, "training_iteration": 150, "trial_id": "befd4_00000", "date": "2025-01-23_03-46-21", "timestamp": 1737632781, "time_this_iter_s": 206.9014995098114, "time_total_s": 31731.412146806717, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 31731.412146806717, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 8.072284644194758, "ram_util_percent": 39.25318352059925, "gpu_util_percent0": 0.059438202247191006, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.57433397026472, "policy_loss": 0.0025539792907740876, "vf_loss": 30.0, "vf_explained_var": -0.009662399516803751, "kl": 0.0, "entropy": 42.82199989930966, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 181955.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1812000, "num_env_steps_trained": 1812000, "num_agent_steps_sampled": 1812000, "num_agent_steps_trained": 1812000}, "env_runners": {"episode_reward_max": -785485.9750667393, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -799610.8405637273, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -785485.9750667393}, "policy_reward_mean": {"default_policy": -799610.8405637273}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9639325595052225, "mean_inference_ms": 4.432051338481814, "mean_action_processing_ms": 0.7785080445711897, "mean_env_wait_ms": 105.12452517797894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08899426460266113, "StateBufferConnector_ms": 0.03399944305419922, "ViewRequirementAgentConnector_ms": 0.13420343399047852}, "num_episodes": 0, "episode_return_max": -785485.9750667393, "episode_return_min": -804649.9336273633, "episode_return_mean": -799610.8405637273, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1812000, "num_agent_steps_trained": 1812000, "num_env_steps_sampled": 1812000, "num_env_steps_trained": 1812000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 54.62984184794393, "num_env_steps_trained_throughput_per_sec": 54.62984184794393, "timesteps_total": 1812000, "num_env_steps_sampled_lifetime": 1812000, "num_agent_steps_sampled_lifetime": 1812000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1812000, "timers": {"training_iteration_time_ms": 210467.302, "restore_workers_time_ms": 0.1, "training_step_time_ms": 210467.102, "sample_time_ms": 178305.767, "load_time_ms": 12.198, "load_throughput": 983731.686, "learn_time_ms": 32140.745, "learn_throughput": 373.358, "synch_weights_time_ms": 7.291}, "counters": {"num_env_steps_sampled": 1812000, "num_env_steps_trained": 1812000, "num_agent_steps_sampled": 1812000, "num_agent_steps_trained": 1812000}, "done": false, "training_iteration": 151, "trial_id": "befd4_00000", "date": "2025-01-23_03-50-01", "timestamp": 1737633001, "time_this_iter_s": 219.6631624698639, "time_total_s": 31951.07530927658, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 31951.07530927658, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 7.864664310954063, "ram_util_percent": 39.38657243816254, "gpu_util_percent0": 0.05526501766784453, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.573656883586825, "policy_loss": 0.003039108760303658, "vf_loss": 30.0, "vf_explained_var": -0.0066314320903459395, "kl": 0.0, "entropy": 42.93822477354897, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 183164.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1824000, "num_env_steps_trained": 1824000, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000}, "env_runners": {"episode_reward_max": -785485.9750667393, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -799610.8405637273, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -785485.9750667393}, "policy_reward_mean": {"default_policy": -799610.8405637273}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9639325595052225, "mean_inference_ms": 4.432051338481814, "mean_action_processing_ms": 0.7785080445711897, "mean_env_wait_ms": 105.12452517797894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08899426460266113, "StateBufferConnector_ms": 0.03399944305419922, "ViewRequirementAgentConnector_ms": 0.13420343399047852}, "num_episodes": 0, "episode_return_max": -785485.9750667393, "episode_return_min": -804649.9336273633, "episode_return_mean": -799610.8405637273, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000, "num_env_steps_sampled": 1824000, "num_env_steps_trained": 1824000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.8187766535882, "num_env_steps_trained_throughput_per_sec": 52.8187766535882, "timesteps_total": 1824000, "num_env_steps_sampled_lifetime": 1824000, "num_agent_steps_sampled_lifetime": 1824000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1824000, "timers": {"training_iteration_time_ms": 210196.021, "restore_workers_time_ms": 0.1, "training_step_time_ms": 210195.821, "sample_time_ms": 178052.43, "load_time_ms": 12.199, "load_throughput": 983716.305, "learn_time_ms": 32122.903, "learn_throughput": 373.565, "synch_weights_time_ms": 7.19}, "counters": {"num_env_steps_sampled": 1824000, "num_env_steps_trained": 1824000, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000}, "done": false, "training_iteration": 152, "trial_id": "befd4_00000", "date": "2025-01-23_03-53-48", "timestamp": 1737633228, "time_this_iter_s": 227.1959309577942, "time_total_s": 32178.271240234375, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 32178.271240234375, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 7.6583617747440265, "ram_util_percent": 39.48941979522184, "gpu_util_percent0": 0.054334470989761095, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.572427194309785, "policy_loss": 0.0025483229751425206, "vf_loss": 30.0, "vf_explained_var": -0.003969869601815273, "kl": 0.0, "entropy": 43.01211120315186, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 184373.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1836000, "num_env_steps_trained": 1836000, "num_agent_steps_sampled": 1836000, "num_agent_steps_trained": 1836000}, "env_runners": {"episode_reward_max": -785485.9750667393, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -799610.8405637273, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -785485.9750667393}, "policy_reward_mean": {"default_policy": -799610.8405637273}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9639325595052225, "mean_inference_ms": 4.432051338481814, "mean_action_processing_ms": 0.7785080445711897, "mean_env_wait_ms": 105.12452517797894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08899426460266113, "StateBufferConnector_ms": 0.03399944305419922, "ViewRequirementAgentConnector_ms": 0.13420343399047852}, "num_episodes": 0, "episode_return_max": -785485.9750667393, "episode_return_min": -804649.9336273633, "episode_return_mean": -799610.8405637273, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1836000, "num_agent_steps_trained": 1836000, "num_env_steps_sampled": 1836000, "num_env_steps_trained": 1836000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.15572463250664, "num_env_steps_trained_throughput_per_sec": 52.15572463250664, "timesteps_total": 1836000, "num_env_steps_sampled_lifetime": 1836000, "num_agent_steps_sampled_lifetime": 1836000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1836000, "timers": {"training_iteration_time_ms": 210194.695, "restore_workers_time_ms": 0.1, "training_step_time_ms": 210194.495, "sample_time_ms": 178019.325, "load_time_ms": 12.199, "load_throughput": 983712.46, "learn_time_ms": 32154.581, "learn_throughput": 373.197, "synch_weights_time_ms": 7.19}, "counters": {"num_env_steps_sampled": 1836000, "num_env_steps_trained": 1836000, "num_agent_steps_sampled": 1836000, "num_agent_steps_trained": 1836000}, "done": false, "training_iteration": 153, "trial_id": "befd4_00000", "date": "2025-01-23_03-57-38", "timestamp": 1737633458, "time_this_iter_s": 230.0832076072693, "time_total_s": 32408.354447841644, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 32408.354447841644, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 7.725675675675676, "ram_util_percent": 39.57905405405406, "gpu_util_percent0": 0.05131756756756757, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.57549382597085, "policy_loss": 0.004817234480104927, "vf_loss": 30.0, "vf_explained_var": -0.004596589418163568, "kl": 0.0, "entropy": 42.93234183829712, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 185582.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1848000, "num_env_steps_trained": 1848000, "num_agent_steps_sampled": 1848000, "num_agent_steps_trained": 1848000}, "env_runners": {"episode_reward_max": -785485.9750667393, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -799610.8405637273, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -785485.9750667393}, "policy_reward_mean": {"default_policy": -799610.8405637273}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9639325595052225, "mean_inference_ms": 4.432051338481814, "mean_action_processing_ms": 0.7785080445711897, "mean_env_wait_ms": 105.12452517797894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08899426460266113, "StateBufferConnector_ms": 0.03399944305419922, "ViewRequirementAgentConnector_ms": 0.13420343399047852}, "num_episodes": 0, "episode_return_max": -785485.9750667393, "episode_return_min": -804649.9336273633, "episode_return_mean": -799610.8405637273, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1848000, "num_agent_steps_trained": 1848000, "num_env_steps_sampled": 1848000, "num_env_steps_trained": 1848000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.187659093011874, "num_env_steps_trained_throughput_per_sec": 52.187659093011874, "timesteps_total": 1848000, "num_env_steps_sampled_lifetime": 1848000, "num_agent_steps_sampled_lifetime": 1848000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1848000, "timers": {"training_iteration_time_ms": 210193.641, "restore_workers_time_ms": 0.1, "training_step_time_ms": 210193.441, "sample_time_ms": 178063.943, "load_time_ms": 12.199, "load_throughput": 983714.382, "learn_time_ms": 32109.008, "learn_throughput": 373.727, "synch_weights_time_ms": 7.092}, "counters": {"num_env_steps_sampled": 1848000, "num_env_steps_trained": 1848000, "num_agent_steps_sampled": 1848000, "num_agent_steps_trained": 1848000}, "done": false, "training_iteration": 154, "trial_id": "befd4_00000", "date": "2025-01-23_04-01-28", "timestamp": 1737633688, "time_this_iter_s": 229.9434142112732, "time_total_s": 32638.297862052917, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 32638.297862052917, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 7.645117845117845, "ram_util_percent": 39.58989898989899, "gpu_util_percent0": 0.054612794612794606, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.575410674089632, "policy_loss": 0.0034898447999045117, "vf_loss": 30.0, "vf_explained_var": -0.004137069011543091, "kl": 0.0, "entropy": 42.80792390304325, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 186791.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1860000, "num_env_steps_trained": 1860000, "num_agent_steps_sampled": 1860000, "num_agent_steps_trained": 1860000}, "env_runners": {"episode_reward_max": -785485.9750667393, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -799610.8405637273, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -785485.9750667393}, "policy_reward_mean": {"default_policy": -799610.8405637273}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9639325595052225, "mean_inference_ms": 4.432051338481814, "mean_action_processing_ms": 0.7785080445711897, "mean_env_wait_ms": 105.12452517797894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08899426460266113, "StateBufferConnector_ms": 0.03399944305419922, "ViewRequirementAgentConnector_ms": 0.13420343399047852}, "num_episodes": 0, "episode_return_max": -785485.9750667393, "episode_return_min": -804649.9336273633, "episode_return_mean": -799610.8405637273, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1860000, "num_agent_steps_trained": 1860000, "num_env_steps_sampled": 1860000, "num_env_steps_trained": 1860000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.180091799929244, "num_env_steps_trained_throughput_per_sec": 52.180091799929244, "timesteps_total": 1860000, "num_env_steps_sampled_lifetime": 1860000, "num_agent_steps_sampled_lifetime": 1860000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1860000, "timers": {"training_iteration_time_ms": 210175.243, "restore_workers_time_ms": 0.1, "training_step_time_ms": 210175.044, "sample_time_ms": 178053.515, "load_time_ms": 12.099, "load_throughput": 991809.377, "learn_time_ms": 32101.138, "learn_throughput": 373.819, "synch_weights_time_ms": 7.191}, "counters": {"num_env_steps_sampled": 1860000, "num_env_steps_trained": 1860000, "num_agent_steps_sampled": 1860000, "num_agent_steps_trained": 1860000}, "done": false, "training_iteration": 155, "trial_id": "befd4_00000", "date": "2025-01-23_04-05-18", "timestamp": 1737633918, "time_this_iter_s": 229.97676420211792, "time_total_s": 32868.274626255035, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 32868.274626255035, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 7.702702702702703, "ram_util_percent": 39.60405405405406, "gpu_util_percent0": 0.053412162162162165, "vram_util_percent0": 0.10029296875000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.57421984329413, "policy_loss": 0.002100219569539511, "vf_loss": 30.0, "vf_explained_var": -0.00262452360023833, "kl": 0.0, "entropy": 42.78803651050855, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 188000.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1872000, "num_env_steps_trained": 1872000, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000}, "env_runners": {"episode_reward_max": -785485.9750667393, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -799610.8405637273, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -785485.9750667393}, "policy_reward_mean": {"default_policy": -799610.8405637273}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9639325595052225, "mean_inference_ms": 4.432051338481814, "mean_action_processing_ms": 0.7785080445711897, "mean_env_wait_ms": 105.12452517797894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08899426460266113, "StateBufferConnector_ms": 0.03399944305419922, "ViewRequirementAgentConnector_ms": 0.13420343399047852}, "num_episodes": 0, "episode_return_max": -785485.9750667393, "episode_return_min": -804649.9336273633, "episode_return_mean": -799610.8405637273, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000, "num_env_steps_sampled": 1872000, "num_env_steps_trained": 1872000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.10518198768945, "num_env_steps_trained_throughput_per_sec": 52.10518198768945, "timesteps_total": 1872000, "num_env_steps_sampled_lifetime": 1872000, "num_agent_steps_sampled_lifetime": 1872000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1872000, "timers": {"training_iteration_time_ms": 210153.45, "restore_workers_time_ms": 0.0, "training_step_time_ms": 210153.35, "sample_time_ms": 178104.32, "load_time_ms": 12.099, "load_throughput": 991813.286, "learn_time_ms": 32028.739, "learn_throughput": 374.664, "synch_weights_time_ms": 7.191}, "counters": {"num_env_steps_sampled": 1872000, "num_env_steps_trained": 1872000, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000}, "done": false, "training_iteration": 156, "trial_id": "befd4_00000", "date": "2025-01-23_04-09-08", "timestamp": 1737634148, "time_this_iter_s": 230.3063838481903, "time_total_s": 33098.581010103226, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33098.581010103226, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 7.675757575757575, "ram_util_percent": 39.598989898989906, "gpu_util_percent0": 0.053737373737373736, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.574214406798358, "policy_loss": 0.002630384902356576, "vf_loss": 30.0, "vf_explained_var": -0.0015148459829704341, "kl": 0.0, "entropy": 42.841598084783435, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 189209.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1884000, "num_env_steps_trained": 1884000, "num_agent_steps_sampled": 1884000, "num_agent_steps_trained": 1884000}, "env_runners": {"episode_reward_max": -785485.9750667393, "episode_reward_min": -804649.9336273633, "episode_reward_mean": -799610.8405637273, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804649.9336273633}, "policy_reward_max": {"default_policy": -785485.9750667393}, "policy_reward_mean": {"default_policy": -799610.8405637273}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-803033.5530697828, -803137.3304505418, -800481.7363571844, -800580.2026452539, -804536.5714148894, -804649.9336273633, -800058.8421816144, -800120.3816884484, -803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9639325595052225, "mean_inference_ms": 4.432051338481814, "mean_action_processing_ms": 0.7785080445711897, "mean_env_wait_ms": 105.12452517797894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08899426460266113, "StateBufferConnector_ms": 0.03399944305419922, "ViewRequirementAgentConnector_ms": 0.13420343399047852}, "num_episodes": 0, "episode_return_max": -785485.9750667393, "episode_return_min": -804649.9336273633, "episode_return_mean": -799610.8405637273, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1884000, "num_agent_steps_trained": 1884000, "num_env_steps_sampled": 1884000, "num_env_steps_trained": 1884000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.063206092775815, "num_env_steps_trained_throughput_per_sec": 52.063206092775815, "timesteps_total": 1884000, "num_env_steps_sampled_lifetime": 1884000, "num_agent_steps_sampled_lifetime": 1884000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1884000, "timers": {"training_iteration_time_ms": 216162.094, "restore_workers_time_ms": 0.0, "training_step_time_ms": 216161.994, "sample_time_ms": 184167.482, "load_time_ms": 11.999, "load_throughput": 1000108.254, "learn_time_ms": 31974.319, "learn_throughput": 375.301, "synch_weights_time_ms": 7.191}, "counters": {"num_env_steps_sampled": 1884000, "num_env_steps_trained": 1884000, "num_agent_steps_sampled": 1884000, "num_agent_steps_trained": 1884000}, "done": false, "training_iteration": 157, "trial_id": "befd4_00000", "date": "2025-01-23_04-12-59", "timestamp": 1737634379, "time_this_iter_s": 230.493066072464, "time_total_s": 33329.07407617569, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33329.07407617569, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 7.682828282828283, "ram_util_percent": 39.65791245791245, "gpu_util_percent0": 0.05303030303030304, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.634159512515893, "policy_loss": -0.011363844767003339, "vf_loss": 29.963471960883382, "vf_explained_var": -0.17837983621261255, "kl": 0.0, "entropy": 31.79485953199262, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 190418.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1896000, "num_env_steps_trained": 1896000, "num_agent_steps_sampled": 1896000, "num_agent_steps_trained": 1896000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -803736.6943223359, "episode_reward_mean": -799181.0486701409, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -803736.6943223359}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -799181.0486701409}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9638229269253022, "mean_inference_ms": 4.428719321255685, "mean_action_processing_ms": 0.7779460780952305, "mean_env_wait_ms": 105.22428797365676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08800244331359863, "StateBufferConnector_ms": 0.0319972038269043, "ViewRequirementAgentConnector_ms": 0.13121390342712402}, "num_episodes": 8, "episode_return_max": -785314.6083469589, "episode_return_min": -803736.6943223359, "episode_return_mean": -799181.0486701409, "episodes_this_iter": 8}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1896000, "num_agent_steps_trained": 1896000, "num_env_steps_sampled": 1896000, "num_env_steps_trained": 1896000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 63.488721923292246, "num_env_steps_trained_throughput_per_sec": 63.488721923292246, "timesteps_total": 1896000, "num_env_steps_sampled_lifetime": 1896000, "num_agent_steps_sampled_lifetime": 1896000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1896000, "timers": {"training_iteration_time_ms": 218309.9, "restore_workers_time_ms": 0.0, "training_step_time_ms": 218309.8, "sample_time_ms": 186233.218, "load_time_ms": 11.999, "load_throughput": 1000114.216, "learn_time_ms": 32056.389, "learn_throughput": 374.34, "synch_weights_time_ms": 7.093}, "counters": {"num_env_steps_sampled": 1896000, "num_env_steps_trained": 1896000, "num_agent_steps_sampled": 1896000, "num_agent_steps_trained": 1896000}, "done": false, "training_iteration": 158, "trial_id": "befd4_00000", "date": "2025-01-23_04-16-08", "timestamp": 1737634568, "time_this_iter_s": 189.0139353275299, "time_total_s": 33518.08801150322, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33518.08801150322, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 5.618106995884774, "ram_util_percent": 39.31111111111112, "gpu_util_percent0": 0.064320987654321, "vram_util_percent0": 0.10029296875000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.024853978500175, "policy_loss": -0.014676281057661777, "vf_loss": 29.42682768393391, "vf_explained_var": 0.09322955235654012, "kl": 0.0, "entropy": 38.72974422729341, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 191627.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1908000, "num_env_steps_trained": 1908000, "num_agent_steps_sampled": 1908000, "num_agent_steps_trained": 1908000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -803736.6943223359, "episode_reward_mean": -799181.0486701409, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -803736.6943223359}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -799181.0486701409}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9638229269253022, "mean_inference_ms": 4.428719321255685, "mean_action_processing_ms": 0.7779460780952305, "mean_env_wait_ms": 105.22428797365676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08800244331359863, "StateBufferConnector_ms": 0.0319972038269043, "ViewRequirementAgentConnector_ms": 0.13121390342712402}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -803736.6943223359, "episode_return_mean": -799181.0486701409, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1908000, "num_agent_steps_trained": 1908000, "num_env_steps_sampled": 1908000, "num_env_steps_trained": 1908000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 74.70717309251926, "num_env_steps_trained_throughput_per_sec": 74.70717309251926, "timesteps_total": 1908000, "num_env_steps_sampled_lifetime": 1908000, "num_agent_steps_sampled_lifetime": 1908000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1908000, "timers": {"training_iteration_time_ms": 215417.155, "restore_workers_time_ms": 0.0, "training_step_time_ms": 215417.055, "sample_time_ms": 183335.133, "load_time_ms": 12.0, "load_throughput": 1000032.744, "learn_time_ms": 32061.127, "learn_throughput": 374.285, "synch_weights_time_ms": 7.694}, "counters": {"num_env_steps_sampled": 1908000, "num_env_steps_trained": 1908000, "num_agent_steps_sampled": 1908000, "num_agent_steps_trained": 1908000}, "done": false, "training_iteration": 159, "trial_id": "befd4_00000", "date": "2025-01-23_04-18-49", "timestamp": 1737634729, "time_this_iter_s": 160.630145072937, "time_total_s": 33678.71815657616, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33678.71815657616, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 2.6548076923076924, "ram_util_percent": 39.04807692307693, "gpu_util_percent0": 0.07567307692307691, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.579958653035884, "policy_loss": -0.00040434737211421466, "vf_loss": 30.0, "vf_explained_var": -0.1152254834561628, "kl": 0.0, "entropy": 41.963701700947325, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 192836.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1920000, "num_env_steps_trained": 1920000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -803736.6943223359, "episode_reward_mean": -799181.0486701409, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -803736.6943223359}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -799181.0486701409}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9638229269253022, "mean_inference_ms": 4.428719321255685, "mean_action_processing_ms": 0.7779460780952305, "mean_env_wait_ms": 105.22428797365676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08800244331359863, "StateBufferConnector_ms": 0.0319972038269043, "ViewRequirementAgentConnector_ms": 0.13121390342712402}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -803736.6943223359, "episode_return_mean": -799181.0486701409, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000, "num_env_steps_sampled": 1920000, "num_env_steps_trained": 1920000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 65.04895829087508, "num_env_steps_trained_throughput_per_sec": 65.04895829087508, "timesteps_total": 1920000, "num_env_steps_sampled_lifetime": 1920000, "num_agent_steps_sampled_lifetime": 1920000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1920000, "timers": {"training_iteration_time_ms": 213175.048, "restore_workers_time_ms": 0.0, "training_step_time_ms": 213175.048, "sample_time_ms": 181136.766, "load_time_ms": 11.999, "load_throughput": 1000056.588, "learn_time_ms": 32017.486, "learn_throughput": 374.795, "synch_weights_time_ms": 7.696}, "counters": {"num_env_steps_sampled": 1920000, "num_env_steps_trained": 1920000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "done": false, "training_iteration": 160, "trial_id": "befd4_00000", "date": "2025-01-23_04-21-53", "timestamp": 1737634913, "time_this_iter_s": 184.48043370246887, "time_total_s": 33863.198590278625, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33863.198590278625, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 3.956118143459915, "ram_util_percent": 39.22869198312237, "gpu_util_percent0": 0.06426160337552743, "vram_util_percent0": 0.10029296875000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.58338418334254, "policy_loss": 0.0012297630987944338, "vf_loss": 30.0, "vf_explained_var": -0.07203213368889909, "kl": 0.0, "entropy": 41.78455642750679, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 194045.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1932000, "num_env_steps_trained": 1932000, "num_agent_steps_sampled": 1932000, "num_agent_steps_trained": 1932000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -803736.6943223359, "episode_reward_mean": -799181.0486701409, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -803736.6943223359}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -799181.0486701409}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9638229269253022, "mean_inference_ms": 4.428719321255685, "mean_action_processing_ms": 0.7779460780952305, "mean_env_wait_ms": 105.22428797365676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08800244331359863, "StateBufferConnector_ms": 0.0319972038269043, "ViewRequirementAgentConnector_ms": 0.13121390342712402}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -803736.6943223359, "episode_return_mean": -799181.0486701409, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1932000, "num_agent_steps_trained": 1932000, "num_env_steps_sampled": 1932000, "num_env_steps_trained": 1932000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 59.557819854025404, "num_env_steps_trained_throughput_per_sec": 59.557819854025404, "timesteps_total": 1932000, "num_env_steps_sampled_lifetime": 1932000, "num_agent_steps_sampled_lifetime": 1932000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1932000, "timers": {"training_iteration_time_ms": 211357.519, "restore_workers_time_ms": 0.0, "training_step_time_ms": 211357.519, "sample_time_ms": 179282.394, "load_time_ms": 12.085, "load_throughput": 992977.533, "learn_time_ms": 32054.189, "learn_throughput": 374.366, "synch_weights_time_ms": 7.75}, "counters": {"num_env_steps_sampled": 1932000, "num_env_steps_trained": 1932000, "num_agent_steps_sampled": 1932000, "num_agent_steps_trained": 1932000}, "done": false, "training_iteration": 161, "trial_id": "befd4_00000", "date": "2025-01-23_04-25-15", "timestamp": 1737635115, "time_this_iter_s": 201.48786568641663, "time_total_s": 34064.68645596504, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34064.68645596504, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 8.218846153846156, "ram_util_percent": 39.33423076923077, "gpu_util_percent0": 0.056307692307692295, "vram_util_percent0": 0.10034329927884619}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.583776224734272, "policy_loss": 0.0009105548915831485, "vf_loss": 30.0, "vf_explained_var": -0.05605719610124309, "kl": 0.0, "entropy": 41.713434691070226, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 195254.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1944000, "num_env_steps_trained": 1944000, "num_agent_steps_sampled": 1944000, "num_agent_steps_trained": 1944000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -803736.6943223359, "episode_reward_mean": -799181.0486701409, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -803736.6943223359}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -799181.0486701409}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9638229269253022, "mean_inference_ms": 4.428719321255685, "mean_action_processing_ms": 0.7779460780952305, "mean_env_wait_ms": 105.22428797365676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08800244331359863, "StateBufferConnector_ms": 0.0319972038269043, "ViewRequirementAgentConnector_ms": 0.13121390342712402}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -803736.6943223359, "episode_return_mean": -799181.0486701409, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1944000, "num_agent_steps_trained": 1944000, "num_env_steps_sampled": 1944000, "num_env_steps_trained": 1944000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 49.141563176601906, "num_env_steps_trained_throughput_per_sec": 49.141563176601906, "timesteps_total": 1944000, "num_env_steps_sampled_lifetime": 1944000, "num_agent_steps_sampled_lifetime": 1944000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1944000, "timers": {"training_iteration_time_ms": 213057.574, "restore_workers_time_ms": 0.0, "training_step_time_ms": 213057.574, "sample_time_ms": 180682.25, "load_time_ms": 12.185, "load_throughput": 984830.776, "learn_time_ms": 32354.186, "learn_throughput": 370.895, "synch_weights_time_ms": 7.751}, "counters": {"num_env_steps_sampled": 1944000, "num_env_steps_trained": 1944000, "num_agent_steps_sampled": 1944000, "num_agent_steps_trained": 1944000}, "done": false, "training_iteration": 162, "trial_id": "befd4_00000", "date": "2025-01-23_04-29-19", "timestamp": 1737635359, "time_this_iter_s": 244.1964647769928, "time_total_s": 34308.882920742035, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34308.882920742035, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 15.26331168831169, "ram_util_percent": 48.35811688311688, "gpu_util_percent0": 0.08931818181818182, "vram_util_percent0": 0.1091819069602273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.58442578343343, "policy_loss": 0.001980166225959882, "vf_loss": 30.0, "vf_explained_var": -0.031155111032443367, "kl": 0.0, "entropy": 41.75544055026853, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 196463.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1956000, "num_env_steps_trained": 1956000, "num_agent_steps_sampled": 1956000, "num_agent_steps_trained": 1956000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -803736.6943223359, "episode_reward_mean": -799181.0486701409, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -803736.6943223359}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -799181.0486701409}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9638229269253022, "mean_inference_ms": 4.428719321255685, "mean_action_processing_ms": 0.7779460780952305, "mean_env_wait_ms": 105.22428797365676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08800244331359863, "StateBufferConnector_ms": 0.0319972038269043, "ViewRequirementAgentConnector_ms": 0.13121390342712402}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -803736.6943223359, "episode_return_mean": -799181.0486701409, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1956000, "num_agent_steps_trained": 1956000, "num_env_steps_sampled": 1956000, "num_env_steps_trained": 1956000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 49.53568084119111, "num_env_steps_trained_throughput_per_sec": 49.53568084119111, "timesteps_total": 1956000, "num_env_steps_sampled_lifetime": 1956000, "num_agent_steps_sampled_lifetime": 1956000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1956000, "timers": {"training_iteration_time_ms": 214274.515, "restore_workers_time_ms": 0.0, "training_step_time_ms": 214274.515, "sample_time_ms": 181635.228, "load_time_ms": 12.386, "load_throughput": 968842.297, "learn_time_ms": 32617.947, "learn_throughput": 367.896, "synch_weights_time_ms": 7.851}, "counters": {"num_env_steps_sampled": 1956000, "num_env_steps_trained": 1956000, "num_agent_steps_sampled": 1956000, "num_agent_steps_trained": 1956000}, "done": false, "training_iteration": 163, "trial_id": "befd4_00000", "date": "2025-01-23_04-33-21", "timestamp": 1737635601, "time_this_iter_s": 242.25362300872803, "time_total_s": 34551.13654375076, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34551.13654375076, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 10.412621359223301, "ram_util_percent": 58.816828478964396, "gpu_util_percent0": 0.13877022653721682, "vram_util_percent0": 0.13450615645226538}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.587918195574613, "policy_loss": 0.003712566900687143, "vf_loss": 30.0, "vf_explained_var": -0.020925456921456764, "kl": 0.0, "entropy": 41.579439265753635, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 197672.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1968000, "num_env_steps_trained": 1968000, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -803736.6943223359, "episode_reward_mean": -799181.0486701409, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -803736.6943223359}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -799181.0486701409}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9638229269253022, "mean_inference_ms": 4.428719321255685, "mean_action_processing_ms": 0.7779460780952305, "mean_env_wait_ms": 105.22428797365676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08800244331359863, "StateBufferConnector_ms": 0.0319972038269043, "ViewRequirementAgentConnector_ms": 0.13121390342712402}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -803736.6943223359, "episode_return_mean": -799181.0486701409, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000, "num_env_steps_sampled": 1968000, "num_env_steps_trained": 1968000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 49.03401162222536, "num_env_steps_trained_throughput_per_sec": 49.03401162222536, "timesteps_total": 1968000, "num_env_steps_sampled_lifetime": 1968000, "num_agent_steps_sampled_lifetime": 1968000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1968000, "timers": {"training_iteration_time_ms": 215753.382, "restore_workers_time_ms": 0.0, "training_step_time_ms": 215753.382, "sample_time_ms": 182695.587, "load_time_ms": 11.886, "load_throughput": 1009591.062, "learn_time_ms": 33036.756, "learn_throughput": 363.232, "synch_weights_time_ms": 8.051}, "counters": {"num_env_steps_sampled": 1968000, "num_env_steps_trained": 1968000, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000}, "done": false, "training_iteration": 164, "trial_id": "befd4_00000", "date": "2025-01-23_04-37-26", "timestamp": 1737635846, "time_this_iter_s": 244.73208737373352, "time_total_s": 34795.8686311245, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34795.8686311245, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 10.88063492063492, "ram_util_percent": 50.27777777777778, "gpu_util_percent0": 0.07346031746031746, "vram_util_percent0": 0.13295355902777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.58655307665652, "policy_loss": 0.0016701076706644915, "vf_loss": 30.0, "vf_explained_var": -0.012421185611396707, "kl": 0.0, "entropy": 41.511702916955436, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 198881.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1980000, "num_env_steps_trained": 1980000, "num_agent_steps_sampled": 1980000, "num_agent_steps_trained": 1980000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -803736.6943223359, "episode_reward_mean": -799181.0486701409, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -803736.6943223359}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -799181.0486701409}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9638229269253022, "mean_inference_ms": 4.428719321255685, "mean_action_processing_ms": 0.7779460780952305, "mean_env_wait_ms": 105.22428797365676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08800244331359863, "StateBufferConnector_ms": 0.0319972038269043, "ViewRequirementAgentConnector_ms": 0.13121390342712402}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -803736.6943223359, "episode_return_mean": -799181.0486701409, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1980000, "num_agent_steps_trained": 1980000, "num_env_steps_sampled": 1980000, "num_env_steps_trained": 1980000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 50.52396347557667, "num_env_steps_trained_throughput_per_sec": 50.52396347557667, "timesteps_total": 1980000, "num_env_steps_sampled_lifetime": 1980000, "num_agent_steps_sampled_lifetime": 1980000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1980000, "timers": {"training_iteration_time_ms": 216507.211, "restore_workers_time_ms": 0.0, "training_step_time_ms": 216507.211, "sample_time_ms": 183005.929, "load_time_ms": 12.086, "load_throughput": 992889.385, "learn_time_ms": 33479.942, "learn_throughput": 358.424, "synch_weights_time_ms": 7.953}, "counters": {"num_env_steps_sampled": 1980000, "num_env_steps_trained": 1980000, "num_agent_steps_sampled": 1980000, "num_agent_steps_trained": 1980000}, "done": false, "training_iteration": 165, "trial_id": "befd4_00000", "date": "2025-01-23_04-41-24", "timestamp": 1737636084, "time_this_iter_s": 237.51605415344238, "time_total_s": 35033.38468527794, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35033.38468527794, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 9.300653594771243, "ram_util_percent": 49.79869281045752, "gpu_util_percent0": 0.10290849673202616, "vram_util_percent0": 0.1336981081495098}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.587008966109888, "policy_loss": 0.0021951305498950635, "vf_loss": 30.0, "vf_explained_var": -0.007138591743481859, "kl": 0.0, "entropy": 41.51861242226474, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 200090.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 1992000, "num_env_steps_trained": 1992000, "num_agent_steps_sampled": 1992000, "num_agent_steps_trained": 1992000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -803736.6943223359, "episode_reward_mean": -799181.0486701409, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -803736.6943223359}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -799181.0486701409}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9638229269253022, "mean_inference_ms": 4.428719321255685, "mean_action_processing_ms": 0.7779460780952305, "mean_env_wait_ms": 105.22428797365676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08800244331359863, "StateBufferConnector_ms": 0.0319972038269043, "ViewRequirementAgentConnector_ms": 0.13121390342712402}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -803736.6943223359, "episode_return_mean": -799181.0486701409, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1992000, "num_agent_steps_trained": 1992000, "num_env_steps_sampled": 1992000, "num_env_steps_trained": 1992000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 50.877485783412716, "num_env_steps_trained_throughput_per_sec": 50.877485783412716, "timesteps_total": 1992000, "num_env_steps_sampled_lifetime": 1992000, "num_agent_steps_sampled_lifetime": 1992000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1992000, "timers": {"training_iteration_time_ms": 217062.944, "restore_workers_time_ms": 0.0, "training_step_time_ms": 217062.944, "sample_time_ms": 183230.651, "load_time_ms": 12.286, "load_throughput": 976727.517, "learn_time_ms": 33810.651, "learn_throughput": 354.918, "synch_weights_time_ms": 7.954}, "counters": {"num_env_steps_sampled": 1992000, "num_env_steps_trained": 1992000, "num_agent_steps_sampled": 1992000, "num_agent_steps_trained": 1992000}, "done": false, "training_iteration": 166, "trial_id": "befd4_00000", "date": "2025-01-23_04-45-19", "timestamp": 1737636319, "time_this_iter_s": 235.86470913887024, "time_total_s": 35269.24939441681, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35269.24939441681, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 8.805921052631579, "ram_util_percent": 48.88618421052632, "gpu_util_percent0": 0.08707236842105263, "vram_util_percent0": 0.1324485377261513}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.58597483134053, "policy_loss": 0.0014033847980700414, "vf_loss": 30.0, "vf_explained_var": -0.009910171292260031, "kl": 0.0, "entropy": 41.542853693808276, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 201299.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2004000, "num_env_steps_trained": 2004000, "num_agent_steps_sampled": 2004000, "num_agent_steps_trained": 2004000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -803736.6943223359, "episode_reward_mean": -799181.0486701409, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -803736.6943223359}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -799181.0486701409}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9638229269253022, "mean_inference_ms": 4.428719321255685, "mean_action_processing_ms": 0.7779460780952305, "mean_env_wait_ms": 105.22428797365676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08800244331359863, "StateBufferConnector_ms": 0.0319972038269043, "ViewRequirementAgentConnector_ms": 0.13121390342712402}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -803736.6943223359, "episode_return_mean": -799181.0486701409, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2004000, "num_agent_steps_trained": 2004000, "num_env_steps_sampled": 2004000, "num_env_steps_trained": 2004000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 48.92099182792891, "num_env_steps_trained_throughput_per_sec": 48.92099182792891, "timesteps_total": 2004000, "num_env_steps_sampled_lifetime": 2004000, "num_agent_steps_sampled_lifetime": 2004000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2004000, "timers": {"training_iteration_time_ms": 218543.384, "restore_workers_time_ms": 0.0, "training_step_time_ms": 218543.384, "sample_time_ms": 184426.33, "load_time_ms": 12.436, "load_throughput": 964925.04, "learn_time_ms": 34094.262, "learn_throughput": 351.965, "synch_weights_time_ms": 9.054}, "counters": {"num_env_steps_sampled": 2004000, "num_env_steps_trained": 2004000, "num_agent_steps_sampled": 2004000, "num_agent_steps_trained": 2004000}, "done": false, "training_iteration": 167, "trial_id": "befd4_00000", "date": "2025-01-23_04-49-25", "timestamp": 1737636565, "time_this_iter_s": 245.2974750995636, "time_total_s": 35514.54686951637, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35514.54686951637, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 9.721587301587302, "ram_util_percent": 51.08285714285714, "gpu_util_percent0": 0.09622222222222222, "vram_util_percent0": 0.18910404265873015}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.58711401069332, "policy_loss": 0.002010924921881768, "vf_loss": 30.0, "vf_explained_var": -0.004944905651019959, "kl": 0.0, "entropy": 41.489694139403284, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 202508.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2016000, "num_env_steps_trained": 2016000, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -803736.6943223359, "episode_reward_mean": -799181.0486701409, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -803736.6943223359}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -799181.0486701409}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-803106.1724047024, -803185.5098042975, -802080.3681311512, -802151.9594842764, -799062.9912408941, -799116.9775144111, -802128.3470464668, -802163.5538986834, -800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9638229269253022, "mean_inference_ms": 4.428719321255685, "mean_action_processing_ms": 0.7779460780952305, "mean_env_wait_ms": 105.22428797365676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08800244331359863, "StateBufferConnector_ms": 0.0319972038269043, "ViewRequirementAgentConnector_ms": 0.13121390342712402}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -803736.6943223359, "episode_return_mean": -799181.0486701409, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000, "num_env_steps_sampled": 2016000, "num_env_steps_trained": 2016000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 47.772304495592465, "num_env_steps_trained_throughput_per_sec": 47.772304495592465, "timesteps_total": 2016000, "num_env_steps_sampled_lifetime": 2016000, "num_agent_steps_sampled_lifetime": 2016000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2016000, "timers": {"training_iteration_time_ms": 224761.546, "restore_workers_time_ms": 0.0, "training_step_time_ms": 224761.546, "sample_time_ms": 190407.54, "load_time_ms": 13.636, "load_throughput": 879996.223, "learn_time_ms": 34329.815, "learn_throughput": 349.55, "synch_weights_time_ms": 9.054}, "counters": {"num_env_steps_sampled": 2016000, "num_env_steps_trained": 2016000, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000}, "done": false, "training_iteration": 168, "trial_id": "befd4_00000", "date": "2025-01-23_04-53-36", "timestamp": 1737636816, "time_this_iter_s": 251.19556832313538, "time_total_s": 35765.74243783951, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35765.74243783951, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 11.529906542056075, "ram_util_percent": 50.25389408099689, "gpu_util_percent0": 0.1014018691588785, "vram_util_percent0": 0.15828982914719625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.61953624286762, "policy_loss": -0.003956038316879715, "vf_loss": 29.99688890297813, "vf_explained_var": -0.08108213837231557, "kl": 0.0, "entropy": 37.33965893911862, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 203717.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2028000, "num_env_steps_trained": 2028000, "num_agent_steps_sampled": 2028000, "num_agent_steps_trained": 2028000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -799070.3763994733, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -799070.3763994733}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9640617948772617, "mean_inference_ms": 4.428271811478817, "mean_action_processing_ms": 0.7779847450122175, "mean_env_wait_ms": 105.29536966297346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07999730110168457, "StateBufferConnector_ms": 0.034002065658569336, "ViewRequirementAgentConnector_ms": 0.14007139205932617}, "num_episodes": 8, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -799070.3763994733, "episodes_this_iter": 8}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2028000, "num_agent_steps_trained": 2028000, "num_env_steps_sampled": 2028000, "num_env_steps_trained": 2028000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 53.62293934646478, "num_env_steps_trained_throughput_per_sec": 53.62293934646478, "timesteps_total": 2028000, "num_env_steps_sampled_lifetime": 2028000, "num_agent_steps_sampled_lifetime": 2028000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2028000, "timers": {"training_iteration_time_ms": 231077.313, "restore_workers_time_ms": 0.0, "training_step_time_ms": 231077.313, "sample_time_ms": 196532.596, "load_time_ms": 13.937, "load_throughput": 861027.965, "learn_time_ms": 34520.726, "learn_throughput": 347.617, "synch_weights_time_ms": 8.553}, "counters": {"num_env_steps_sampled": 2028000, "num_env_steps_trained": 2028000, "num_agent_steps_sampled": 2028000, "num_agent_steps_trained": 2028000}, "done": false, "training_iteration": 169, "trial_id": "befd4_00000", "date": "2025-01-23_04-57-20", "timestamp": 1737637040, "time_this_iter_s": 223.78981757164001, "time_total_s": 35989.53225541115, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35989.53225541115, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 9.383333333333333, "ram_util_percent": 48.33368055555556, "gpu_util_percent0": 0.07024305555555554, "vram_util_percent0": 0.14409586588541667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.01440459031325, "policy_loss": -0.026234094097704233, "vf_loss": 29.37337907865286, "vf_explained_var": -0.1172681352735256, "kl": 0.0, "entropy": 33.27404219577685, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 204926.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2040000, "num_env_steps_trained": 2040000, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -799070.3763994733, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -799070.3763994733}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9640617948772617, "mean_inference_ms": 4.428271811478817, "mean_action_processing_ms": 0.7779847450122175, "mean_env_wait_ms": 105.29536966297346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07999730110168457, "StateBufferConnector_ms": 0.034002065658569336, "ViewRequirementAgentConnector_ms": 0.14007139205932617}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -799070.3763994733, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000, "num_env_steps_sampled": 2040000, "num_env_steps_trained": 2040000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 67.30139777484474, "num_env_steps_trained_throughput_per_sec": 67.30139777484474, "timesteps_total": 2040000, "num_env_steps_sampled_lifetime": 2040000, "num_agent_steps_sampled_lifetime": 2040000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2040000, "timers": {"training_iteration_time_ms": 230459.909, "restore_workers_time_ms": 0.1, "training_step_time_ms": 230459.808, "sample_time_ms": 195217.925, "load_time_ms": 14.337, "load_throughput": 837009.614, "learn_time_ms": 35217.493, "learn_throughput": 340.74, "synch_weights_time_ms": 8.553}, "counters": {"num_env_steps_sampled": 2040000, "num_env_steps_trained": 2040000, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000}, "done": false, "training_iteration": 170, "trial_id": "befd4_00000", "date": "2025-01-23_05-00-18", "timestamp": 1737637218, "time_this_iter_s": 178.30638813972473, "time_total_s": 36167.83864355087, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 36167.83864355087, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 8.402620087336246, "ram_util_percent": 49.71266375545852, "gpu_util_percent0": 0.11602620087336243, "vram_util_percent0": 0.14659098662663753}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.5766173757927, "policy_loss": 0.0002227139445845996, "vf_loss": 30.0, "vf_explained_var": -0.12279636091787624, "kl": 0.0, "entropy": 42.36053284738949, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 206135.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2052000, "num_env_steps_trained": 2052000, "num_agent_steps_sampled": 2052000, "num_agent_steps_trained": 2052000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -799070.3763994733, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -799070.3763994733}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9640617948772617, "mean_inference_ms": 4.428271811478817, "mean_action_processing_ms": 0.7779847450122175, "mean_env_wait_ms": 105.29536966297346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07999730110168457, "StateBufferConnector_ms": 0.034002065658569336, "ViewRequirementAgentConnector_ms": 0.14007139205932617}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -799070.3763994733, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2052000, "num_agent_steps_trained": 2052000, "num_env_steps_sampled": 2052000, "num_env_steps_trained": 2052000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 57.9509440055116, "num_env_steps_trained_throughput_per_sec": 57.9509440055116, "timesteps_total": 2052000, "num_env_steps_sampled_lifetime": 2052000, "num_agent_steps_sampled_lifetime": 2052000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2052000, "timers": {"training_iteration_time_ms": 231018.59, "restore_workers_time_ms": 0.1, "training_step_time_ms": 231018.49, "sample_time_ms": 195385.929, "load_time_ms": 15.551, "load_throughput": 771655.993, "learn_time_ms": 35606.858, "learn_throughput": 337.014, "synch_weights_time_ms": 8.551}, "counters": {"num_env_steps_sampled": 2052000, "num_env_steps_trained": 2052000, "num_agent_steps_sampled": 2052000, "num_agent_steps_trained": 2052000}, "done": false, "training_iteration": 171, "trial_id": "befd4_00000", "date": "2025-01-23_05-03-45", "timestamp": 1737637425, "time_this_iter_s": 207.0746922492981, "time_total_s": 36374.91333580017, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 36374.91333580017, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 7.189513108614232, "ram_util_percent": 54.595880149812736, "gpu_util_percent0": 0.17146067415730337, "vram_util_percent0": 0.1623602820692884}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.590733076147643, "policy_loss": 0.002390213760588167, "vf_loss": 30.0, "vf_explained_var": -0.09127003560882645, "kl": 0.0, "entropy": 41.165709928602496, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 207344.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2064000, "num_env_steps_trained": 2064000, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -799070.3763994733, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -799070.3763994733}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9640617948772617, "mean_inference_ms": 4.428271811478817, "mean_action_processing_ms": 0.7779847450122175, "mean_env_wait_ms": 105.29536966297346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07999730110168457, "StateBufferConnector_ms": 0.034002065658569336, "ViewRequirementAgentConnector_ms": 0.14007139205932617}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -799070.3763994733, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000, "num_env_steps_sampled": 2064000, "num_env_steps_trained": 2064000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 58.34514712392447, "num_env_steps_trained_throughput_per_sec": 58.34514712392447, "timesteps_total": 2064000, "num_env_steps_sampled_lifetime": 2064000, "num_agent_steps_sampled_lifetime": 2064000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2064000, "timers": {"training_iteration_time_ms": 227166.606, "restore_workers_time_ms": 0.1, "training_step_time_ms": 227166.406, "sample_time_ms": 191577.958, "load_time_ms": 15.051, "load_throughput": 797286.306, "learn_time_ms": 35563.293, "learn_throughput": 337.427, "synch_weights_time_ms": 8.703}, "counters": {"num_env_steps_sampled": 2064000, "num_env_steps_trained": 2064000, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000}, "done": false, "training_iteration": 172, "trial_id": "befd4_00000", "date": "2025-01-23_05-07-11", "timestamp": 1737637631, "time_this_iter_s": 205.67563152313232, "time_total_s": 36580.5889673233, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 36580.5889673233, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 7.987169811320754, "ram_util_percent": 43.194716981132075, "gpu_util_percent0": 0.08237735849056604, "vram_util_percent0": 0.1372037146226415}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.594672094996653, "policy_loss": 0.0028800417240046586, "vf_loss": 30.0, "vf_explained_var": -0.04545124953595738, "kl": 0.0, "entropy": 40.820793038266466, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 208553.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2076000, "num_env_steps_trained": 2076000, "num_agent_steps_sampled": 2076000, "num_agent_steps_trained": 2076000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -799070.3763994733, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -799070.3763994733}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9640617948772617, "mean_inference_ms": 4.428271811478817, "mean_action_processing_ms": 0.7779847450122175, "mean_env_wait_ms": 105.29536966297346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07999730110168457, "StateBufferConnector_ms": 0.034002065658569336, "ViewRequirementAgentConnector_ms": 0.14007139205932617}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -799070.3763994733, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2076000, "num_agent_steps_trained": 2076000, "num_env_steps_sampled": 2076000, "num_env_steps_trained": 2076000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 56.83863471027481, "num_env_steps_trained_throughput_per_sec": 56.83863471027481, "timesteps_total": 2076000, "num_env_steps_sampled_lifetime": 2076000, "num_agent_steps_sampled_lifetime": 2076000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2076000, "timers": {"training_iteration_time_ms": 224054.044, "restore_workers_time_ms": 0.1, "training_step_time_ms": 224053.744, "sample_time_ms": 188787.251, "load_time_ms": 14.85, "load_throughput": 808079.698, "learn_time_ms": 35241.541, "learn_throughput": 340.507, "synch_weights_time_ms": 8.702}, "counters": {"num_env_steps_sampled": 2076000, "num_env_steps_trained": 2076000, "num_agent_steps_sampled": 2076000, "num_agent_steps_trained": 2076000}, "done": false, "training_iteration": 173, "trial_id": "befd4_00000", "date": "2025-01-23_05-10-42", "timestamp": 1737637842, "time_this_iter_s": 211.1280117034912, "time_total_s": 36791.716979026794, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 36791.716979026794, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 7.208823529411765, "ram_util_percent": 43.37830882352941, "gpu_util_percent0": 0.05886029411764705, "vram_util_percent0": 0.13680886661305147}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.59476738985754, "policy_loss": 0.0020354002979148804, "vf_loss": 30.0, "vf_explained_var": -0.03593344595730058, "kl": 0.0, "entropy": 40.72680169950348, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 209762.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2088000, "num_env_steps_trained": 2088000, "num_agent_steps_sampled": 2088000, "num_agent_steps_trained": 2088000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -799070.3763994733, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -799070.3763994733}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9640617948772617, "mean_inference_ms": 4.428271811478817, "mean_action_processing_ms": 0.7779847450122175, "mean_env_wait_ms": 105.29536966297346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07999730110168457, "StateBufferConnector_ms": 0.034002065658569336, "ViewRequirementAgentConnector_ms": 0.14007139205932617}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -799070.3763994733, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2088000, "num_agent_steps_trained": 2088000, "num_env_steps_sampled": 2088000, "num_env_steps_trained": 2088000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 54.989824904746634, "num_env_steps_trained_throughput_per_sec": 54.989824904746634, "timesteps_total": 2088000, "num_env_steps_sampled_lifetime": 2088000, "num_agent_steps_sampled_lifetime": 2088000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2088000, "timers": {"training_iteration_time_ms": 221403.454, "restore_workers_time_ms": 0.1, "training_step_time_ms": 221403.153, "sample_time_ms": 186569.579, "load_time_ms": 15.45, "load_throughput": 776696.594, "learn_time_ms": 34808.123, "learn_throughput": 344.747, "synch_weights_time_ms": 8.501}, "counters": {"num_env_steps_sampled": 2088000, "num_env_steps_trained": 2088000, "num_agent_steps_sampled": 2088000, "num_agent_steps_trained": 2088000}, "done": false, "training_iteration": 174, "trial_id": "befd4_00000", "date": "2025-01-23_05-14-21", "timestamp": 1737638061, "time_this_iter_s": 218.231192111969, "time_total_s": 37009.94817113876, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 37009.94817113876, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 6.91950354609929, "ram_util_percent": 43.063475177304966, "gpu_util_percent0": 0.056099290780141836, "vram_util_percent0": 0.13658403978280143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.594983036997302, "policy_loss": 0.0017477153893637205, "vf_loss": 30.0, "vf_explained_var": -0.029707818409941036, "kl": 0.0, "entropy": 40.67646818894606, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 210971.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2100000, "num_env_steps_trained": 2100000, "num_agent_steps_sampled": 2100000, "num_agent_steps_trained": 2100000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -799070.3763994733, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -799070.3763994733}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9640617948772617, "mean_inference_ms": 4.428271811478817, "mean_action_processing_ms": 0.7779847450122175, "mean_env_wait_ms": 105.29536966297346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07999730110168457, "StateBufferConnector_ms": 0.034002065658569336, "ViewRequirementAgentConnector_ms": 0.14007139205932617}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -799070.3763994733, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2100000, "num_agent_steps_trained": 2100000, "num_env_steps_sampled": 2100000, "num_env_steps_trained": 2100000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 53.538738411140066, "num_env_steps_trained_throughput_per_sec": 53.538738411140066, "timesteps_total": 2100000, "num_env_steps_sampled_lifetime": 2100000, "num_agent_steps_sampled_lifetime": 2100000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2100000, "timers": {"training_iteration_time_ms": 220066.025, "restore_workers_time_ms": 0.1, "training_step_time_ms": 220065.725, "sample_time_ms": 185738.2, "load_time_ms": 15.35, "load_throughput": 781769.478, "learn_time_ms": 34302.174, "learn_throughput": 349.832, "synch_weights_time_ms": 8.501}, "counters": {"num_env_steps_sampled": 2100000, "num_env_steps_trained": 2100000, "num_agent_steps_sampled": 2100000, "num_agent_steps_trained": 2100000}, "done": false, "training_iteration": 175, "trial_id": "befd4_00000", "date": "2025-01-23_05-18-05", "timestamp": 1737638285, "time_this_iter_s": 224.14077401161194, "time_total_s": 37234.088945150375, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 37234.088945150375, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 6.789965397923876, "ram_util_percent": 43.04982698961938, "gpu_util_percent0": 0.055155709342560554, "vram_util_percent0": 0.13662109375000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.596402391507866, "policy_loss": 0.001987656891173425, "vf_loss": 30.0, "vf_explained_var": -0.018347040447348695, "kl": 0.0, "entropy": 40.55852459954072, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 212180.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2112000, "num_env_steps_trained": 2112000, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -799070.3763994733, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -799070.3763994733}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9640617948772617, "mean_inference_ms": 4.428271811478817, "mean_action_processing_ms": 0.7779847450122175, "mean_env_wait_ms": 105.29536966297346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07999730110168457, "StateBufferConnector_ms": 0.034002065658569336, "ViewRequirementAgentConnector_ms": 0.14007139205932617}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -799070.3763994733, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000, "num_env_steps_sampled": 2112000, "num_env_steps_trained": 2112000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.71716111405518, "num_env_steps_trained_throughput_per_sec": 52.71716111405518, "timesteps_total": 2112000, "num_env_steps_sampled_lifetime": 2112000, "num_agent_steps_sampled_lifetime": 2112000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2112000, "timers": {"training_iteration_time_ms": 219242.94, "restore_workers_time_ms": 0.1, "training_step_time_ms": 219242.54, "sample_time_ms": 185245.98, "load_time_ms": 15.15, "load_throughput": 792084.264, "learn_time_ms": 33971.31, "learn_throughput": 353.239, "synch_weights_time_ms": 8.7}, "counters": {"num_env_steps_sampled": 2112000, "num_env_steps_trained": 2112000, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000}, "done": false, "training_iteration": 176, "trial_id": "befd4_00000", "date": "2025-01-23_05-21-52", "timestamp": 1737638512, "time_this_iter_s": 227.63386511802673, "time_total_s": 37461.7228102684, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 37461.7228102684, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 6.840273037542663, "ram_util_percent": 43.108532423208196, "gpu_util_percent0": 0.054470989761092166, "vram_util_percent0": 0.13660309566979523}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.597667182941294, "policy_loss": 0.003470881439196955, "vf_loss": 30.0, "vf_explained_var": -0.014999792633025089, "kl": 0.0, "entropy": 40.58036820922044, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 213389.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2124000, "num_env_steps_trained": 2124000, "num_agent_steps_sampled": 2124000, "num_agent_steps_trained": 2124000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -799070.3763994733, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -799070.3763994733}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9640617948772617, "mean_inference_ms": 4.428271811478817, "mean_action_processing_ms": 0.7779847450122175, "mean_env_wait_ms": 105.29536966297346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07999730110168457, "StateBufferConnector_ms": 0.034002065658569336, "ViewRequirementAgentConnector_ms": 0.14007139205932617}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -799070.3763994733, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2124000, "num_agent_steps_trained": 2124000, "num_env_steps_sampled": 2124000, "num_env_steps_trained": 2124000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 52.885272286549366, "num_env_steps_trained_throughput_per_sec": 52.885272286549366, "timesteps_total": 2124000, "num_env_steps_sampled_lifetime": 2124000, "num_agent_steps_sampled_lifetime": 2124000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2124000, "timers": {"training_iteration_time_ms": 217404.22, "restore_workers_time_ms": 0.1, "training_step_time_ms": 217403.82, "sample_time_ms": 183730.489, "load_time_ms": 14.999, "load_throughput": 800028.738, "learn_time_ms": 33649.232, "learn_throughput": 356.62, "synch_weights_time_ms": 7.6}, "counters": {"num_env_steps_sampled": 2124000, "num_env_steps_trained": 2124000, "num_agent_steps_sampled": 2124000, "num_agent_steps_trained": 2124000}, "done": false, "training_iteration": 177, "trial_id": "befd4_00000", "date": "2025-01-23_05-25-39", "timestamp": 1737638739, "time_this_iter_s": 226.90927290916443, "time_total_s": 37688.63208317757, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 37688.63208317757, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 6.803082191780821, "ram_util_percent": 43.12842465753425, "gpu_util_percent0": 0.05397260273972604, "vram_util_percent0": 0.1365849743150685}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.597556818606343, "policy_loss": 0.003052682578070682, "vf_loss": 30.0, "vf_explained_var": -0.010875457076616185, "kl": 0.0, "entropy": 40.549595794172895, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 214598.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2136000, "num_env_steps_trained": 2136000, "num_agent_steps_sampled": 2136000, "num_agent_steps_trained": 2136000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -799070.3763994733, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -799070.3763994733}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9640617948772617, "mean_inference_ms": 4.428271811478817, "mean_action_processing_ms": 0.7779847450122175, "mean_env_wait_ms": 105.29536966297346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07999730110168457, "StateBufferConnector_ms": 0.034002065658569336, "ViewRequirementAgentConnector_ms": 0.14007139205932617}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -799070.3763994733, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2136000, "num_agent_steps_trained": 2136000, "num_env_steps_sampled": 2136000, "num_env_steps_trained": 2136000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 49.69171937950713, "num_env_steps_trained_throughput_per_sec": 49.69171937950713, "timesteps_total": 2136000, "num_env_steps_sampled_lifetime": 2136000, "num_agent_steps_sampled_lifetime": 2136000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2136000, "timers": {"training_iteration_time_ms": 216433.956, "restore_workers_time_ms": 0.1, "training_step_time_ms": 216433.556, "sample_time_ms": 182700.918, "load_time_ms": 13.199, "load_throughput": 909133.813, "learn_time_ms": 33710.438, "learn_throughput": 355.973, "synch_weights_time_ms": 7.7}, "counters": {"num_env_steps_sampled": 2136000, "num_env_steps_trained": 2136000, "num_agent_steps_sampled": 2136000, "num_agent_steps_trained": 2136000}, "done": false, "training_iteration": 178, "trial_id": "befd4_00000", "date": "2025-01-23_05-29-41", "timestamp": 1737638981, "time_this_iter_s": 241.4929220676422, "time_total_s": 37930.12500524521, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 37930.12500524521, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 7.492282958199357, "ram_util_percent": 44.65048231511254, "gpu_util_percent0": 0.07167202572347266, "vram_util_percent0": 0.13890800844051446}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.595948002375877, "policy_loss": 0.002019929148817575, "vf_loss": 30.0, "vf_explained_var": -0.009786593411164012, "kl": 0.0, "entropy": 40.60719459918632, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 215807.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2148000, "num_env_steps_trained": 2148000, "num_agent_steps_sampled": 2148000, "num_agent_steps_trained": 2148000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -799070.3763994733, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -799070.3763994733}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-800453.8478922385, -800534.0447723849, -799579.293377483, -799617.4727643527, -802199.210746044, -802250.2184281953, -798883.7827245467, -799039.5332734425, -801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9640617948772617, "mean_inference_ms": 4.428271811478817, "mean_action_processing_ms": 0.7779847450122175, "mean_env_wait_ms": 105.29536966297346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07999730110168457, "StateBufferConnector_ms": 0.034002065658569336, "ViewRequirementAgentConnector_ms": 0.14007139205932617}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -799070.3763994733, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2148000, "num_agent_steps_trained": 2148000, "num_env_steps_sampled": 2148000, "num_env_steps_trained": 2148000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 49.674812018649206, "num_env_steps_trained_throughput_per_sec": 49.674812018649206, "timesteps_total": 2148000, "num_env_steps_sampled_lifetime": 2148000, "num_agent_steps_sampled_lifetime": 2148000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2148000, "timers": {"training_iteration_time_ms": 218212.586, "restore_workers_time_ms": 0.1, "training_step_time_ms": 218212.186, "sample_time_ms": 184174.063, "load_time_ms": 13.199, "load_throughput": 909130.529, "learn_time_ms": 34015.824, "learn_throughput": 352.777, "synch_weights_time_ms": 7.7}, "counters": {"num_env_steps_sampled": 2148000, "num_env_steps_trained": 2148000, "num_agent_steps_sampled": 2148000, "num_agent_steps_trained": 2148000}, "done": false, "training_iteration": 179, "trial_id": "befd4_00000", "date": "2025-01-23_05-33-43", "timestamp": 1737639223, "time_this_iter_s": 241.57512068748474, "time_total_s": 38171.70012593269, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 38171.70012593269, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 8.278456591639873, "ram_util_percent": 46.32090032154341, "gpu_util_percent0": 0.11167202572347268, "vram_util_percent0": 0.14860392383440515}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.595405453980906, "policy_loss": 0.0030447244212783203, "vf_loss": 30.0, "vf_explained_var": -0.009428398337021063, "kl": 0.0, "entropy": 40.76392652260754, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 217016.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2160000, "num_env_steps_trained": 2160000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -798886.1867362406, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -798886.1867362406}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9644153475401179, "mean_inference_ms": 4.429046374189502, "mean_action_processing_ms": 0.7782117505706707, "mean_env_wait_ms": 105.35345972607364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08398795127868652, "StateBufferConnector_ms": 0.03600144386291504, "ViewRequirementAgentConnector_ms": 0.14005088806152344}, "num_episodes": 8, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -798886.1867362406, "episodes_this_iter": 8}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000, "num_env_steps_sampled": 2160000, "num_env_steps_trained": 2160000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 47.461064426991676, "num_env_steps_trained_throughput_per_sec": 47.461064426991676, "timesteps_total": 2160000, "num_env_steps_sampled_lifetime": 2160000, "num_agent_steps_sampled_lifetime": 2160000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2160000, "timers": {"training_iteration_time_ms": 225666.23, "restore_workers_time_ms": 0.0, "training_step_time_ms": 225665.93, "sample_time_ms": 191892.184, "load_time_ms": 13.199, "load_throughput": 909130.529, "learn_time_ms": 33751.246, "learn_throughput": 355.542, "synch_weights_time_ms": 7.8}, "counters": {"num_env_steps_sampled": 2160000, "num_env_steps_trained": 2160000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "done": false, "training_iteration": 180, "trial_id": "befd4_00000", "date": "2025-01-23_05-37-55", "timestamp": 1737639475, "time_this_iter_s": 252.8428235054016, "time_total_s": 38424.542949438095, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 38424.542949438095, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 10.854629629629628, "ram_util_percent": 47.443827160493825, "gpu_util_percent0": 0.09641975308641976, "vram_util_percent0": 0.15414436246141974}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 28.632006119064698, "policy_loss": -0.02240882192432535, "vf_loss": 28.93171041439741, "vf_explained_var": -0.2523066953157373, "kl": 0.0, "entropy": 27.72954207042508, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 218225.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2172000, "num_env_steps_trained": 2172000, "num_agent_steps_sampled": 2172000, "num_agent_steps_trained": 2172000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -798886.1867362406, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -798886.1867362406}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9644153475401179, "mean_inference_ms": 4.429046374189502, "mean_action_processing_ms": 0.7782117505706707, "mean_env_wait_ms": 105.35345972607364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08398795127868652, "StateBufferConnector_ms": 0.03600144386291504, "ViewRequirementAgentConnector_ms": 0.14005088806152344}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -798886.1867362406, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2172000, "num_agent_steps_trained": 2172000, "num_env_steps_sampled": 2172000, "num_env_steps_trained": 2172000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 74.11616266535766, "num_env_steps_trained_throughput_per_sec": 74.11616266535766, "timesteps_total": 2172000, "num_env_steps_sampled_lifetime": 2172000, "num_agent_steps_sampled_lifetime": 2172000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2172000, "timers": {"training_iteration_time_ms": 221149.861, "restore_workers_time_ms": 0.0, "training_step_time_ms": 221149.561, "sample_time_ms": 187367.076, "load_time_ms": 11.999, "load_throughput": 1000060.562, "learn_time_ms": 33760.536, "learn_throughput": 355.445, "synch_weights_time_ms": 8.55}, "counters": {"num_env_steps_sampled": 2172000, "num_env_steps_trained": 2172000, "num_agent_steps_sampled": 2172000, "num_agent_steps_trained": 2172000}, "done": false, "training_iteration": 181, "trial_id": "befd4_00000", "date": "2025-01-23_05-40-37", "timestamp": 1737639637, "time_this_iter_s": 161.91353559494019, "time_total_s": 38586.456485033035, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 38586.456485033035, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 4.689473684210527, "ram_util_percent": 47.37368421052631, "gpu_util_percent0": 0.1623444976076555, "vram_util_percent0": 0.1584288090610048}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.56618320064371, "policy_loss": -0.0049939208191790985, "vf_loss": 30.0, "vf_explained_var": -0.0936950944592087, "kl": 0.0, "entropy": 42.88228764940235, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 219434.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2184000, "num_env_steps_trained": 2184000, "num_agent_steps_sampled": 2184000, "num_agent_steps_trained": 2184000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -798886.1867362406, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -798886.1867362406}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9644153475401179, "mean_inference_ms": 4.429046374189502, "mean_action_processing_ms": 0.7782117505706707, "mean_env_wait_ms": 105.35345972607364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08398795127868652, "StateBufferConnector_ms": 0.03600144386291504, "ViewRequirementAgentConnector_ms": 0.14005088806152344}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -798886.1867362406, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2184000, "num_agent_steps_trained": 2184000, "num_env_steps_sampled": 2184000, "num_env_steps_trained": 2184000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 62.538245799330625, "num_env_steps_trained_throughput_per_sec": 62.538245799330625, "timesteps_total": 2184000, "num_env_steps_sampled_lifetime": 2184000, "num_agent_steps_sampled_lifetime": 2184000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2184000, "timers": {"training_iteration_time_ms": 219770.856, "restore_workers_time_ms": 0.0, "training_step_time_ms": 219770.656, "sample_time_ms": 185842.587, "load_time_ms": 12.499, "load_throughput": 960060.429, "learn_time_ms": 33905.271, "learn_throughput": 353.927, "synch_weights_time_ms": 8.698}, "counters": {"num_env_steps_sampled": 2184000, "num_env_steps_trained": 2184000, "num_agent_steps_sampled": 2184000, "num_agent_steps_trained": 2184000}, "done": false, "training_iteration": 182, "trial_id": "befd4_00000", "date": "2025-01-23_05-43-49", "timestamp": 1737639829, "time_this_iter_s": 191.88758063316345, "time_total_s": 38778.3440656662, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 38778.3440656662, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 8.30650406504065, "ram_util_percent": 47.74918699186993, "gpu_util_percent0": 0.10743902439024391, "vram_util_percent0": 0.15935912093495933}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.577363112822756, "policy_loss": 0.0033946640086972685, "vf_loss": 30.0, "vf_explained_var": -0.07413245741250202, "kl": 0.0, "entropy": 42.60315456027527, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 220643.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2196000, "num_env_steps_trained": 2196000, "num_agent_steps_sampled": 2196000, "num_agent_steps_trained": 2196000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -798886.1867362406, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -798886.1867362406}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9644153475401179, "mean_inference_ms": 4.429046374189502, "mean_action_processing_ms": 0.7782117505706707, "mean_env_wait_ms": 105.35345972607364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08398795127868652, "StateBufferConnector_ms": 0.03600144386291504, "ViewRequirementAgentConnector_ms": 0.14005088806152344}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -798886.1867362406, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2196000, "num_agent_steps_trained": 2196000, "num_env_steps_sampled": 2196000, "num_env_steps_trained": 2196000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 55.61492205291291, "num_env_steps_trained_throughput_per_sec": 55.61492205291291, "timesteps_total": 2196000, "num_env_steps_sampled_lifetime": 2196000, "num_agent_steps_sampled_lifetime": 2196000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2196000, "timers": {"training_iteration_time_ms": 220235.399, "restore_workers_time_ms": 0.0, "training_step_time_ms": 220235.299, "sample_time_ms": 185893.909, "load_time_ms": 12.699, "load_throughput": 944943.283, "learn_time_ms": 34318.289, "learn_throughput": 349.668, "synch_weights_time_ms": 8.7}, "counters": {"num_env_steps_sampled": 2196000, "num_env_steps_trained": 2196000, "num_agent_steps_sampled": 2196000, "num_agent_steps_trained": 2196000}, "done": false, "training_iteration": 183, "trial_id": "befd4_00000", "date": "2025-01-23_05-47-25", "timestamp": 1737640045, "time_this_iter_s": 215.77342629432678, "time_total_s": 38994.117491960526, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 38994.117491960526, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 12.165703971119134, "ram_util_percent": 48.72779783393503, "gpu_util_percent0": 0.09487364620938629, "vram_util_percent0": 0.159830846683213}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.58003042866318, "policy_loss": 0.004351427435036826, "vf_loss": 30.0, "vf_explained_var": -0.051561998127904976, "kl": 0.0, "entropy": 42.432102894368896, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 221852.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2208000, "num_env_steps_trained": 2208000, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -798886.1867362406, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -798886.1867362406}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9644153475401179, "mean_inference_ms": 4.429046374189502, "mean_action_processing_ms": 0.7782117505706707, "mean_env_wait_ms": 105.35345972607364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08398795127868652, "StateBufferConnector_ms": 0.03600144386291504, "ViewRequirementAgentConnector_ms": 0.14005088806152344}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -798886.1867362406, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000, "num_env_steps_sampled": 2208000, "num_env_steps_trained": 2208000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 51.46184359143778, "num_env_steps_trained_throughput_per_sec": 51.46184359143778, "timesteps_total": 2208000, "num_env_steps_sampled_lifetime": 2208000, "num_agent_steps_sampled_lifetime": 2208000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2208000, "timers": {"training_iteration_time_ms": 221731.427, "restore_workers_time_ms": 0.0, "training_step_time_ms": 221731.327, "sample_time_ms": 187022.589, "load_time_ms": 12.8, "load_throughput": 937487.623, "learn_time_ms": 34685.536, "learn_throughput": 345.966, "synch_weights_time_ms": 8.8}, "counters": {"num_env_steps_sampled": 2208000, "num_env_steps_trained": 2208000, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000}, "done": false, "training_iteration": 184, "trial_id": "befd4_00000", "date": "2025-01-23_05-51-18", "timestamp": 1737640278, "time_this_iter_s": 233.18647575378418, "time_total_s": 39227.30396771431, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 39227.30396771431, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 13.568, "ram_util_percent": 49.336666666666666, "gpu_util_percent0": 0.1058, "vram_util_percent0": 0.15511848958333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.580362375163165, "policy_loss": 0.0028567201249159696, "vf_loss": 30.0, "vf_explained_var": -0.0457843752120328, "kl": 0.0, "entropy": 42.249435566790936, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 223061.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2220000, "num_env_steps_trained": 2220000, "num_agent_steps_sampled": 2220000, "num_agent_steps_trained": 2220000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -798886.1867362406, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -798886.1867362406}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9644153475401179, "mean_inference_ms": 4.429046374189502, "mean_action_processing_ms": 0.7782117505706707, "mean_env_wait_ms": 105.35345972607364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08398795127868652, "StateBufferConnector_ms": 0.03600144386291504, "ViewRequirementAgentConnector_ms": 0.14005088806152344}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -798886.1867362406, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2220000, "num_agent_steps_trained": 2220000, "num_env_steps_sampled": 2220000, "num_env_steps_trained": 2220000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 50.43825424373129, "num_env_steps_trained_throughput_per_sec": 50.43825424373129, "timesteps_total": 2220000, "num_env_steps_sampled_lifetime": 2220000, "num_agent_steps_sampled_lifetime": 2220000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2220000, "timers": {"training_iteration_time_ms": 223109.216, "restore_workers_time_ms": 0.0, "training_step_time_ms": 223109.116, "sample_time_ms": 187967.051, "load_time_ms": 12.861, "load_throughput": 933087.04, "learn_time_ms": 35118.802, "learn_throughput": 341.697, "synch_weights_time_ms": 8.9}, "counters": {"num_env_steps_sampled": 2220000, "num_env_steps_trained": 2220000, "num_agent_steps_sampled": 2220000, "num_agent_steps_trained": 2220000}, "done": false, "training_iteration": 185, "trial_id": "befd4_00000", "date": "2025-01-23_05-55-16", "timestamp": 1737640516, "time_this_iter_s": 237.91865515708923, "time_total_s": 39465.2226228714, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 39465.2226228714, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 12.732026143790849, "ram_util_percent": 48.7297385620915, "gpu_util_percent0": 0.09133986928104576, "vram_util_percent0": 0.14762242136437911}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.580902773255254, "policy_loss": 0.0039387759871971914, "vf_loss": 30.0, "vf_explained_var": -0.03822606821707007, "kl": 0.0, "entropy": 42.30360748316258, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 224270.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2232000, "num_env_steps_trained": 2232000, "num_agent_steps_sampled": 2232000, "num_agent_steps_trained": 2232000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -798886.1867362406, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -798886.1867362406}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9644153475401179, "mean_inference_ms": 4.429046374189502, "mean_action_processing_ms": 0.7782117505706707, "mean_env_wait_ms": 105.35345972607364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08398795127868652, "StateBufferConnector_ms": 0.03600144386291504, "ViewRequirementAgentConnector_ms": 0.14005088806152344}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -798886.1867362406, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2232000, "num_agent_steps_trained": 2232000, "num_env_steps_sampled": 2232000, "num_env_steps_trained": 2232000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 48.623986574121275, "num_env_steps_trained_throughput_per_sec": 48.623986574121275, "timesteps_total": 2232000, "num_env_steps_sampled_lifetime": 2232000, "num_agent_steps_sampled_lifetime": 2232000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2232000, "timers": {"training_iteration_time_ms": 225025.407, "restore_workers_time_ms": 0.0, "training_step_time_ms": 225025.407, "sample_time_ms": 189468.574, "load_time_ms": 12.961, "load_throughput": 925889.813, "learn_time_ms": 35533.369, "learn_throughput": 337.711, "synch_weights_time_ms": 8.902}, "counters": {"num_env_steps_sampled": 2232000, "num_env_steps_trained": 2232000, "num_agent_steps_sampled": 2232000, "num_agent_steps_trained": 2232000}, "done": false, "training_iteration": 186, "trial_id": "befd4_00000", "date": "2025-01-23_05-59-23", "timestamp": 1737640763, "time_this_iter_s": 246.79577088356018, "time_total_s": 39712.01839375496, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 39712.01839375496, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 14.272955974842768, "ram_util_percent": 49.57610062893082, "gpu_util_percent0": 0.09663522012578615, "vram_util_percent0": 0.1464266411163522}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.58103552882192, "policy_loss": 0.0027691048744840994, "vf_loss": 30.0, "vf_explained_var": -0.029133623941956323, "kl": 0.0, "entropy": 42.17335758887607, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 225479.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2244000, "num_env_steps_trained": 2244000, "num_agent_steps_sampled": 2244000, "num_agent_steps_trained": 2244000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -798886.1867362406, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -798886.1867362406}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9644153475401179, "mean_inference_ms": 4.429046374189502, "mean_action_processing_ms": 0.7782117505706707, "mean_env_wait_ms": 105.35345972607364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08398795127868652, "StateBufferConnector_ms": 0.03600144386291504, "ViewRequirementAgentConnector_ms": 0.14005088806152344}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -798886.1867362406, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2244000, "num_agent_steps_trained": 2244000, "num_env_steps_sampled": 2244000, "num_env_steps_trained": 2244000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 46.601394543244446, "num_env_steps_trained_throughput_per_sec": 46.601394543244446, "timesteps_total": 2244000, "num_env_steps_sampled_lifetime": 2244000, "num_agent_steps_sampled_lifetime": 2244000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2244000, "timers": {"training_iteration_time_ms": 228085.082, "restore_workers_time_ms": 0.0, "training_step_time_ms": 228084.983, "sample_time_ms": 191915.372, "load_time_ms": 13.36, "load_throughput": 898179.573, "learn_time_ms": 36145.646, "learn_throughput": 331.99, "synch_weights_time_ms": 9.102}, "counters": {"num_env_steps_sampled": 2244000, "num_env_steps_trained": 2244000, "num_agent_steps_sampled": 2244000, "num_agent_steps_trained": 2244000}, "done": false, "training_iteration": 187, "trial_id": "befd4_00000", "date": "2025-01-23_06-03-41", "timestamp": 1737641021, "time_this_iter_s": 257.50702261924744, "time_total_s": 39969.52541637421, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 39969.52541637421, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 16.099999999999998, "ram_util_percent": 50.674698795180724, "gpu_util_percent0": 0.08499999999999999, "vram_util_percent0": 0.15033532567771082}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.581926806491698, "policy_loss": 0.0035053723059576144, "vf_loss": 30.0, "vf_explained_var": -0.01525379183669047, "kl": 0.0, "entropy": 42.15785898188109, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 226688.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2256000, "num_env_steps_trained": 2256000, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -798886.1867362406, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -798886.1867362406}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9644153475401179, "mean_inference_ms": 4.429046374189502, "mean_action_processing_ms": 0.7782117505706707, "mean_env_wait_ms": 105.35345972607364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08398795127868652, "StateBufferConnector_ms": 0.03600144386291504, "ViewRequirementAgentConnector_ms": 0.14005088806152344}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -798886.1867362406, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000, "num_env_steps_sampled": 2256000, "num_env_steps_trained": 2256000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 46.51237786090551, "num_env_steps_trained_throughput_per_sec": 46.51237786090551, "timesteps_total": 2256000, "num_env_steps_sampled_lifetime": 2256000, "num_agent_steps_sampled_lifetime": 2256000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2256000, "timers": {"training_iteration_time_ms": 229735.774, "restore_workers_time_ms": 0.0, "training_step_time_ms": 229735.674, "sample_time_ms": 193690.938, "load_time_ms": 14.06, "load_throughput": 853473.692, "learn_time_ms": 36019.972, "learn_throughput": 333.149, "synch_weights_time_ms": 9.202}, "counters": {"num_env_steps_sampled": 2256000, "num_env_steps_trained": 2256000, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000}, "done": false, "training_iteration": 188, "trial_id": "befd4_00000", "date": "2025-01-23_06-07-59", "timestamp": 1737641279, "time_this_iter_s": 257.99983954429626, "time_total_s": 40227.5252559185, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 40227.5252559185, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 15.620241691842898, "ram_util_percent": 51.1380664652568, "gpu_util_percent0": 0.09773413897280969, "vram_util_percent0": 0.1510146218844411}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.580802231213593, "policy_loss": 0.0035839016226523173, "vf_loss": 30.0, "vf_explained_var": -0.00849768378894323, "kl": 0.0, "entropy": 42.278171993662646, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 227897.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2268000, "num_env_steps_trained": 2268000, "num_agent_steps_sampled": 2268000, "num_agent_steps_trained": 2268000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -798886.1867362406, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -798886.1867362406}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9644153475401179, "mean_inference_ms": 4.429046374189502, "mean_action_processing_ms": 0.7782117505706707, "mean_env_wait_ms": 105.35345972607364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08398795127868652, "StateBufferConnector_ms": 0.03600144386291504, "ViewRequirementAgentConnector_ms": 0.14005088806152344}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -798886.1867362406, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2268000, "num_agent_steps_trained": 2268000, "num_env_steps_sampled": 2268000, "num_env_steps_trained": 2268000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 36.56812171166729, "num_env_steps_trained_throughput_per_sec": 36.56812171166729, "timesteps_total": 2268000, "num_env_steps_sampled_lifetime": 2268000, "num_agent_steps_sampled_lifetime": 2268000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2268000, "timers": {"training_iteration_time_ms": 238394.129, "restore_workers_time_ms": 0.0, "training_step_time_ms": 238393.929, "sample_time_ms": 202463.566, "load_time_ms": 13.96, "load_throughput": 859625.043, "learn_time_ms": 35905.499, "learn_throughput": 334.211, "synch_weights_time_ms": 9.502}, "counters": {"num_env_steps_sampled": 2268000, "num_env_steps_trained": 2268000, "num_agent_steps_sampled": 2268000, "num_agent_steps_trained": 2268000}, "done": false, "training_iteration": 189, "trial_id": "befd4_00000", "date": "2025-01-23_06-13-27", "timestamp": 1737641607, "time_this_iter_s": 328.15967202186584, "time_total_s": 40555.68492794037, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 40555.68492794037, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 49.677283950617294, "ram_util_percent": 53.67481481481482, "gpu_util_percent0": 0.13822222222222222, "vram_util_percent0": 0.15214457947530866}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.581532763093833, "policy_loss": 0.0038896551951950894, "vf_loss": 30.0, "vf_explained_var": -0.006005320103332166, "kl": 0.0, "entropy": 42.23569056256139, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 229106.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2280000, "num_env_steps_trained": 2280000, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -798886.1867362406, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -798886.1867362406}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9644153475401179, "mean_inference_ms": 4.429046374189502, "mean_action_processing_ms": 0.7782117505706707, "mean_env_wait_ms": 105.35345972607364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08398795127868652, "StateBufferConnector_ms": 0.03600144386291504, "ViewRequirementAgentConnector_ms": 0.14005088806152344}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -798886.1867362406, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000, "num_env_steps_sampled": 2280000, "num_env_steps_trained": 2280000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 47.916022940149674, "num_env_steps_trained_throughput_per_sec": 47.916022940149674, "timesteps_total": 2280000, "num_env_steps_sampled_lifetime": 2280000, "num_agent_steps_sampled_lifetime": 2280000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2280000, "timers": {"training_iteration_time_ms": 238154.061, "restore_workers_time_ms": 0.0, "training_step_time_ms": 238153.861, "sample_time_ms": 202097.671, "load_time_ms": 13.759, "load_throughput": 872128.127, "learn_time_ms": 36031.627, "learn_throughput": 333.041, "synch_weights_time_ms": 9.503}, "counters": {"num_env_steps_sampled": 2280000, "num_env_steps_trained": 2280000, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000}, "done": false, "training_iteration": 190, "trial_id": "befd4_00000", "date": "2025-01-23_06-17-38", "timestamp": 1737641858, "time_this_iter_s": 250.44214725494385, "time_total_s": 40806.12707519531, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 40806.12707519531, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 14.650773993808048, "ram_util_percent": 51.1687306501548, "gpu_util_percent0": 0.07820433436532508, "vram_util_percent0": 0.1455688854489164}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.580470391992108, "policy_loss": 0.0025941430382288816, "vf_loss": 30.0, "vf_explained_var": -0.0030684425280644344, "kl": 0.0, "entropy": 42.21238010239266, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 230315.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2292000, "num_env_steps_trained": 2292000, "num_agent_steps_sampled": 2292000, "num_agent_steps_trained": 2292000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -798886.1867362406, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -798886.1867362406}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-801921.6256321925, -802061.4625563009, -802836.6533961897, -802930.3231463758, -798727.7930209836, -798852.4408911688, -799872.4277301095, -799899.5741555709, -800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9644153475401179, "mean_inference_ms": 4.429046374189502, "mean_action_processing_ms": 0.7782117505706707, "mean_env_wait_ms": 105.35345972607364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08398795127868652, "StateBufferConnector_ms": 0.03600144386291504, "ViewRequirementAgentConnector_ms": 0.14005088806152344}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -798886.1867362406, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2292000, "num_agent_steps_trained": 2292000, "num_env_steps_sampled": 2292000, "num_env_steps_trained": 2292000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 51.33097780098873, "num_env_steps_trained_throughput_per_sec": 51.33097780098873, "timesteps_total": 2292000, "num_env_steps_sampled_lifetime": 2292000, "num_agent_steps_sampled_lifetime": 2292000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2292000, "timers": {"training_iteration_time_ms": 245340.956, "restore_workers_time_ms": 0.0, "training_step_time_ms": 245340.756, "sample_time_ms": 209499.013, "load_time_ms": 14.36, "load_throughput": 835661.609, "learn_time_ms": 35817.28, "learn_throughput": 335.034, "synch_weights_time_ms": 8.702}, "counters": {"num_env_steps_sampled": 2292000, "num_env_steps_trained": 2292000, "num_agent_steps_sampled": 2292000, "num_agent_steps_trained": 2292000}, "done": false, "training_iteration": 191, "trial_id": "befd4_00000", "date": "2025-01-23_06-21-31", "timestamp": 1737642091, "time_this_iter_s": 233.779958486557, "time_total_s": 41039.90703368187, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 41039.90703368187, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 9.74784053156146, "ram_util_percent": 47.548172757475086, "gpu_util_percent0": 0.08109634551495015, "vram_util_percent0": 0.145421511627907}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 28.674072025826, "policy_loss": 0.00221889984321752, "vf_loss": 28.95411749177969, "vf_explained_var": -0.27356033225607734, "kl": 0.0, "entropy": 28.22644165865738, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 231524.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2304000, "num_env_steps_trained": 2304000, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -798877.2522679754, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -798877.2522679754}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9651591130458067, "mean_inference_ms": 4.431892278845543, "mean_action_processing_ms": 0.7788426441553407, "mean_env_wait_ms": 105.45961764913241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0829923152923584, "StateBufferConnector_ms": 0.03800082206726074, "ViewRequirementAgentConnector_ms": 0.1380317211151123}, "num_episodes": 8, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -798877.2522679754, "episodes_this_iter": 8}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000, "num_env_steps_sampled": 2304000, "num_env_steps_trained": 2304000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 68.50393988537161, "num_env_steps_trained_throughput_per_sec": 68.50393988537161, "timesteps_total": 2304000, "num_env_steps_sampled_lifetime": 2304000, "num_agent_steps_sampled_lifetime": 2304000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2304000, "timers": {"training_iteration_time_ms": 243669.939, "restore_workers_time_ms": 0.0, "training_step_time_ms": 243669.739, "sample_time_ms": 207737.844, "load_time_ms": 14.46, "load_throughput": 829882.851, "learn_time_ms": 35907.632, "learn_throughput": 334.191, "synch_weights_time_ms": 8.502}, "counters": {"num_env_steps_sampled": 2304000, "num_env_steps_trained": 2304000, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000}, "done": false, "training_iteration": 192, "trial_id": "befd4_00000", "date": "2025-01-23_06-24-27", "timestamp": 1737642267, "time_this_iter_s": 175.17740106582642, "time_total_s": 41215.084434747696, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 41215.084434747696, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 7.069777777777778, "ram_util_percent": 47.03244444444445, "gpu_util_percent0": 0.06942222222222222, "vram_util_percent0": 0.1463841145833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.346523431631233, "policy_loss": -0.01117620732699967, "vf_loss": 29.801899592081707, "vf_explained_var": -0.06485132879220917, "kl": 0.0, "entropy": 44.41999372319805, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 232733.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2316000, "num_env_steps_trained": 2316000, "num_agent_steps_sampled": 2316000, "num_agent_steps_trained": 2316000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -798877.2522679754, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -798877.2522679754}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9651591130458067, "mean_inference_ms": 4.431892278845543, "mean_action_processing_ms": 0.7788426441553407, "mean_env_wait_ms": 105.45961764913241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0829923152923584, "StateBufferConnector_ms": 0.03800082206726074, "ViewRequirementAgentConnector_ms": 0.1380317211151123}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -798877.2522679754, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2316000, "num_agent_steps_trained": 2316000, "num_env_steps_sampled": 2316000, "num_env_steps_trained": 2316000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 61.784818568455975, "num_env_steps_trained_throughput_per_sec": 61.784818568455975, "timesteps_total": 2316000, "num_env_steps_sampled_lifetime": 2316000, "num_agent_steps_sampled_lifetime": 2316000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2316000, "timers": {"training_iteration_time_ms": 241515.243, "restore_workers_time_ms": 0.0, "training_step_time_ms": 241515.043, "sample_time_ms": 205251.645, "load_time_ms": 14.26, "load_throughput": 841527.038, "learn_time_ms": 36239.435, "learn_throughput": 331.131, "synch_weights_time_ms": 8.402}, "counters": {"num_env_steps_sampled": 2316000, "num_env_steps_trained": 2316000, "num_agent_steps_sampled": 2316000, "num_agent_steps_trained": 2316000}, "done": false, "training_iteration": 193, "trial_id": "befd4_00000", "date": "2025-01-23_06-27-41", "timestamp": 1737642461, "time_this_iter_s": 194.22646474838257, "time_total_s": 41409.31089949608, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 41409.31089949608, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 11.703265306122447, "ram_util_percent": 49.00775510204081, "gpu_util_percent0": 0.1025714285714286, "vram_util_percent0": 0.15416972257653064}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.575969022399043, "policy_loss": 0.0015506135550927681, "vf_loss": 30.0, "vf_explained_var": -0.06335579215050532, "kl": 0.0, "entropy": 42.55815668161296, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 233942.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2328000, "num_env_steps_trained": 2328000, "num_agent_steps_sampled": 2328000, "num_agent_steps_trained": 2328000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -798877.2522679754, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -798877.2522679754}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9651591130458067, "mean_inference_ms": 4.431892278845543, "mean_action_processing_ms": 0.7788426441553407, "mean_env_wait_ms": 105.45961764913241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0829923152923584, "StateBufferConnector_ms": 0.03800082206726074, "ViewRequirementAgentConnector_ms": 0.1380317211151123}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -798877.2522679754, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2328000, "num_agent_steps_trained": 2328000, "num_env_steps_sampled": 2328000, "num_env_steps_trained": 2328000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 55.269149529307406, "num_env_steps_trained_throughput_per_sec": 55.269149529307406, "timesteps_total": 2328000, "num_env_steps_sampled_lifetime": 2328000, "num_agent_steps_sampled_lifetime": 2328000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2328000, "timers": {"training_iteration_time_ms": 239908.927, "restore_workers_time_ms": 0.0, "training_step_time_ms": 239908.727, "sample_time_ms": 203536.288, "load_time_ms": 14.258, "load_throughput": 841621.318, "learn_time_ms": 36348.378, "learn_throughput": 330.139, "synch_weights_time_ms": 8.502}, "counters": {"num_env_steps_sampled": 2328000, "num_env_steps_trained": 2328000, "num_agent_steps_sampled": 2328000, "num_agent_steps_trained": 2328000}, "done": false, "training_iteration": 194, "trial_id": "befd4_00000", "date": "2025-01-23_06-31-18", "timestamp": 1737642678, "time_this_iter_s": 217.12331676483154, "time_total_s": 41626.43421626091, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 41626.43421626091, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 14.41899641577061, "ram_util_percent": 49.58888888888889, "gpu_util_percent0": 0.08942652329749103, "vram_util_percent0": 0.15616039426523295}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.57979477092784, "policy_loss": 0.0033659911702939357, "vf_loss": 30.0, "vf_explained_var": -0.037170642313629855, "kl": 0.0, "entropy": 42.357125000681535, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 235151.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2340000, "num_env_steps_trained": 2340000, "num_agent_steps_sampled": 2340000, "num_agent_steps_trained": 2340000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -798877.2522679754, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -798877.2522679754}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9651591130458067, "mean_inference_ms": 4.431892278845543, "mean_action_processing_ms": 0.7788426441553407, "mean_env_wait_ms": 105.45961764913241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0829923152923584, "StateBufferConnector_ms": 0.03800082206726074, "ViewRequirementAgentConnector_ms": 0.1380317211151123}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -798877.2522679754, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2340000, "num_agent_steps_trained": 2340000, "num_env_steps_sampled": 2340000, "num_env_steps_trained": 2340000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 49.052072354082554, "num_env_steps_trained_throughput_per_sec": 49.052072354082554, "timesteps_total": 2340000, "num_env_steps_sampled_lifetime": 2340000, "num_agent_steps_sampled_lifetime": 2340000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2340000, "timers": {"training_iteration_time_ms": 240581.259, "restore_workers_time_ms": 0.0, "training_step_time_ms": 240581.06, "sample_time_ms": 203837.755, "load_time_ms": 14.249, "load_throughput": 842152.212, "learn_time_ms": 36719.261, "learn_throughput": 326.804, "synch_weights_time_ms": 8.394}, "counters": {"num_env_steps_sampled": 2340000, "num_env_steps_trained": 2340000, "num_agent_steps_sampled": 2340000, "num_agent_steps_trained": 2340000}, "done": false, "training_iteration": 195, "trial_id": "befd4_00000", "date": "2025-01-23_06-35-23", "timestamp": 1737642923, "time_this_iter_s": 244.64198207855225, "time_total_s": 41871.07619833946, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 41871.07619833946, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 15.236942675159234, "ram_util_percent": 50.87070063694268, "gpu_util_percent0": 0.0913375796178344, "vram_util_percent0": 0.15425022392515925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.579699685891075, "policy_loss": 0.0027048158820647656, "vf_loss": 30.0, "vf_explained_var": -0.012272302280091569, "kl": 0.0, "entropy": 42.30051417070741, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 236360.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2352000, "num_env_steps_trained": 2352000, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -798877.2522679754, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -798877.2522679754}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9651591130458067, "mean_inference_ms": 4.431892278845543, "mean_action_processing_ms": 0.7788426441553407, "mean_env_wait_ms": 105.45961764913241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0829923152923584, "StateBufferConnector_ms": 0.03800082206726074, "ViewRequirementAgentConnector_ms": 0.1380317211151123}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -798877.2522679754, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000, "num_env_steps_sampled": 2352000, "num_env_steps_trained": 2352000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 49.50648080975731, "num_env_steps_trained_throughput_per_sec": 49.50648080975731, "timesteps_total": 2352000, "num_env_steps_sampled_lifetime": 2352000, "num_agent_steps_sampled_lifetime": 2352000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2352000, "timers": {"training_iteration_time_ms": 240141.333, "restore_workers_time_ms": 0.0, "training_step_time_ms": 240141.133, "sample_time_ms": 203497.274, "load_time_ms": 14.229, "load_throughput": 843354.474, "learn_time_ms": 36619.984, "learn_throughput": 327.69, "synch_weights_time_ms": 8.245}, "counters": {"num_env_steps_sampled": 2352000, "num_env_steps_trained": 2352000, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000}, "done": false, "training_iteration": 196, "trial_id": "befd4_00000", "date": "2025-01-23_06-39-25", "timestamp": 1737643165, "time_this_iter_s": 242.39650464057922, "time_total_s": 42113.47270298004, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 42113.47270298004, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 12.881672025723471, "ram_util_percent": 50.39228295819936, "gpu_util_percent0": 0.09488745980707394, "vram_util_percent0": 0.15294036374598072}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.580472957210368, "policy_loss": 0.002580719073268379, "vf_loss": 30.0, "vf_explained_var": -0.008474838940736378, "kl": 0.0, "entropy": 42.21077132560282, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 237569.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2364000, "num_env_steps_trained": 2364000, "num_agent_steps_sampled": 2364000, "num_agent_steps_trained": 2364000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -798877.2522679754, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -798877.2522679754}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9651591130458067, "mean_inference_ms": 4.431892278845543, "mean_action_processing_ms": 0.7788426441553407, "mean_env_wait_ms": 105.45961764913241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0829923152923584, "StateBufferConnector_ms": 0.03800082206726074, "ViewRequirementAgentConnector_ms": 0.1380317211151123}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -798877.2522679754, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2364000, "num_agent_steps_trained": 2364000, "num_env_steps_sampled": 2364000, "num_env_steps_trained": 2364000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 46.33860806737792, "num_env_steps_trained_throughput_per_sec": 46.33860806737792, "timesteps_total": 2364000, "num_env_steps_sampled_lifetime": 2364000, "num_agent_steps_sampled_lifetime": 2364000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2364000, "timers": {"training_iteration_time_ms": 240287.363, "restore_workers_time_ms": 0.0, "training_step_time_ms": 240287.262, "sample_time_ms": 203708.552, "load_time_ms": 13.931, "load_throughput": 861378.674, "learn_time_ms": 36555.333, "learn_throughput": 328.269, "synch_weights_time_ms": 8.145}, "counters": {"num_env_steps_sampled": 2364000, "num_env_steps_trained": 2364000, "num_agent_steps_sampled": 2364000, "num_agent_steps_trained": 2364000}, "done": false, "training_iteration": 197, "trial_id": "befd4_00000", "date": "2025-01-23_06-43-44", "timestamp": 1737643424, "time_this_iter_s": 258.96837043762207, "time_total_s": 42372.44107341766, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 42372.44107341766, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 13.190332326283988, "ram_util_percent": 52.050151057401806, "gpu_util_percent0": 0.13353474320241693, "vram_util_percent0": 0.15893923479984895}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.580127974794955, "policy_loss": 0.0019461763136834522, "vf_loss": 30.0, "vf_explained_var": -0.005515332010977519, "kl": 0.0, "entropy": 42.18181849275373, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 238778.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2376000, "num_env_steps_trained": 2376000, "num_agent_steps_sampled": 2376000, "num_agent_steps_trained": 2376000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -798877.2522679754, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -798877.2522679754}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9651591130458067, "mean_inference_ms": 4.431892278845543, "mean_action_processing_ms": 0.7788426441553407, "mean_env_wait_ms": 105.45961764913241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0829923152923584, "StateBufferConnector_ms": 0.03800082206726074, "ViewRequirementAgentConnector_ms": 0.1380317211151123}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -798877.2522679754, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2376000, "num_agent_steps_trained": 2376000, "num_env_steps_sampled": 2376000, "num_env_steps_trained": 2376000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 46.968826999280054, "num_env_steps_trained_throughput_per_sec": 46.968826999280054, "timesteps_total": 2376000, "num_env_steps_sampled_lifetime": 2376000, "num_agent_steps_sampled_lifetime": 2376000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2376000, "timers": {"training_iteration_time_ms": 240036.639, "restore_workers_time_ms": 0.0, "training_step_time_ms": 240036.539, "sample_time_ms": 203429.051, "load_time_ms": 13.282, "load_throughput": 903466.159, "learn_time_ms": 36584.746, "learn_throughput": 328.006, "synch_weights_time_ms": 8.059}, "counters": {"num_env_steps_sampled": 2376000, "num_env_steps_trained": 2376000, "num_agent_steps_sampled": 2376000, "num_agent_steps_trained": 2376000}, "done": false, "training_iteration": 198, "trial_id": "befd4_00000", "date": "2025-01-23_06-48-00", "timestamp": 1737643680, "time_this_iter_s": 255.49160838127136, "time_total_s": 42627.932681798935, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 42627.932681798935, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 12.035276073619633, "ram_util_percent": 53.6006134969325, "gpu_util_percent0": 0.15656441717791414, "vram_util_percent0": 0.15891427818251533}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.57879131938723, "policy_loss": 0.0025531634860930115, "vf_loss": 30.0, "vf_explained_var": -0.003869362120001251, "kl": 0.0, "entropy": 42.376183531124596, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 239987.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2388000, "num_env_steps_trained": 2388000, "num_agent_steps_sampled": 2388000, "num_agent_steps_trained": 2388000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -798877.2522679754, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -798877.2522679754}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9651591130458067, "mean_inference_ms": 4.431892278845543, "mean_action_processing_ms": 0.7788426441553407, "mean_env_wait_ms": 105.45961764913241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0829923152923584, "StateBufferConnector_ms": 0.03800082206726074, "ViewRequirementAgentConnector_ms": 0.1380317211151123}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -798877.2522679754, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2388000, "num_agent_steps_trained": 2388000, "num_env_steps_sampled": 2388000, "num_env_steps_trained": 2388000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 48.415929642924205, "num_env_steps_trained_throughput_per_sec": 48.415929642924205, "timesteps_total": 2388000, "num_env_steps_sampled_lifetime": 2388000, "num_agent_steps_sampled_lifetime": 2388000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2388000, "timers": {"training_iteration_time_ms": 232006.403, "restore_workers_time_ms": 0.0, "training_step_time_ms": 232006.403, "sample_time_ms": 195491.14, "load_time_ms": 13.246, "load_throughput": 905921.65, "learn_time_ms": 36492.864, "learn_throughput": 328.831, "synch_weights_time_ms": 7.751}, "counters": {"num_env_steps_sampled": 2388000, "num_env_steps_trained": 2388000, "num_agent_steps_sampled": 2388000, "num_agent_steps_trained": 2388000}, "done": false, "training_iteration": 199, "trial_id": "befd4_00000", "date": "2025-01-23_06-52-08", "timestamp": 1737643928, "time_this_iter_s": 247.8553330898285, "time_total_s": 42875.78801488876, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 42875.78801488876, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 10.300314465408805, "ram_util_percent": 50.229559748427675, "gpu_util_percent0": 0.12003144654088051, "vram_util_percent0": 0.15133125737028302}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.57737221256379, "policy_loss": 0.0004943157981455672, "vf_loss": 30.0, "vf_explained_var": 0.0012525224902592384, "kl": 0.0, "entropy": 42.312213216171074, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 241196.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2400000, "num_env_steps_trained": 2400000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -798877.2522679754, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -798877.2522679754}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9651591130458067, "mean_inference_ms": 4.431892278845543, "mean_action_processing_ms": 0.7788426441553407, "mean_env_wait_ms": 105.45961764913241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0829923152923584, "StateBufferConnector_ms": 0.03800082206726074, "ViewRequirementAgentConnector_ms": 0.1380317211151123}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -798877.2522679754, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000, "num_env_steps_sampled": 2400000, "num_env_steps_trained": 2400000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 49.66956874161455, "num_env_steps_trained_throughput_per_sec": 49.66956874161455, "timesteps_total": 2400000, "num_env_steps_sampled_lifetime": 2400000, "num_agent_steps_sampled_lifetime": 2400000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2400000, "timers": {"training_iteration_time_ms": 231122.25, "restore_workers_time_ms": 0.0, "training_step_time_ms": 231122.151, "sample_time_ms": 194880.646, "load_time_ms": 13.476, "load_throughput": 890497.799, "learn_time_ms": 36218.877, "learn_throughput": 331.319, "synch_weights_time_ms": 7.75}, "counters": {"num_env_steps_sampled": 2400000, "num_env_steps_trained": 2400000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "done": false, "training_iteration": 200, "trial_id": "befd4_00000", "date": "2025-01-23_06-56-09", "timestamp": 1737644169, "time_this_iter_s": 241.60061979293823, "time_total_s": 43117.3886346817, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 43117.3886346817, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 10.037942122186495, "ram_util_percent": 49.73987138263665, "gpu_util_percent0": 0.11803858520900319, "vram_util_percent0": 0.1555557300040193}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.578255696766035, "policy_loss": 0.0028196694290864755, "vf_loss": 30.0, "vf_explained_var": 0.0024114957123970177, "kl": 0.0, "entropy": 42.456394643602145, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 242405.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2412000, "num_env_steps_trained": 2412000, "num_agent_steps_sampled": 2412000, "num_agent_steps_trained": 2412000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -798877.2522679754, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -798877.2522679754}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9651591130458067, "mean_inference_ms": 4.431892278845543, "mean_action_processing_ms": 0.7788426441553407, "mean_env_wait_ms": 105.45961764913241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0829923152923584, "StateBufferConnector_ms": 0.03800082206726074, "ViewRequirementAgentConnector_ms": 0.1380317211151123}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -798877.2522679754, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2412000, "num_agent_steps_trained": 2412000, "num_env_steps_sampled": 2412000, "num_env_steps_trained": 2412000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 49.694581307986304, "num_env_steps_trained_throughput_per_sec": 49.694581307986304, "timesteps_total": 2412000, "num_env_steps_sampled_lifetime": 2412000, "num_agent_steps_sampled_lifetime": 2412000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2412000, "timers": {"training_iteration_time_ms": 231892.056, "restore_workers_time_ms": 0.0, "training_step_time_ms": 231891.956, "sample_time_ms": 195667.254, "load_time_ms": 13.076, "load_throughput": 917733.911, "learn_time_ms": 36202.475, "learn_throughput": 331.469, "synch_weights_time_ms": 7.851}, "counters": {"num_env_steps_sampled": 2412000, "num_env_steps_trained": 2412000, "num_agent_steps_sampled": 2412000, "num_agent_steps_trained": 2412000}, "done": false, "training_iteration": 201, "trial_id": "befd4_00000", "date": "2025-01-23_07-00-11", "timestamp": 1737644411, "time_this_iter_s": 241.47801685333252, "time_total_s": 43358.866651535034, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 43358.866651535034, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 10.415755627009647, "ram_util_percent": 50.330868167202574, "gpu_util_percent0": 0.07954983922829582, "vram_util_percent0": 0.15961678557073955}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.57654285036502, "policy_loss": 0.002296770556935404, "vf_loss": 30.0, "vf_explained_var": -0.0007492113547250197, "kl": 0.0, "entropy": 42.575392973137056, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 243614.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2424000, "num_env_steps_trained": 2424000, "num_agent_steps_sampled": 2424000, "num_agent_steps_trained": 2424000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -798877.2522679754, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -798877.2522679754}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-800687.0549133165, -800660.0982830378, -798711.3841966455, -798825.6366793215, -798670.0450775467, -798815.022857917, -798514.9432456958, -798630.9841252462, -802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9651591130458067, "mean_inference_ms": 4.431892278845543, "mean_action_processing_ms": 0.7788426441553407, "mean_env_wait_ms": 105.45961764913241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0829923152923584, "StateBufferConnector_ms": 0.03800082206726074, "ViewRequirementAgentConnector_ms": 0.1380317211151123}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -798877.2522679754, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2424000, "num_agent_steps_trained": 2424000, "num_env_steps_sampled": 2424000, "num_env_steps_trained": 2424000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 49.4948090711997, "num_env_steps_trained_throughput_per_sec": 49.4948090711997, "timesteps_total": 2424000, "num_env_steps_sampled_lifetime": 2424000, "num_agent_steps_sampled_lifetime": 2424000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2424000, "timers": {"training_iteration_time_ms": 238619.782, "restore_workers_time_ms": 0.0, "training_step_time_ms": 238619.683, "sample_time_ms": 202622.102, "load_time_ms": 13.076, "load_throughput": 917738.932, "learn_time_ms": 35975.301, "learn_throughput": 333.562, "synch_weights_time_ms": 7.903}, "counters": {"num_env_steps_sampled": 2424000, "num_env_steps_trained": 2424000, "num_agent_steps_sampled": 2424000, "num_agent_steps_trained": 2424000}, "done": false, "training_iteration": 202, "trial_id": "befd4_00000", "date": "2025-01-23_07-04-13", "timestamp": 1737644653, "time_this_iter_s": 242.4536612033844, "time_total_s": 43601.32031273842, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 43601.32031273842, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 10.131089743589744, "ram_util_percent": 50.01538461538461, "gpu_util_percent0": 0.08528846153846154, "vram_util_percent0": 0.15409718048878204}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.654821113479148, "policy_loss": -0.007197166692135845, "vf_loss": 29.987694168406346, "vf_explained_var": -0.27319491451885014, "kl": 0.0, "entropy": 32.56758670475583, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 244823.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2436000, "num_env_steps_trained": 2436000, "num_agent_steps_sampled": 2436000, "num_agent_steps_trained": 2436000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -798444.0434425422, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -798444.0434425422}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953, -789491.7572202615, -789535.142843389, -800201.5279544892, -800211.1075603036, -786126.5946142266, -786170.5937016765, -799190.749484124, -799266.8134569596], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953, -789491.7572202615, -789535.142843389, -800201.5279544892, -800211.1075603036, -786126.5946142266, -786170.5937016765, -799190.749484124, -799266.8134569596]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9662336766536006, "mean_inference_ms": 4.436043836218127, "mean_action_processing_ms": 0.7798143153015034, "mean_env_wait_ms": 105.6181316156422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08199691772460938, "StateBufferConnector_ms": 0.036998748779296875, "ViewRequirementAgentConnector_ms": 0.13404011726379395}, "num_episodes": 8, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -798444.0434425422, "episodes_this_iter": 8}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2436000, "num_agent_steps_trained": 2436000, "num_env_steps_sampled": 2436000, "num_env_steps_trained": 2436000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 59.70799893816484, "num_env_steps_trained_throughput_per_sec": 59.70799893816484, "timesteps_total": 2436000, "num_env_steps_sampled_lifetime": 2436000, "num_agent_steps_sampled_lifetime": 2436000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2436000, "timers": {"training_iteration_time_ms": 239295.345, "restore_workers_time_ms": 0.0, "training_step_time_ms": 239295.245, "sample_time_ms": 203800.596, "load_time_ms": 13.227, "load_throughput": 907257.425, "learn_time_ms": 35472.218, "learn_throughput": 338.293, "synch_weights_time_ms": 7.902}, "counters": {"num_env_steps_sampled": 2436000, "num_env_steps_trained": 2436000, "num_agent_steps_sampled": 2436000, "num_agent_steps_trained": 2436000}, "done": false, "training_iteration": 203, "trial_id": "befd4_00000", "date": "2025-01-23_07-07-34", "timestamp": 1737644854, "time_this_iter_s": 200.98209238052368, "time_total_s": 43802.30240511894, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 43802.30240511894, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 8.768725868725868, "ram_util_percent": 50.05791505791506, "gpu_util_percent0": 0.0904247104247104, "vram_util_percent0": 0.1566707890926641}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 28.95180794342773, "policy_loss": -0.006293340460562923, "vf_loss": 29.38376842558729, "vf_explained_var": 0.11754187761603356, "kl": 0.0, "entropy": 42.566720695905786, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 246032.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2448000, "num_env_steps_trained": 2448000, "num_agent_steps_sampled": 2448000, "num_agent_steps_trained": 2448000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -798444.0434425422, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -798444.0434425422}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953, -789491.7572202615, -789535.142843389, -800201.5279544892, -800211.1075603036, -786126.5946142266, -786170.5937016765, -799190.749484124, -799266.8134569596], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953, -789491.7572202615, -789535.142843389, -800201.5279544892, -800211.1075603036, -786126.5946142266, -786170.5937016765, -799190.749484124, -799266.8134569596]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9662336766536006, "mean_inference_ms": 4.436043836218127, "mean_action_processing_ms": 0.7798143153015034, "mean_env_wait_ms": 105.6181316156422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08199691772460938, "StateBufferConnector_ms": 0.036998748779296875, "ViewRequirementAgentConnector_ms": 0.13404011726379395}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -798444.0434425422, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2448000, "num_agent_steps_trained": 2448000, "num_env_steps_sampled": 2448000, "num_env_steps_trained": 2448000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 65.4065557421231, "num_env_steps_trained_throughput_per_sec": 65.4065557421231, "timesteps_total": 2448000, "num_env_steps_sampled_lifetime": 2448000, "num_agent_steps_sampled_lifetime": 2448000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2448000, "timers": {"training_iteration_time_ms": 235930.198, "restore_workers_time_ms": 0.0, "training_step_time_ms": 235929.997, "sample_time_ms": 199892.421, "load_time_ms": 13.127, "load_throughput": 914141.91, "learn_time_ms": 36015.445, "learn_throughput": 333.19, "synch_weights_time_ms": 7.803}, "counters": {"num_env_steps_sampled": 2448000, "num_env_steps_trained": 2448000, "num_agent_steps_sampled": 2448000, "num_agent_steps_trained": 2448000}, "done": false, "training_iteration": 204, "trial_id": "befd4_00000", "date": "2025-01-23_07-10-38", "timestamp": 1737645038, "time_this_iter_s": 183.47183537483215, "time_total_s": 43985.774240493774, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 43985.774240493774, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 9.784255319148937, "ram_util_percent": 50.15404255319149, "gpu_util_percent0": 0.08472340425531913, "vram_util_percent0": 0.15558759973404257}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.553416776696544, "policy_loss": -0.00034050852664252565, "vf_loss": 30.0, "vf_explained_var": -0.036516697274642705, "kl": 0.0, "entropy": 44.624270925845266, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 247241.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2460000, "num_env_steps_trained": 2460000, "num_agent_steps_sampled": 2460000, "num_agent_steps_trained": 2460000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -798444.0434425422, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -798444.0434425422}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953, -789491.7572202615, -789535.142843389, -800201.5279544892, -800211.1075603036, -786126.5946142266, -786170.5937016765, -799190.749484124, -799266.8134569596], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953, -789491.7572202615, -789535.142843389, -800201.5279544892, -800211.1075603036, -786126.5946142266, -786170.5937016765, -799190.749484124, -799266.8134569596]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9662336766536006, "mean_inference_ms": 4.436043836218127, "mean_action_processing_ms": 0.7798143153015034, "mean_env_wait_ms": 105.6181316156422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08199691772460938, "StateBufferConnector_ms": 0.036998748779296875, "ViewRequirementAgentConnector_ms": 0.13404011726379395}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -798444.0434425422, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2460000, "num_agent_steps_trained": 2460000, "num_env_steps_sampled": 2460000, "num_env_steps_trained": 2460000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 55.74077265617031, "num_env_steps_trained_throughput_per_sec": 55.74077265617031, "timesteps_total": 2460000, "num_env_steps_sampled_lifetime": 2460000, "num_agent_steps_sampled_lifetime": 2460000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2460000, "timers": {"training_iteration_time_ms": 232994.627, "restore_workers_time_ms": 0.0, "training_step_time_ms": 232994.324, "sample_time_ms": 197447.888, "load_time_ms": 13.276, "load_throughput": 903910.736, "learn_time_ms": 35524.247, "learn_throughput": 337.797, "synch_weights_time_ms": 7.911}, "counters": {"num_env_steps_sampled": 2460000, "num_env_steps_trained": 2460000, "num_agent_steps_sampled": 2460000, "num_agent_steps_trained": 2460000}, "done": false, "training_iteration": 205, "trial_id": "befd4_00000", "date": "2025-01-23_07-14-13", "timestamp": 1737645253, "time_this_iter_s": 215.28525471687317, "time_total_s": 44201.05949521065, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 44201.05949521065, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 13.693478260869565, "ram_util_percent": 52.47934782608695, "gpu_util_percent0": 0.08565217391304349, "vram_util_percent0": 0.1636520606884058}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.562033756593717, "policy_loss": 0.001188107266270296, "vf_loss": 30.0, "vf_explained_var": -0.00978992535517766, "kl": 0.0, "entropy": 43.91543712884163, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 248450.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2472000, "num_env_steps_trained": 2472000, "num_agent_steps_sampled": 2472000, "num_agent_steps_trained": 2472000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -798444.0434425422, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -798444.0434425422}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953, -789491.7572202615, -789535.142843389, -800201.5279544892, -800211.1075603036, -786126.5946142266, -786170.5937016765, -799190.749484124, -799266.8134569596], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953, -789491.7572202615, -789535.142843389, -800201.5279544892, -800211.1075603036, -786126.5946142266, -786170.5937016765, -799190.749484124, -799266.8134569596]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9662336766536006, "mean_inference_ms": 4.436043836218127, "mean_action_processing_ms": 0.7798143153015034, "mean_env_wait_ms": 105.6181316156422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08199691772460938, "StateBufferConnector_ms": 0.036998748779296875, "ViewRequirementAgentConnector_ms": 0.13404011726379395}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -798444.0434425422, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2472000, "num_agent_steps_trained": 2472000, "num_env_steps_sampled": 2472000, "num_env_steps_trained": 2472000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 54.18225913852758, "num_env_steps_trained_throughput_per_sec": 54.18225913852758, "timesteps_total": 2472000, "num_env_steps_sampled_lifetime": 2472000, "num_agent_steps_sampled_lifetime": 2472000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2472000, "timers": {"training_iteration_time_ms": 230902.847, "restore_workers_time_ms": 0.0, "training_step_time_ms": 230902.544, "sample_time_ms": 195193.636, "load_time_ms": 13.299, "load_throughput": 902355.01, "learn_time_ms": 35686.797, "learn_throughput": 336.259, "synch_weights_time_ms": 7.911}, "counters": {"num_env_steps_sampled": 2472000, "num_env_steps_trained": 2472000, "num_agent_steps_sampled": 2472000, "num_agent_steps_trained": 2472000}, "done": false, "training_iteration": 206, "trial_id": "befd4_00000", "date": "2025-01-23_07-17-55", "timestamp": 1737645475, "time_this_iter_s": 221.47970700263977, "time_total_s": 44422.53920221329, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 44422.53920221329, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 11.246315789473684, "ram_util_percent": 52.81578947368421, "gpu_util_percent0": 0.09571929824561404, "vram_util_percent0": 0.1607713130482456}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.56471358931094, "policy_loss": 0.0013543397829096804, "vf_loss": 30.0, "vf_explained_var": -0.010067486881322365, "kl": 0.0, "entropy": 43.66407792286206, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 249659.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2484000, "num_env_steps_trained": 2484000, "num_agent_steps_sampled": 2484000, "num_agent_steps_trained": 2484000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -798444.0434425422, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -798444.0434425422}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953, -789491.7572202615, -789535.142843389, -800201.5279544892, -800211.1075603036, -786126.5946142266, -786170.5937016765, -799190.749484124, -799266.8134569596], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953, -789491.7572202615, -789535.142843389, -800201.5279544892, -800211.1075603036, -786126.5946142266, -786170.5937016765, -799190.749484124, -799266.8134569596]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9662336766536006, "mean_inference_ms": 4.436043836218127, "mean_action_processing_ms": 0.7798143153015034, "mean_env_wait_ms": 105.6181316156422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08199691772460938, "StateBufferConnector_ms": 0.036998748779296875, "ViewRequirementAgentConnector_ms": 0.13404011726379395}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -798444.0434425422, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2484000, "num_agent_steps_trained": 2484000, "num_env_steps_sampled": 2484000, "num_env_steps_trained": 2484000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 46.90833227716929, "num_env_steps_trained_throughput_per_sec": 46.90833227716929, "timesteps_total": 2484000, "num_env_steps_sampled_lifetime": 2484000, "num_agent_steps_sampled_lifetime": 2484000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2484000, "timers": {"training_iteration_time_ms": 230588.323, "restore_workers_time_ms": 0.0, "training_step_time_ms": 230588.021, "sample_time_ms": 194735.211, "load_time_ms": 12.612, "load_throughput": 951438.131, "learn_time_ms": 35831.253, "learn_throughput": 334.903, "synch_weights_time_ms": 7.943}, "counters": {"num_env_steps_sampled": 2484000, "num_env_steps_trained": 2484000, "num_agent_steps_sampled": 2484000, "num_agent_steps_trained": 2484000}, "done": false, "training_iteration": 207, "trial_id": "befd4_00000", "date": "2025-01-23_07-22-10", "timestamp": 1737645730, "time_this_iter_s": 255.82108569145203, "time_total_s": 44678.36028790474, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 44678.36028790474, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 15.443076923076923, "ram_util_percent": 54.14523076923077, "gpu_util_percent0": 0.0800923076923077, "vram_util_percent0": 0.16167548076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.567042574002983, "policy_loss": 0.0020750460405183093, "vf_loss": 30.0, "vf_explained_var": -0.009536375676037557, "kl": 0.0, "entropy": 43.50324546492129, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 250868.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2496000, "num_env_steps_trained": 2496000, "num_agent_steps_sampled": 2496000, "num_agent_steps_trained": 2496000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -798444.0434425422, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -798444.0434425422}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953, -789491.7572202615, -789535.142843389, -800201.5279544892, -800211.1075603036, -786126.5946142266, -786170.5937016765, -799190.749484124, -799266.8134569596], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953, -789491.7572202615, -789535.142843389, -800201.5279544892, -800211.1075603036, -786126.5946142266, -786170.5937016765, -799190.749484124, -799266.8134569596]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9662336766536006, "mean_inference_ms": 4.436043836218127, "mean_action_processing_ms": 0.7798143153015034, "mean_env_wait_ms": 105.6181316156422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08199691772460938, "StateBufferConnector_ms": 0.036998748779296875, "ViewRequirementAgentConnector_ms": 0.13404011726379395}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -798444.0434425422, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2496000, "num_agent_steps_trained": 2496000, "num_env_steps_sampled": 2496000, "num_env_steps_trained": 2496000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 46.38325530287334, "num_env_steps_trained_throughput_per_sec": 46.38325530287334, "timesteps_total": 2496000, "num_env_steps_sampled_lifetime": 2496000, "num_agent_steps_sampled_lifetime": 2496000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2496000, "timers": {"training_iteration_time_ms": 230910.868, "restore_workers_time_ms": 0.0, "training_step_time_ms": 230910.566, "sample_time_ms": 194850.431, "load_time_ms": 12.613, "load_throughput": 951364.397, "learn_time_ms": 36038.639, "learn_throughput": 332.976, "synch_weights_time_ms": 7.88}, "counters": {"num_env_steps_sampled": 2496000, "num_env_steps_trained": 2496000, "num_agent_steps_sampled": 2496000, "num_agent_steps_trained": 2496000}, "done": false, "training_iteration": 208, "trial_id": "befd4_00000", "date": "2025-01-23_07-26-29", "timestamp": 1737645989, "time_this_iter_s": 258.71805453300476, "time_total_s": 44937.078342437744, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 44937.078342437744, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 14.076132930513594, "ram_util_percent": 57.62930513595166, "gpu_util_percent0": 0.1117522658610272, "vram_util_percent0": 0.16377838226963745}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.566489728449593, "policy_loss": 0.0013541392920380095, "vf_loss": 30.0, "vf_explained_var": -0.007777863390885472, "kl": 0.0, "entropy": 43.486441572014215, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 252077.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2508000, "num_env_steps_trained": 2508000, "num_agent_steps_sampled": 2508000, "num_agent_steps_trained": 2508000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -798444.0434425422, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -798444.0434425422}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953, -789491.7572202615, -789535.142843389, -800201.5279544892, -800211.1075603036, -786126.5946142266, -786170.5937016765, -799190.749484124, -799266.8134569596], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953, -789491.7572202615, -789535.142843389, -800201.5279544892, -800211.1075603036, -786126.5946142266, -786170.5937016765, -799190.749484124, -799266.8134569596]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9662336766536006, "mean_inference_ms": 4.436043836218127, "mean_action_processing_ms": 0.7798143153015034, "mean_env_wait_ms": 105.6181316156422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08199691772460938, "StateBufferConnector_ms": 0.036998748779296875, "ViewRequirementAgentConnector_ms": 0.13404011726379395}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -798444.0434425422, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2508000, "num_agent_steps_trained": 2508000, "num_env_steps_sampled": 2508000, "num_env_steps_trained": 2508000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 48.17092704945684, "num_env_steps_trained_throughput_per_sec": 48.17092704945684, "timesteps_total": 2508000, "num_env_steps_sampled_lifetime": 2508000, "num_agent_steps_sampled_lifetime": 2508000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2508000, "timers": {"training_iteration_time_ms": 231036.929, "restore_workers_time_ms": 0.0, "training_step_time_ms": 231036.626, "sample_time_ms": 195017.348, "load_time_ms": 12.645, "load_throughput": 948960.815, "learn_time_ms": 35997.743, "learn_throughput": 333.354, "synch_weights_time_ms": 7.889}, "counters": {"num_env_steps_sampled": 2508000, "num_env_steps_trained": 2508000, "num_agent_steps_sampled": 2508000, "num_agent_steps_trained": 2508000}, "done": false, "training_iteration": 209, "trial_id": "befd4_00000", "date": "2025-01-23_07-30-38", "timestamp": 1737646238, "time_this_iter_s": 249.11791443824768, "time_total_s": 45186.19625687599, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 45186.19625687599, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 10.775394321766562, "ram_util_percent": 58.3794952681388, "gpu_util_percent0": 0.10211356466876971, "vram_util_percent0": 0.17264515970031546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.56776978340496, "policy_loss": 0.0013444860079891924, "vf_loss": 30.0, "vf_explained_var": -0.01046330727655302, "kl": 0.0, "entropy": 43.357473324506714, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 253286.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2520000, "num_env_steps_trained": 2520000, "num_agent_steps_sampled": 2520000, "num_agent_steps_trained": 2520000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -798444.0434425422, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -798444.0434425422}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953, -789491.7572202615, -789535.142843389, -800201.5279544892, -800211.1075603036, -786126.5946142266, -786170.5937016765, -799190.749484124, -799266.8134569596], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953, -789491.7572202615, -789535.142843389, -800201.5279544892, -800211.1075603036, -786126.5946142266, -786170.5937016765, -799190.749484124, -799266.8134569596]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9662336766536006, "mean_inference_ms": 4.436043836218127, "mean_action_processing_ms": 0.7798143153015034, "mean_env_wait_ms": 105.6181316156422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08199691772460938, "StateBufferConnector_ms": 0.036998748779296875, "ViewRequirementAgentConnector_ms": 0.13404011726379395}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -798444.0434425422, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2520000, "num_agent_steps_trained": 2520000, "num_env_steps_sampled": 2520000, "num_env_steps_trained": 2520000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 47.61571364164402, "num_env_steps_trained_throughput_per_sec": 47.61571364164402, "timesteps_total": 2520000, "num_env_steps_sampled_lifetime": 2520000, "num_agent_steps_sampled_lifetime": 2520000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2520000, "timers": {"training_iteration_time_ms": 232079.031, "restore_workers_time_ms": 0.0, "training_step_time_ms": 232078.828, "sample_time_ms": 195714.176, "load_time_ms": 12.374, "load_throughput": 969807.432, "learn_time_ms": 36343.018, "learn_throughput": 330.187, "synch_weights_time_ms": 8.059}, "counters": {"num_env_steps_sampled": 2520000, "num_env_steps_trained": 2520000, "num_agent_steps_sampled": 2520000, "num_agent_steps_trained": 2520000}, "done": false, "training_iteration": 210, "trial_id": "befd4_00000", "date": "2025-01-23_07-34-50", "timestamp": 1737646490, "time_this_iter_s": 252.02265048027039, "time_total_s": 45438.21890735626, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 45438.21890735626, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 11.265217391304347, "ram_util_percent": 55.88850931677018, "gpu_util_percent0": 0.0898447204968944, "vram_util_percent0": 0.16299161733307455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.57006102026347, "policy_loss": 0.003413420199817917, "vf_loss": 30.0, "vf_explained_var": -0.013263110438095232, "kl": 0.0, "entropy": 43.33523877303989, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 254495.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2532000, "num_env_steps_trained": 2532000, "num_agent_steps_sampled": 2532000, "num_agent_steps_trained": 2532000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -798444.0434425422, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -798444.0434425422}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953, -789491.7572202615, -789535.142843389, -800201.5279544892, -800211.1075603036, -786126.5946142266, -786170.5937016765, -799190.749484124, -799266.8134569596], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953, -789491.7572202615, -789535.142843389, -800201.5279544892, -800211.1075603036, -786126.5946142266, -786170.5937016765, -799190.749484124, -799266.8134569596]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9662336766536006, "mean_inference_ms": 4.436043836218127, "mean_action_processing_ms": 0.7798143153015034, "mean_env_wait_ms": 105.6181316156422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08199691772460938, "StateBufferConnector_ms": 0.036998748779296875, "ViewRequirementAgentConnector_ms": 0.13404011726379395}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -798444.0434425422, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2532000, "num_agent_steps_trained": 2532000, "num_env_steps_sampled": 2532000, "num_env_steps_trained": 2532000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 48.28840590470213, "num_env_steps_trained_throughput_per_sec": 48.28840590470213, "timesteps_total": 2532000, "num_env_steps_sampled_lifetime": 2532000, "num_agent_steps_sampled_lifetime": 2532000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2532000, "timers": {"training_iteration_time_ms": 232782.215, "restore_workers_time_ms": 0.0, "training_step_time_ms": 232782.012, "sample_time_ms": 196308.32, "load_time_ms": 12.173, "load_throughput": 985764.329, "learn_time_ms": 36452.158, "learn_throughput": 329.199, "synch_weights_time_ms": 8.059}, "counters": {"num_env_steps_sampled": 2532000, "num_env_steps_trained": 2532000, "num_agent_steps_sampled": 2532000, "num_agent_steps_trained": 2532000}, "done": false, "training_iteration": 211, "trial_id": "befd4_00000", "date": "2025-01-23_07-38-59", "timestamp": 1737646739, "time_this_iter_s": 248.5108470916748, "time_total_s": 45686.72975444794, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 45686.72975444794, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 10.862578616352202, "ram_util_percent": 56.12201257861636, "gpu_util_percent0": 0.07783018867924528, "vram_util_percent0": 0.16782410819575472}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.569062445161755, "policy_loss": 0.002010226893686282, "vf_loss": 30.0, "vf_explained_var": -0.00849919880195725, "kl": 0.0, "entropy": 43.294782270963175, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 255704.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2544000, "num_env_steps_trained": 2544000, "num_agent_steps_sampled": 2544000, "num_agent_steps_trained": 2544000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -798444.0434425422, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -798444.0434425422}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953, -789491.7572202615, -789535.142843389, -800201.5279544892, -800211.1075603036, -786126.5946142266, -786170.5937016765, -799190.749484124, -799266.8134569596], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953, -789491.7572202615, -789535.142843389, -800201.5279544892, -800211.1075603036, -786126.5946142266, -786170.5937016765, -799190.749484124, -799266.8134569596]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9662336766536006, "mean_inference_ms": 4.436043836218127, "mean_action_processing_ms": 0.7798143153015034, "mean_env_wait_ms": 105.6181316156422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08199691772460938, "StateBufferConnector_ms": 0.036998748779296875, "ViewRequirementAgentConnector_ms": 0.13404011726379395}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -798444.0434425422, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2544000, "num_agent_steps_trained": 2544000, "num_env_steps_sampled": 2544000, "num_env_steps_trained": 2544000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 51.309716954479015, "num_env_steps_trained_throughput_per_sec": 51.309716954479015, "timesteps_total": 2544000, "num_env_steps_sampled_lifetime": 2544000, "num_agent_steps_sampled_lifetime": 2544000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2544000, "timers": {"training_iteration_time_ms": 231924.631, "restore_workers_time_ms": 0.0, "training_step_time_ms": 231924.428, "sample_time_ms": 195400.538, "load_time_ms": 12.173, "load_throughput": 985756.607, "learn_time_ms": 36502.407, "learn_throughput": 328.745, "synch_weights_time_ms": 7.907}, "counters": {"num_env_steps_sampled": 2544000, "num_env_steps_trained": 2544000, "num_agent_steps_sampled": 2544000, "num_agent_steps_trained": 2544000}, "done": false, "training_iteration": 212, "trial_id": "befd4_00000", "date": "2025-01-23_07-42-53", "timestamp": 1737646973, "time_this_iter_s": 233.87782430648804, "time_total_s": 45920.607578754425, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 45920.607578754425, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 9.250830564784053, "ram_util_percent": 53.03255813953489, "gpu_util_percent0": 0.06511627906976744, "vram_util_percent0": 0.15810060215946845}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.570517898887715, "policy_loss": 0.002992634155392351, "vf_loss": 30.0, "vf_explained_var": -0.012734435184421966, "kl": 0.0, "entropy": 43.2474733168079, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 256913.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2556000, "num_env_steps_trained": 2556000, "num_agent_steps_sampled": 2556000, "num_agent_steps_trained": 2556000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -798444.0434425422, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -798444.0434425422}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953, -789491.7572202615, -789535.142843389, -800201.5279544892, -800211.1075603036, -786126.5946142266, -786170.5937016765, -799190.749484124, -799266.8134569596], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-802768.5972113784, -802802.597366958, -798837.9416121726, -798862.9565523121, -802003.1063441819, -802075.7691051192, -800374.3298815963, -800434.739579027, -798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953, -789491.7572202615, -789535.142843389, -800201.5279544892, -800211.1075603036, -786126.5946142266, -786170.5937016765, -799190.749484124, -799266.8134569596]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9662336766536006, "mean_inference_ms": 4.436043836218127, "mean_action_processing_ms": 0.7798143153015034, "mean_env_wait_ms": 105.6181316156422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08199691772460938, "StateBufferConnector_ms": 0.036998748779296875, "ViewRequirementAgentConnector_ms": 0.13404011726379395}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -798444.0434425422, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2556000, "num_agent_steps_trained": 2556000, "num_env_steps_sampled": 2556000, "num_env_steps_trained": 2556000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 50.37177637341723, "num_env_steps_trained_throughput_per_sec": 50.37177637341723, "timesteps_total": 2556000, "num_env_steps_sampled_lifetime": 2556000, "num_agent_steps_sampled_lifetime": 2556000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2556000, "timers": {"training_iteration_time_ms": 235649.686, "restore_workers_time_ms": 0.0, "training_step_time_ms": 235649.483, "sample_time_ms": 199199.902, "load_time_ms": 12.122, "load_throughput": 989921.112, "learn_time_ms": 36428.147, "learn_throughput": 329.416, "synch_weights_time_ms": 7.907}, "counters": {"num_env_steps_sampled": 2556000, "num_env_steps_trained": 2556000, "num_agent_steps_sampled": 2556000, "num_agent_steps_trained": 2556000}, "done": false, "training_iteration": 213, "trial_id": "befd4_00000", "date": "2025-01-23_07-46-51", "timestamp": 1737647211, "time_this_iter_s": 238.23262357711792, "time_total_s": 46158.84020233154, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 46158.84020233154, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 9.036482084690554, "ram_util_percent": 52.72671009771987, "gpu_util_percent0": 0.062149837133550496, "vram_util_percent0": 0.15803198798859935}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.602433194396315, "policy_loss": 0.00556573616856874, "vf_loss": 29.988632157974937, "vf_explained_var": -0.14228136333381963, "kl": 0.0, "entropy": 39.17647313164521, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 258122.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2568000, "num_env_steps_trained": 2568000, "num_agent_steps_sampled": 2568000, "num_agent_steps_trained": 2568000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -797620.7874244159, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -797620.7874244159}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953, -789491.7572202615, -789535.142843389, -800201.5279544892, -800211.1075603036, -786126.5946142266, -786170.5937016765, -799190.749484124, -799266.8134569596, -787666.2353737499, -787795.5999691539, -803297.1799744549, -803344.135400976, -786161.7909980449, -786233.84135787, -785619.1088854196, -785716.5438804259], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953, -789491.7572202615, -789535.142843389, -800201.5279544892, -800211.1075603036, -786126.5946142266, -786170.5937016765, -799190.749484124, -799266.8134569596, -787666.2353737499, -787795.5999691539, -803297.1799744549, -803344.135400976, -786161.7909980449, -786233.84135787, -785619.1088854196, -785716.5438804259]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.967526881939542, "mean_inference_ms": 4.441265590181613, "mean_action_processing_ms": 0.7809854007233744, "mean_env_wait_ms": 105.7928706587948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08501505851745605, "StateBufferConnector_ms": 0.03499555587768555, "ViewRequirementAgentConnector_ms": 0.1410534381866455}, "num_episodes": 8, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -797620.7874244159, "episodes_this_iter": 8}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2568000, "num_agent_steps_trained": 2568000, "num_env_steps_sampled": 2568000, "num_env_steps_trained": 2568000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 56.48091663885599, "num_env_steps_trained_throughput_per_sec": 56.48091663885599, "timesteps_total": 2568000, "num_env_steps_sampled_lifetime": 2568000, "num_agent_steps_sampled_lifetime": 2568000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2568000, "timers": {"training_iteration_time_ms": 238549.015, "restore_workers_time_ms": 0.0, "training_step_time_ms": 238548.914, "sample_time_ms": 202804.677, "load_time_ms": 12.122, "load_throughput": 989911.377, "learn_time_ms": 35722.703, "learn_throughput": 335.921, "synch_weights_time_ms": 7.906}, "counters": {"num_env_steps_sampled": 2568000, "num_env_steps_trained": 2568000, "num_agent_steps_sampled": 2568000, "num_agent_steps_trained": 2568000}, "done": false, "training_iteration": 214, "trial_id": "befd4_00000", "date": "2025-01-23_07-50-24", "timestamp": 1737647424, "time_this_iter_s": 212.46513295173645, "time_total_s": 46371.30533528328, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 46371.30533528328, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 8.167518248175183, "ram_util_percent": 52.43759124087592, "gpu_util_percent0": 0.061897810218978104, "vram_util_percent0": 0.15545271156478102}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.243176793933802, "policy_loss": -0.021067235276805554, "vf_loss": 29.57395138515728, "vf_explained_var": -0.49227130792671436, "kl": 0.0, "entropy": 30.97073090539874, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 259331.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2580000, "num_env_steps_trained": 2580000, "num_agent_steps_sampled": 2580000, "num_agent_steps_trained": 2580000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -797620.7874244159, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -797620.7874244159}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953, -789491.7572202615, -789535.142843389, -800201.5279544892, -800211.1075603036, -786126.5946142266, -786170.5937016765, -799190.749484124, -799266.8134569596, -787666.2353737499, -787795.5999691539, -803297.1799744549, -803344.135400976, -786161.7909980449, -786233.84135787, -785619.1088854196, -785716.5438804259], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953, -789491.7572202615, -789535.142843389, -800201.5279544892, -800211.1075603036, -786126.5946142266, -786170.5937016765, -799190.749484124, -799266.8134569596, -787666.2353737499, -787795.5999691539, -803297.1799744549, -803344.135400976, -786161.7909980449, -786233.84135787, -785619.1088854196, -785716.5438804259]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.967526881939542, "mean_inference_ms": 4.441265590181613, "mean_action_processing_ms": 0.7809854007233744, "mean_env_wait_ms": 105.7928706587948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08501505851745605, "StateBufferConnector_ms": 0.03499555587768555, "ViewRequirementAgentConnector_ms": 0.1410534381866455}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -797620.7874244159, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2580000, "num_agent_steps_trained": 2580000, "num_env_steps_sampled": 2580000, "num_env_steps_trained": 2580000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 74.23225886455765, "num_env_steps_trained_throughput_per_sec": 74.23225886455765, "timesteps_total": 2580000, "num_env_steps_sampled_lifetime": 2580000, "num_agent_steps_sampled_lifetime": 2580000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2580000, "timers": {"training_iteration_time_ms": 233186.267, "restore_workers_time_ms": 0.0, "training_step_time_ms": 233186.267, "sample_time_ms": 197311.545, "load_time_ms": 11.974, "load_throughput": 1002169.298, "learn_time_ms": 35852.982, "learn_throughput": 334.7, "synch_weights_time_ms": 8.16}, "counters": {"num_env_steps_sampled": 2580000, "num_env_steps_trained": 2580000, "num_agent_steps_sampled": 2580000, "num_agent_steps_trained": 2580000}, "done": false, "training_iteration": 215, "trial_id": "befd4_00000", "date": "2025-01-23_07-53-05", "timestamp": 1737647585, "time_this_iter_s": 161.65990829467773, "time_total_s": 46532.96524357796, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 46532.96524357796, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 4.547115384615385, "ram_util_percent": 52.095192307692315, "gpu_util_percent0": 0.08014423076923077, "vram_util_percent0": 0.16701190655048082}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.00010000000000000002, "total_loss": 29.633708791362046, "policy_loss": -0.0039483169779317056, "vf_loss": 29.99551141547999, "vf_explained_var": -0.17604056826497624, "kl": 0.0, "entropy": 35.78543832304066, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 260540.0, "diff_num_grad_updates_vs_sampler_policy": 604.0}}, "num_env_steps_sampled": 2592000, "num_env_steps_trained": 2592000, "num_agent_steps_sampled": 2592000, "num_agent_steps_trained": 2592000}, "env_runners": {"episode_reward_max": -785314.6083469589, "episode_reward_min": -804646.9256076601, "episode_reward_mean": -797620.7874244159, "episode_len_mean": 18000.0, "episode_media": {}, "episodes_timesteps_total": 1800000, "policy_reward_min": {"default_policy": -804646.9256076601}, "policy_reward_max": {"default_policy": -785314.6083469589}, "policy_reward_mean": {"default_policy": -797620.7874244159}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953, -789491.7572202615, -789535.142843389, -800201.5279544892, -800211.1075603036, -786126.5946142266, -786170.5937016765, -799190.749484124, -799266.8134569596, -787666.2353737499, -787795.5999691539, -803297.1799744549, -803344.135400976, -786161.7909980449, -786233.84135787, -785619.1088854196, -785716.5438804259], "episode_lengths": [18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000], "policy_default_policy_reward": [-798858.0107664492, -799014.9597711444, -788359.327673963, -788467.4923707603, -798903.7118759855, -799052.5450604733, -800592.2279510582, -800635.5495215002, -799422.2089337185, -799533.3224041731, -801983.2037828855, -802078.5708348367, -800067.9047783397, -800051.9050104065, -801896.6132435496, -801979.8616312738, -800111.7052900346, -800198.017441455, -788457.0451873981, -788525.6330187041, -800205.7458107101, -800304.3948631021, -799988.2988496335, -800012.834791882, -798943.0479087654, -798987.0750284706, -799098.767535706, -799077.0826590653, -802757.4023106865, -802846.5471003957, -785485.9750667393, -785559.1356019869, -798085.2318274358, -798134.7227271007, -799116.6608160126, -799247.4770792022, -789383.6539173329, -789475.9085482345, -803140.5927544752, -803204.3825541851, -799231.5805694519, -799407.7423751216, -799445.4876125692, -799498.7043608581, -799747.9334688941, -799793.7208305825, -803694.9478150734, -803736.6943223359, -799061.084301374, -799128.1881448904, -803017.8238404266, -803146.0519329003, -799258.617877959, -799311.3899795566, -785314.6083469589, -785370.6099029023, -802302.0273292062, -802303.1387069465, -799825.6125838212, -799933.3573490756, -800730.3263008221, -800780.0069667748, -796523.435490894, -796551.642327623, -799044.8762325713, -799114.0596147996, -804537.3799169962, -804646.9256076601, -799021.0372478436, -799049.3033317889, -802062.1018593772, -802121.7343159036, -800663.9587160079, -800738.6125761373, -790198.1745113592, -790283.5150970026, -802193.2463922942, -802215.524921486, -802235.9223884564, -802294.2859849414, -799259.8222353186, -799314.7515518265, -799308.1399693531, -799387.1602586953, -789491.7572202615, -789535.142843389, -800201.5279544892, -800211.1075603036, -786126.5946142266, -786170.5937016765, -799190.749484124, -799266.8134569596, -787666.2353737499, -787795.5999691539, -803297.1799744549, -803344.135400976, -786161.7909980449, -786233.84135787, -785619.1088854196, -785716.5438804259]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.967526881939542, "mean_inference_ms": 4.441265590181613, "mean_action_processing_ms": 0.7809854007233744, "mean_env_wait_ms": 105.7928706587948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08501505851745605, "StateBufferConnector_ms": 0.03499555587768555, "ViewRequirementAgentConnector_ms": 0.1410534381866455}, "num_episodes": 0, "episode_return_max": -785314.6083469589, "episode_return_min": -804646.9256076601, "episode_return_mean": -797620.7874244159, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2592000, "num_agent_steps_trained": 2592000, "num_env_steps_sampled": 2592000, "num_env_steps_trained": 2592000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 62.07025991898403, "num_env_steps_trained_throughput_per_sec": 62.07025991898403, "timesteps_total": 2592000, "num_env_steps_sampled_lifetime": 2592000, "num_agent_steps_sampled_lifetime": 2592000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 2592000, "timers": {"training_iteration_time_ms": 230371.726, "restore_workers_time_ms": 0.0, "training_step_time_ms": 230371.726, "sample_time_ms": 194643.734, "load_time_ms": 11.971, "load_throughput": 1002396.831, "learn_time_ms": 35706.207, "learn_throughput": 336.076, "synch_weights_time_ms": 8.209}, "counters": {"num_env_steps_sampled": 2592000, "num_env_steps_trained": 2592000, "num_agent_steps_sampled": 2592000, "num_agent_steps_trained": 2592000}, "done": false, "training_iteration": 216, "trial_id": "befd4_00000", "date": "2025-01-23_07-56-19", "timestamp": 1737647779, "time_this_iter_s": 193.3332998752594, "time_total_s": 46726.29854345322, "pid": 24912, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.TrafficLightEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 18000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 1.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 12000, "num_epochs": 13, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_traffic_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000139FDA48790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 30.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 46726.29854345322, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 6.806451612903226, "ram_util_percent": 51.566129032258054, "gpu_util_percent0": 0.08955645161290322, "vram_util_percent0": 0.16953597530241934}}
