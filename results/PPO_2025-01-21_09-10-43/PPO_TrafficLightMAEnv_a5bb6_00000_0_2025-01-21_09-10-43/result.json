{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.331756273558799, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0002999999999999999, "total_loss": 10.105837293990115, "policy_loss": 0.07882340406305453, "vf_loss": 9.979543539818296, "vf_explained_var": -3.363365822650017e-05, "kl": 0.3308196528287644, "entropy": 1.869357953325231, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 1175.5, "diff_num_grad_updates_vs_sampler_policy": 1174.5}}, "num_env_steps_sampled": 6000, "num_env_steps_trained": 6000, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 30000}, "env_runners": {"episode_reward_max": 2635966.6399999997, "episode_reward_min": 1214867.2900000021, "episode_reward_mean": 1523426.0823750002, "episode_len_mean": 305.875, "episode_media": {}, "episodes_timesteps_total": 2447, "policy_reward_min": {"shared_policy": 132645.57400000002}, "policy_reward_max": {"shared_policy": 676669.675}, "policy_reward_mean": {"shared_policy": 304685.21647499996}, "custom_metrics": {"mean_queue_length": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "mean_waiting_time": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "mean_throughput": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "hist_stats": {"episode_reward": [2635966.6399999997, 1577107.1990000035, 1435334.2020000007, 1281700.6929999979, 1214867.2900000021, 1320232.8339999984, 1320277.062999999, 1401922.7379999997], "episode_lengths": [431, 327, 294, 304, 290, 263, 263, 275], "policy_shared_policy_reward": [292163.18699999974, 676669.675, 672171.9889999996, 665747.1960000007, 329214.59300000005, 172246.5559999999, 416722.4049999997, 402155.40399999986, 379286.9280000001, 206695.906, 157204.51600000003, 384913.5190000003, 363090.5069999997, 346082.5689999999, 184043.091, 140285.56800000003, 358160.6400000001, 289471.5149999998, 325496.1569999998, 168286.81299999994, 132645.57400000002, 329951.0429999999, 282157.646, 309175.7189999999, 160937.30799999993, 137345.956, 362218.75800000026, 324212.24899999955, 324595.49, 171860.38099999996, 140905.53500000006, 362067.88599999994, 327039.70800000016, 320229.50299999985, 170034.431, 152347.52699999994, 387437.2550000001, 341594.17100000015, 340989.2739999997, 179554.51100000014]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.28486257307836, "mean_inference_ms": 1.8823214535707242, "mean_action_processing_ms": 1.3917292771714456, "mean_env_wait_ms": 454.3432880206948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.062465667724609375, "StateBufferConnector_ms": 0.03757774829864502, "ViewRequirementAgentConnector_ms": 0.5141079425811768}, "num_episodes": 8, "episode_return_max": 2635966.6399999997, "episode_return_min": 1214867.2900000021, "episode_return_mean": 1523426.0823750002, "episodes_this_iter": 8}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 30000, "num_env_steps_sampled": 6000, "num_env_steps_trained": 6000, "num_env_steps_sampled_this_iter": 6000, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 12.887074266851606, "num_env_steps_trained_throughput_per_sec": 12.887074266851606, "timesteps_total": 6000, "num_env_steps_sampled_lifetime": 6000, "num_agent_steps_sampled_lifetime": 30000, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 30000, "timers": {"training_iteration_time_ms": 465582.791, "restore_workers_time_ms": 0.0, "training_step_time_ms": 465582.791, "sample_time_ms": 434904.645, "learn_time_ms": 30664.148, "learn_throughput": 195.668, "synch_weights_time_ms": 12.002}, "counters": {"num_env_steps_sampled": 6000, "num_env_steps_trained": 6000, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 30000}, "done": false, "training_iteration": 1, "trial_id": "a5bb6_00000", "date": "2025-01-21_09-18-55", "timestamp": 1737479935, "time_this_iter_s": 465.5877888202667, "time_total_s": 465.5877888202667, "pid": 61756, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'environments.trafficEnv.TrafficLightMAEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 20000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 6000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function my_policy_mapping at 0x00000177903D92D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, "Dict('local_state': Dict('current_phase': Discrete(3), 'queue_length': Box(0.0, 100.0, (4,), float32), 'waiting_time': Box(0.0, 1000000.0, (4,), float32)), 'neighbor_info': Box(0.0, 100.0, (4,), float32))", "Dict('duration': Box(5.0, 60.0, (1,), float32), 'phase': Discrete(3))", {"model": {"custom_model": "my_traffic_model"}}]}, "callbacks": "<class 'config.trainingConfig.MetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 465.5877888202667, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 6.066053511705686, "ram_util_percent": 65.7573578595318, "gpu_util_percent0": 0.04842809364548495, "vram_util_percent0": 0.12422168948578595}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.282113591445253, "cur_kl_coeff": 0.3, "cur_lr": 0.0002999999999999999, "total_loss": 9.948477690676425, "policy_loss": 0.0016949343907230712, "vf_loss": 9.962117791683117, "vf_explained_var": -1.0204492731297269e-05, "kl": 0.009354496010951553, "entropy": 1.8141391494933594, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 3525.5, "diff_num_grad_updates_vs_sampler_policy": 1174.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": 5034831.708000005, "episode_reward_min": 1108518.2280000004, "episode_reward_mean": 1744691.7129259259, "episode_len_mean": 327.3703703703704, "episode_media": {}, "episodes_timesteps_total": 8839, "policy_reward_min": {"shared_policy": 119446.918}, "policy_reward_max": {"shared_policy": 1294357.2120000008}, "policy_reward_mean": {"shared_policy": 348938.34258518525}, "custom_metrics": {"mean_queue_length": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "mean_waiting_time": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "mean_throughput": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "hist_stats": {"episode_reward": [2635966.6399999997, 1577107.1990000035, 1435334.2020000007, 1281700.6929999979, 1214867.2900000021, 1320232.8339999984, 1320277.062999999, 1401922.7379999997, 5034831.708000005, 2375296.458999998, 1317280.6699999997, 1217756.0139999986, 1108518.2280000004, 4591677.7200000025, 1506015.4599999995, 1197365.7219999994, 1207677.637999998, 1395562.2590000003, 1462325.825999998, 1420484.7980000007, 1293434.7149999982, 2826614.4269999946, 1449513.8989999988, 1404089.050000002, 1412785.4899999998, 1490892.2589999998, 1207145.248000001], "episode_lengths": [431, 327, 294, 304, 290, 263, 263, 275, 819, 388, 229, 216, 204, 903, 282, 226, 226, 247, 343, 252, 235, 561, 286, 246, 246, 257, 226], "policy_shared_policy_reward": [292163.18699999974, 676669.675, 672171.9889999996, 665747.1960000007, 329214.59300000005, 172246.5559999999, 416722.4049999997, 402155.40399999986, 379286.9280000001, 206695.906, 157204.51600000003, 384913.5190000003, 363090.5069999997, 346082.5689999999, 184043.091, 140285.56800000003, 358160.6400000001, 289471.5149999998, 325496.1569999998, 168286.81299999994, 132645.57400000002, 329951.0429999999, 282157.646, 309175.7189999999, 160937.30799999993, 137345.956, 362218.75800000026, 324212.24899999955, 324595.49, 171860.38099999996, 140905.53500000006, 362067.88599999994, 327039.70800000016, 320229.50299999985, 170034.431, 152347.52699999994, 387437.2550000001, 341594.17100000015, 340989.2739999997, 179554.51100000014, 555899.7210000008, 1294357.2120000008, 1281514.0020000006, 1261280.6060000025, 641780.167, 261887.02700000012, 609583.7500000003, 608097.2899999998, 588872.0539999994, 306856.33799999976, 150858.37699999998, 352944.7050000003, 335020.4410000001, 317206.6469999999, 161250.49999999997, 139849.3699999999, 327697.9060000003, 298965.1319999998, 296429.3760000001, 154814.23, 119446.918, 298275.25600000017, 283631.044, 271438.2680000001, 135726.74199999997, 511145.7900000002, 1220550.0109999992, 1168670.151999999, 1107680.872999999, 583630.8940000003, 172820.27799999996, 402723.27899999986, 382765.42399999994, 361002.6920000002, 186703.78699999998, 128813.68, 324224.2980000001, 299340.7180000001, 294077.4170000001, 150909.6090000001, 129349.90100000004, 330323.0120000003, 302207.86100000015, 292037.44900000014, 153759.41499999992, 155429.824, 377462.09200000006, 347985.5660000002, 338512.2010000001, 176172.57599999997, 152085.75600000008, 403562.46800000005, 346454.35199999996, 369962.30100000004, 190260.94900000008, 161095.21499999997, 377160.51400000026, 347673.05799999955, 356729.266, 177826.74499999994, 146952.75, 361862.4060000002, 318541.5379999998, 309403.83699999977, 156674.18399999995, 311062.6470000003, 779559.4470000003, 696240.9819999997, 681434.1180000007, 358317.233, 157639.7190000001, 394569.16400000016, 364805.063, 348821.9209999996, 183678.03199999992, 155573.24, 373003.0010000004, 347765.99700000015, 351558.27699999994, 176188.53500000012, 156194.77699999994, 376100.10300000035, 350363.7309999998, 349420.7769999998, 180706.102, 163425.78100000005, 394361.49999999994, 374445.44800000003, 366886.55100000027, 191772.97900000002, 142379.836, 326055.97399999993, 307108.3069999999, 285178.8039999997, 146422.32700000002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.918226667852002, "mean_inference_ms": 1.8552534522526656, "mean_action_processing_ms": 1.3810271368435916, "mean_env_wait_ms": 475.548882795386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0629354406286169, "StateBufferConnector_ms": 0.02960540630199291, "ViewRequirementAgentConnector_ms": 0.47460397084554035}, "num_episodes": 19, "episode_return_max": 5034831.708000005, "episode_return_min": 1108518.2280000004, "episode_return_mean": 1744691.7129259259, "episodes_this_iter": 19}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 6000, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 13.608043119822181, "num_env_steps_trained_throughput_per_sec": 13.608043119822181, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 453249.251, "restore_workers_time_ms": 0.0, "training_step_time_ms": 453249.251, "sample_time_ms": 423414.711, "learn_time_ms": 29820.041, "learn_throughput": 201.207, "synch_weights_time_ms": 11.502}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 2, "trial_id": "a5bb6_00000", "date": "2025-01-21_09-26-16", "timestamp": 1737480376, "time_this_iter_s": 440.9197130203247, "time_total_s": 906.5075018405914, "pid": 61756, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'environments.trafficEnv.TrafficLightMAEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 20000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 6000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function my_policy_mapping at 0x00000177903D92D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, "Dict('local_state': Dict('current_phase': Discrete(3), 'queue_length': Box(0.0, 100.0, (4,), float32), 'waiting_time': Box(0.0, 1000000.0, (4,), float32)), 'neighbor_info': Box(0.0, 100.0, (4,), float32))", "Dict('duration': Box(5.0, 60.0, (1,), float32), 'phase': Discrete(3))", {"model": {"custom_model": "my_traffic_model"}}]}, "callbacks": "<class 'config.trainingConfig.MetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 906.5075018405914, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 3.640035273368607, "ram_util_percent": 65.70952380952382, "gpu_util_percent0": 0.04063492063492064, "vram_util_percent0": 0.12108238260582009}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1326910104142858, "cur_kl_coeff": 0.3, "cur_lr": 0.0002999999999999999, "total_loss": 9.949246878522509, "policy_loss": 0.0016564685776037104, "vf_loss": 9.963917849520419, "vf_explained_var": -4.848470079137924e-06, "kl": 0.00623510778474635, "entropy": 1.8197981869413498, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 5875.5, "diff_num_grad_updates_vs_sampler_policy": 1174.5}}, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "env_runners": {"episode_reward_max": 8344200.362000038, "episode_reward_min": 1051513.0200000003, "episode_reward_mean": 1897348.1611956516, "episode_len_mean": 351.32608695652175, "episode_media": {}, "episodes_timesteps_total": 16161, "policy_reward_min": {"shared_policy": 115993.55000000002}, "policy_reward_max": {"shared_policy": 2267602.2100000023}, "policy_reward_mean": {"shared_policy": 379469.63223913044}, "custom_metrics": {"mean_queue_length": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "mean_waiting_time": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "mean_throughput": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "hist_stats": {"episode_reward": [2635966.6399999997, 1577107.1990000035, 1435334.2020000007, 1281700.6929999979, 1214867.2900000021, 1320232.8339999984, 1320277.062999999, 1401922.7379999997, 5034831.708000005, 2375296.458999998, 1317280.6699999997, 1217756.0139999986, 1108518.2280000004, 4591677.7200000025, 1506015.4599999995, 1197365.7219999994, 1207677.637999998, 1395562.2590000003, 1462325.825999998, 1420484.7980000007, 1293434.7149999982, 2826614.4269999946, 1449513.8989999988, 1404089.050000002, 1412785.4899999998, 1490892.2589999998, 1207145.248000001, 1391870.1069999977, 1088245.1120000002, 1246761.718999998, 8344200.362000038, 1051513.0200000003, 2667343.7369999937, 1351439.0600000012, 1320881.2169999995, 1268130.447999999, 3888424.738999997, 1341333.3639999996, 1169157.5889999988, 1286582.9869999976, 1200969.4360000005, 1414532.825999997, 1119612.5860000001, 1372774.5720000009, 6405143.447999987, 1242422.8369999977], "episode_lengths": [431, 327, 294, 304, 290, 263, 263, 275, 819, 388, 229, 216, 204, 903, 282, 226, 226, 247, 343, 252, 235, 561, 286, 246, 246, 257, 226, 252, 203, 229, 1527, 194, 492, 245, 241, 230, 710, 239, 216, 239, 215, 249, 210, 242, 1162, 227], "policy_shared_policy_reward": [292163.18699999974, 676669.675, 672171.9889999996, 665747.1960000007, 329214.59300000005, 172246.5559999999, 416722.4049999997, 402155.40399999986, 379286.9280000001, 206695.906, 157204.51600000003, 384913.5190000003, 363090.5069999997, 346082.5689999999, 184043.091, 140285.56800000003, 358160.6400000001, 289471.5149999998, 325496.1569999998, 168286.81299999994, 132645.57400000002, 329951.0429999999, 282157.646, 309175.7189999999, 160937.30799999993, 137345.956, 362218.75800000026, 324212.24899999955, 324595.49, 171860.38099999996, 140905.53500000006, 362067.88599999994, 327039.70800000016, 320229.50299999985, 170034.431, 152347.52699999994, 387437.2550000001, 341594.17100000015, 340989.2739999997, 179554.51100000014, 555899.7210000008, 1294357.2120000008, 1281514.0020000006, 1261280.6060000025, 641780.167, 261887.02700000012, 609583.7500000003, 608097.2899999998, 588872.0539999994, 306856.33799999976, 150858.37699999998, 352944.7050000003, 335020.4410000001, 317206.6469999999, 161250.49999999997, 139849.3699999999, 327697.9060000003, 298965.1319999998, 296429.3760000001, 154814.23, 119446.918, 298275.25600000017, 283631.044, 271438.2680000001, 135726.74199999997, 511145.7900000002, 1220550.0109999992, 1168670.151999999, 1107680.872999999, 583630.8940000003, 172820.27799999996, 402723.27899999986, 382765.42399999994, 361002.6920000002, 186703.78699999998, 128813.68, 324224.2980000001, 299340.7180000001, 294077.4170000001, 150909.6090000001, 129349.90100000004, 330323.0120000003, 302207.86100000015, 292037.44900000014, 153759.41499999992, 155429.824, 377462.09200000006, 347985.5660000002, 338512.2010000001, 176172.57599999997, 152085.75600000008, 403562.46800000005, 346454.35199999996, 369962.30100000004, 190260.94900000008, 161095.21499999997, 377160.51400000026, 347673.05799999955, 356729.266, 177826.74499999994, 146952.75, 361862.4060000002, 318541.5379999998, 309403.83699999977, 156674.18399999995, 311062.6470000003, 779559.4470000003, 696240.9819999997, 681434.1180000007, 358317.233, 157639.7190000001, 394569.16400000016, 364805.063, 348821.9209999996, 183678.03199999992, 155573.24, 373003.0010000004, 347765.99700000015, 351558.27699999994, 176188.53500000012, 156194.77699999994, 376100.10300000035, 350363.7309999998, 349420.7769999998, 180706.102, 163425.78100000005, 394361.49999999994, 374445.44800000003, 366886.55100000027, 191772.97900000002, 142379.836, 326055.97399999993, 307108.3069999999, 285178.8039999997, 146422.32700000002, 158412.53100000008, 367473.8829999998, 352654.4100000001, 340808.176, 172521.10699999987, 115993.55000000002, 299230.8940000002, 271711.40300000017, 262427.71200000006, 138881.55300000007, 141561.419, 344216.00600000005, 299428.2509999999, 303856.93799999985, 157699.10499999998, 940756.8639999997, 2267602.2100000023, 2073797.74, 2024529.2649999987, 1037514.2829999987, 129729.91899999997, 287130.202, 255253.211, 242876.4120000001, 136523.276, 292252.4709999999, 715073.3200000006, 661994.0100000005, 662236.449, 335787.4869999999, 145806.73799999998, 362434.87299999985, 331342.7890000001, 341050.2010000002, 170804.45899999992, 140026.16100000002, 353913.32499999984, 335806.2149999996, 323372.27699999994, 167763.23900000006, 136487.09799999997, 346894.24900000024, 309775.9190000001, 315308.33900000004, 159664.84300000008, 420112.8840000002, 1048991.9740000004, 975890.031000001, 954505.9729999996, 488923.87699999934, 148352.44900000002, 367139.73100000026, 334497.4459999999, 324142.5979999999, 167201.13999999996, 129196.373, 320487.7939999998, 296869.2020000001, 279612.73300000036, 142991.48700000002, 137984.85899999994, 350920.8839999999, 321781.0309999999, 311112.2909999998, 164783.92200000014, 132661.57999999996, 329504.176, 298221.05399999995, 285784.64199999993, 154797.98400000008, 152714.11800000002, 369190.92799999984, 360093.9110000001, 350958.9970000002, 181574.872, 118561.29899999997, 303033.3249999999, 274413.4349999998, 280093.363, 143511.16400000005, 147047.21599999996, 364408.80699999974, 348016.929, 339256.884, 174044.73600000003, 699174.4019999999, 1727795.0410000002, 1598367.9719999994, 1575350.251000002, 804455.7820000004, 136463.75999999998, 335965.96500000014, 313290.6010000002, 301699.9469999997, 155002.564]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.123009396506736, "mean_inference_ms": 1.841693798617505, "mean_action_processing_ms": 1.3731752978612237, "mean_env_wait_ms": 479.13634948729896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07716831953629204, "StateBufferConnector_ms": 0.023909755375074303, "ViewRequirementAgentConnector_ms": 0.45657365218452783}, "num_episodes": 19, "episode_return_max": 8344200.362000038, "episode_return_min": 1051513.0200000003, "episode_return_mean": 1897348.1611956516, "episodes_this_iter": 19}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_env_steps_sampled_this_iter": 6000, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 13.758607875359214, "num_env_steps_trained_throughput_per_sec": 13.758607875359214, "timesteps_total": 18000, "num_env_steps_sampled_lifetime": 18000, "num_agent_steps_sampled_lifetime": 90000, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 90000, "timers": {"training_iteration_time_ms": 447529.711, "restore_workers_time_ms": 0.0, "training_step_time_ms": 447529.711, "sample_time_ms": 417828.606, "learn_time_ms": 29687.106, "learn_throughput": 202.108, "synch_weights_time_ms": 11.331}, "counters": {"num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "done": false, "training_iteration": 3, "trial_id": "a5bb6_00000", "date": "2025-01-21_09-33-32", "timestamp": 1737480812, "time_this_iter_s": 436.09563398361206, "time_total_s": 1342.6031358242035, "pid": 61756, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'environments.trafficEnv.TrafficLightMAEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 20000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 6000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function my_policy_mapping at 0x00000177903D92D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, "Dict('local_state': Dict('current_phase': Discrete(3), 'queue_length': Box(0.0, 100.0, (4,), float32), 'waiting_time': Box(0.0, 1000000.0, (4,), float32)), 'neighbor_info': Box(0.0, 100.0, (4,), float32))", "Dict('duration': Box(5.0, 60.0, (1,), float32), 'phase': Discrete(3))", {"model": {"custom_model": "my_traffic_model"}}]}, "callbacks": "<class 'config.trainingConfig.MetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1342.6031358242035, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 3.005704099821747, "ram_util_percent": 64.90855614973262, "gpu_util_percent0": 0.031247771836007132, "vram_util_percent0": 0.11978766293449197}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0497416010942864, "cur_kl_coeff": 0.3, "cur_lr": 0.0002999999999999999, "total_loss": 9.93902966357292, "policy_loss": 0.00031160019987084447, "vf_loss": 9.956032518021605, "vf_explained_var": -6.085101594316198e-06, "kl": 0.004013852451611973, "entropy": 1.8518614469690526, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 8225.5, "diff_num_grad_updates_vs_sampler_policy": 1174.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": 8344200.362000038, "episode_reward_min": 1051513.0200000003, "episode_reward_mean": 1720026.2702352945, "episode_len_mean": 315.0882352941176, "episode_media": {}, "episodes_timesteps_total": 21426, "policy_reward_min": {"shared_policy": 115993.55000000002}, "policy_reward_max": {"shared_policy": 2267602.2100000023}, "policy_reward_mean": {"shared_policy": 344005.2540470588}, "custom_metrics": {"mean_queue_length": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "mean_waiting_time": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "mean_throughput": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "hist_stats": {"episode_reward": [2635966.6399999997, 1577107.1990000035, 1435334.2020000007, 1281700.6929999979, 1214867.2900000021, 1320232.8339999984, 1320277.062999999, 1401922.7379999997, 5034831.708000005, 2375296.458999998, 1317280.6699999997, 1217756.0139999986, 1108518.2280000004, 4591677.7200000025, 1506015.4599999995, 1197365.7219999994, 1207677.637999998, 1395562.2590000003, 1462325.825999998, 1420484.7980000007, 1293434.7149999982, 2826614.4269999946, 1449513.8989999988, 1404089.050000002, 1412785.4899999998, 1490892.2589999998, 1207145.248000001, 1391870.1069999977, 1088245.1120000002, 1246761.718999998, 8344200.362000038, 1051513.0200000003, 2667343.7369999937, 1351439.0600000012, 1320881.2169999995, 1268130.447999999, 3888424.738999997, 1341333.3639999996, 1169157.5889999988, 1286582.9869999976, 1200969.4360000005, 1414532.825999997, 1119612.5860000001, 1372774.5720000009, 6405143.447999987, 1242422.8369999977, 1177546.1180000002, 1167440.3130000003, 1332054.1689999998, 1310011.4979999985, 1413639.4140000015, 1392401.2219999996, 1320380.920000001, 2698390.461000005, 1282919.1230000013, 1161204.9599999988, 1193858.0950000007, 1431615.269, 1468431.451, 1293786.2470000018, 1131464.0239999983, 1088596.4640000009, 1260684.6130000006, 1273456.0540000007, 1325319.6249999988, 1341578.6350000012, 1314445.5690000006, 1304546.7169999992], "episode_lengths": [431, 327, 294, 304, 290, 263, 263, 275, 819, 388, 229, 216, 204, 903, 282, 226, 226, 247, 343, 252, 235, 561, 286, 246, 246, 257, 226, 252, 203, 229, 1527, 194, 492, 245, 241, 230, 710, 239, 216, 239, 215, 249, 210, 242, 1162, 227, 205, 205, 226, 226, 258, 258, 242, 469, 227, 206, 206, 249, 254, 230, 206, 206, 219, 219, 242, 242, 235, 235], "policy_shared_policy_reward": [292163.18699999974, 676669.675, 672171.9889999996, 665747.1960000007, 329214.59300000005, 172246.5559999999, 416722.4049999997, 402155.40399999986, 379286.9280000001, 206695.906, 157204.51600000003, 384913.5190000003, 363090.5069999997, 346082.5689999999, 184043.091, 140285.56800000003, 358160.6400000001, 289471.5149999998, 325496.1569999998, 168286.81299999994, 132645.57400000002, 329951.0429999999, 282157.646, 309175.7189999999, 160937.30799999993, 137345.956, 362218.75800000026, 324212.24899999955, 324595.49, 171860.38099999996, 140905.53500000006, 362067.88599999994, 327039.70800000016, 320229.50299999985, 170034.431, 152347.52699999994, 387437.2550000001, 341594.17100000015, 340989.2739999997, 179554.51100000014, 555899.7210000008, 1294357.2120000008, 1281514.0020000006, 1261280.6060000025, 641780.167, 261887.02700000012, 609583.7500000003, 608097.2899999998, 588872.0539999994, 306856.33799999976, 150858.37699999998, 352944.7050000003, 335020.4410000001, 317206.6469999999, 161250.49999999997, 139849.3699999999, 327697.9060000003, 298965.1319999998, 296429.3760000001, 154814.23, 119446.918, 298275.25600000017, 283631.044, 271438.2680000001, 135726.74199999997, 511145.7900000002, 1220550.0109999992, 1168670.151999999, 1107680.872999999, 583630.8940000003, 172820.27799999996, 402723.27899999986, 382765.42399999994, 361002.6920000002, 186703.78699999998, 128813.68, 324224.2980000001, 299340.7180000001, 294077.4170000001, 150909.6090000001, 129349.90100000004, 330323.0120000003, 302207.86100000015, 292037.44900000014, 153759.41499999992, 155429.824, 377462.09200000006, 347985.5660000002, 338512.2010000001, 176172.57599999997, 152085.75600000008, 403562.46800000005, 346454.35199999996, 369962.30100000004, 190260.94900000008, 161095.21499999997, 377160.51400000026, 347673.05799999955, 356729.266, 177826.74499999994, 146952.75, 361862.4060000002, 318541.5379999998, 309403.83699999977, 156674.18399999995, 311062.6470000003, 779559.4470000003, 696240.9819999997, 681434.1180000007, 358317.233, 157639.7190000001, 394569.16400000016, 364805.063, 348821.9209999996, 183678.03199999992, 155573.24, 373003.0010000004, 347765.99700000015, 351558.27699999994, 176188.53500000012, 156194.77699999994, 376100.10300000035, 350363.7309999998, 349420.7769999998, 180706.102, 163425.78100000005, 394361.49999999994, 374445.44800000003, 366886.55100000027, 191772.97900000002, 142379.836, 326055.97399999993, 307108.3069999999, 285178.8039999997, 146422.32700000002, 158412.53100000008, 367473.8829999998, 352654.4100000001, 340808.176, 172521.10699999987, 115993.55000000002, 299230.8940000002, 271711.40300000017, 262427.71200000006, 138881.55300000007, 141561.419, 344216.00600000005, 299428.2509999999, 303856.93799999985, 157699.10499999998, 940756.8639999997, 2267602.2100000023, 2073797.74, 2024529.2649999987, 1037514.2829999987, 129729.91899999997, 287130.202, 255253.211, 242876.4120000001, 136523.276, 292252.4709999999, 715073.3200000006, 661994.0100000005, 662236.449, 335787.4869999999, 145806.73799999998, 362434.87299999985, 331342.7890000001, 341050.2010000002, 170804.45899999992, 140026.16100000002, 353913.32499999984, 335806.2149999996, 323372.27699999994, 167763.23900000006, 136487.09799999997, 346894.24900000024, 309775.9190000001, 315308.33900000004, 159664.84300000008, 420112.8840000002, 1048991.9740000004, 975890.031000001, 954505.9729999996, 488923.87699999934, 148352.44900000002, 367139.73100000026, 334497.4459999999, 324142.5979999999, 167201.13999999996, 129196.373, 320487.7939999998, 296869.2020000001, 279612.73300000036, 142991.48700000002, 137984.85899999994, 350920.8839999999, 321781.0309999999, 311112.2909999998, 164783.92200000014, 132661.57999999996, 329504.176, 298221.05399999995, 285784.64199999993, 154797.98400000008, 152714.11800000002, 369190.92799999984, 360093.9110000001, 350958.9970000002, 181574.872, 118561.29899999997, 303033.3249999999, 274413.4349999998, 280093.363, 143511.16400000005, 147047.21599999996, 364408.80699999974, 348016.929, 339256.884, 174044.73600000003, 699174.4019999999, 1727795.0410000002, 1598367.9719999994, 1575350.251000002, 804455.7820000004, 136463.75999999998, 335965.96500000014, 313290.6010000002, 301699.9469999997, 155002.564, 130483.02400000006, 315796.53699999984, 286395.24700000003, 294239.682, 150631.628, 128110.27899999995, 311431.67199999996, 281573.74599999975, 293914.1149999998, 152410.50100000008, 140739.87900000004, 352216.50999999954, 330350.19700000004, 338066.2560000003, 170681.32699999996, 138269.44800000015, 349139.2199999999, 325612.12800000014, 330580.9150000001, 166409.787, 152502.03, 384638.5819999998, 364006.46200000006, 340309.91200000007, 172182.42799999993, 145126.23699999994, 386857.14900000015, 354165.811, 336051.87400000007, 170200.15100000013, 146472.05999999997, 356183.0470000004, 334270.7749999997, 319564.27599999966, 163890.762, 298686.44100000005, 724326.4879999999, 681271.0500000003, 663978.02, 330128.4619999998, 139093.7230000001, 343750.8849999999, 326852.139, 315777.94000000006, 157444.4360000001, 130881.85399999998, 309134.81, 292524.09299999994, 283474.5390000001, 145189.664, 134724.91699999996, 319671.06699999975, 297146.84799999994, 293732.5759999999, 148582.6870000001, 158575.25699999998, 386620.20999999956, 355591.01100000046, 346362.62600000016, 184466.1649999999, 170993.092, 397523.2999999998, 359336.7300000001, 359897.1579999999, 180681.17100000006, 140465.33200000002, 348161.1459999998, 323693.52, 314992.88899999973, 166473.36, 127253.50400000003, 315345.772, 280113.70999999985, 267336.32799999986, 141414.7100000001, 123392.295, 298007.36699999997, 268663.808, 261873.26099999997, 136659.73300000007, 138880.11099999998, 330149.1999999997, 308631.4360000001, 312522.75599999994, 170501.11000000007, 140698.30600000004, 335642.7239999998, 311429.861, 315068.764, 170616.39899999983, 144150.73500000002, 358924.19600000005, 336766.65600000013, 322459.9110000001, 163018.12699999998, 146278.1629999999, 361441.3690000002, 342465.9260000002, 327629.1439999999, 163764.03299999994, 147894.99199999988, 357553.0169999999, 325279.39500000014, 323190.5509999999, 160527.61399999994, 143397.60999999996, 358125.4800000001, 323764.988, 319928.3660000003, 159330.2729999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.377538867947675, "mean_inference_ms": 1.83201770758905, "mean_action_processing_ms": 1.366619111924652, "mean_env_wait_ms": 483.373180774321, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08159665500416476, "StateBufferConnector_ms": 0.024996434941011315, "ViewRequirementAgentConnector_ms": 0.441209358327529}, "num_episodes": 22, "episode_return_max": 8344200.362000038, "episode_return_min": 1051513.0200000003, "episode_return_mean": 1720026.2702352945, "episodes_this_iter": 22}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 6000, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 13.367933132045076, "num_env_steps_trained_throughput_per_sec": 13.367933132045076, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 447856.103, "restore_workers_time_ms": 0.0, "training_step_time_ms": 447855.856, "sample_time_ms": 418328.167, "learn_time_ms": 29513.685, "learn_throughput": 203.296, "synch_weights_time_ms": 11.25}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 4, "trial_id": "a5bb6_00000", "date": "2025-01-21_09-41-01", "timestamp": 1737481261, "time_this_iter_s": 448.840802192688, "time_total_s": 1791.4439380168915, "pid": 61756, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'environments.trafficEnv.TrafficLightMAEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 20000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 6000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function my_policy_mapping at 0x00000177903D92D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, "Dict('local_state': Dict('current_phase': Discrete(3), 'queue_length': Box(0.0, 100.0, (4,), float32), 'waiting_time': Box(0.0, 1000000.0, (4,), float32)), 'neighbor_info': Box(0.0, 100.0, (4,), float32))", "Dict('duration': Box(5.0, 60.0, (1,), float32), 'phase': Discrete(3))", {"model": {"custom_model": "my_traffic_model"}}]}, "callbacks": "<class 'config.trainingConfig.MetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1791.4439380168915, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 3.142906574394464, "ram_util_percent": 63.133391003460204, "gpu_util_percent0": 0.03124567474048443, "vram_util_percent0": 0.1131837627054498}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9655714777936326, "cur_kl_coeff": 0.15, "cur_lr": 0.0002999999999999999, "total_loss": 9.931821201405628, "policy_loss": 0.0006691632376230778, "vf_loss": 9.948946139558833, "vf_explained_var": -5.528647848900328e-06, "kl": 0.005737644883947794, "entropy": 1.8654744591104224, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 10575.5, "diff_num_grad_updates_vs_sampler_policy": 1174.5}}, "num_env_steps_sampled": 30000, "num_env_steps_trained": 30000, "num_agent_steps_sampled": 150000, "num_agent_steps_trained": 150000}, "env_runners": {"episode_reward_max": 17082292.984000027, "episode_reward_min": 1023724.9150000003, "episode_reward_mean": 1779239.9232173916, "episode_len_mean": 327.0217391304348, "episode_media": {}, "episodes_timesteps_total": 30086, "policy_reward_min": {"shared_policy": 109582.05800000005}, "policy_reward_max": {"shared_policy": 4645141.872000005}, "policy_reward_mean": {"shared_policy": 355847.98464347824}, "custom_metrics": {"mean_queue_length": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "mean_waiting_time": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "mean_throughput": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "hist_stats": {"episode_reward": [2635966.6399999997, 1577107.1990000035, 1435334.2020000007, 1281700.6929999979, 1214867.2900000021, 1320232.8339999984, 1320277.062999999, 1401922.7379999997, 5034831.708000005, 2375296.458999998, 1317280.6699999997, 1217756.0139999986, 1108518.2280000004, 4591677.7200000025, 1506015.4599999995, 1197365.7219999994, 1207677.637999998, 1395562.2590000003, 1462325.825999998, 1420484.7980000007, 1293434.7149999982, 2826614.4269999946, 1449513.8989999988, 1404089.050000002, 1412785.4899999998, 1490892.2589999998, 1207145.248000001, 1391870.1069999977, 1088245.1120000002, 1246761.718999998, 8344200.362000038, 1051513.0200000003, 2667343.7369999937, 1351439.0600000012, 1320881.2169999995, 1268130.447999999, 3888424.738999997, 1341333.3639999996, 1169157.5889999988, 1286582.9869999976, 1200969.4360000005, 1414532.825999997, 1119612.5860000001, 1372774.5720000009, 6405143.447999987, 1242422.8369999977, 1177546.1180000002, 1167440.3130000003, 1332054.1689999998, 1310011.4979999985, 1413639.4140000015, 1392401.2219999996, 1320380.920000001, 2698390.461000005, 1282919.1230000013, 1161204.9599999988, 1193858.0950000007, 1431615.269, 1468431.451, 1293786.2470000018, 1131464.0239999983, 1088596.4640000009, 1260684.6130000006, 1273456.0540000007, 1325319.6249999988, 1341578.6350000012, 1314445.5690000006, 1304546.7169999992, 1278158.753, 1329246.9179999998, 1137675.9400000009, 1131879.048000001, 1182392.3040000016, 1172873.5859999978, 1513559.6589999998, 1184487.0290000006, 2369608.0269999923, 1146335.2099999995, 1509781.3659999995, 1451405.6800000025, 1092130.5919999995, 1093484.3940000013, 17082292.984000027, 1286196.2600000023, 1149566.5949999995, 1153722.962, 1334950.8949999965, 1319682.4190000002, 1082668.7429999986, 1512900.0229999998, 1189562.2579999994, 1023724.9150000003], "episode_lengths": [431, 327, 294, 304, 290, 263, 263, 275, 819, 388, 229, 216, 204, 903, 282, 226, 226, 247, 343, 252, 235, 561, 286, 246, 246, 257, 226, 252, 203, 229, 1527, 194, 492, 245, 241, 230, 710, 239, 216, 239, 215, 249, 210, 242, 1162, 227, 205, 205, 226, 226, 258, 258, 242, 469, 227, 206, 206, 249, 254, 230, 206, 206, 219, 219, 242, 242, 235, 235, 238, 238, 209, 209, 211, 211, 250, 215, 426, 211, 265, 265, 202, 202, 3309, 233, 212, 212, 242, 242, 196, 261, 203, 198], "policy_shared_policy_reward": [292163.18699999974, 676669.675, 672171.9889999996, 665747.1960000007, 329214.59300000005, 172246.5559999999, 416722.4049999997, 402155.40399999986, 379286.9280000001, 206695.906, 157204.51600000003, 384913.5190000003, 363090.5069999997, 346082.5689999999, 184043.091, 140285.56800000003, 358160.6400000001, 289471.5149999998, 325496.1569999998, 168286.81299999994, 132645.57400000002, 329951.0429999999, 282157.646, 309175.7189999999, 160937.30799999993, 137345.956, 362218.75800000026, 324212.24899999955, 324595.49, 171860.38099999996, 140905.53500000006, 362067.88599999994, 327039.70800000016, 320229.50299999985, 170034.431, 152347.52699999994, 387437.2550000001, 341594.17100000015, 340989.2739999997, 179554.51100000014, 555899.7210000008, 1294357.2120000008, 1281514.0020000006, 1261280.6060000025, 641780.167, 261887.02700000012, 609583.7500000003, 608097.2899999998, 588872.0539999994, 306856.33799999976, 150858.37699999998, 352944.7050000003, 335020.4410000001, 317206.6469999999, 161250.49999999997, 139849.3699999999, 327697.9060000003, 298965.1319999998, 296429.3760000001, 154814.23, 119446.918, 298275.25600000017, 283631.044, 271438.2680000001, 135726.74199999997, 511145.7900000002, 1220550.0109999992, 1168670.151999999, 1107680.872999999, 583630.8940000003, 172820.27799999996, 402723.27899999986, 382765.42399999994, 361002.6920000002, 186703.78699999998, 128813.68, 324224.2980000001, 299340.7180000001, 294077.4170000001, 150909.6090000001, 129349.90100000004, 330323.0120000003, 302207.86100000015, 292037.44900000014, 153759.41499999992, 155429.824, 377462.09200000006, 347985.5660000002, 338512.2010000001, 176172.57599999997, 152085.75600000008, 403562.46800000005, 346454.35199999996, 369962.30100000004, 190260.94900000008, 161095.21499999997, 377160.51400000026, 347673.05799999955, 356729.266, 177826.74499999994, 146952.75, 361862.4060000002, 318541.5379999998, 309403.83699999977, 156674.18399999995, 311062.6470000003, 779559.4470000003, 696240.9819999997, 681434.1180000007, 358317.233, 157639.7190000001, 394569.16400000016, 364805.063, 348821.9209999996, 183678.03199999992, 155573.24, 373003.0010000004, 347765.99700000015, 351558.27699999994, 176188.53500000012, 156194.77699999994, 376100.10300000035, 350363.7309999998, 349420.7769999998, 180706.102, 163425.78100000005, 394361.49999999994, 374445.44800000003, 366886.55100000027, 191772.97900000002, 142379.836, 326055.97399999993, 307108.3069999999, 285178.8039999997, 146422.32700000002, 158412.53100000008, 367473.8829999998, 352654.4100000001, 340808.176, 172521.10699999987, 115993.55000000002, 299230.8940000002, 271711.40300000017, 262427.71200000006, 138881.55300000007, 141561.419, 344216.00600000005, 299428.2509999999, 303856.93799999985, 157699.10499999998, 940756.8639999997, 2267602.2100000023, 2073797.74, 2024529.2649999987, 1037514.2829999987, 129729.91899999997, 287130.202, 255253.211, 242876.4120000001, 136523.276, 292252.4709999999, 715073.3200000006, 661994.0100000005, 662236.449, 335787.4869999999, 145806.73799999998, 362434.87299999985, 331342.7890000001, 341050.2010000002, 170804.45899999992, 140026.16100000002, 353913.32499999984, 335806.2149999996, 323372.27699999994, 167763.23900000006, 136487.09799999997, 346894.24900000024, 309775.9190000001, 315308.33900000004, 159664.84300000008, 420112.8840000002, 1048991.9740000004, 975890.031000001, 954505.9729999996, 488923.87699999934, 148352.44900000002, 367139.73100000026, 334497.4459999999, 324142.5979999999, 167201.13999999996, 129196.373, 320487.7939999998, 296869.2020000001, 279612.73300000036, 142991.48700000002, 137984.85899999994, 350920.8839999999, 321781.0309999999, 311112.2909999998, 164783.92200000014, 132661.57999999996, 329504.176, 298221.05399999995, 285784.64199999993, 154797.98400000008, 152714.11800000002, 369190.92799999984, 360093.9110000001, 350958.9970000002, 181574.872, 118561.29899999997, 303033.3249999999, 274413.4349999998, 280093.363, 143511.16400000005, 147047.21599999996, 364408.80699999974, 348016.929, 339256.884, 174044.73600000003, 699174.4019999999, 1727795.0410000002, 1598367.9719999994, 1575350.251000002, 804455.7820000004, 136463.75999999998, 335965.96500000014, 313290.6010000002, 301699.9469999997, 155002.564, 130483.02400000006, 315796.53699999984, 286395.24700000003, 294239.682, 150631.628, 128110.27899999995, 311431.67199999996, 281573.74599999975, 293914.1149999998, 152410.50100000008, 140739.87900000004, 352216.50999999954, 330350.19700000004, 338066.2560000003, 170681.32699999996, 138269.44800000015, 349139.2199999999, 325612.12800000014, 330580.9150000001, 166409.787, 152502.03, 384638.5819999998, 364006.46200000006, 340309.91200000007, 172182.42799999993, 145126.23699999994, 386857.14900000015, 354165.811, 336051.87400000007, 170200.15100000013, 146472.05999999997, 356183.0470000004, 334270.7749999997, 319564.27599999966, 163890.762, 298686.44100000005, 724326.4879999999, 681271.0500000003, 663978.02, 330128.4619999998, 139093.7230000001, 343750.8849999999, 326852.139, 315777.94000000006, 157444.4360000001, 130881.85399999998, 309134.81, 292524.09299999994, 283474.5390000001, 145189.664, 134724.91699999996, 319671.06699999975, 297146.84799999994, 293732.5759999999, 148582.6870000001, 158575.25699999998, 386620.20999999956, 355591.01100000046, 346362.62600000016, 184466.1649999999, 170993.092, 397523.2999999998, 359336.7300000001, 359897.1579999999, 180681.17100000006, 140465.33200000002, 348161.1459999998, 323693.52, 314992.88899999973, 166473.36, 127253.50400000003, 315345.772, 280113.70999999985, 267336.32799999986, 141414.7100000001, 123392.295, 298007.36699999997, 268663.808, 261873.26099999997, 136659.73300000007, 138880.11099999998, 330149.1999999997, 308631.4360000001, 312522.75599999994, 170501.11000000007, 140698.30600000004, 335642.7239999998, 311429.861, 315068.764, 170616.39899999983, 144150.73500000002, 358924.19600000005, 336766.65600000013, 322459.9110000001, 163018.12699999998, 146278.1629999999, 361441.3690000002, 342465.9260000002, 327629.1439999999, 163764.03299999994, 147894.99199999988, 357553.0169999999, 325279.39500000014, 323190.5509999999, 160527.61399999994, 143397.60999999996, 358125.4800000001, 323764.988, 319928.3660000003, 159330.2729999998, 142260.03099999996, 350601.685, 312652.5100000002, 313029.1209999999, 159615.40600000008, 151271.71600000007, 355633.40300000017, 327979.1009999999, 327350.06799999985, 167012.62999999995, 118740.17699999995, 317653.69399999996, 275109.61, 282680.817, 143491.642, 120869.226, 312002.75099999993, 277381.89299999987, 280395.6660000001, 141229.51200000002, 128932.61700000003, 318400.9079999997, 290071.2829999999, 293098.69999999984, 151888.7959999999, 129319.53499999996, 315449.41100000014, 290173.09199999995, 288875.1500000002, 149056.39799999993, 173732.72300000023, 402042.36499999993, 368646.77600000025, 378301.8370000001, 190835.95799999993, 131428.12099999993, 317822.0650000003, 298817.0220000002, 288204.5730000001, 148215.24799999996, 272441.94000000006, 638325.9010000004, 600386.9040000002, 566392.8500000001, 292060.4320000002, 133626.02199999988, 313128.6040000002, 287903.05100000004, 269767.9170000002, 141909.616, 162908.20900000012, 407847.51500000013, 382718.46899999975, 371045.9940000001, 185261.179, 155197.78599999993, 387106.54099999997, 369648.30700000003, 359074.10000000027, 180378.94599999994, 115084.54800000002, 300800.5870000001, 264309.45600000006, 270319.4929999997, 141616.5080000001, 111462.147, 295761.68099999987, 272879.2370000001, 270053.44800000015, 143327.88100000008, 1875178.2080000043, 4645141.872000005, 4197978.230999993, 4202188.602000003, 2161806.070999998, 141855.22600000005, 354570.79500000033, 331028.589, 305615.8760000001, 153125.77399999998, 124634.91599999995, 306516.5420000001, 285436.875, 283697.61500000005, 149280.64700000006, 124275.876, 304052.234, 293183.0140000001, 282315.1379999998, 149896.69999999992, 146289.95799999993, 361593.77099999983, 335008.97099999996, 328965.5599999999, 163092.63499999995, 142701.04700000008, 360108.3529999999, 327885.24799999985, 325768.36599999963, 163219.405, 120390.10599999999, 285837.4160000001, 277642.64000000025, 260634.88499999992, 138163.696, 170124.80000000002, 404433.75399999996, 379335.7110000002, 368992.32399999985, 190013.4339999999, 133878.01200000002, 312134.955, 304662.714, 292137.39900000015, 146749.17799999999, 109582.05800000005, 275321.3280000001, 260858.59300000005, 249495.69000000003, 128467.246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.52693681508339, "mean_inference_ms": 1.827219633079107, "mean_action_processing_ms": 1.3627481165224464, "mean_env_wait_ms": 485.43816295172934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08531471957331119, "StateBufferConnector_ms": 0.023379274036573326, "ViewRequirementAgentConnector_ms": 0.4489134187283723}, "num_episodes": 24, "episode_return_max": 17082292.984000027, "episode_return_min": 1023724.9150000003, "episode_return_mean": 1779239.9232173916, "episodes_this_iter": 24}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 150000, "num_agent_steps_trained": 150000, "num_env_steps_sampled": 30000, "num_env_steps_trained": 30000, "num_env_steps_sampled_this_iter": 6000, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 13.459790678681049, "num_env_steps_trained_throughput_per_sec": 13.459790678681049, "timesteps_total": 30000, "num_env_steps_sampled_lifetime": 30000, "num_agent_steps_sampled_lifetime": 150000, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 150000, "timers": {"training_iteration_time_ms": 447439.315, "restore_workers_time_ms": 0.0, "training_step_time_ms": 447439.117, "sample_time_ms": 417920.595, "learn_time_ms": 29504.522, "learn_throughput": 203.359, "synch_weights_time_ms": 11.198}, "counters": {"num_env_steps_sampled": 30000, "num_env_steps_trained": 30000, "num_agent_steps_sampled": 150000, "num_agent_steps_trained": 150000}, "done": false, "training_iteration": 5, "trial_id": "a5bb6_00000", "date": "2025-01-21_09-48-26", "timestamp": 1737481706, "time_this_iter_s": 445.7791602611542, "time_total_s": 2237.2230982780457, "pid": 61756, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'environments.trafficEnv.TrafficLightMAEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 20000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 6000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function my_policy_mapping at 0x00000177903D92D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, "Dict('local_state': Dict('current_phase': Discrete(3), 'queue_length': Box(0.0, 100.0, (4,), float32), 'waiting_time': Box(0.0, 1000000.0, (4,), float32)), 'neighbor_info': Box(0.0, 100.0, (4,), float32))", "Dict('duration': Box(5.0, 60.0, (1,), float32), 'phase': Discrete(3))", {"model": {"custom_model": "my_traffic_model"}}]}, "callbacks": "<class 'config.trainingConfig.MetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2237.2230982780457, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 3.1409407665505227, "ram_util_percent": 58.068815331010455, "gpu_util_percent0": 0.032595818815331, "vram_util_percent0": 0.11318359374999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9569157103147912, "cur_kl_coeff": 0.15, "cur_lr": 0.0002999999999999999, "total_loss": 9.945828462154306, "policy_loss": 0.0002526043238554229, "vf_loss": 9.96316080377457, "vf_explained_var": -2.9723187710376497e-06, "kl": 0.005590785043371208, "entropy": 1.8423569574761898, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 12925.5, "diff_num_grad_updates_vs_sampler_policy": 1174.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "env_runners": {"episode_reward_max": 17082292.984000027, "episode_reward_min": 1023724.9150000003, "episode_reward_mean": 1784882.1784000006, "episode_len_mean": 325.87, "episode_media": {}, "episodes_timesteps_total": 32587, "policy_reward_min": {"shared_policy": 109582.05800000005}, "policy_reward_max": {"shared_policy": 4645141.872000005}, "policy_reward_mean": {"shared_policy": 356976.43567999994}, "custom_metrics": {"mean_queue_length": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "mean_waiting_time": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "mean_throughput": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "hist_stats": {"episode_reward": [1108518.2280000004, 4591677.7200000025, 1506015.4599999995, 1197365.7219999994, 1207677.637999998, 1395562.2590000003, 1462325.825999998, 1420484.7980000007, 1293434.7149999982, 2826614.4269999946, 1449513.8989999988, 1404089.050000002, 1412785.4899999998, 1490892.2589999998, 1207145.248000001, 1391870.1069999977, 1088245.1120000002, 1246761.718999998, 8344200.362000038, 1051513.0200000003, 2667343.7369999937, 1351439.0600000012, 1320881.2169999995, 1268130.447999999, 3888424.738999997, 1341333.3639999996, 1169157.5889999988, 1286582.9869999976, 1200969.4360000005, 1414532.825999997, 1119612.5860000001, 1372774.5720000009, 6405143.447999987, 1242422.8369999977, 1177546.1180000002, 1167440.3130000003, 1332054.1689999998, 1310011.4979999985, 1413639.4140000015, 1392401.2219999996, 1320380.920000001, 2698390.461000005, 1282919.1230000013, 1161204.9599999988, 1193858.0950000007, 1431615.269, 1468431.451, 1293786.2470000018, 1131464.0239999983, 1088596.4640000009, 1260684.6130000006, 1273456.0540000007, 1325319.6249999988, 1341578.6350000012, 1314445.5690000006, 1304546.7169999992, 1278158.753, 1329246.9179999998, 1137675.9400000009, 1131879.048000001, 1182392.3040000016, 1172873.5859999978, 1513559.6589999998, 1184487.0290000006, 2369608.0269999923, 1146335.2099999995, 1509781.3659999995, 1451405.6800000025, 1092130.5919999995, 1093484.3940000013, 17082292.984000027, 1286196.2600000023, 1149566.5949999995, 1153722.962, 1334950.8949999965, 1319682.4190000002, 1082668.7429999986, 1512900.0229999998, 1189562.2579999994, 1023724.9150000003, 1403770.132999999, 4288617.136999999, 1415027.7569999972, 1206023.9390000002, 1163919.3200000003, 1281143.6989999986, 3596176.684999996, 1138626.9849999994, 1370397.3619999993, 1209157.3799999994, 3630630.1000000006, 1256401.993000001, 1275213.462999999, 5109243.983999991, 1337340.8800000001, 1113894.4590000003, 1116112.8860000002, 1451009.533999998, 1452797.6310000008, 1115213.0869999991], "episode_lengths": [204, 903, 282, 226, 226, 247, 343, 252, 235, 561, 286, 246, 246, 257, 226, 252, 203, 229, 1527, 194, 492, 245, 241, 230, 710, 239, 216, 239, 215, 249, 210, 242, 1162, 227, 205, 205, 226, 226, 258, 258, 242, 469, 227, 206, 206, 249, 254, 230, 206, 206, 219, 219, 242, 242, 235, 235, 238, 238, 209, 209, 211, 211, 250, 215, 426, 211, 265, 265, 202, 202, 3309, 233, 212, 212, 242, 242, 196, 261, 203, 198, 249, 756, 257, 227, 209, 235, 655, 211, 230, 222, 632, 214, 229, 906, 244, 204, 204, 254, 254, 208], "policy_shared_policy_reward": [119446.918, 298275.25600000017, 283631.044, 271438.2680000001, 135726.74199999997, 511145.7900000002, 1220550.0109999992, 1168670.151999999, 1107680.872999999, 583630.8940000003, 172820.27799999996, 402723.27899999986, 382765.42399999994, 361002.6920000002, 186703.78699999998, 128813.68, 324224.2980000001, 299340.7180000001, 294077.4170000001, 150909.6090000001, 129349.90100000004, 330323.0120000003, 302207.86100000015, 292037.44900000014, 153759.41499999992, 155429.824, 377462.09200000006, 347985.5660000002, 338512.2010000001, 176172.57599999997, 152085.75600000008, 403562.46800000005, 346454.35199999996, 369962.30100000004, 190260.94900000008, 161095.21499999997, 377160.51400000026, 347673.05799999955, 356729.266, 177826.74499999994, 146952.75, 361862.4060000002, 318541.5379999998, 309403.83699999977, 156674.18399999995, 311062.6470000003, 779559.4470000003, 696240.9819999997, 681434.1180000007, 358317.233, 157639.7190000001, 394569.16400000016, 364805.063, 348821.9209999996, 183678.03199999992, 155573.24, 373003.0010000004, 347765.99700000015, 351558.27699999994, 176188.53500000012, 156194.77699999994, 376100.10300000035, 350363.7309999998, 349420.7769999998, 180706.102, 163425.78100000005, 394361.49999999994, 374445.44800000003, 366886.55100000027, 191772.97900000002, 142379.836, 326055.97399999993, 307108.3069999999, 285178.8039999997, 146422.32700000002, 158412.53100000008, 367473.8829999998, 352654.4100000001, 340808.176, 172521.10699999987, 115993.55000000002, 299230.8940000002, 271711.40300000017, 262427.71200000006, 138881.55300000007, 141561.419, 344216.00600000005, 299428.2509999999, 303856.93799999985, 157699.10499999998, 940756.8639999997, 2267602.2100000023, 2073797.74, 2024529.2649999987, 1037514.2829999987, 129729.91899999997, 287130.202, 255253.211, 242876.4120000001, 136523.276, 292252.4709999999, 715073.3200000006, 661994.0100000005, 662236.449, 335787.4869999999, 145806.73799999998, 362434.87299999985, 331342.7890000001, 341050.2010000002, 170804.45899999992, 140026.16100000002, 353913.32499999984, 335806.2149999996, 323372.27699999994, 167763.23900000006, 136487.09799999997, 346894.24900000024, 309775.9190000001, 315308.33900000004, 159664.84300000008, 420112.8840000002, 1048991.9740000004, 975890.031000001, 954505.9729999996, 488923.87699999934, 148352.44900000002, 367139.73100000026, 334497.4459999999, 324142.5979999999, 167201.13999999996, 129196.373, 320487.7939999998, 296869.2020000001, 279612.73300000036, 142991.48700000002, 137984.85899999994, 350920.8839999999, 321781.0309999999, 311112.2909999998, 164783.92200000014, 132661.57999999996, 329504.176, 298221.05399999995, 285784.64199999993, 154797.98400000008, 152714.11800000002, 369190.92799999984, 360093.9110000001, 350958.9970000002, 181574.872, 118561.29899999997, 303033.3249999999, 274413.4349999998, 280093.363, 143511.16400000005, 147047.21599999996, 364408.80699999974, 348016.929, 339256.884, 174044.73600000003, 699174.4019999999, 1727795.0410000002, 1598367.9719999994, 1575350.251000002, 804455.7820000004, 136463.75999999998, 335965.96500000014, 313290.6010000002, 301699.9469999997, 155002.564, 130483.02400000006, 315796.53699999984, 286395.24700000003, 294239.682, 150631.628, 128110.27899999995, 311431.67199999996, 281573.74599999975, 293914.1149999998, 152410.50100000008, 140739.87900000004, 352216.50999999954, 330350.19700000004, 338066.2560000003, 170681.32699999996, 138269.44800000015, 349139.2199999999, 325612.12800000014, 330580.9150000001, 166409.787, 152502.03, 384638.5819999998, 364006.46200000006, 340309.91200000007, 172182.42799999993, 145126.23699999994, 386857.14900000015, 354165.811, 336051.87400000007, 170200.15100000013, 146472.05999999997, 356183.0470000004, 334270.7749999997, 319564.27599999966, 163890.762, 298686.44100000005, 724326.4879999999, 681271.0500000003, 663978.02, 330128.4619999998, 139093.7230000001, 343750.8849999999, 326852.139, 315777.94000000006, 157444.4360000001, 130881.85399999998, 309134.81, 292524.09299999994, 283474.5390000001, 145189.664, 134724.91699999996, 319671.06699999975, 297146.84799999994, 293732.5759999999, 148582.6870000001, 158575.25699999998, 386620.20999999956, 355591.01100000046, 346362.62600000016, 184466.1649999999, 170993.092, 397523.2999999998, 359336.7300000001, 359897.1579999999, 180681.17100000006, 140465.33200000002, 348161.1459999998, 323693.52, 314992.88899999973, 166473.36, 127253.50400000003, 315345.772, 280113.70999999985, 267336.32799999986, 141414.7100000001, 123392.295, 298007.36699999997, 268663.808, 261873.26099999997, 136659.73300000007, 138880.11099999998, 330149.1999999997, 308631.4360000001, 312522.75599999994, 170501.11000000007, 140698.30600000004, 335642.7239999998, 311429.861, 315068.764, 170616.39899999983, 144150.73500000002, 358924.19600000005, 336766.65600000013, 322459.9110000001, 163018.12699999998, 146278.1629999999, 361441.3690000002, 342465.9260000002, 327629.1439999999, 163764.03299999994, 147894.99199999988, 357553.0169999999, 325279.39500000014, 323190.5509999999, 160527.61399999994, 143397.60999999996, 358125.4800000001, 323764.988, 319928.3660000003, 159330.2729999998, 142260.03099999996, 350601.685, 312652.5100000002, 313029.1209999999, 159615.40600000008, 151271.71600000007, 355633.40300000017, 327979.1009999999, 327350.06799999985, 167012.62999999995, 118740.17699999995, 317653.69399999996, 275109.61, 282680.817, 143491.642, 120869.226, 312002.75099999993, 277381.89299999987, 280395.6660000001, 141229.51200000002, 128932.61700000003, 318400.9079999997, 290071.2829999999, 293098.69999999984, 151888.7959999999, 129319.53499999996, 315449.41100000014, 290173.09199999995, 288875.1500000002, 149056.39799999993, 173732.72300000023, 402042.36499999993, 368646.77600000025, 378301.8370000001, 190835.95799999993, 131428.12099999993, 317822.0650000003, 298817.0220000002, 288204.5730000001, 148215.24799999996, 272441.94000000006, 638325.9010000004, 600386.9040000002, 566392.8500000001, 292060.4320000002, 133626.02199999988, 313128.6040000002, 287903.05100000004, 269767.9170000002, 141909.616, 162908.20900000012, 407847.51500000013, 382718.46899999975, 371045.9940000001, 185261.179, 155197.78599999993, 387106.54099999997, 369648.30700000003, 359074.10000000027, 180378.94599999994, 115084.54800000002, 300800.5870000001, 264309.45600000006, 270319.4929999997, 141616.5080000001, 111462.147, 295761.68099999987, 272879.2370000001, 270053.44800000015, 143327.88100000008, 1875178.2080000043, 4645141.872000005, 4197978.230999993, 4202188.602000003, 2161806.070999998, 141855.22600000005, 354570.79500000033, 331028.589, 305615.8760000001, 153125.77399999998, 124634.91599999995, 306516.5420000001, 285436.875, 283697.61500000005, 149280.64700000006, 124275.876, 304052.234, 293183.0140000001, 282315.1379999998, 149896.69999999992, 146289.95799999993, 361593.77099999983, 335008.97099999996, 328965.5599999999, 163092.63499999995, 142701.04700000008, 360108.3529999999, 327885.24799999985, 325768.36599999963, 163219.405, 120390.10599999999, 285837.4160000001, 277642.64000000025, 260634.88499999992, 138163.696, 170124.80000000002, 404433.75399999996, 379335.7110000002, 368992.32399999985, 190013.4339999999, 133878.01200000002, 312134.955, 304662.714, 292137.39900000015, 146749.17799999999, 109582.05800000005, 275321.3280000001, 260858.59300000005, 249495.69000000003, 128467.246, 156170.98499999996, 375578.96499999985, 357170.85699999996, 337763.50899999996, 177085.81700000007, 487508.2809999991, 1145293.9920000003, 1072517.9330000016, 1040911.3039999997, 542385.6270000008, 162888.76800000007, 376054.606, 354988.90300000005, 344592.73, 176502.74999999997, 135085.53200000004, 331626.85699999996, 297052.8979999998, 290960.5219999998, 151298.12999999998, 124947.00199999993, 313265.264, 297593.00999999983, 281660.6169999999, 146453.427, 142960.47799999994, 351608.63500000007, 319289.65700000024, 310056.2979999998, 157228.631, 398700.1550000004, 981974.6249999999, 898696.902999999, 868590.9730000002, 448214.02900000004, 129120.68000000005, 313487.448, 280060.08, 272238.2690000001, 143720.50800000006, 155026.603, 361657.13300000026, 339496.3589999999, 332719.21599999996, 181498.05100000004, 132663.97299999997, 317175.3869999999, 306829.3569999999, 295923.1979999998, 156565.4649999999, 390907.25600000017, 963590.7330000012, 916998.1810000007, 894568.431, 464565.4989999999, 139574.09499999997, 329041.53399999987, 313550.50799999986, 312050.3660000002, 162185.48999999993, 134519.336, 344692.529, 316354.6009999999, 318719.91900000005, 160927.07800000018, 569306.9939999995, 1346985.5979999995, 1292536.5740000007, 1259804.8329999994, 640609.9850000002, 146070.75100000008, 358323.47000000026, 331303.28999999986, 334250.93499999994, 167392.434, 123894.02799999999, 301355.05300000025, 284711.49699999986, 263092.04400000017, 140841.83699999994, 125103.74700000008, 302415.06600000005, 280578.6349999999, 267446.38500000007, 140569.05299999999, 159515.65699999998, 384916.6720000002, 362863.0419999997, 358116.38900000026, 185597.77400000015, 158435.19999999998, 388031.458, 361380.80600000016, 359487.12899999996, 185463.0379999999, 124151.24700000005, 308693.895, 279882.02099999983, 266632.267, 135853.65700000012]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.770633526610136, "mean_inference_ms": 1.8182621822273852, "mean_action_processing_ms": 1.358878795118785, "mean_env_wait_ms": 488.1843448503761, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08251118659973145, "StateBufferConnector_ms": 0.022510051727294922, "ViewRequirementAgentConnector_ms": 0.44737792015075684}, "num_episodes": 20, "episode_return_max": 17082292.984000027, "episode_return_min": 1023724.9150000003, "episode_return_mean": 1784882.1784000006, "episodes_this_iter": 20}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 6000, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 13.592608737271608, "num_env_steps_trained_throughput_per_sec": 13.592608737271608, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 180000, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 446435.491, "restore_workers_time_ms": 0.0, "training_step_time_ms": 446435.326, "sample_time_ms": 417143.392, "learn_time_ms": 29277.934, "learn_throughput": 204.932, "synch_weights_time_ms": 10.999}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "training_iteration": 6, "trial_id": "a5bb6_00000", "date": "2025-01-21_09-55-48", "timestamp": 1737482148, "time_this_iter_s": 441.42236828804016, "time_total_s": 2678.645466566086, "pid": 61756, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'environments.trafficEnv.TrafficLightMAEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 20000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 6000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function my_policy_mapping at 0x00000177903D92D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, "Dict('local_state': Dict('current_phase': Discrete(3), 'queue_length': Box(0.0, 100.0, (4,), float32), 'waiting_time': Box(0.0, 1000000.0, (4,), float32)), 'neighbor_info': Box(0.0, 100.0, (4,), float32))", "Dict('duration': Box(5.0, 60.0, (1,), float32), 'phase': Discrete(3))", {"model": {"custom_model": "my_traffic_model"}}]}, "callbacks": "<class 'config.trainingConfig.MetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2678.645466566086, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 3.31305114638448, "ram_util_percent": 53.06278659611993, "gpu_util_percent0": 0.03400352733686067, "vram_util_percent0": 0.11291697668650794}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8509456414364753, "cur_kl_coeff": 0.15, "cur_lr": 0.0002999999999999999, "total_loss": 9.953253959899254, "policy_loss": -1.5731523843838813e-05, "vf_loss": 9.970719005909372, "vf_explained_var": -1.7556738346181018e-07, "kl": 0.005270745782249531, "entropy": 1.8239962754351027, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 15275.5, "diff_num_grad_updates_vs_sampler_policy": 1174.5}}, "num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_agent_steps_sampled": 210000, "num_agent_steps_trained": 210000}, "env_runners": {"episode_reward_max": 17082292.984000027, "episode_reward_min": 1023724.9150000003, "episode_reward_mean": 1740916.3431099996, "episode_len_mean": 314.45, "episode_media": {}, "episodes_timesteps_total": 31445, "policy_reward_min": {"shared_policy": 109582.05800000005}, "policy_reward_max": {"shared_policy": 4645141.872000005}, "policy_reward_mean": {"shared_policy": 348183.268622}, "custom_metrics": {"mean_queue_length": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "mean_waiting_time": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "mean_throughput": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "hist_stats": {"episode_reward": [2667343.7369999937, 1351439.0600000012, 1320881.2169999995, 1268130.447999999, 3888424.738999997, 1341333.3639999996, 1169157.5889999988, 1286582.9869999976, 1200969.4360000005, 1414532.825999997, 1119612.5860000001, 1372774.5720000009, 6405143.447999987, 1242422.8369999977, 1177546.1180000002, 1167440.3130000003, 1332054.1689999998, 1310011.4979999985, 1413639.4140000015, 1392401.2219999996, 1320380.920000001, 2698390.461000005, 1282919.1230000013, 1161204.9599999988, 1193858.0950000007, 1431615.269, 1468431.451, 1293786.2470000018, 1131464.0239999983, 1088596.4640000009, 1260684.6130000006, 1273456.0540000007, 1325319.6249999988, 1341578.6350000012, 1314445.5690000006, 1304546.7169999992, 1278158.753, 1329246.9179999998, 1137675.9400000009, 1131879.048000001, 1182392.3040000016, 1172873.5859999978, 1513559.6589999998, 1184487.0290000006, 2369608.0269999923, 1146335.2099999995, 1509781.3659999995, 1451405.6800000025, 1092130.5919999995, 1093484.3940000013, 17082292.984000027, 1286196.2600000023, 1149566.5949999995, 1153722.962, 1334950.8949999965, 1319682.4190000002, 1082668.7429999986, 1512900.0229999998, 1189562.2579999994, 1023724.9150000003, 1403770.132999999, 4288617.136999999, 1415027.7569999972, 1206023.9390000002, 1163919.3200000003, 1281143.6989999986, 3596176.684999996, 1138626.9849999994, 1370397.3619999993, 1209157.3799999994, 3630630.1000000006, 1256401.993000001, 1275213.462999999, 5109243.983999991, 1337340.8800000001, 1113894.4590000003, 1116112.8860000002, 1451009.533999998, 1452797.6310000008, 1115213.0869999991, 1242785.4400000023, 3646076.6129999966, 1183203.0319999985, 1299716.448000001, 2566343.3810000042, 1207945.966, 1128369.2409999988, 1275615.214999999, 1379723.0099999988, 2435422.3009999935, 1192791.3190000004, 1330169.1260000009, 1278286.0130000005, 1265177.024, 1285547.1030000004, 1218811.2039999978, 1159254.3409999989, 1225134.4079999984, 4901312.096000002, 1478426.2490000003], "episode_lengths": [492, 245, 241, 230, 710, 239, 216, 239, 215, 249, 210, 242, 1162, 227, 205, 205, 226, 226, 258, 258, 242, 469, 227, 206, 206, 249, 254, 230, 206, 206, 219, 219, 242, 242, 235, 235, 238, 238, 209, 209, 211, 211, 250, 215, 426, 211, 265, 265, 202, 202, 3309, 233, 212, 212, 242, 242, 196, 261, 203, 198, 249, 756, 257, 227, 209, 235, 655, 211, 230, 222, 632, 214, 229, 906, 244, 204, 204, 254, 254, 208, 216, 657, 214, 224, 440, 216, 213, 215, 240, 448, 219, 230, 230, 226, 226, 225, 208, 218, 886, 252], "policy_shared_policy_reward": [292252.4709999999, 715073.3200000006, 661994.0100000005, 662236.449, 335787.4869999999, 145806.73799999998, 362434.87299999985, 331342.7890000001, 341050.2010000002, 170804.45899999992, 140026.16100000002, 353913.32499999984, 335806.2149999996, 323372.27699999994, 167763.23900000006, 136487.09799999997, 346894.24900000024, 309775.9190000001, 315308.33900000004, 159664.84300000008, 420112.8840000002, 1048991.9740000004, 975890.031000001, 954505.9729999996, 488923.87699999934, 148352.44900000002, 367139.73100000026, 334497.4459999999, 324142.5979999999, 167201.13999999996, 129196.373, 320487.7939999998, 296869.2020000001, 279612.73300000036, 142991.48700000002, 137984.85899999994, 350920.8839999999, 321781.0309999999, 311112.2909999998, 164783.92200000014, 132661.57999999996, 329504.176, 298221.05399999995, 285784.64199999993, 154797.98400000008, 152714.11800000002, 369190.92799999984, 360093.9110000001, 350958.9970000002, 181574.872, 118561.29899999997, 303033.3249999999, 274413.4349999998, 280093.363, 143511.16400000005, 147047.21599999996, 364408.80699999974, 348016.929, 339256.884, 174044.73600000003, 699174.4019999999, 1727795.0410000002, 1598367.9719999994, 1575350.251000002, 804455.7820000004, 136463.75999999998, 335965.96500000014, 313290.6010000002, 301699.9469999997, 155002.564, 130483.02400000006, 315796.53699999984, 286395.24700000003, 294239.682, 150631.628, 128110.27899999995, 311431.67199999996, 281573.74599999975, 293914.1149999998, 152410.50100000008, 140739.87900000004, 352216.50999999954, 330350.19700000004, 338066.2560000003, 170681.32699999996, 138269.44800000015, 349139.2199999999, 325612.12800000014, 330580.9150000001, 166409.787, 152502.03, 384638.5819999998, 364006.46200000006, 340309.91200000007, 172182.42799999993, 145126.23699999994, 386857.14900000015, 354165.811, 336051.87400000007, 170200.15100000013, 146472.05999999997, 356183.0470000004, 334270.7749999997, 319564.27599999966, 163890.762, 298686.44100000005, 724326.4879999999, 681271.0500000003, 663978.02, 330128.4619999998, 139093.7230000001, 343750.8849999999, 326852.139, 315777.94000000006, 157444.4360000001, 130881.85399999998, 309134.81, 292524.09299999994, 283474.5390000001, 145189.664, 134724.91699999996, 319671.06699999975, 297146.84799999994, 293732.5759999999, 148582.6870000001, 158575.25699999998, 386620.20999999956, 355591.01100000046, 346362.62600000016, 184466.1649999999, 170993.092, 397523.2999999998, 359336.7300000001, 359897.1579999999, 180681.17100000006, 140465.33200000002, 348161.1459999998, 323693.52, 314992.88899999973, 166473.36, 127253.50400000003, 315345.772, 280113.70999999985, 267336.32799999986, 141414.7100000001, 123392.295, 298007.36699999997, 268663.808, 261873.26099999997, 136659.73300000007, 138880.11099999998, 330149.1999999997, 308631.4360000001, 312522.75599999994, 170501.11000000007, 140698.30600000004, 335642.7239999998, 311429.861, 315068.764, 170616.39899999983, 144150.73500000002, 358924.19600000005, 336766.65600000013, 322459.9110000001, 163018.12699999998, 146278.1629999999, 361441.3690000002, 342465.9260000002, 327629.1439999999, 163764.03299999994, 147894.99199999988, 357553.0169999999, 325279.39500000014, 323190.5509999999, 160527.61399999994, 143397.60999999996, 358125.4800000001, 323764.988, 319928.3660000003, 159330.2729999998, 142260.03099999996, 350601.685, 312652.5100000002, 313029.1209999999, 159615.40600000008, 151271.71600000007, 355633.40300000017, 327979.1009999999, 327350.06799999985, 167012.62999999995, 118740.17699999995, 317653.69399999996, 275109.61, 282680.817, 143491.642, 120869.226, 312002.75099999993, 277381.89299999987, 280395.6660000001, 141229.51200000002, 128932.61700000003, 318400.9079999997, 290071.2829999999, 293098.69999999984, 151888.7959999999, 129319.53499999996, 315449.41100000014, 290173.09199999995, 288875.1500000002, 149056.39799999993, 173732.72300000023, 402042.36499999993, 368646.77600000025, 378301.8370000001, 190835.95799999993, 131428.12099999993, 317822.0650000003, 298817.0220000002, 288204.5730000001, 148215.24799999996, 272441.94000000006, 638325.9010000004, 600386.9040000002, 566392.8500000001, 292060.4320000002, 133626.02199999988, 313128.6040000002, 287903.05100000004, 269767.9170000002, 141909.616, 162908.20900000012, 407847.51500000013, 382718.46899999975, 371045.9940000001, 185261.179, 155197.78599999993, 387106.54099999997, 369648.30700000003, 359074.10000000027, 180378.94599999994, 115084.54800000002, 300800.5870000001, 264309.45600000006, 270319.4929999997, 141616.5080000001, 111462.147, 295761.68099999987, 272879.2370000001, 270053.44800000015, 143327.88100000008, 1875178.2080000043, 4645141.872000005, 4197978.230999993, 4202188.602000003, 2161806.070999998, 141855.22600000005, 354570.79500000033, 331028.589, 305615.8760000001, 153125.77399999998, 124634.91599999995, 306516.5420000001, 285436.875, 283697.61500000005, 149280.64700000006, 124275.876, 304052.234, 293183.0140000001, 282315.1379999998, 149896.69999999992, 146289.95799999993, 361593.77099999983, 335008.97099999996, 328965.5599999999, 163092.63499999995, 142701.04700000008, 360108.3529999999, 327885.24799999985, 325768.36599999963, 163219.405, 120390.10599999999, 285837.4160000001, 277642.64000000025, 260634.88499999992, 138163.696, 170124.80000000002, 404433.75399999996, 379335.7110000002, 368992.32399999985, 190013.4339999999, 133878.01200000002, 312134.955, 304662.714, 292137.39900000015, 146749.17799999999, 109582.05800000005, 275321.3280000001, 260858.59300000005, 249495.69000000003, 128467.246, 156170.98499999996, 375578.96499999985, 357170.85699999996, 337763.50899999996, 177085.81700000007, 487508.2809999991, 1145293.9920000003, 1072517.9330000016, 1040911.3039999997, 542385.6270000008, 162888.76800000007, 376054.606, 354988.90300000005, 344592.73, 176502.74999999997, 135085.53200000004, 331626.85699999996, 297052.8979999998, 290960.5219999998, 151298.12999999998, 124947.00199999993, 313265.264, 297593.00999999983, 281660.6169999999, 146453.427, 142960.47799999994, 351608.63500000007, 319289.65700000024, 310056.2979999998, 157228.631, 398700.1550000004, 981974.6249999999, 898696.902999999, 868590.9730000002, 448214.02900000004, 129120.68000000005, 313487.448, 280060.08, 272238.2690000001, 143720.50800000006, 155026.603, 361657.13300000026, 339496.3589999999, 332719.21599999996, 181498.05100000004, 132663.97299999997, 317175.3869999999, 306829.3569999999, 295923.1979999998, 156565.4649999999, 390907.25600000017, 963590.7330000012, 916998.1810000007, 894568.431, 464565.4989999999, 139574.09499999997, 329041.53399999987, 313550.50799999986, 312050.3660000002, 162185.48999999993, 134519.336, 344692.529, 316354.6009999999, 318719.91900000005, 160927.07800000018, 569306.9939999995, 1346985.5979999995, 1292536.5740000007, 1259804.8329999994, 640609.9850000002, 146070.75100000008, 358323.47000000026, 331303.28999999986, 334250.93499999994, 167392.434, 123894.02799999999, 301355.05300000025, 284711.49699999986, 263092.04400000017, 140841.83699999994, 125103.74700000008, 302415.06600000005, 280578.6349999999, 267446.38500000007, 140569.05299999999, 159515.65699999998, 384916.6720000002, 362863.0419999997, 358116.38900000026, 185597.77400000015, 158435.19999999998, 388031.458, 361380.80600000016, 359487.12899999996, 185463.0379999999, 124151.24700000005, 308693.895, 279882.02099999983, 266632.267, 135853.65700000012, 142741.52699999997, 335777.9379999999, 296724.77499999997, 309931.37999999983, 157609.82000000004, 415080.35599999956, 993368.7649999997, 896352.2800000001, 886563.4419999998, 454711.7700000002, 131673.1510000001, 322816.15100000007, 291868.05099999986, 284054.15, 152791.529, 147555.818, 345783.56600000005, 310807.74799999985, 325550.62500000006, 170018.6910000001, 289559.4179999997, 683837.8470000002, 631214.9659999994, 630283.1940000007, 331447.9559999998, 136342.78699999995, 321254.376, 303694.9859999998, 291483.66599999997, 155170.15100000004, 129545.96000000004, 302733.2349999999, 279221.70499999984, 272474.6849999999, 144393.65599999996, 137611.00199999995, 337010.12000000005, 313933.55199999997, 321643.942, 165416.5989999999, 148673.82299999992, 366515.65999999986, 346998.54800000024, 344296.4280000002, 173238.55100000012, 262888.4550000002, 660640.2250000003, 602030.4789999997, 598932.9859999999, 310930.15600000013, 125399.41199999997, 330182.6540000001, 291060.453, 292356.4300000001, 153792.36999999988, 146865.34999999998, 353864.95100000023, 336792.5030000001, 323746.7879999998, 168899.53399999996, 141298.33399999994, 339594.8869999998, 323463.46, 312751.6340000003, 161177.69799999997, 144516.30800000002, 335376.534, 326082.2889999999, 303078.71500000014, 156123.1780000001, 147101.718, 341924.21100000007, 326669.64100000024, 310706.2089999999, 159145.32399999994, 128564.553, 330225.358, 309483.0559999999, 299520.46499999985, 151017.772, 126817.91300000004, 313430.41099999973, 291843.3289999999, 281623.8779999998, 145538.81000000003, 133206.20299999998, 327357.9069999998, 305823.3600000003, 300063.738, 158683.19999999998, 539490.2360000004, 1324454.054000001, 1213576.0540000002, 1194521.0080000006, 629270.7439999995, 165724.4110000001, 382432.05, 366017.566, 369615.47700000013, 194636.74500000008]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.918150015396427, "mean_inference_ms": 1.8121100059873958, "mean_action_processing_ms": 1.3536679307555257, "mean_env_wait_ms": 490.1957247113156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09200167655944824, "StateBufferConnector_ms": 0.023496150970458984, "ViewRequirementAgentConnector_ms": 0.43446946144104004}, "num_episodes": 20, "episode_return_max": 17082292.984000027, "episode_return_min": 1023724.9150000003, "episode_return_mean": 1740916.3431099996, "episodes_this_iter": 20}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 210000, "num_agent_steps_trained": 210000, "num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_env_steps_sampled_this_iter": 6000, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 13.663942696895914, "num_env_steps_trained_throughput_per_sec": 13.663942696895914, "timesteps_total": 42000, "num_env_steps_sampled_lifetime": 42000, "num_agent_steps_sampled_lifetime": 210000, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 210000, "timers": {"training_iteration_time_ms": 445389.265, "restore_workers_time_ms": 0.0, "training_step_time_ms": 445389.124, "sample_time_ms": 416291.589, "learn_time_ms": 29083.534, "learn_throughput": 206.302, "synch_weights_time_ms": 11.0}, "counters": {"num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_agent_steps_sampled": 210000, "num_agent_steps_trained": 210000}, "done": false, "training_iteration": 7, "trial_id": "a5bb6_00000", "date": "2025-01-21_10-03-07", "timestamp": 1737482587, "time_this_iter_s": 439.11791157722473, "time_total_s": 3117.7633781433105, "pid": 61756, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'environments.trafficEnv.TrafficLightMAEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 20000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 6000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function my_policy_mapping at 0x00000177903D92D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, "Dict('local_state': Dict('current_phase': Discrete(3), 'queue_length': Box(0.0, 100.0, (4,), float32), 'waiting_time': Box(0.0, 1000000.0, (4,), float32)), 'neighbor_info': Box(0.0, 100.0, (4,), float32))", "Dict('duration': Box(5.0, 60.0, (1,), float32), 'phase': Discrete(3))", {"model": {"custom_model": "my_traffic_model"}}]}, "callbacks": "<class 'config.trainingConfig.MetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3117.7633781433105, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 3.1968141592920354, "ram_util_percent": 49.914690265486726, "gpu_util_percent0": 0.03010619469026549, "vram_util_percent0": 0.11142578125000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8036886201259938, "cur_kl_coeff": 0.15, "cur_lr": 0.0002999999999999999, "total_loss": 9.934255330511863, "policy_loss": -0.015417961011581282, "vf_loss": 9.96509483864967, "vf_explained_var": 1.115291676622756e-06, "kl": 0.023900668235891865, "entropy": 1.9006667353751812, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 17625.5, "diff_num_grad_updates_vs_sampler_policy": 1174.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 17082292.984000027, "episode_reward_min": 1023724.9150000003, "episode_reward_mean": 1778022.3188000002, "episode_len_mean": 318.29, "episode_media": {}, "episodes_timesteps_total": 31829, "policy_reward_min": {"shared_policy": 109582.05800000005}, "policy_reward_max": {"shared_policy": 4645141.872000005}, "policy_reward_mean": {"shared_policy": 355604.46376}, "custom_metrics": {"mean_queue_length": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "mean_waiting_time": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "mean_throughput": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "hist_stats": {"episode_reward": [1413639.4140000015, 1392401.2219999996, 1320380.920000001, 2698390.461000005, 1282919.1230000013, 1161204.9599999988, 1193858.0950000007, 1431615.269, 1468431.451, 1293786.2470000018, 1131464.0239999983, 1088596.4640000009, 1260684.6130000006, 1273456.0540000007, 1325319.6249999988, 1341578.6350000012, 1314445.5690000006, 1304546.7169999992, 1278158.753, 1329246.9179999998, 1137675.9400000009, 1131879.048000001, 1182392.3040000016, 1172873.5859999978, 1513559.6589999998, 1184487.0290000006, 2369608.0269999923, 1146335.2099999995, 1509781.3659999995, 1451405.6800000025, 1092130.5919999995, 1093484.3940000013, 17082292.984000027, 1286196.2600000023, 1149566.5949999995, 1153722.962, 1334950.8949999965, 1319682.4190000002, 1082668.7429999986, 1512900.0229999998, 1189562.2579999994, 1023724.9150000003, 1403770.132999999, 4288617.136999999, 1415027.7569999972, 1206023.9390000002, 1163919.3200000003, 1281143.6989999986, 3596176.684999996, 1138626.9849999994, 1370397.3619999993, 1209157.3799999994, 3630630.1000000006, 1256401.993000001, 1275213.462999999, 5109243.983999991, 1337340.8800000001, 1113894.4590000003, 1116112.8860000002, 1451009.533999998, 1452797.6310000008, 1115213.0869999991, 1242785.4400000023, 3646076.6129999966, 1183203.0319999985, 1299716.448000001, 2566343.3810000042, 1207945.966, 1128369.2409999988, 1275615.214999999, 1379723.0099999988, 2435422.3009999935, 1192791.3190000004, 1330169.1260000009, 1278286.0130000005, 1265177.024, 1285547.1030000004, 1218811.2039999978, 1159254.3409999989, 1225134.4079999984, 4901312.096000002, 1478426.2490000003, 1386772.7459999984, 2968492.0420000013, 1466565.5240000016, 1496394.3400000005, 1564661.1319999993, 1227084.999999998, 7940878.053000032, 1545874.975999999, 1467957.721999998, 1461715.050999998, 1455626.8830000008, 1265715.272, 1588042.878, 1360639.112999998, 1351212.1880000005, 1613814.7919999994, 3107689.009000001, 1477261.7919999994], "episode_lengths": [258, 258, 242, 469, 227, 206, 206, 249, 254, 230, 206, 206, 219, 219, 242, 242, 235, 235, 238, 238, 209, 209, 211, 211, 250, 215, 426, 211, 265, 265, 202, 202, 3309, 233, 212, 212, 242, 242, 196, 261, 203, 198, 249, 756, 257, 227, 209, 235, 655, 211, 230, 222, 632, 214, 229, 906, 244, 204, 204, 254, 254, 208, 216, 657, 214, 224, 440, 216, 213, 215, 240, 448, 219, 230, 230, 226, 226, 225, 208, 218, 886, 252, 252, 509, 257, 267, 267, 221, 1372, 253, 244, 244, 255, 213, 275, 234, 234, 283, 533, 250], "policy_shared_policy_reward": [152502.03, 384638.5819999998, 364006.46200000006, 340309.91200000007, 172182.42799999993, 145126.23699999994, 386857.14900000015, 354165.811, 336051.87400000007, 170200.15100000013, 146472.05999999997, 356183.0470000004, 334270.7749999997, 319564.27599999966, 163890.762, 298686.44100000005, 724326.4879999999, 681271.0500000003, 663978.02, 330128.4619999998, 139093.7230000001, 343750.8849999999, 326852.139, 315777.94000000006, 157444.4360000001, 130881.85399999998, 309134.81, 292524.09299999994, 283474.5390000001, 145189.664, 134724.91699999996, 319671.06699999975, 297146.84799999994, 293732.5759999999, 148582.6870000001, 158575.25699999998, 386620.20999999956, 355591.01100000046, 346362.62600000016, 184466.1649999999, 170993.092, 397523.2999999998, 359336.7300000001, 359897.1579999999, 180681.17100000006, 140465.33200000002, 348161.1459999998, 323693.52, 314992.88899999973, 166473.36, 127253.50400000003, 315345.772, 280113.70999999985, 267336.32799999986, 141414.7100000001, 123392.295, 298007.36699999997, 268663.808, 261873.26099999997, 136659.73300000007, 138880.11099999998, 330149.1999999997, 308631.4360000001, 312522.75599999994, 170501.11000000007, 140698.30600000004, 335642.7239999998, 311429.861, 315068.764, 170616.39899999983, 144150.73500000002, 358924.19600000005, 336766.65600000013, 322459.9110000001, 163018.12699999998, 146278.1629999999, 361441.3690000002, 342465.9260000002, 327629.1439999999, 163764.03299999994, 147894.99199999988, 357553.0169999999, 325279.39500000014, 323190.5509999999, 160527.61399999994, 143397.60999999996, 358125.4800000001, 323764.988, 319928.3660000003, 159330.2729999998, 142260.03099999996, 350601.685, 312652.5100000002, 313029.1209999999, 159615.40600000008, 151271.71600000007, 355633.40300000017, 327979.1009999999, 327350.06799999985, 167012.62999999995, 118740.17699999995, 317653.69399999996, 275109.61, 282680.817, 143491.642, 120869.226, 312002.75099999993, 277381.89299999987, 280395.6660000001, 141229.51200000002, 128932.61700000003, 318400.9079999997, 290071.2829999999, 293098.69999999984, 151888.7959999999, 129319.53499999996, 315449.41100000014, 290173.09199999995, 288875.1500000002, 149056.39799999993, 173732.72300000023, 402042.36499999993, 368646.77600000025, 378301.8370000001, 190835.95799999993, 131428.12099999993, 317822.0650000003, 298817.0220000002, 288204.5730000001, 148215.24799999996, 272441.94000000006, 638325.9010000004, 600386.9040000002, 566392.8500000001, 292060.4320000002, 133626.02199999988, 313128.6040000002, 287903.05100000004, 269767.9170000002, 141909.616, 162908.20900000012, 407847.51500000013, 382718.46899999975, 371045.9940000001, 185261.179, 155197.78599999993, 387106.54099999997, 369648.30700000003, 359074.10000000027, 180378.94599999994, 115084.54800000002, 300800.5870000001, 264309.45600000006, 270319.4929999997, 141616.5080000001, 111462.147, 295761.68099999987, 272879.2370000001, 270053.44800000015, 143327.88100000008, 1875178.2080000043, 4645141.872000005, 4197978.230999993, 4202188.602000003, 2161806.070999998, 141855.22600000005, 354570.79500000033, 331028.589, 305615.8760000001, 153125.77399999998, 124634.91599999995, 306516.5420000001, 285436.875, 283697.61500000005, 149280.64700000006, 124275.876, 304052.234, 293183.0140000001, 282315.1379999998, 149896.69999999992, 146289.95799999993, 361593.77099999983, 335008.97099999996, 328965.5599999999, 163092.63499999995, 142701.04700000008, 360108.3529999999, 327885.24799999985, 325768.36599999963, 163219.405, 120390.10599999999, 285837.4160000001, 277642.64000000025, 260634.88499999992, 138163.696, 170124.80000000002, 404433.75399999996, 379335.7110000002, 368992.32399999985, 190013.4339999999, 133878.01200000002, 312134.955, 304662.714, 292137.39900000015, 146749.17799999999, 109582.05800000005, 275321.3280000001, 260858.59300000005, 249495.69000000003, 128467.246, 156170.98499999996, 375578.96499999985, 357170.85699999996, 337763.50899999996, 177085.81700000007, 487508.2809999991, 1145293.9920000003, 1072517.9330000016, 1040911.3039999997, 542385.6270000008, 162888.76800000007, 376054.606, 354988.90300000005, 344592.73, 176502.74999999997, 135085.53200000004, 331626.85699999996, 297052.8979999998, 290960.5219999998, 151298.12999999998, 124947.00199999993, 313265.264, 297593.00999999983, 281660.6169999999, 146453.427, 142960.47799999994, 351608.63500000007, 319289.65700000024, 310056.2979999998, 157228.631, 398700.1550000004, 981974.6249999999, 898696.902999999, 868590.9730000002, 448214.02900000004, 129120.68000000005, 313487.448, 280060.08, 272238.2690000001, 143720.50800000006, 155026.603, 361657.13300000026, 339496.3589999999, 332719.21599999996, 181498.05100000004, 132663.97299999997, 317175.3869999999, 306829.3569999999, 295923.1979999998, 156565.4649999999, 390907.25600000017, 963590.7330000012, 916998.1810000007, 894568.431, 464565.4989999999, 139574.09499999997, 329041.53399999987, 313550.50799999986, 312050.3660000002, 162185.48999999993, 134519.336, 344692.529, 316354.6009999999, 318719.91900000005, 160927.07800000018, 569306.9939999995, 1346985.5979999995, 1292536.5740000007, 1259804.8329999994, 640609.9850000002, 146070.75100000008, 358323.47000000026, 331303.28999999986, 334250.93499999994, 167392.434, 123894.02799999999, 301355.05300000025, 284711.49699999986, 263092.04400000017, 140841.83699999994, 125103.74700000008, 302415.06600000005, 280578.6349999999, 267446.38500000007, 140569.05299999999, 159515.65699999998, 384916.6720000002, 362863.0419999997, 358116.38900000026, 185597.77400000015, 158435.19999999998, 388031.458, 361380.80600000016, 359487.12899999996, 185463.0379999999, 124151.24700000005, 308693.895, 279882.02099999983, 266632.267, 135853.65700000012, 142741.52699999997, 335777.9379999999, 296724.77499999997, 309931.37999999983, 157609.82000000004, 415080.35599999956, 993368.7649999997, 896352.2800000001, 886563.4419999998, 454711.7700000002, 131673.1510000001, 322816.15100000007, 291868.05099999986, 284054.15, 152791.529, 147555.818, 345783.56600000005, 310807.74799999985, 325550.62500000006, 170018.6910000001, 289559.4179999997, 683837.8470000002, 631214.9659999994, 630283.1940000007, 331447.9559999998, 136342.78699999995, 321254.376, 303694.9859999998, 291483.66599999997, 155170.15100000004, 129545.96000000004, 302733.2349999999, 279221.70499999984, 272474.6849999999, 144393.65599999996, 137611.00199999995, 337010.12000000005, 313933.55199999997, 321643.942, 165416.5989999999, 148673.82299999992, 366515.65999999986, 346998.54800000024, 344296.4280000002, 173238.55100000012, 262888.4550000002, 660640.2250000003, 602030.4789999997, 598932.9859999999, 310930.15600000013, 125399.41199999997, 330182.6540000001, 291060.453, 292356.4300000001, 153792.36999999988, 146865.34999999998, 353864.95100000023, 336792.5030000001, 323746.7879999998, 168899.53399999996, 141298.33399999994, 339594.8869999998, 323463.46, 312751.6340000003, 161177.69799999997, 144516.30800000002, 335376.534, 326082.2889999999, 303078.71500000014, 156123.1780000001, 147101.718, 341924.21100000007, 326669.64100000024, 310706.2089999999, 159145.32399999994, 128564.553, 330225.358, 309483.0559999999, 299520.46499999985, 151017.772, 126817.91300000004, 313430.41099999973, 291843.3289999999, 281623.8779999998, 145538.81000000003, 133206.20299999998, 327357.9069999998, 305823.3600000003, 300063.738, 158683.19999999998, 539490.2360000004, 1324454.054000001, 1213576.0540000002, 1194521.0080000006, 629270.7439999995, 165724.4110000001, 382432.05, 366017.566, 369615.47700000013, 194636.74500000008, 156596.75700000004, 363945.147, 351886.713, 345019.70900000026, 169324.42, 334722.97800000035, 783993.5380000002, 756986.5509999995, 728530.7279999995, 364258.24699999986, 162458.33799999987, 385407.1429999999, 374350.17000000004, 362324.2470000001, 182025.62600000005, 168953.36700000003, 383477.7059999999, 372892.33799999993, 374487.924, 196583.00499999992, 175948.8729999999, 404986.619, 389729.3829999997, 387557.27000000037, 206438.98700000005, 135764.11600000004, 330476.9019999999, 312785.99400000024, 293567.8260000001, 154490.1620000001, 884745.2509999992, 2104941.6359999985, 1976756.8779999989, 1962945.484, 1011488.8040000013, 178802.60599999994, 406533.2239999999, 389005.7999999999, 379622.3230000002, 191911.023, 166811.80099999983, 389484.7709999998, 361152.6190000002, 363866.6589999998, 186641.8720000001, 163441.68099999998, 387910.3280000003, 361316.77399999986, 362642.6590000002, 186403.60899999997, 154277.5209999999, 387150.70099999994, 365370.67599999986, 363957.8180000003, 184870.1670000001, 142530.444, 333235.1260000001, 316578.706, 314535.6510000001, 158835.34499999997, 176563.15500000006, 422860.3770000001, 402135.485, 387468.8560000001, 199015.00500000006, 152437.77999999994, 356684.1159999998, 334724.94799999974, 340771.37200000003, 176020.89700000003, 149278.41799999998, 361611.4649999998, 331947.1710000001, 335098.6819999999, 173276.45199999993, 182993.25700000016, 424187.78600000014, 405950.2529999997, 397875.2909999999, 202808.20499999996, 353940.431, 832699.8539999999, 766054.1580000006, 764005.893, 390988.67300000007, 168417.469, 400105.9620000002, 357060.22899999976, 365626.88899999985, 186051.24300000007]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.0207207074239975, "mean_inference_ms": 1.8094919900342905, "mean_action_processing_ms": 1.3523352677483675, "mean_env_wait_ms": 493.18462102369233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08699965476989746, "StateBufferConnector_ms": 0.025501489639282227, "ViewRequirementAgentConnector_ms": 0.44548630714416504}, "num_episodes": 18, "episode_return_max": 17082292.984000027, "episode_return_min": 1023724.9150000003, "episode_return_mean": 1778022.3188000002, "episodes_this_iter": 18}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 6000, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 12.950904218144201, "num_env_steps_trained_throughput_per_sec": 12.950904218144201, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 447626.621, "restore_workers_time_ms": 0.0, "training_step_time_ms": 447626.498, "sample_time_ms": 418437.651, "learn_time_ms": 29174.72, "learn_throughput": 205.657, "synch_weights_time_ms": 11.0}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 8, "trial_id": "a5bb6_00000", "date": "2025-01-21_10-10-50", "timestamp": 1737483050, "time_this_iter_s": 463.2941131591797, "time_total_s": 3581.0574913024902, "pid": 61756, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'environments.trafficEnv.TrafficLightMAEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 20000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 6000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function my_policy_mapping at 0x00000177903D92D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, "Dict('local_state': Dict('current_phase': Discrete(3), 'queue_length': Box(0.0, 100.0, (4,), float32), 'waiting_time': Box(0.0, 1000000.0, (4,), float32)), 'neighbor_info': Box(0.0, 100.0, (4,), float32))", "Dict('duration': Box(5.0, 60.0, (1,), float32), 'phase': Discrete(3))", {"model": {"custom_model": "my_traffic_model"}}]}, "callbacks": "<class 'config.trainingConfig.MetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3581.0574913024902, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 3.2414429530201345, "ram_util_percent": 49.723993288590606, "gpu_util_percent0": 0.036744966442953025, "vram_util_percent0": 0.11471315934354029}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8353517019875507, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.0002999999999999999, "total_loss": 9.931255567834732, "policy_loss": 0.0002023617140552465, "vf_loss": 9.94920421519178, "vf_explained_var": -1.7113381243766623e-06, "kl": 0.003996548043638888, "entropy": 1.9050263104540237, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 19975.5, "diff_num_grad_updates_vs_sampler_policy": 1174.5}}, "num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000}, "env_runners": {"episode_reward_max": 17082292.984000027, "episode_reward_min": 1023724.9150000003, "episode_reward_mean": 1896165.1040200004, "episode_len_mean": 335.97, "episode_media": {}, "episodes_timesteps_total": 33597, "policy_reward_min": {"shared_policy": 109582.05800000005}, "policy_reward_max": {"shared_policy": 4645141.872000005}, "policy_reward_mean": {"shared_policy": 379233.020804}, "custom_metrics": {"mean_queue_length": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "mean_waiting_time": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "mean_throughput": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "hist_stats": {"episode_reward": [1131879.048000001, 1182392.3040000016, 1172873.5859999978, 1513559.6589999998, 1184487.0290000006, 2369608.0269999923, 1146335.2099999995, 1509781.3659999995, 1451405.6800000025, 1092130.5919999995, 1093484.3940000013, 17082292.984000027, 1286196.2600000023, 1149566.5949999995, 1153722.962, 1334950.8949999965, 1319682.4190000002, 1082668.7429999986, 1512900.0229999998, 1189562.2579999994, 1023724.9150000003, 1403770.132999999, 4288617.136999999, 1415027.7569999972, 1206023.9390000002, 1163919.3200000003, 1281143.6989999986, 3596176.684999996, 1138626.9849999994, 1370397.3619999993, 1209157.3799999994, 3630630.1000000006, 1256401.993000001, 1275213.462999999, 5109243.983999991, 1337340.8800000001, 1113894.4590000003, 1116112.8860000002, 1451009.533999998, 1452797.6310000008, 1115213.0869999991, 1242785.4400000023, 3646076.6129999966, 1183203.0319999985, 1299716.448000001, 2566343.3810000042, 1207945.966, 1128369.2409999988, 1275615.214999999, 1379723.0099999988, 2435422.3009999935, 1192791.3190000004, 1330169.1260000009, 1278286.0130000005, 1265177.024, 1285547.1030000004, 1218811.2039999978, 1159254.3409999989, 1225134.4079999984, 4901312.096000002, 1478426.2490000003, 1386772.7459999984, 2968492.0420000013, 1466565.5240000016, 1496394.3400000005, 1564661.1319999993, 1227084.999999998, 7940878.053000032, 1545874.975999999, 1467957.721999998, 1461715.050999998, 1455626.8830000008, 1265715.272, 1588042.878, 1360639.112999998, 1351212.1880000005, 1613814.7919999994, 3107689.009000001, 1477261.7919999994, 1335107.1639999987, 1343918.2459999986, 1591676.940000004, 1331750.1229999992, 1362586.9060000002, 2910374.401999999, 1571368.9460000026, 1414888.5409999997, 1428347.0460000008, 1621435.1520000002, 1608403.0889999992, 7143385.11, 1484244.436999999, 1312120.430000001, 2765265.2610000074, 1457681.2639999993, 1527683.6670000001, 2955945.198000001, 1415059.2410000004, 1337141.0340000002, 1337696.7990000022], "episode_lengths": [209, 211, 211, 250, 215, 426, 211, 265, 265, 202, 202, 3309, 233, 212, 212, 242, 242, 196, 261, 203, 198, 249, 756, 257, 227, 209, 235, 655, 211, 230, 222, 632, 214, 229, 906, 244, 204, 204, 254, 254, 208, 216, 657, 214, 224, 440, 216, 213, 215, 240, 448, 219, 230, 230, 226, 226, 225, 208, 218, 886, 252, 252, 509, 257, 267, 267, 221, 1372, 253, 244, 244, 255, 213, 275, 234, 234, 283, 533, 250, 237, 237, 264, 227, 235, 495, 260, 243, 243, 267, 267, 1219, 251, 233, 478, 245, 267, 506, 239, 225, 218], "policy_shared_policy_reward": [120869.226, 312002.75099999993, 277381.89299999987, 280395.6660000001, 141229.51200000002, 128932.61700000003, 318400.9079999997, 290071.2829999999, 293098.69999999984, 151888.7959999999, 129319.53499999996, 315449.41100000014, 290173.09199999995, 288875.1500000002, 149056.39799999993, 173732.72300000023, 402042.36499999993, 368646.77600000025, 378301.8370000001, 190835.95799999993, 131428.12099999993, 317822.0650000003, 298817.0220000002, 288204.5730000001, 148215.24799999996, 272441.94000000006, 638325.9010000004, 600386.9040000002, 566392.8500000001, 292060.4320000002, 133626.02199999988, 313128.6040000002, 287903.05100000004, 269767.9170000002, 141909.616, 162908.20900000012, 407847.51500000013, 382718.46899999975, 371045.9940000001, 185261.179, 155197.78599999993, 387106.54099999997, 369648.30700000003, 359074.10000000027, 180378.94599999994, 115084.54800000002, 300800.5870000001, 264309.45600000006, 270319.4929999997, 141616.5080000001, 111462.147, 295761.68099999987, 272879.2370000001, 270053.44800000015, 143327.88100000008, 1875178.2080000043, 4645141.872000005, 4197978.230999993, 4202188.602000003, 2161806.070999998, 141855.22600000005, 354570.79500000033, 331028.589, 305615.8760000001, 153125.77399999998, 124634.91599999995, 306516.5420000001, 285436.875, 283697.61500000005, 149280.64700000006, 124275.876, 304052.234, 293183.0140000001, 282315.1379999998, 149896.69999999992, 146289.95799999993, 361593.77099999983, 335008.97099999996, 328965.5599999999, 163092.63499999995, 142701.04700000008, 360108.3529999999, 327885.24799999985, 325768.36599999963, 163219.405, 120390.10599999999, 285837.4160000001, 277642.64000000025, 260634.88499999992, 138163.696, 170124.80000000002, 404433.75399999996, 379335.7110000002, 368992.32399999985, 190013.4339999999, 133878.01200000002, 312134.955, 304662.714, 292137.39900000015, 146749.17799999999, 109582.05800000005, 275321.3280000001, 260858.59300000005, 249495.69000000003, 128467.246, 156170.98499999996, 375578.96499999985, 357170.85699999996, 337763.50899999996, 177085.81700000007, 487508.2809999991, 1145293.9920000003, 1072517.9330000016, 1040911.3039999997, 542385.6270000008, 162888.76800000007, 376054.606, 354988.90300000005, 344592.73, 176502.74999999997, 135085.53200000004, 331626.85699999996, 297052.8979999998, 290960.5219999998, 151298.12999999998, 124947.00199999993, 313265.264, 297593.00999999983, 281660.6169999999, 146453.427, 142960.47799999994, 351608.63500000007, 319289.65700000024, 310056.2979999998, 157228.631, 398700.1550000004, 981974.6249999999, 898696.902999999, 868590.9730000002, 448214.02900000004, 129120.68000000005, 313487.448, 280060.08, 272238.2690000001, 143720.50800000006, 155026.603, 361657.13300000026, 339496.3589999999, 332719.21599999996, 181498.05100000004, 132663.97299999997, 317175.3869999999, 306829.3569999999, 295923.1979999998, 156565.4649999999, 390907.25600000017, 963590.7330000012, 916998.1810000007, 894568.431, 464565.4989999999, 139574.09499999997, 329041.53399999987, 313550.50799999986, 312050.3660000002, 162185.48999999993, 134519.336, 344692.529, 316354.6009999999, 318719.91900000005, 160927.07800000018, 569306.9939999995, 1346985.5979999995, 1292536.5740000007, 1259804.8329999994, 640609.9850000002, 146070.75100000008, 358323.47000000026, 331303.28999999986, 334250.93499999994, 167392.434, 123894.02799999999, 301355.05300000025, 284711.49699999986, 263092.04400000017, 140841.83699999994, 125103.74700000008, 302415.06600000005, 280578.6349999999, 267446.38500000007, 140569.05299999999, 159515.65699999998, 384916.6720000002, 362863.0419999997, 358116.38900000026, 185597.77400000015, 158435.19999999998, 388031.458, 361380.80600000016, 359487.12899999996, 185463.0379999999, 124151.24700000005, 308693.895, 279882.02099999983, 266632.267, 135853.65700000012, 142741.52699999997, 335777.9379999999, 296724.77499999997, 309931.37999999983, 157609.82000000004, 415080.35599999956, 993368.7649999997, 896352.2800000001, 886563.4419999998, 454711.7700000002, 131673.1510000001, 322816.15100000007, 291868.05099999986, 284054.15, 152791.529, 147555.818, 345783.56600000005, 310807.74799999985, 325550.62500000006, 170018.6910000001, 289559.4179999997, 683837.8470000002, 631214.9659999994, 630283.1940000007, 331447.9559999998, 136342.78699999995, 321254.376, 303694.9859999998, 291483.66599999997, 155170.15100000004, 129545.96000000004, 302733.2349999999, 279221.70499999984, 272474.6849999999, 144393.65599999996, 137611.00199999995, 337010.12000000005, 313933.55199999997, 321643.942, 165416.5989999999, 148673.82299999992, 366515.65999999986, 346998.54800000024, 344296.4280000002, 173238.55100000012, 262888.4550000002, 660640.2250000003, 602030.4789999997, 598932.9859999999, 310930.15600000013, 125399.41199999997, 330182.6540000001, 291060.453, 292356.4300000001, 153792.36999999988, 146865.34999999998, 353864.95100000023, 336792.5030000001, 323746.7879999998, 168899.53399999996, 141298.33399999994, 339594.8869999998, 323463.46, 312751.6340000003, 161177.69799999997, 144516.30800000002, 335376.534, 326082.2889999999, 303078.71500000014, 156123.1780000001, 147101.718, 341924.21100000007, 326669.64100000024, 310706.2089999999, 159145.32399999994, 128564.553, 330225.358, 309483.0559999999, 299520.46499999985, 151017.772, 126817.91300000004, 313430.41099999973, 291843.3289999999, 281623.8779999998, 145538.81000000003, 133206.20299999998, 327357.9069999998, 305823.3600000003, 300063.738, 158683.19999999998, 539490.2360000004, 1324454.054000001, 1213576.0540000002, 1194521.0080000006, 629270.7439999995, 165724.4110000001, 382432.05, 366017.566, 369615.47700000013, 194636.74500000008, 156596.75700000004, 363945.147, 351886.713, 345019.70900000026, 169324.42, 334722.97800000035, 783993.5380000002, 756986.5509999995, 728530.7279999995, 364258.24699999986, 162458.33799999987, 385407.1429999999, 374350.17000000004, 362324.2470000001, 182025.62600000005, 168953.36700000003, 383477.7059999999, 372892.33799999993, 374487.924, 196583.00499999992, 175948.8729999999, 404986.619, 389729.3829999997, 387557.27000000037, 206438.98700000005, 135764.11600000004, 330476.9019999999, 312785.99400000024, 293567.8260000001, 154490.1620000001, 884745.2509999992, 2104941.6359999985, 1976756.8779999989, 1962945.484, 1011488.8040000013, 178802.60599999994, 406533.2239999999, 389005.7999999999, 379622.3230000002, 191911.023, 166811.80099999983, 389484.7709999998, 361152.6190000002, 363866.6589999998, 186641.8720000001, 163441.68099999998, 387910.3280000003, 361316.77399999986, 362642.6590000002, 186403.60899999997, 154277.5209999999, 387150.70099999994, 365370.67599999986, 363957.8180000003, 184870.1670000001, 142530.444, 333235.1260000001, 316578.706, 314535.6510000001, 158835.34499999997, 176563.15500000006, 422860.3770000001, 402135.485, 387468.8560000001, 199015.00500000006, 152437.77999999994, 356684.1159999998, 334724.94799999974, 340771.37200000003, 176020.89700000003, 149278.41799999998, 361611.4649999998, 331947.1710000001, 335098.6819999999, 173276.45199999993, 182993.25700000016, 424187.78600000014, 405950.2529999997, 397875.2909999999, 202808.20499999996, 353940.431, 832699.8539999999, 766054.1580000006, 764005.893, 390988.67300000007, 168417.469, 400105.9620000002, 357060.22899999976, 365626.88899999985, 186051.24300000007, 150747.29000000007, 357855.6309999999, 338050.3500000004, 323210.724, 165243.1690000001, 153105.64500000002, 358235.50899999996, 339753.83899999975, 326672.0500000001, 166151.20299999998, 178210.03300000005, 414006.95699999953, 395100.3270000003, 401201.90500000026, 203157.71800000002, 147374.87499999997, 362240.1969999999, 322356.135, 329907.00800000026, 169871.90800000008, 151777.685, 359808.6740000001, 344828.6690000001, 337751.98899999994, 168419.88899999997, 328111.80700000003, 758025.0909999997, 735711.2710000003, 722559.4409999996, 365966.79199999984, 178129.38300000003, 408624.51999999984, 390885.9960000001, 392331.41099999985, 201397.636, 159048.3359999999, 370860.30400000006, 352530.47200000007, 346065.82300000015, 186383.60600000017, 159402.26499999996, 368228.8059999998, 361654.5559999998, 351495.48299999983, 187565.93600000005, 177071.54699999993, 428025.86500000017, 404752.591, 406600.0869999995, 204985.0619999999, 178467.22800000006, 422275.05199999973, 403669.45699999976, 400802.3589999998, 203188.9930000001, 783536.1099999992, 1899173.2550000024, 1795664.5569999984, 1766765.272999998, 898245.915000001, 163357.2580000001, 385954.4140000002, 372821.4319999999, 372464.61799999996, 189646.71499999982, 149059.226, 352329.80199999997, 332424.809, 319317.296, 158989.2969999999, 306498.95200000005, 730097.4069999998, 700380.8310000005, 681205.4609999995, 347082.6100000002, 157360.54100000003, 382075.20800000016, 367447.2959999998, 363530.9949999999, 187267.22399999993, 161670.53600000005, 405213.24199999997, 393427.94600000023, 373366.0039999999, 194005.93900000007, 316494.21499999997, 778790.718, 752235.1760000004, 737857.2080000003, 370567.8809999998, 152978.30699999997, 362713.51200000005, 363588.1900000001, 359387.25799999986, 176391.97400000007, 157465.229, 355796.29399999994, 332249.9659999999, 327201.3449999999, 164428.19999999998, 149098.40300000002, 355114.01100000035, 329209.05099999986, 330076.315, 174199.0190000001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.047979081438648, "mean_inference_ms": 1.808984480020327, "mean_action_processing_ms": 1.3521778406220586, "mean_env_wait_ms": 495.1889653919797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08199739456176758, "StateBufferConnector_ms": 0.026506900787353516, "ViewRequirementAgentConnector_ms": 0.44149088859558105}, "num_episodes": 21, "episode_return_max": 17082292.984000027, "episode_return_min": 1023724.9150000003, "episode_return_mean": 1896165.1040200004, "episodes_this_iter": 21}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000, "num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_env_steps_sampled_this_iter": 6000, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 12.994458682275448, "num_env_steps_trained_throughput_per_sec": 12.994458682275448, "timesteps_total": 54000, "num_env_steps_sampled_lifetime": 54000, "num_agent_steps_sampled_lifetime": 270000, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 270000, "timers": {"training_iteration_time_ms": 449194.25, "restore_workers_time_ms": 0.0, "training_step_time_ms": 449194.14, "sample_time_ms": 419972.596, "learn_time_ms": 29207.321, "learn_throughput": 205.428, "synch_weights_time_ms": 11.001}, "counters": {"num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000}, "done": false, "training_iteration": 9, "trial_id": "a5bb6_00000", "date": "2025-01-21_10-18-32", "timestamp": 1737483512, "time_this_iter_s": 461.7407910823822, "time_total_s": 4042.7982823848724, "pid": 61756, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'environments.trafficEnv.TrafficLightMAEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 20000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 6000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function my_policy_mapping at 0x00000177903D92D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, "Dict('local_state': Dict('current_phase': Discrete(3), 'queue_length': Box(0.0, 100.0, (4,), float32), 'waiting_time': Box(0.0, 1000000.0, (4,), float32)), 'neighbor_info': Box(0.0, 100.0, (4,), float32))", "Dict('duration': Box(5.0, 60.0, (1,), float32), 'phase': Discrete(3))", {"model": {"custom_model": "my_traffic_model"}}]}, "callbacks": "<class 'config.trainingConfig.MetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4042.7982823848724, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 3.046632996632997, "ram_util_percent": 51.38855218855219, "gpu_util_percent0": 0.03126262626262627, "vram_util_percent0": 0.13064038825757573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8533677225924552, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.0002999999999999999, "total_loss": 9.940213317465275, "policy_loss": 0.0008505773249062452, "vf_loss": 9.957932735199623, "vf_explained_var": -1.7942012624537691e-06, "kl": 0.003907355571068176, "entropy": 1.9009584599860172, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 22325.5, "diff_num_grad_updates_vs_sampler_policy": 1174.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "env_runners": {"episode_reward_max": 7940878.053000032, "episode_reward_min": 1113894.4590000003, "episode_reward_mean": 1882495.3508, "episode_len_mean": 325.91, "episode_media": {}, "episodes_timesteps_total": 32591, "policy_reward_min": {"shared_policy": 123894.02799999999}, "policy_reward_max": {"shared_policy": 2104941.6359999985}, "policy_reward_mean": {"shared_policy": 376499.07015999994}, "custom_metrics": {"mean_queue_length": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "mean_waiting_time": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "mean_throughput": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "hist_stats": {"episode_reward": [1403770.132999999, 4288617.136999999, 1415027.7569999972, 1206023.9390000002, 1163919.3200000003, 1281143.6989999986, 3596176.684999996, 1138626.9849999994, 1370397.3619999993, 1209157.3799999994, 3630630.1000000006, 1256401.993000001, 1275213.462999999, 5109243.983999991, 1337340.8800000001, 1113894.4590000003, 1116112.8860000002, 1451009.533999998, 1452797.6310000008, 1115213.0869999991, 1242785.4400000023, 3646076.6129999966, 1183203.0319999985, 1299716.448000001, 2566343.3810000042, 1207945.966, 1128369.2409999988, 1275615.214999999, 1379723.0099999988, 2435422.3009999935, 1192791.3190000004, 1330169.1260000009, 1278286.0130000005, 1265177.024, 1285547.1030000004, 1218811.2039999978, 1159254.3409999989, 1225134.4079999984, 4901312.096000002, 1478426.2490000003, 1386772.7459999984, 2968492.0420000013, 1466565.5240000016, 1496394.3400000005, 1564661.1319999993, 1227084.999999998, 7940878.053000032, 1545874.975999999, 1467957.721999998, 1461715.050999998, 1455626.8830000008, 1265715.272, 1588042.878, 1360639.112999998, 1351212.1880000005, 1613814.7919999994, 3107689.009000001, 1477261.7919999994, 1335107.1639999987, 1343918.2459999986, 1591676.940000004, 1331750.1229999992, 1362586.9060000002, 2910374.401999999, 1571368.9460000026, 1414888.5409999997, 1428347.0460000008, 1621435.1520000002, 1608403.0889999992, 7143385.11, 1484244.436999999, 1312120.430000001, 2765265.2610000074, 1457681.2639999993, 1527683.6670000001, 2955945.198000001, 1415059.2410000004, 1337141.0340000002, 1337696.7990000022, 4289520.62599999, 1472988.1740000022, 1530794.403000001, 1498791.4790000003, 1588040.2709999974, 1680785.195999999, 1694990.3249999995, 1295877.7690000029, 1307843.0509999995, 1596103.3599999985, 1612009.9570000018, 1461751.3669999987, 1249222.8679999984, 4217729.301999999, 1474059.4150000017, 1655503.3449999986, 4024348.6569999955, 1442801.9730000007, 1616008.7469999986, 3225226.572000004, 1681832.770000001], "episode_lengths": [249, 756, 257, 227, 209, 235, 655, 211, 230, 222, 632, 214, 229, 906, 244, 204, 204, 254, 254, 208, 216, 657, 214, 224, 440, 216, 213, 215, 240, 448, 219, 230, 230, 226, 226, 225, 208, 218, 886, 252, 252, 509, 257, 267, 267, 221, 1372, 253, 244, 244, 255, 213, 275, 234, 234, 283, 533, 250, 237, 237, 264, 227, 235, 495, 260, 243, 243, 267, 267, 1219, 251, 233, 478, 245, 267, 506, 239, 225, 218, 738, 247, 253, 253, 258, 284, 284, 220, 220, 269, 269, 246, 211, 706, 249, 279, 677, 234, 266, 536, 270], "policy_shared_policy_reward": [156170.98499999996, 375578.96499999985, 357170.85699999996, 337763.50899999996, 177085.81700000007, 487508.2809999991, 1145293.9920000003, 1072517.9330000016, 1040911.3039999997, 542385.6270000008, 162888.76800000007, 376054.606, 354988.90300000005, 344592.73, 176502.74999999997, 135085.53200000004, 331626.85699999996, 297052.8979999998, 290960.5219999998, 151298.12999999998, 124947.00199999993, 313265.264, 297593.00999999983, 281660.6169999999, 146453.427, 142960.47799999994, 351608.63500000007, 319289.65700000024, 310056.2979999998, 157228.631, 398700.1550000004, 981974.6249999999, 898696.902999999, 868590.9730000002, 448214.02900000004, 129120.68000000005, 313487.448, 280060.08, 272238.2690000001, 143720.50800000006, 155026.603, 361657.13300000026, 339496.3589999999, 332719.21599999996, 181498.05100000004, 132663.97299999997, 317175.3869999999, 306829.3569999999, 295923.1979999998, 156565.4649999999, 390907.25600000017, 963590.7330000012, 916998.1810000007, 894568.431, 464565.4989999999, 139574.09499999997, 329041.53399999987, 313550.50799999986, 312050.3660000002, 162185.48999999993, 134519.336, 344692.529, 316354.6009999999, 318719.91900000005, 160927.07800000018, 569306.9939999995, 1346985.5979999995, 1292536.5740000007, 1259804.8329999994, 640609.9850000002, 146070.75100000008, 358323.47000000026, 331303.28999999986, 334250.93499999994, 167392.434, 123894.02799999999, 301355.05300000025, 284711.49699999986, 263092.04400000017, 140841.83699999994, 125103.74700000008, 302415.06600000005, 280578.6349999999, 267446.38500000007, 140569.05299999999, 159515.65699999998, 384916.6720000002, 362863.0419999997, 358116.38900000026, 185597.77400000015, 158435.19999999998, 388031.458, 361380.80600000016, 359487.12899999996, 185463.0379999999, 124151.24700000005, 308693.895, 279882.02099999983, 266632.267, 135853.65700000012, 142741.52699999997, 335777.9379999999, 296724.77499999997, 309931.37999999983, 157609.82000000004, 415080.35599999956, 993368.7649999997, 896352.2800000001, 886563.4419999998, 454711.7700000002, 131673.1510000001, 322816.15100000007, 291868.05099999986, 284054.15, 152791.529, 147555.818, 345783.56600000005, 310807.74799999985, 325550.62500000006, 170018.6910000001, 289559.4179999997, 683837.8470000002, 631214.9659999994, 630283.1940000007, 331447.9559999998, 136342.78699999995, 321254.376, 303694.9859999998, 291483.66599999997, 155170.15100000004, 129545.96000000004, 302733.2349999999, 279221.70499999984, 272474.6849999999, 144393.65599999996, 137611.00199999995, 337010.12000000005, 313933.55199999997, 321643.942, 165416.5989999999, 148673.82299999992, 366515.65999999986, 346998.54800000024, 344296.4280000002, 173238.55100000012, 262888.4550000002, 660640.2250000003, 602030.4789999997, 598932.9859999999, 310930.15600000013, 125399.41199999997, 330182.6540000001, 291060.453, 292356.4300000001, 153792.36999999988, 146865.34999999998, 353864.95100000023, 336792.5030000001, 323746.7879999998, 168899.53399999996, 141298.33399999994, 339594.8869999998, 323463.46, 312751.6340000003, 161177.69799999997, 144516.30800000002, 335376.534, 326082.2889999999, 303078.71500000014, 156123.1780000001, 147101.718, 341924.21100000007, 326669.64100000024, 310706.2089999999, 159145.32399999994, 128564.553, 330225.358, 309483.0559999999, 299520.46499999985, 151017.772, 126817.91300000004, 313430.41099999973, 291843.3289999999, 281623.8779999998, 145538.81000000003, 133206.20299999998, 327357.9069999998, 305823.3600000003, 300063.738, 158683.19999999998, 539490.2360000004, 1324454.054000001, 1213576.0540000002, 1194521.0080000006, 629270.7439999995, 165724.4110000001, 382432.05, 366017.566, 369615.47700000013, 194636.74500000008, 156596.75700000004, 363945.147, 351886.713, 345019.70900000026, 169324.42, 334722.97800000035, 783993.5380000002, 756986.5509999995, 728530.7279999995, 364258.24699999986, 162458.33799999987, 385407.1429999999, 374350.17000000004, 362324.2470000001, 182025.62600000005, 168953.36700000003, 383477.7059999999, 372892.33799999993, 374487.924, 196583.00499999992, 175948.8729999999, 404986.619, 389729.3829999997, 387557.27000000037, 206438.98700000005, 135764.11600000004, 330476.9019999999, 312785.99400000024, 293567.8260000001, 154490.1620000001, 884745.2509999992, 2104941.6359999985, 1976756.8779999989, 1962945.484, 1011488.8040000013, 178802.60599999994, 406533.2239999999, 389005.7999999999, 379622.3230000002, 191911.023, 166811.80099999983, 389484.7709999998, 361152.6190000002, 363866.6589999998, 186641.8720000001, 163441.68099999998, 387910.3280000003, 361316.77399999986, 362642.6590000002, 186403.60899999997, 154277.5209999999, 387150.70099999994, 365370.67599999986, 363957.8180000003, 184870.1670000001, 142530.444, 333235.1260000001, 316578.706, 314535.6510000001, 158835.34499999997, 176563.15500000006, 422860.3770000001, 402135.485, 387468.8560000001, 199015.00500000006, 152437.77999999994, 356684.1159999998, 334724.94799999974, 340771.37200000003, 176020.89700000003, 149278.41799999998, 361611.4649999998, 331947.1710000001, 335098.6819999999, 173276.45199999993, 182993.25700000016, 424187.78600000014, 405950.2529999997, 397875.2909999999, 202808.20499999996, 353940.431, 832699.8539999999, 766054.1580000006, 764005.893, 390988.67300000007, 168417.469, 400105.9620000002, 357060.22899999976, 365626.88899999985, 186051.24300000007, 150747.29000000007, 357855.6309999999, 338050.3500000004, 323210.724, 165243.1690000001, 153105.64500000002, 358235.50899999996, 339753.83899999975, 326672.0500000001, 166151.20299999998, 178210.03300000005, 414006.95699999953, 395100.3270000003, 401201.90500000026, 203157.71800000002, 147374.87499999997, 362240.1969999999, 322356.135, 329907.00800000026, 169871.90800000008, 151777.685, 359808.6740000001, 344828.6690000001, 337751.98899999994, 168419.88899999997, 328111.80700000003, 758025.0909999997, 735711.2710000003, 722559.4409999996, 365966.79199999984, 178129.38300000003, 408624.51999999984, 390885.9960000001, 392331.41099999985, 201397.636, 159048.3359999999, 370860.30400000006, 352530.47200000007, 346065.82300000015, 186383.60600000017, 159402.26499999996, 368228.8059999998, 361654.5559999998, 351495.48299999983, 187565.93600000005, 177071.54699999993, 428025.86500000017, 404752.591, 406600.0869999995, 204985.0619999999, 178467.22800000006, 422275.05199999973, 403669.45699999976, 400802.3589999998, 203188.9930000001, 783536.1099999992, 1899173.2550000024, 1795664.5569999984, 1766765.272999998, 898245.915000001, 163357.2580000001, 385954.4140000002, 372821.4319999999, 372464.61799999996, 189646.71499999982, 149059.226, 352329.80199999997, 332424.809, 319317.296, 158989.2969999999, 306498.95200000005, 730097.4069999998, 700380.8310000005, 681205.4609999995, 347082.6100000002, 157360.54100000003, 382075.20800000016, 367447.2959999998, 363530.9949999999, 187267.22399999993, 161670.53600000005, 405213.24199999997, 393427.94600000023, 373366.0039999999, 194005.93900000007, 316494.21499999997, 778790.718, 752235.1760000004, 737857.2080000003, 370567.8809999998, 152978.30699999997, 362713.51200000005, 363588.1900000001, 359387.25799999986, 176391.97400000007, 157465.229, 355796.29399999994, 332249.9659999999, 327201.3449999999, 164428.19999999998, 149098.40300000002, 355114.01100000035, 329209.05099999986, 330076.315, 174199.0190000001, 478528.06699999986, 1136735.2729999986, 1068963.2950000006, 1068740.575999999, 536553.415, 165063.28399999999, 392687.8229999999, 372246.5389999998, 360930.4050000001, 182060.1230000001, 180784.43399999995, 407310.8130000001, 386196.93899999995, 369696.626, 186805.59100000007, 176782.39800000002, 394608.4539999999, 379329.76199999976, 366776.39699999994, 181294.468, 175084.17899999997, 408038.27200000006, 398721.02099999995, 402858.0230000002, 203338.77600000016, 190942.429, 442387.21000000014, 420842.96799999994, 422685.201, 203927.38799999995, 194168.08500000014, 447962.66200000024, 422742.82800000004, 422282.7669999999, 207833.98300000004, 146106.818, 351913.07699999976, 321306.787, 314674.16000000003, 161876.92700000003, 144481.7529999999, 361148.714, 323125.61499999993, 318492.05799999996, 160594.91099999993, 181146.85799999983, 411894.29199999967, 409502.46400000015, 399363.69399999996, 194196.05200000008, 180434.56500000018, 415886.74600000016, 409495.62899999943, 409596.8179999999, 196596.199, 156719.789, 384155.34800000035, 368573.7589999998, 363199.97200000007, 189102.49900000013, 139304.42299999995, 334491.0169999999, 309151.3829999999, 307008.2230000002, 159267.82200000004, 468593.17100000003, 1117838.099, 1053845.9729999993, 1045894.1299999986, 531557.9290000007, 168973.85200000007, 383420.8870000001, 376462.4210000004, 363091.38899999997, 182110.86600000007, 180539.21499999997, 426122.317, 415782.84099999984, 420137.42400000023, 212921.54800000007, 452378.7339999999, 1050400.7850000001, 1021914.5190000002, 991664.4929999999, 507990.1259999998, 161894.602, 369533.60099999973, 363580.9169999999, 362327.8709999998, 185464.98200000005, 179417.04899999997, 425795.4040000001, 409846.2219999997, 399693.60899999976, 201256.46299999996, 359733.6279999998, 845150.4609999999, 811512.7980000001, 801235.422999999, 407594.2619999998, 190088.52899999986, 433451.94299999997, 417568.16399999964, 423489.36699999997, 217234.7670000001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.0951151295678825, "mean_inference_ms": 1.8075958543933939, "mean_action_processing_ms": 1.351515731356564, "mean_env_wait_ms": 498.39415434583583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07899641990661621, "StateBufferConnector_ms": 0.026996135711669922, "ViewRequirementAgentConnector_ms": 0.42451047897338867}, "num_episodes": 21, "episode_return_max": 7940878.053000032, "episode_return_min": 1113894.4590000003, "episode_return_mean": 1882495.3508, "episodes_this_iter": 21}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 6000, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 12.808511508930414, "num_env_steps_trained_throughput_per_sec": 12.808511508930414, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 300000, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 451118.676, "restore_workers_time_ms": 0.0, "training_step_time_ms": 451118.577, "sample_time_ms": 421849.455, "learn_time_ms": 29254.822, "learn_throughput": 205.094, "synch_weights_time_ms": 10.899}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "training_iteration": 10, "trial_id": "a5bb6_00000", "date": "2025-01-21_10-26-21", "timestamp": 1737483981, "time_this_iter_s": 468.4445095062256, "time_total_s": 4511.242791891098, "pid": 61756, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'environments.trafficEnv.TrafficLightMAEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 20000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 6000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function my_policy_mapping at 0x00000177903D92D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, "Dict('local_state': Dict('current_phase': Discrete(3), 'queue_length': Box(0.0, 100.0, (4,), float32), 'waiting_time': Box(0.0, 1000000.0, (4,), float32)), 'neighbor_info': Box(0.0, 100.0, (4,), float32))", "Dict('duration': Box(5.0, 60.0, (1,), float32), 'phase': Discrete(3))", {"model": {"custom_model": "my_traffic_model"}}]}, "callbacks": "<class 'config.trainingConfig.MetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4511.242791891098, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 2.8583747927031506, "ram_util_percent": 51.24112769485903, "gpu_util_percent0": 0.031011608623548927, "vram_util_percent0": 0.1303077710406302}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.690437885548206, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.0002999999999999999, "total_loss": 9.950587902069092, "policy_loss": -0.001334850405085277, "vf_loss": 9.970581805046569, "vf_explained_var": -4.598612480975212e-06, "kl": 0.010883395004956525, "entropy": 1.9271236560699787, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 24675.5, "diff_num_grad_updates_vs_sampler_policy": 1174.5}}, "num_env_steps_sampled": 66000, "num_env_steps_trained": 66000, "num_agent_steps_sampled": 330000, "num_agent_steps_trained": 330000}, "env_runners": {"episode_reward_max": 7940878.053000032, "episode_reward_min": 1115213.0869999991, "episode_reward_mean": 1883485.7733900005, "episode_len_mean": 322.62, "episode_media": {}, "episodes_timesteps_total": 32262, "policy_reward_min": {"shared_policy": 124151.24700000005}, "policy_reward_max": {"shared_policy": 2104941.6359999985}, "policy_reward_mean": {"shared_policy": 376697.15467799996}, "custom_metrics": {"mean_queue_length": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "mean_waiting_time": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "mean_throughput": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "hist_stats": {"episode_reward": [1451009.533999998, 1452797.6310000008, 1115213.0869999991, 1242785.4400000023, 3646076.6129999966, 1183203.0319999985, 1299716.448000001, 2566343.3810000042, 1207945.966, 1128369.2409999988, 1275615.214999999, 1379723.0099999988, 2435422.3009999935, 1192791.3190000004, 1330169.1260000009, 1278286.0130000005, 1265177.024, 1285547.1030000004, 1218811.2039999978, 1159254.3409999989, 1225134.4079999984, 4901312.096000002, 1478426.2490000003, 1386772.7459999984, 2968492.0420000013, 1466565.5240000016, 1496394.3400000005, 1564661.1319999993, 1227084.999999998, 7940878.053000032, 1545874.975999999, 1467957.721999998, 1461715.050999998, 1455626.8830000008, 1265715.272, 1588042.878, 1360639.112999998, 1351212.1880000005, 1613814.7919999994, 3107689.009000001, 1477261.7919999994, 1335107.1639999987, 1343918.2459999986, 1591676.940000004, 1331750.1229999992, 1362586.9060000002, 2910374.401999999, 1571368.9460000026, 1414888.5409999997, 1428347.0460000008, 1621435.1520000002, 1608403.0889999992, 7143385.11, 1484244.436999999, 1312120.430000001, 2765265.2610000074, 1457681.2639999993, 1527683.6670000001, 2955945.198000001, 1415059.2410000004, 1337141.0340000002, 1337696.7990000022, 4289520.62599999, 1472988.1740000022, 1530794.403000001, 1498791.4790000003, 1588040.2709999974, 1680785.195999999, 1694990.3249999995, 1295877.7690000029, 1307843.0509999995, 1596103.3599999985, 1612009.9570000018, 1461751.3669999987, 1249222.8679999984, 4217729.301999999, 1474059.4150000017, 1655503.3449999986, 4024348.6569999955, 1442801.9730000007, 1616008.7469999986, 3225226.572000004, 1681832.770000001, 1409625.2759999987, 1354114.7949999978, 1549549.4129999985, 7239513.248000013, 1393742.6539999982, 1225970.1290000004, 1658899.9990000024, 1280678.9019999995, 3142772.036999994, 1496163.169999995, 1540139.1380000014, 3007680.450000001, 1461509.6700000004, 1162002.1150000005, 1222054.398, 1335600.314, 1530724.7129999963], "episode_lengths": [254, 254, 208, 216, 657, 214, 224, 440, 216, 213, 215, 240, 448, 219, 230, 230, 226, 226, 225, 208, 218, 886, 252, 252, 509, 257, 267, 267, 221, 1372, 253, 244, 244, 255, 213, 275, 234, 234, 283, 533, 250, 237, 237, 264, 227, 235, 495, 260, 243, 243, 267, 267, 1219, 251, 233, 478, 245, 267, 506, 239, 225, 218, 738, 247, 253, 253, 258, 284, 284, 220, 220, 269, 269, 246, 211, 706, 249, 279, 677, 234, 266, 536, 270, 238, 229, 253, 1205, 227, 205, 284, 211, 539, 260, 253, 507, 254, 208, 208, 217, 257], "policy_shared_policy_reward": [159515.65699999998, 384916.6720000002, 362863.0419999997, 358116.38900000026, 185597.77400000015, 158435.19999999998, 388031.458, 361380.80600000016, 359487.12899999996, 185463.0379999999, 124151.24700000005, 308693.895, 279882.02099999983, 266632.267, 135853.65700000012, 142741.52699999997, 335777.9379999999, 296724.77499999997, 309931.37999999983, 157609.82000000004, 415080.35599999956, 993368.7649999997, 896352.2800000001, 886563.4419999998, 454711.7700000002, 131673.1510000001, 322816.15100000007, 291868.05099999986, 284054.15, 152791.529, 147555.818, 345783.56600000005, 310807.74799999985, 325550.62500000006, 170018.6910000001, 289559.4179999997, 683837.8470000002, 631214.9659999994, 630283.1940000007, 331447.9559999998, 136342.78699999995, 321254.376, 303694.9859999998, 291483.66599999997, 155170.15100000004, 129545.96000000004, 302733.2349999999, 279221.70499999984, 272474.6849999999, 144393.65599999996, 137611.00199999995, 337010.12000000005, 313933.55199999997, 321643.942, 165416.5989999999, 148673.82299999992, 366515.65999999986, 346998.54800000024, 344296.4280000002, 173238.55100000012, 262888.4550000002, 660640.2250000003, 602030.4789999997, 598932.9859999999, 310930.15600000013, 125399.41199999997, 330182.6540000001, 291060.453, 292356.4300000001, 153792.36999999988, 146865.34999999998, 353864.95100000023, 336792.5030000001, 323746.7879999998, 168899.53399999996, 141298.33399999994, 339594.8869999998, 323463.46, 312751.6340000003, 161177.69799999997, 144516.30800000002, 335376.534, 326082.2889999999, 303078.71500000014, 156123.1780000001, 147101.718, 341924.21100000007, 326669.64100000024, 310706.2089999999, 159145.32399999994, 128564.553, 330225.358, 309483.0559999999, 299520.46499999985, 151017.772, 126817.91300000004, 313430.41099999973, 291843.3289999999, 281623.8779999998, 145538.81000000003, 133206.20299999998, 327357.9069999998, 305823.3600000003, 300063.738, 158683.19999999998, 539490.2360000004, 1324454.054000001, 1213576.0540000002, 1194521.0080000006, 629270.7439999995, 165724.4110000001, 382432.05, 366017.566, 369615.47700000013, 194636.74500000008, 156596.75700000004, 363945.147, 351886.713, 345019.70900000026, 169324.42, 334722.97800000035, 783993.5380000002, 756986.5509999995, 728530.7279999995, 364258.24699999986, 162458.33799999987, 385407.1429999999, 374350.17000000004, 362324.2470000001, 182025.62600000005, 168953.36700000003, 383477.7059999999, 372892.33799999993, 374487.924, 196583.00499999992, 175948.8729999999, 404986.619, 389729.3829999997, 387557.27000000037, 206438.98700000005, 135764.11600000004, 330476.9019999999, 312785.99400000024, 293567.8260000001, 154490.1620000001, 884745.2509999992, 2104941.6359999985, 1976756.8779999989, 1962945.484, 1011488.8040000013, 178802.60599999994, 406533.2239999999, 389005.7999999999, 379622.3230000002, 191911.023, 166811.80099999983, 389484.7709999998, 361152.6190000002, 363866.6589999998, 186641.8720000001, 163441.68099999998, 387910.3280000003, 361316.77399999986, 362642.6590000002, 186403.60899999997, 154277.5209999999, 387150.70099999994, 365370.67599999986, 363957.8180000003, 184870.1670000001, 142530.444, 333235.1260000001, 316578.706, 314535.6510000001, 158835.34499999997, 176563.15500000006, 422860.3770000001, 402135.485, 387468.8560000001, 199015.00500000006, 152437.77999999994, 356684.1159999998, 334724.94799999974, 340771.37200000003, 176020.89700000003, 149278.41799999998, 361611.4649999998, 331947.1710000001, 335098.6819999999, 173276.45199999993, 182993.25700000016, 424187.78600000014, 405950.2529999997, 397875.2909999999, 202808.20499999996, 353940.431, 832699.8539999999, 766054.1580000006, 764005.893, 390988.67300000007, 168417.469, 400105.9620000002, 357060.22899999976, 365626.88899999985, 186051.24300000007, 150747.29000000007, 357855.6309999999, 338050.3500000004, 323210.724, 165243.1690000001, 153105.64500000002, 358235.50899999996, 339753.83899999975, 326672.0500000001, 166151.20299999998, 178210.03300000005, 414006.95699999953, 395100.3270000003, 401201.90500000026, 203157.71800000002, 147374.87499999997, 362240.1969999999, 322356.135, 329907.00800000026, 169871.90800000008, 151777.685, 359808.6740000001, 344828.6690000001, 337751.98899999994, 168419.88899999997, 328111.80700000003, 758025.0909999997, 735711.2710000003, 722559.4409999996, 365966.79199999984, 178129.38300000003, 408624.51999999984, 390885.9960000001, 392331.41099999985, 201397.636, 159048.3359999999, 370860.30400000006, 352530.47200000007, 346065.82300000015, 186383.60600000017, 159402.26499999996, 368228.8059999998, 361654.5559999998, 351495.48299999983, 187565.93600000005, 177071.54699999993, 428025.86500000017, 404752.591, 406600.0869999995, 204985.0619999999, 178467.22800000006, 422275.05199999973, 403669.45699999976, 400802.3589999998, 203188.9930000001, 783536.1099999992, 1899173.2550000024, 1795664.5569999984, 1766765.272999998, 898245.915000001, 163357.2580000001, 385954.4140000002, 372821.4319999999, 372464.61799999996, 189646.71499999982, 149059.226, 352329.80199999997, 332424.809, 319317.296, 158989.2969999999, 306498.95200000005, 730097.4069999998, 700380.8310000005, 681205.4609999995, 347082.6100000002, 157360.54100000003, 382075.20800000016, 367447.2959999998, 363530.9949999999, 187267.22399999993, 161670.53600000005, 405213.24199999997, 393427.94600000023, 373366.0039999999, 194005.93900000007, 316494.21499999997, 778790.718, 752235.1760000004, 737857.2080000003, 370567.8809999998, 152978.30699999997, 362713.51200000005, 363588.1900000001, 359387.25799999986, 176391.97400000007, 157465.229, 355796.29399999994, 332249.9659999999, 327201.3449999999, 164428.19999999998, 149098.40300000002, 355114.01100000035, 329209.05099999986, 330076.315, 174199.0190000001, 478528.06699999986, 1136735.2729999986, 1068963.2950000006, 1068740.575999999, 536553.415, 165063.28399999999, 392687.8229999999, 372246.5389999998, 360930.4050000001, 182060.1230000001, 180784.43399999995, 407310.8130000001, 386196.93899999995, 369696.626, 186805.59100000007, 176782.39800000002, 394608.4539999999, 379329.76199999976, 366776.39699999994, 181294.468, 175084.17899999997, 408038.27200000006, 398721.02099999995, 402858.0230000002, 203338.77600000016, 190942.429, 442387.21000000014, 420842.96799999994, 422685.201, 203927.38799999995, 194168.08500000014, 447962.66200000024, 422742.82800000004, 422282.7669999999, 207833.98300000004, 146106.818, 351913.07699999976, 321306.787, 314674.16000000003, 161876.92700000003, 144481.7529999999, 361148.714, 323125.61499999993, 318492.05799999996, 160594.91099999993, 181146.85799999983, 411894.29199999967, 409502.46400000015, 399363.69399999996, 194196.05200000008, 180434.56500000018, 415886.74600000016, 409495.62899999943, 409596.8179999999, 196596.199, 156719.789, 384155.34800000035, 368573.7589999998, 363199.97200000007, 189102.49900000013, 139304.42299999995, 334491.0169999999, 309151.3829999999, 307008.2230000002, 159267.82200000004, 468593.17100000003, 1117838.099, 1053845.9729999993, 1045894.1299999986, 531557.9290000007, 168973.85200000007, 383420.8870000001, 376462.4210000004, 363091.38899999997, 182110.86600000007, 180539.21499999997, 426122.317, 415782.84099999984, 420137.42400000023, 212921.54800000007, 452378.7339999999, 1050400.7850000001, 1021914.5190000002, 991664.4929999999, 507990.1259999998, 161894.602, 369533.60099999973, 363580.9169999999, 362327.8709999998, 185464.98200000005, 179417.04899999997, 425795.4040000001, 409846.2219999997, 399693.60899999976, 201256.46299999996, 359733.6279999998, 845150.4609999999, 811512.7980000001, 801235.422999999, 407594.2619999998, 190088.52899999986, 433451.94299999997, 417568.16399999964, 423489.36699999997, 217234.7670000001, 156453.60999999996, 365086.10800000024, 359207.9290000001, 351597.7179999997, 177279.91100000002, 155249.94299999997, 357901.0470000001, 343083.1990000001, 330875.96699999995, 167004.63900000002, 173964.05200000008, 398329.289, 386559.47600000014, 392303.28900000005, 198393.30700000015, 822186.3560000004, 1884721.6909999985, 1819564.909000001, 1804816.7189999984, 908223.5730000004, 163035.39400000017, 369964.5040000003, 353651.4140000001, 337202.16000000003, 169889.18200000003, 137217.75500000003, 331620.223, 307788.1179999997, 296839.992, 152504.04100000006, 177587.624, 429757.497, 426695.5580000002, 413272.8170000001, 211586.50300000014, 145067.31900000008, 335109.40599999984, 322519.4699999999, 315513.82299999986, 162468.88400000002, 350387.87299999985, 819172.2820000007, 789134.3299999997, 790284.6540000006, 393792.8979999998, 167601.51900000012, 394771.11199999996, 379939.8569999998, 366951.8460000002, 186898.8359999999, 169966.87199999994, 407759.73100000015, 382112.2260000002, 382171.9790000002, 198128.33000000002, 329439.4110000002, 786230.5789999998, 755826.2369999996, 755379.7759999997, 380804.44700000045, 161714.068, 379596.84700000007, 367852.81299999997, 367694.00199999975, 184651.9400000001, 125820.46299999997, 309906.2769999999, 300523.5370000003, 286229.3899999999, 139522.44799999997, 130654.21399999999, 329360.698, 318783.0310000002, 297721.07800000004, 145535.37700000004, 149997.904, 351813.22599999997, 334628.2919999999, 329694.9659999999, 169465.92600000012, 169015.0439999999, 405722.8960000002, 382782.7680000001, 382205.8599999999, 190998.14500000008]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.100931291934885, "mean_inference_ms": 1.8072702224104893, "mean_action_processing_ms": 1.349945199670445, "mean_env_wait_ms": 500.66398009817766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08799576759338379, "StateBufferConnector_ms": 0.02300429344177246, "ViewRequirementAgentConnector_ms": 0.4315488338470459}, "num_episodes": 17, "episode_return_max": 7940878.053000032, "episode_return_min": 1115213.0869999991, "episode_return_mean": 1883485.7733900005, "episodes_this_iter": 17}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 330000, "num_agent_steps_trained": 330000, "num_env_steps_sampled": 66000, "num_env_steps_trained": 66000, "num_env_steps_sampled_this_iter": 6000, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 12.899975651138488, "num_env_steps_trained_throughput_per_sec": 12.899975651138488, "timesteps_total": 66000, "num_env_steps_sampled_lifetime": 66000, "num_agent_steps_sampled_lifetime": 330000, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 330000, "timers": {"training_iteration_time_ms": 451072.112, "restore_workers_time_ms": 0.0, "training_step_time_ms": 451072.013, "sample_time_ms": 421928.225, "learn_time_ms": 29129.489, "learn_throughput": 205.977, "synch_weights_time_ms": 10.707}, "counters": {"num_env_steps_sampled": 66000, "num_env_steps_trained": 66000, "num_agent_steps_sampled": 330000, "num_agent_steps_trained": 330000}, "done": false, "training_iteration": 11, "trial_id": "a5bb6_00000", "date": "2025-01-21_10-34-06", "timestamp": 1737484446, "time_this_iter_s": 465.12215638160706, "time_total_s": 4976.364948272705, "pid": 61756, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'environments.trafficEnv.TrafficLightMAEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 20000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 6000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function my_policy_mapping at 0x00000177903D92D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, "Dict('local_state': Dict('current_phase': Discrete(3), 'queue_length': Box(0.0, 100.0, (4,), float32), 'waiting_time': Box(0.0, 1000000.0, (4,), float32)), 'neighbor_info': Box(0.0, 100.0, (4,), float32))", "Dict('duration': Box(5.0, 60.0, (1,), float32), 'phase': Discrete(3))", {"model": {"custom_model": "my_traffic_model"}}]}, "callbacks": "<class 'config.trainingConfig.MetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4976.364948272705, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 2.976086956521739, "ram_util_percent": 50.766555183946494, "gpu_util_percent0": 0.031020066889632113, "vram_util_percent0": 0.1302618428616221}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7797709137962219, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.0002999999999999999, "total_loss": 9.946148627260898, "policy_loss": 8.147999723540976e-06, "vf_loss": 9.964980271927853, "vf_explained_var": -4.671938875888256e-06, "kl": 0.007278185337272967, "entropy": 1.924923879491522, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 27025.5, "diff_num_grad_updates_vs_sampler_policy": 1174.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": 7940878.053000032, "episode_reward_min": 1159254.3409999989, "episode_reward_mean": 2007993.4171300002, "episode_len_mean": 339.99, "episode_media": {}, "episodes_timesteps_total": 33999, "policy_reward_min": {"shared_policy": 125820.46299999997}, "policy_reward_max": {"shared_policy": 2104941.6359999985}, "policy_reward_mean": {"shared_policy": 401598.68342599995}, "custom_metrics": {"mean_queue_length": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "mean_waiting_time": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "mean_throughput": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "hist_stats": {"episode_reward": [1218811.2039999978, 1159254.3409999989, 1225134.4079999984, 4901312.096000002, 1478426.2490000003, 1386772.7459999984, 2968492.0420000013, 1466565.5240000016, 1496394.3400000005, 1564661.1319999993, 1227084.999999998, 7940878.053000032, 1545874.975999999, 1467957.721999998, 1461715.050999998, 1455626.8830000008, 1265715.272, 1588042.878, 1360639.112999998, 1351212.1880000005, 1613814.7919999994, 3107689.009000001, 1477261.7919999994, 1335107.1639999987, 1343918.2459999986, 1591676.940000004, 1331750.1229999992, 1362586.9060000002, 2910374.401999999, 1571368.9460000026, 1414888.5409999997, 1428347.0460000008, 1621435.1520000002, 1608403.0889999992, 7143385.11, 1484244.436999999, 1312120.430000001, 2765265.2610000074, 1457681.2639999993, 1527683.6670000001, 2955945.198000001, 1415059.2410000004, 1337141.0340000002, 1337696.7990000022, 4289520.62599999, 1472988.1740000022, 1530794.403000001, 1498791.4790000003, 1588040.2709999974, 1680785.195999999, 1694990.3249999995, 1295877.7690000029, 1307843.0509999995, 1596103.3599999985, 1612009.9570000018, 1461751.3669999987, 1249222.8679999984, 4217729.301999999, 1474059.4150000017, 1655503.3449999986, 4024348.6569999955, 1442801.9730000007, 1616008.7469999986, 3225226.572000004, 1681832.770000001, 1409625.2759999987, 1354114.7949999978, 1549549.4129999985, 7239513.248000013, 1393742.6539999982, 1225970.1290000004, 1658899.9990000024, 1280678.9019999995, 3142772.036999994, 1496163.169999995, 1540139.1380000014, 3007680.450000001, 1461509.6700000004, 1162002.1150000005, 1222054.398, 1335600.314, 1530724.7129999963, 1391522.2230000016, 1395978.8579999984, 1659357.8830000008, 1714563.2589999991, 1380621.456, 6968816.132000002, 1387911.7620000006, 1507664.862, 1419863.3330000006, 1421453.3090000025, 1969585.5860000015, 3610952.6350000007, 1592522.1670000001, 1493959.4880000001, 6182367.800000024, 1817646.8379999993, 1627006.5810000012, 1645161.6860000016], "episode_lengths": [225, 208, 218, 886, 252, 252, 509, 257, 267, 267, 221, 1372, 253, 244, 244, 255, 213, 275, 234, 234, 283, 533, 250, 237, 237, 264, 227, 235, 495, 260, 243, 243, 267, 267, 1219, 251, 233, 478, 245, 267, 506, 239, 225, 218, 738, 247, 253, 253, 258, 284, 284, 220, 220, 269, 269, 246, 211, 706, 249, 279, 677, 234, 266, 536, 270, 238, 229, 253, 1205, 227, 205, 284, 211, 539, 260, 253, 507, 254, 208, 208, 217, 257, 228, 228, 271, 288, 229, 1166, 237, 254, 237, 237, 320, 580, 260, 254, 1035, 307, 268, 268], "policy_shared_policy_reward": [128564.553, 330225.358, 309483.0559999999, 299520.46499999985, 151017.772, 126817.91300000004, 313430.41099999973, 291843.3289999999, 281623.8779999998, 145538.81000000003, 133206.20299999998, 327357.9069999998, 305823.3600000003, 300063.738, 158683.19999999998, 539490.2360000004, 1324454.054000001, 1213576.0540000002, 1194521.0080000006, 629270.7439999995, 165724.4110000001, 382432.05, 366017.566, 369615.47700000013, 194636.74500000008, 156596.75700000004, 363945.147, 351886.713, 345019.70900000026, 169324.42, 334722.97800000035, 783993.5380000002, 756986.5509999995, 728530.7279999995, 364258.24699999986, 162458.33799999987, 385407.1429999999, 374350.17000000004, 362324.2470000001, 182025.62600000005, 168953.36700000003, 383477.7059999999, 372892.33799999993, 374487.924, 196583.00499999992, 175948.8729999999, 404986.619, 389729.3829999997, 387557.27000000037, 206438.98700000005, 135764.11600000004, 330476.9019999999, 312785.99400000024, 293567.8260000001, 154490.1620000001, 884745.2509999992, 2104941.6359999985, 1976756.8779999989, 1962945.484, 1011488.8040000013, 178802.60599999994, 406533.2239999999, 389005.7999999999, 379622.3230000002, 191911.023, 166811.80099999983, 389484.7709999998, 361152.6190000002, 363866.6589999998, 186641.8720000001, 163441.68099999998, 387910.3280000003, 361316.77399999986, 362642.6590000002, 186403.60899999997, 154277.5209999999, 387150.70099999994, 365370.67599999986, 363957.8180000003, 184870.1670000001, 142530.444, 333235.1260000001, 316578.706, 314535.6510000001, 158835.34499999997, 176563.15500000006, 422860.3770000001, 402135.485, 387468.8560000001, 199015.00500000006, 152437.77999999994, 356684.1159999998, 334724.94799999974, 340771.37200000003, 176020.89700000003, 149278.41799999998, 361611.4649999998, 331947.1710000001, 335098.6819999999, 173276.45199999993, 182993.25700000016, 424187.78600000014, 405950.2529999997, 397875.2909999999, 202808.20499999996, 353940.431, 832699.8539999999, 766054.1580000006, 764005.893, 390988.67300000007, 168417.469, 400105.9620000002, 357060.22899999976, 365626.88899999985, 186051.24300000007, 150747.29000000007, 357855.6309999999, 338050.3500000004, 323210.724, 165243.1690000001, 153105.64500000002, 358235.50899999996, 339753.83899999975, 326672.0500000001, 166151.20299999998, 178210.03300000005, 414006.95699999953, 395100.3270000003, 401201.90500000026, 203157.71800000002, 147374.87499999997, 362240.1969999999, 322356.135, 329907.00800000026, 169871.90800000008, 151777.685, 359808.6740000001, 344828.6690000001, 337751.98899999994, 168419.88899999997, 328111.80700000003, 758025.0909999997, 735711.2710000003, 722559.4409999996, 365966.79199999984, 178129.38300000003, 408624.51999999984, 390885.9960000001, 392331.41099999985, 201397.636, 159048.3359999999, 370860.30400000006, 352530.47200000007, 346065.82300000015, 186383.60600000017, 159402.26499999996, 368228.8059999998, 361654.5559999998, 351495.48299999983, 187565.93600000005, 177071.54699999993, 428025.86500000017, 404752.591, 406600.0869999995, 204985.0619999999, 178467.22800000006, 422275.05199999973, 403669.45699999976, 400802.3589999998, 203188.9930000001, 783536.1099999992, 1899173.2550000024, 1795664.5569999984, 1766765.272999998, 898245.915000001, 163357.2580000001, 385954.4140000002, 372821.4319999999, 372464.61799999996, 189646.71499999982, 149059.226, 352329.80199999997, 332424.809, 319317.296, 158989.2969999999, 306498.95200000005, 730097.4069999998, 700380.8310000005, 681205.4609999995, 347082.6100000002, 157360.54100000003, 382075.20800000016, 367447.2959999998, 363530.9949999999, 187267.22399999993, 161670.53600000005, 405213.24199999997, 393427.94600000023, 373366.0039999999, 194005.93900000007, 316494.21499999997, 778790.718, 752235.1760000004, 737857.2080000003, 370567.8809999998, 152978.30699999997, 362713.51200000005, 363588.1900000001, 359387.25799999986, 176391.97400000007, 157465.229, 355796.29399999994, 332249.9659999999, 327201.3449999999, 164428.19999999998, 149098.40300000002, 355114.01100000035, 329209.05099999986, 330076.315, 174199.0190000001, 478528.06699999986, 1136735.2729999986, 1068963.2950000006, 1068740.575999999, 536553.415, 165063.28399999999, 392687.8229999999, 372246.5389999998, 360930.4050000001, 182060.1230000001, 180784.43399999995, 407310.8130000001, 386196.93899999995, 369696.626, 186805.59100000007, 176782.39800000002, 394608.4539999999, 379329.76199999976, 366776.39699999994, 181294.468, 175084.17899999997, 408038.27200000006, 398721.02099999995, 402858.0230000002, 203338.77600000016, 190942.429, 442387.21000000014, 420842.96799999994, 422685.201, 203927.38799999995, 194168.08500000014, 447962.66200000024, 422742.82800000004, 422282.7669999999, 207833.98300000004, 146106.818, 351913.07699999976, 321306.787, 314674.16000000003, 161876.92700000003, 144481.7529999999, 361148.714, 323125.61499999993, 318492.05799999996, 160594.91099999993, 181146.85799999983, 411894.29199999967, 409502.46400000015, 399363.69399999996, 194196.05200000008, 180434.56500000018, 415886.74600000016, 409495.62899999943, 409596.8179999999, 196596.199, 156719.789, 384155.34800000035, 368573.7589999998, 363199.97200000007, 189102.49900000013, 139304.42299999995, 334491.0169999999, 309151.3829999999, 307008.2230000002, 159267.82200000004, 468593.17100000003, 1117838.099, 1053845.9729999993, 1045894.1299999986, 531557.9290000007, 168973.85200000007, 383420.8870000001, 376462.4210000004, 363091.38899999997, 182110.86600000007, 180539.21499999997, 426122.317, 415782.84099999984, 420137.42400000023, 212921.54800000007, 452378.7339999999, 1050400.7850000001, 1021914.5190000002, 991664.4929999999, 507990.1259999998, 161894.602, 369533.60099999973, 363580.9169999999, 362327.8709999998, 185464.98200000005, 179417.04899999997, 425795.4040000001, 409846.2219999997, 399693.60899999976, 201256.46299999996, 359733.6279999998, 845150.4609999999, 811512.7980000001, 801235.422999999, 407594.2619999998, 190088.52899999986, 433451.94299999997, 417568.16399999964, 423489.36699999997, 217234.7670000001, 156453.60999999996, 365086.10800000024, 359207.9290000001, 351597.7179999997, 177279.91100000002, 155249.94299999997, 357901.0470000001, 343083.1990000001, 330875.96699999995, 167004.63900000002, 173964.05200000008, 398329.289, 386559.47600000014, 392303.28900000005, 198393.30700000015, 822186.3560000004, 1884721.6909999985, 1819564.909000001, 1804816.7189999984, 908223.5730000004, 163035.39400000017, 369964.5040000003, 353651.4140000001, 337202.16000000003, 169889.18200000003, 137217.75500000003, 331620.223, 307788.1179999997, 296839.992, 152504.04100000006, 177587.624, 429757.497, 426695.5580000002, 413272.8170000001, 211586.50300000014, 145067.31900000008, 335109.40599999984, 322519.4699999999, 315513.82299999986, 162468.88400000002, 350387.87299999985, 819172.2820000007, 789134.3299999997, 790284.6540000006, 393792.8979999998, 167601.51900000012, 394771.11199999996, 379939.8569999998, 366951.8460000002, 186898.8359999999, 169966.87199999994, 407759.73100000015, 382112.2260000002, 382171.9790000002, 198128.33000000002, 329439.4110000002, 786230.5789999998, 755826.2369999996, 755379.7759999997, 380804.44700000045, 161714.068, 379596.84700000007, 367852.81299999997, 367694.00199999975, 184651.9400000001, 125820.46299999997, 309906.2769999999, 300523.5370000003, 286229.3899999999, 139522.44799999997, 130654.21399999999, 329360.698, 318783.0310000002, 297721.07800000004, 145535.37700000004, 149997.904, 351813.22599999997, 334628.2919999999, 329694.9659999999, 169465.92600000012, 169015.0439999999, 405722.8960000002, 382782.7680000001, 382205.8599999999, 190998.14500000008, 163629.034, 379837.359, 339486.0139999999, 334209.97899999993, 174359.83700000003, 165091.87600000002, 378493.52799999993, 340487.7629999999, 336452.91700000013, 175452.7739999999, 189920.448, 436498.53700000007, 420163.18399999995, 408590.5050000002, 204185.209, 196451.14900000012, 441417.88399999996, 430161.1470000001, 434043.3159999999, 212489.7630000002, 158607.584, 369654.76000000024, 342623.74199999997, 337145.94799999974, 172589.42200000005, 770619.5350000004, 1835807.8819999986, 1757405.5189999987, 1726534.7710000034, 878448.4249999995, 150850.45399999994, 362303.8590000001, 353530.0099999998, 348352.95099999954, 172874.48799999995, 171764.09499999994, 406256.4200000003, 375242.16899999994, 370827.09599999984, 183575.08199999997, 153696.58200000017, 363010.5949999999, 364570.577, 359822.46100000007, 178763.11800000013, 154027.20299999998, 364933.6189999998, 362160.81600000034, 357585.8370000001, 182745.83399999997, 222225.77999999985, 512622.576, 493783.58400000044, 491357.8840000001, 249595.76200000025, 411988.21599999984, 935256.7830000003, 911911.1859999998, 899947.8180000002, 451848.63199999975, 182386.0600000002, 414803.85699999996, 405899.51399999997, 391162.28400000004, 198270.45199999984, 170320.13200000013, 393282.48000000033, 388108.18399999995, 361526.48400000005, 180722.2080000001, 697884.725, 1618851.7209999955, 1565216.3459999994, 1537612.2219999991, 762802.7860000002, 209523.202, 472945.8010000001, 453936.3870000001, 457350.39900000044, 223891.04899999997, 187497.21500000023, 415152.28900000005, 408369.995, 411573.45600000024, 204413.626, 189091.51899999997, 423488.4849999997, 414339.148, 412256.0610000003, 205986.473]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.1072074458521435, "mean_inference_ms": 1.806800227769601, "mean_action_processing_ms": 1.3497940627831673, "mean_env_wait_ms": 503.3163792884245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09499716758728027, "StateBufferConnector_ms": 0.02301192283630371, "ViewRequirementAgentConnector_ms": 0.4406700134277344}, "num_episodes": 18, "episode_return_max": 7940878.053000032, "episode_return_min": 1159254.3409999989, "episode_return_mean": 2007993.4171300002, "episodes_this_iter": 18}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 6000, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 12.714195207018824, "num_env_steps_trained_throughput_per_sec": 12.714195207018824, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 454171.888, "restore_workers_time_ms": 0.0, "training_step_time_ms": 454171.789, "sample_time_ms": 424985.718, "learn_time_ms": 29171.874, "learn_throughput": 205.678, "synch_weights_time_ms": 10.606}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 12, "trial_id": "a5bb6_00000", "date": "2025-01-21_10-41-58", "timestamp": 1737484918, "time_this_iter_s": 471.91847038269043, "time_total_s": 5448.2834186553955, "pid": 61756, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'environments.trafficEnv.TrafficLightMAEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 20000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 6000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function my_policy_mapping at 0x00000177903D92D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, "Dict('local_state': Dict('current_phase': Discrete(3), 'queue_length': Box(0.0, 100.0, (4,), float32), 'waiting_time': Box(0.0, 1000000.0, (4,), float32)), 'neighbor_info': Box(0.0, 100.0, (4,), float32))", "Dict('duration': Box(5.0, 60.0, (1,), float32), 'phase': Discrete(3))", {"model": {"custom_model": "my_traffic_model"}}]}, "callbacks": "<class 'config.trainingConfig.MetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5448.2834186553955, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 2.8214521452145216, "ram_util_percent": 51.742079207920796, "gpu_util_percent0": 0.030363036303630367, "vram_util_percent0": 0.1294054893770627}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7473297509741277, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.0002999999999999999, "total_loss": 9.955299031683738, "policy_loss": 0.0008534530617613741, "vf_loss": 9.973410658329092, "vf_explained_var": -1.789559709264877e-06, "kl": 0.004587053158057918, "entropy": 1.922315108421001, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 29375.5, "diff_num_grad_updates_vs_sampler_policy": 1174.5}}, "num_env_steps_sampled": 78000, "num_env_steps_trained": 78000, "num_agent_steps_sampled": 390000, "num_agent_steps_trained": 390000}, "env_runners": {"episode_reward_max": 7239513.248000013, "episode_reward_min": 1162002.1150000005, "episode_reward_mean": 2012431.2094300005, "episode_len_mean": 337.21, "episode_media": {}, "episodes_timesteps_total": 33721, "policy_reward_min": {"shared_policy": 125820.46299999997}, "policy_reward_max": {"shared_policy": 1899173.2550000024}, "policy_reward_mean": {"shared_policy": 402486.241886}, "custom_metrics": {"mean_queue_length": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "mean_waiting_time": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "mean_throughput": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "hist_stats": {"episode_reward": [1265715.272, 1588042.878, 1360639.112999998, 1351212.1880000005, 1613814.7919999994, 3107689.009000001, 1477261.7919999994, 1335107.1639999987, 1343918.2459999986, 1591676.940000004, 1331750.1229999992, 1362586.9060000002, 2910374.401999999, 1571368.9460000026, 1414888.5409999997, 1428347.0460000008, 1621435.1520000002, 1608403.0889999992, 7143385.11, 1484244.436999999, 1312120.430000001, 2765265.2610000074, 1457681.2639999993, 1527683.6670000001, 2955945.198000001, 1415059.2410000004, 1337141.0340000002, 1337696.7990000022, 4289520.62599999, 1472988.1740000022, 1530794.403000001, 1498791.4790000003, 1588040.2709999974, 1680785.195999999, 1694990.3249999995, 1295877.7690000029, 1307843.0509999995, 1596103.3599999985, 1612009.9570000018, 1461751.3669999987, 1249222.8679999984, 4217729.301999999, 1474059.4150000017, 1655503.3449999986, 4024348.6569999955, 1442801.9730000007, 1616008.7469999986, 3225226.572000004, 1681832.770000001, 1409625.2759999987, 1354114.7949999978, 1549549.4129999985, 7239513.248000013, 1393742.6539999982, 1225970.1290000004, 1658899.9990000024, 1280678.9019999995, 3142772.036999994, 1496163.169999995, 1540139.1380000014, 3007680.450000001, 1461509.6700000004, 1162002.1150000005, 1222054.398, 1335600.314, 1530724.7129999963, 1391522.2230000016, 1395978.8579999984, 1659357.8830000008, 1714563.2589999991, 1380621.456, 6968816.132000002, 1387911.7620000006, 1507664.862, 1419863.3330000006, 1421453.3090000025, 1969585.5860000015, 3610952.6350000007, 1592522.1670000001, 1493959.4880000001, 6182367.800000024, 1817646.8379999993, 1627006.5810000012, 1645161.6860000016, 5004995.1499999855, 1649039.2520000003, 1434059.6080000019, 3249876.8370000017, 1775928.8559999992, 1720974.2309999994, 4903745.851000003, 1652246.8730000027, 1617371.239, 1410139.898000001, 1847409.503000001, 1471809.0679999993, 1717470.9779999994, 1685332.5339999993, 1468867.036, 1799474.0829999978], "episode_lengths": [213, 275, 234, 234, 283, 533, 250, 237, 237, 264, 227, 235, 495, 260, 243, 243, 267, 267, 1219, 251, 233, 478, 245, 267, 506, 239, 225, 218, 738, 247, 253, 253, 258, 284, 284, 220, 220, 269, 269, 246, 211, 706, 249, 279, 677, 234, 266, 536, 270, 238, 229, 253, 1205, 227, 205, 284, 211, 539, 260, 253, 507, 254, 208, 208, 217, 257, 228, 228, 271, 288, 229, 1166, 237, 254, 237, 237, 320, 580, 260, 254, 1035, 307, 268, 268, 831, 272, 234, 519, 285, 278, 814, 282, 271, 231, 290, 247, 279, 279, 247, 293], "policy_shared_policy_reward": [142530.444, 333235.1260000001, 316578.706, 314535.6510000001, 158835.34499999997, 176563.15500000006, 422860.3770000001, 402135.485, 387468.8560000001, 199015.00500000006, 152437.77999999994, 356684.1159999998, 334724.94799999974, 340771.37200000003, 176020.89700000003, 149278.41799999998, 361611.4649999998, 331947.1710000001, 335098.6819999999, 173276.45199999993, 182993.25700000016, 424187.78600000014, 405950.2529999997, 397875.2909999999, 202808.20499999996, 353940.431, 832699.8539999999, 766054.1580000006, 764005.893, 390988.67300000007, 168417.469, 400105.9620000002, 357060.22899999976, 365626.88899999985, 186051.24300000007, 150747.29000000007, 357855.6309999999, 338050.3500000004, 323210.724, 165243.1690000001, 153105.64500000002, 358235.50899999996, 339753.83899999975, 326672.0500000001, 166151.20299999998, 178210.03300000005, 414006.95699999953, 395100.3270000003, 401201.90500000026, 203157.71800000002, 147374.87499999997, 362240.1969999999, 322356.135, 329907.00800000026, 169871.90800000008, 151777.685, 359808.6740000001, 344828.6690000001, 337751.98899999994, 168419.88899999997, 328111.80700000003, 758025.0909999997, 735711.2710000003, 722559.4409999996, 365966.79199999984, 178129.38300000003, 408624.51999999984, 390885.9960000001, 392331.41099999985, 201397.636, 159048.3359999999, 370860.30400000006, 352530.47200000007, 346065.82300000015, 186383.60600000017, 159402.26499999996, 368228.8059999998, 361654.5559999998, 351495.48299999983, 187565.93600000005, 177071.54699999993, 428025.86500000017, 404752.591, 406600.0869999995, 204985.0619999999, 178467.22800000006, 422275.05199999973, 403669.45699999976, 400802.3589999998, 203188.9930000001, 783536.1099999992, 1899173.2550000024, 1795664.5569999984, 1766765.272999998, 898245.915000001, 163357.2580000001, 385954.4140000002, 372821.4319999999, 372464.61799999996, 189646.71499999982, 149059.226, 352329.80199999997, 332424.809, 319317.296, 158989.2969999999, 306498.95200000005, 730097.4069999998, 700380.8310000005, 681205.4609999995, 347082.6100000002, 157360.54100000003, 382075.20800000016, 367447.2959999998, 363530.9949999999, 187267.22399999993, 161670.53600000005, 405213.24199999997, 393427.94600000023, 373366.0039999999, 194005.93900000007, 316494.21499999997, 778790.718, 752235.1760000004, 737857.2080000003, 370567.8809999998, 152978.30699999997, 362713.51200000005, 363588.1900000001, 359387.25799999986, 176391.97400000007, 157465.229, 355796.29399999994, 332249.9659999999, 327201.3449999999, 164428.19999999998, 149098.40300000002, 355114.01100000035, 329209.05099999986, 330076.315, 174199.0190000001, 478528.06699999986, 1136735.2729999986, 1068963.2950000006, 1068740.575999999, 536553.415, 165063.28399999999, 392687.8229999999, 372246.5389999998, 360930.4050000001, 182060.1230000001, 180784.43399999995, 407310.8130000001, 386196.93899999995, 369696.626, 186805.59100000007, 176782.39800000002, 394608.4539999999, 379329.76199999976, 366776.39699999994, 181294.468, 175084.17899999997, 408038.27200000006, 398721.02099999995, 402858.0230000002, 203338.77600000016, 190942.429, 442387.21000000014, 420842.96799999994, 422685.201, 203927.38799999995, 194168.08500000014, 447962.66200000024, 422742.82800000004, 422282.7669999999, 207833.98300000004, 146106.818, 351913.07699999976, 321306.787, 314674.16000000003, 161876.92700000003, 144481.7529999999, 361148.714, 323125.61499999993, 318492.05799999996, 160594.91099999993, 181146.85799999983, 411894.29199999967, 409502.46400000015, 399363.69399999996, 194196.05200000008, 180434.56500000018, 415886.74600000016, 409495.62899999943, 409596.8179999999, 196596.199, 156719.789, 384155.34800000035, 368573.7589999998, 363199.97200000007, 189102.49900000013, 139304.42299999995, 334491.0169999999, 309151.3829999999, 307008.2230000002, 159267.82200000004, 468593.17100000003, 1117838.099, 1053845.9729999993, 1045894.1299999986, 531557.9290000007, 168973.85200000007, 383420.8870000001, 376462.4210000004, 363091.38899999997, 182110.86600000007, 180539.21499999997, 426122.317, 415782.84099999984, 420137.42400000023, 212921.54800000007, 452378.7339999999, 1050400.7850000001, 1021914.5190000002, 991664.4929999999, 507990.1259999998, 161894.602, 369533.60099999973, 363580.9169999999, 362327.8709999998, 185464.98200000005, 179417.04899999997, 425795.4040000001, 409846.2219999997, 399693.60899999976, 201256.46299999996, 359733.6279999998, 845150.4609999999, 811512.7980000001, 801235.422999999, 407594.2619999998, 190088.52899999986, 433451.94299999997, 417568.16399999964, 423489.36699999997, 217234.7670000001, 156453.60999999996, 365086.10800000024, 359207.9290000001, 351597.7179999997, 177279.91100000002, 155249.94299999997, 357901.0470000001, 343083.1990000001, 330875.96699999995, 167004.63900000002, 173964.05200000008, 398329.289, 386559.47600000014, 392303.28900000005, 198393.30700000015, 822186.3560000004, 1884721.6909999985, 1819564.909000001, 1804816.7189999984, 908223.5730000004, 163035.39400000017, 369964.5040000003, 353651.4140000001, 337202.16000000003, 169889.18200000003, 137217.75500000003, 331620.223, 307788.1179999997, 296839.992, 152504.04100000006, 177587.624, 429757.497, 426695.5580000002, 413272.8170000001, 211586.50300000014, 145067.31900000008, 335109.40599999984, 322519.4699999999, 315513.82299999986, 162468.88400000002, 350387.87299999985, 819172.2820000007, 789134.3299999997, 790284.6540000006, 393792.8979999998, 167601.51900000012, 394771.11199999996, 379939.8569999998, 366951.8460000002, 186898.8359999999, 169966.87199999994, 407759.73100000015, 382112.2260000002, 382171.9790000002, 198128.33000000002, 329439.4110000002, 786230.5789999998, 755826.2369999996, 755379.7759999997, 380804.44700000045, 161714.068, 379596.84700000007, 367852.81299999997, 367694.00199999975, 184651.9400000001, 125820.46299999997, 309906.2769999999, 300523.5370000003, 286229.3899999999, 139522.44799999997, 130654.21399999999, 329360.698, 318783.0310000002, 297721.07800000004, 145535.37700000004, 149997.904, 351813.22599999997, 334628.2919999999, 329694.9659999999, 169465.92600000012, 169015.0439999999, 405722.8960000002, 382782.7680000001, 382205.8599999999, 190998.14500000008, 163629.034, 379837.359, 339486.0139999999, 334209.97899999993, 174359.83700000003, 165091.87600000002, 378493.52799999993, 340487.7629999999, 336452.91700000013, 175452.7739999999, 189920.448, 436498.53700000007, 420163.18399999995, 408590.5050000002, 204185.209, 196451.14900000012, 441417.88399999996, 430161.1470000001, 434043.3159999999, 212489.7630000002, 158607.584, 369654.76000000024, 342623.74199999997, 337145.94799999974, 172589.42200000005, 770619.5350000004, 1835807.8819999986, 1757405.5189999987, 1726534.7710000034, 878448.4249999995, 150850.45399999994, 362303.8590000001, 353530.0099999998, 348352.95099999954, 172874.48799999995, 171764.09499999994, 406256.4200000003, 375242.16899999994, 370827.09599999984, 183575.08199999997, 153696.58200000017, 363010.5949999999, 364570.577, 359822.46100000007, 178763.11800000013, 154027.20299999998, 364933.6189999998, 362160.81600000034, 357585.8370000001, 182745.83399999997, 222225.77999999985, 512622.576, 493783.58400000044, 491357.8840000001, 249595.76200000025, 411988.21599999984, 935256.7830000003, 911911.1859999998, 899947.8180000002, 451848.63199999975, 182386.0600000002, 414803.85699999996, 405899.51399999997, 391162.28400000004, 198270.45199999984, 170320.13200000013, 393282.48000000033, 388108.18399999995, 361526.48400000005, 180722.2080000001, 697884.725, 1618851.7209999955, 1565216.3459999994, 1537612.2219999991, 762802.7860000002, 209523.202, 472945.8010000001, 453936.3870000001, 457350.39900000044, 223891.04899999997, 187497.21500000023, 415152.28900000005, 408369.995, 411573.45600000024, 204413.626, 189091.51899999997, 423488.4849999997, 414339.148, 412256.0610000003, 205986.473, 556949.724, 1300316.8050000006, 1272795.0389999975, 1243717.884, 631215.6980000001, 175943.106, 429939.98799999984, 412477.0200000002, 417293.2700000001, 213385.86800000002, 157430.09799999997, 369346.9770000002, 367120.459, 356025.638, 184136.4359999999, 357791.68299999984, 836719.1590000001, 828364.9330000004, 814060.2109999997, 412940.8510000003, 199356.7570000001, 456591.6379999998, 457232.3630000002, 440295.2400000002, 222452.85800000007, 197887.4789999999, 444561.89499999996, 432909.60400000017, 431457.666, 214157.58699999994, 546467.8269999993, 1285815.6340000003, 1225850.9799999977, 1233826.0680000007, 611785.342, 175228.57500000007, 430726.11099999986, 408624.6570000002, 426992.94399999996, 210674.58600000004, 187174.654, 425566.4620000002, 407257.972, 393317.14599999966, 204055.0050000001, 156532.4579999999, 363673.79499999987, 358673.20600000006, 351250.6509999997, 180009.78800000006, 206006.51300000027, 475028.10400000005, 459724.32199999987, 466727.21900000045, 239923.34500000006, 164205.603, 383795.55300000036, 375041.76300000027, 365752.3659999999, 183013.78299999997, 200867.155, 455181.01300000015, 431334.856, 424920.7210000002, 205167.23299999998, 197404.5900000001, 443196.44099999976, 423637.3650000001, 418832.6229999996, 202261.51500000004, 172543.991, 393249.38200000004, 374991.31000000023, 352585.80899999983, 175496.54400000005, 206889.27100000007, 462268.8969999999, 453374.56599999947, 449668.97599999997, 227272.373]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.098351032478095, "mean_inference_ms": 1.8062758563915633, "mean_action_processing_ms": 1.3488713419618674, "mean_env_wait_ms": 505.5454518500212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10698890686035156, "StateBufferConnector_ms": 0.021010637283325195, "ViewRequirementAgentConnector_ms": 0.4306936264038086}, "num_episodes": 16, "episode_return_max": 7239513.248000013, "episode_return_min": 1162002.1150000005, "episode_return_mean": 2012431.2094300005, "episodes_this_iter": 16}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 390000, "num_agent_steps_trained": 390000, "num_env_steps_sampled": 78000, "num_env_steps_trained": 78000, "num_env_steps_sampled_this_iter": 6000, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 12.467297013602588, "num_env_steps_trained_throughput_per_sec": 12.467297013602588, "timesteps_total": 78000, "num_env_steps_sampled_lifetime": 78000, "num_agent_steps_sampled_lifetime": 390000, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 390000, "timers": {"training_iteration_time_ms": 458688.734, "restore_workers_time_ms": 0.0, "training_step_time_ms": 458688.635, "sample_time_ms": 429507.652, "learn_time_ms": 29166.285, "learn_throughput": 205.717, "synch_weights_time_ms": 10.907}, "counters": {"num_env_steps_sampled": 78000, "num_env_steps_trained": 78000, "num_agent_steps_sampled": 390000, "num_agent_steps_trained": 390000}, "done": false, "training_iteration": 13, "trial_id": "a5bb6_00000", "date": "2025-01-21_10-49-59", "timestamp": 1737485399, "time_this_iter_s": 481.2640862464905, "time_total_s": 5929.547504901886, "pid": 61756, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'environments.trafficEnv.TrafficLightMAEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 20000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 6000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function my_policy_mapping at 0x00000177903D92D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, "Dict('local_state': Dict('current_phase': Discrete(3), 'queue_length': Box(0.0, 100.0, (4,), float32), 'waiting_time': Box(0.0, 1000000.0, (4,), float32)), 'neighbor_info': Box(0.0, 100.0, (4,), float32))", "Dict('duration': Box(5.0, 60.0, (1,), float32), 'phase': Discrete(3))", {"model": {"custom_model": "my_traffic_model"}}]}, "callbacks": "<class 'config.trainingConfig.MetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5929.547504901886, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 3.670645161290323, "ram_util_percent": 52.957903225806454, "gpu_util_percent0": 0.030870967741935484, "vram_util_percent0": 0.12939453125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6949208256158423, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.0002999999999999999, "total_loss": 9.938565145451971, "policy_loss": 0.000333809194135222, "vf_loss": 9.957760692758763, "vf_explained_var": -1.1680481281686336e-06, "kl": 0.006088413046433297, "entropy": 1.9700620828790867, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 31725.5, "diff_num_grad_updates_vs_sampler_policy": 1174.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "env_runners": {"episode_reward_max": 7239513.248000013, "episode_reward_min": 1162002.1150000005, "episode_reward_mean": 2108370.9185700007, "episode_len_mean": 350.3, "episode_media": {}, "episodes_timesteps_total": 35030, "policy_reward_min": {"shared_policy": 125820.46299999997}, "policy_reward_max": {"shared_policy": 1884721.6909999985}, "policy_reward_mean": {"shared_policy": 421674.183714}, "custom_metrics": {"mean_queue_length": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "mean_waiting_time": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "mean_throughput": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "hist_stats": {"episode_reward": [1484244.436999999, 1312120.430000001, 2765265.2610000074, 1457681.2639999993, 1527683.6670000001, 2955945.198000001, 1415059.2410000004, 1337141.0340000002, 1337696.7990000022, 4289520.62599999, 1472988.1740000022, 1530794.403000001, 1498791.4790000003, 1588040.2709999974, 1680785.195999999, 1694990.3249999995, 1295877.7690000029, 1307843.0509999995, 1596103.3599999985, 1612009.9570000018, 1461751.3669999987, 1249222.8679999984, 4217729.301999999, 1474059.4150000017, 1655503.3449999986, 4024348.6569999955, 1442801.9730000007, 1616008.7469999986, 3225226.572000004, 1681832.770000001, 1409625.2759999987, 1354114.7949999978, 1549549.4129999985, 7239513.248000013, 1393742.6539999982, 1225970.1290000004, 1658899.9990000024, 1280678.9019999995, 3142772.036999994, 1496163.169999995, 1540139.1380000014, 3007680.450000001, 1461509.6700000004, 1162002.1150000005, 1222054.398, 1335600.314, 1530724.7129999963, 1391522.2230000016, 1395978.8579999984, 1659357.8830000008, 1714563.2589999991, 1380621.456, 6968816.132000002, 1387911.7620000006, 1507664.862, 1419863.3330000006, 1421453.3090000025, 1969585.5860000015, 3610952.6350000007, 1592522.1670000001, 1493959.4880000001, 6182367.800000024, 1817646.8379999993, 1627006.5810000012, 1645161.6860000016, 5004995.1499999855, 1649039.2520000003, 1434059.6080000019, 3249876.8370000017, 1775928.8559999992, 1720974.2309999994, 4903745.851000003, 1652246.8730000027, 1617371.239, 1410139.898000001, 1847409.503000001, 1471809.0679999993, 1717470.9779999994, 1685332.5339999993, 1468867.036, 1799474.0829999978, 1700009.679999998, 1692169.5289999996, 1490069.7390000024, 1523391.222000001, 1680268.056, 1339476.1450000019, 1717444.326000002, 6429190.093000004, 1706597.0710000005, 6393925.244000013, 1672207.3180000028, 1789604.6169999992, 1773335.9319999984, 1805104.2139999976, 1526196.8170000007, 6507973.155000015, 1648052.6640000006, 1823738.559999998, 1802833.2409999995], "episode_lengths": [251, 233, 478, 245, 267, 506, 239, 225, 218, 738, 247, 253, 253, 258, 284, 284, 220, 220, 269, 269, 246, 211, 706, 249, 279, 677, 234, 266, 536, 270, 238, 229, 253, 1205, 227, 205, 284, 211, 539, 260, 253, 507, 254, 208, 208, 217, 257, 228, 228, 271, 288, 229, 1166, 237, 254, 237, 237, 320, 580, 260, 254, 1035, 307, 268, 268, 831, 272, 234, 519, 285, 278, 814, 282, 271, 231, 290, 247, 279, 279, 247, 293, 286, 286, 261, 261, 266, 223, 283, 1059, 282, 1034, 266, 283, 283, 286, 257, 1062, 265, 291, 291], "policy_shared_policy_reward": [163357.2580000001, 385954.4140000002, 372821.4319999999, 372464.61799999996, 189646.71499999982, 149059.226, 352329.80199999997, 332424.809, 319317.296, 158989.2969999999, 306498.95200000005, 730097.4069999998, 700380.8310000005, 681205.4609999995, 347082.6100000002, 157360.54100000003, 382075.20800000016, 367447.2959999998, 363530.9949999999, 187267.22399999993, 161670.53600000005, 405213.24199999997, 393427.94600000023, 373366.0039999999, 194005.93900000007, 316494.21499999997, 778790.718, 752235.1760000004, 737857.2080000003, 370567.8809999998, 152978.30699999997, 362713.51200000005, 363588.1900000001, 359387.25799999986, 176391.97400000007, 157465.229, 355796.29399999994, 332249.9659999999, 327201.3449999999, 164428.19999999998, 149098.40300000002, 355114.01100000035, 329209.05099999986, 330076.315, 174199.0190000001, 478528.06699999986, 1136735.2729999986, 1068963.2950000006, 1068740.575999999, 536553.415, 165063.28399999999, 392687.8229999999, 372246.5389999998, 360930.4050000001, 182060.1230000001, 180784.43399999995, 407310.8130000001, 386196.93899999995, 369696.626, 186805.59100000007, 176782.39800000002, 394608.4539999999, 379329.76199999976, 366776.39699999994, 181294.468, 175084.17899999997, 408038.27200000006, 398721.02099999995, 402858.0230000002, 203338.77600000016, 190942.429, 442387.21000000014, 420842.96799999994, 422685.201, 203927.38799999995, 194168.08500000014, 447962.66200000024, 422742.82800000004, 422282.7669999999, 207833.98300000004, 146106.818, 351913.07699999976, 321306.787, 314674.16000000003, 161876.92700000003, 144481.7529999999, 361148.714, 323125.61499999993, 318492.05799999996, 160594.91099999993, 181146.85799999983, 411894.29199999967, 409502.46400000015, 399363.69399999996, 194196.05200000008, 180434.56500000018, 415886.74600000016, 409495.62899999943, 409596.8179999999, 196596.199, 156719.789, 384155.34800000035, 368573.7589999998, 363199.97200000007, 189102.49900000013, 139304.42299999995, 334491.0169999999, 309151.3829999999, 307008.2230000002, 159267.82200000004, 468593.17100000003, 1117838.099, 1053845.9729999993, 1045894.1299999986, 531557.9290000007, 168973.85200000007, 383420.8870000001, 376462.4210000004, 363091.38899999997, 182110.86600000007, 180539.21499999997, 426122.317, 415782.84099999984, 420137.42400000023, 212921.54800000007, 452378.7339999999, 1050400.7850000001, 1021914.5190000002, 991664.4929999999, 507990.1259999998, 161894.602, 369533.60099999973, 363580.9169999999, 362327.8709999998, 185464.98200000005, 179417.04899999997, 425795.4040000001, 409846.2219999997, 399693.60899999976, 201256.46299999996, 359733.6279999998, 845150.4609999999, 811512.7980000001, 801235.422999999, 407594.2619999998, 190088.52899999986, 433451.94299999997, 417568.16399999964, 423489.36699999997, 217234.7670000001, 156453.60999999996, 365086.10800000024, 359207.9290000001, 351597.7179999997, 177279.91100000002, 155249.94299999997, 357901.0470000001, 343083.1990000001, 330875.96699999995, 167004.63900000002, 173964.05200000008, 398329.289, 386559.47600000014, 392303.28900000005, 198393.30700000015, 822186.3560000004, 1884721.6909999985, 1819564.909000001, 1804816.7189999984, 908223.5730000004, 163035.39400000017, 369964.5040000003, 353651.4140000001, 337202.16000000003, 169889.18200000003, 137217.75500000003, 331620.223, 307788.1179999997, 296839.992, 152504.04100000006, 177587.624, 429757.497, 426695.5580000002, 413272.8170000001, 211586.50300000014, 145067.31900000008, 335109.40599999984, 322519.4699999999, 315513.82299999986, 162468.88400000002, 350387.87299999985, 819172.2820000007, 789134.3299999997, 790284.6540000006, 393792.8979999998, 167601.51900000012, 394771.11199999996, 379939.8569999998, 366951.8460000002, 186898.8359999999, 169966.87199999994, 407759.73100000015, 382112.2260000002, 382171.9790000002, 198128.33000000002, 329439.4110000002, 786230.5789999998, 755826.2369999996, 755379.7759999997, 380804.44700000045, 161714.068, 379596.84700000007, 367852.81299999997, 367694.00199999975, 184651.9400000001, 125820.46299999997, 309906.2769999999, 300523.5370000003, 286229.3899999999, 139522.44799999997, 130654.21399999999, 329360.698, 318783.0310000002, 297721.07800000004, 145535.37700000004, 149997.904, 351813.22599999997, 334628.2919999999, 329694.9659999999, 169465.92600000012, 169015.0439999999, 405722.8960000002, 382782.7680000001, 382205.8599999999, 190998.14500000008, 163629.034, 379837.359, 339486.0139999999, 334209.97899999993, 174359.83700000003, 165091.87600000002, 378493.52799999993, 340487.7629999999, 336452.91700000013, 175452.7739999999, 189920.448, 436498.53700000007, 420163.18399999995, 408590.5050000002, 204185.209, 196451.14900000012, 441417.88399999996, 430161.1470000001, 434043.3159999999, 212489.7630000002, 158607.584, 369654.76000000024, 342623.74199999997, 337145.94799999974, 172589.42200000005, 770619.5350000004, 1835807.8819999986, 1757405.5189999987, 1726534.7710000034, 878448.4249999995, 150850.45399999994, 362303.8590000001, 353530.0099999998, 348352.95099999954, 172874.48799999995, 171764.09499999994, 406256.4200000003, 375242.16899999994, 370827.09599999984, 183575.08199999997, 153696.58200000017, 363010.5949999999, 364570.577, 359822.46100000007, 178763.11800000013, 154027.20299999998, 364933.6189999998, 362160.81600000034, 357585.8370000001, 182745.83399999997, 222225.77999999985, 512622.576, 493783.58400000044, 491357.8840000001, 249595.76200000025, 411988.21599999984, 935256.7830000003, 911911.1859999998, 899947.8180000002, 451848.63199999975, 182386.0600000002, 414803.85699999996, 405899.51399999997, 391162.28400000004, 198270.45199999984, 170320.13200000013, 393282.48000000033, 388108.18399999995, 361526.48400000005, 180722.2080000001, 697884.725, 1618851.7209999955, 1565216.3459999994, 1537612.2219999991, 762802.7860000002, 209523.202, 472945.8010000001, 453936.3870000001, 457350.39900000044, 223891.04899999997, 187497.21500000023, 415152.28900000005, 408369.995, 411573.45600000024, 204413.626, 189091.51899999997, 423488.4849999997, 414339.148, 412256.0610000003, 205986.473, 556949.724, 1300316.8050000006, 1272795.0389999975, 1243717.884, 631215.6980000001, 175943.106, 429939.98799999984, 412477.0200000002, 417293.2700000001, 213385.86800000002, 157430.09799999997, 369346.9770000002, 367120.459, 356025.638, 184136.4359999999, 357791.68299999984, 836719.1590000001, 828364.9330000004, 814060.2109999997, 412940.8510000003, 199356.7570000001, 456591.6379999998, 457232.3630000002, 440295.2400000002, 222452.85800000007, 197887.4789999999, 444561.89499999996, 432909.60400000017, 431457.666, 214157.58699999994, 546467.8269999993, 1285815.6340000003, 1225850.9799999977, 1233826.0680000007, 611785.342, 175228.57500000007, 430726.11099999986, 408624.6570000002, 426992.94399999996, 210674.58600000004, 187174.654, 425566.4620000002, 407257.972, 393317.14599999966, 204055.0050000001, 156532.4579999999, 363673.79499999987, 358673.20600000006, 351250.6509999997, 180009.78800000006, 206006.51300000027, 475028.10400000005, 459724.32199999987, 466727.21900000045, 239923.34500000006, 164205.603, 383795.55300000036, 375041.76300000027, 365752.3659999999, 183013.78299999997, 200867.155, 455181.01300000015, 431334.856, 424920.7210000002, 205167.23299999998, 197404.5900000001, 443196.44099999976, 423637.3650000001, 418832.6229999996, 202261.51500000004, 172543.991, 393249.38200000004, 374991.31000000023, 352585.80899999983, 175496.54400000005, 206889.27100000007, 462268.8969999999, 453374.56599999947, 449668.97599999997, 227272.373, 188502.2089999999, 450000.221, 430349.5070000001, 417763.94800000003, 213393.795, 187815.7319999999, 453141.58900000004, 426618.721, 414362.8269999998, 210230.66000000003, 157046.66599999997, 403623.98600000003, 372200.3850000001, 373888.082, 183310.62000000017, 159529.3299999999, 407554.2059999999, 379184.3889999998, 386079.69999999995, 191043.59699999998, 199591.58700000017, 431621.628, 429052.64000000036, 416572.34300000005, 203429.8580000001, 142818.37300000008, 353628.9630000001, 346055.9470000001, 325795.732, 171177.13, 197993.96799999988, 448676.105, 443416.25299999997, 419371.40300000017, 207986.59700000024, 727851.8619999993, 1685555.0599999987, 1639589.3539999996, 1576433.3029999998, 799760.5139999988, 192329.91500000012, 442009.4649999998, 434933.7869999998, 422934.23800000007, 214389.66599999982, 720980.1440000007, 1651992.6430000009, 1613823.9320000012, 1598052.8320000023, 809075.6930000001, 196871.48600000003, 433941.891, 419309.30700000015, 414492.69100000034, 207591.94300000003, 193190.31699999992, 456390.0230000002, 450368.8530000002, 458040.9659999999, 231614.45799999993, 191580.596, 457961.80000000005, 444140.37200000003, 449890.121, 229763.043, 198561.28799999994, 473900.0540000004, 446885.7440000002, 459295.97099999984, 226461.15700000006, 166546.50599999988, 412170.8770000003, 388071.73700000014, 371606.9359999999, 187800.76100000006, 735767.3230000007, 1724811.7769999977, 1646047.1899999976, 1597505.503000001, 803841.3620000002, 186413.18700000012, 433961.55900000007, 417324.83400000003, 404798.5770000002, 205554.50699999993, 210734.14200000008, 479847.2490000001, 457831.29200000013, 449220.62000000005, 226105.25700000004, 207507.6780000003, 473564.05900000024, 455497.4549999999, 441601.2700000002, 224662.77900000027]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.079144497072357, "mean_inference_ms": 1.805321993516485, "mean_action_processing_ms": 1.3478391298087917, "mean_env_wait_ms": 508.27599217231466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11400508880615234, "StateBufferConnector_ms": 0.02000141143798828, "ViewRequirementAgentConnector_ms": 0.43374156951904297}, "num_episodes": 19, "episode_return_max": 7239513.248000013, "episode_return_min": 1162002.1150000005, "episode_return_mean": 2108370.9185700007, "episodes_this_iter": 19}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 6000, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 12.410078059059133, "num_env_steps_trained_throughput_per_sec": 12.410078059059133, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 420000, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 462153.008, "restore_workers_time_ms": 0.0, "training_step_time_ms": 462153.008, "sample_time_ms": 432944.253, "learn_time_ms": 29193.959, "learn_throughput": 205.522, "synch_weights_time_ms": 10.907}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "done": false, "training_iteration": 14, "trial_id": "a5bb6_00000", "date": "2025-01-21_10-58-03", "timestamp": 1737485883, "time_this_iter_s": 483.4840199947357, "time_total_s": 6413.031524896622, "pid": 61756, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'environments.trafficEnv.TrafficLightMAEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 20000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 6000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function my_policy_mapping at 0x00000177903D92D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, "Dict('local_state': Dict('current_phase': Discrete(3), 'queue_length': Box(0.0, 100.0, (4,), float32), 'waiting_time': Box(0.0, 1000000.0, (4,), float32)), 'neighbor_info': Box(0.0, 100.0, (4,), float32))", "Dict('duration': Box(5.0, 60.0, (1,), float32), 'phase': Discrete(3))", {"model": {"custom_model": "my_traffic_model"}}]}, "callbacks": "<class 'config.trainingConfig.MetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6413.031524896622, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 4.681028938906752, "ram_util_percent": 52.1797427652733, "gpu_util_percent0": 0.029726688102893892, "vram_util_percent0": 0.12939453125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7015865246412603, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.0002999999999999999, "total_loss": 9.95947309331691, "policy_loss": 0.0004362870707236072, "vf_loss": 9.979722141509361, "vf_explained_var": -6.313780520824676e-07, "kl": 0.006341612523942763, "entropy": 2.0863704685454674, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 34075.5, "diff_num_grad_updates_vs_sampler_policy": 1174.5}}, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000}, "env_runners": {"episode_reward_max": 7239513.248000013, "episode_reward_min": 1162002.1150000005, "episode_reward_mean": 2115353.0507100006, "episode_len_mean": 349.92, "episode_media": {}, "episodes_timesteps_total": 34992, "policy_reward_min": {"shared_policy": 125820.46299999997}, "policy_reward_max": {"shared_policy": 1884721.6909999985}, "policy_reward_mean": {"shared_policy": 423070.610142}, "custom_metrics": {"mean_queue_length": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "mean_waiting_time": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "mean_throughput": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "hist_stats": {"episode_reward": [1295877.7690000029, 1307843.0509999995, 1596103.3599999985, 1612009.9570000018, 1461751.3669999987, 1249222.8679999984, 4217729.301999999, 1474059.4150000017, 1655503.3449999986, 4024348.6569999955, 1442801.9730000007, 1616008.7469999986, 3225226.572000004, 1681832.770000001, 1409625.2759999987, 1354114.7949999978, 1549549.4129999985, 7239513.248000013, 1393742.6539999982, 1225970.1290000004, 1658899.9990000024, 1280678.9019999995, 3142772.036999994, 1496163.169999995, 1540139.1380000014, 3007680.450000001, 1461509.6700000004, 1162002.1150000005, 1222054.398, 1335600.314, 1530724.7129999963, 1391522.2230000016, 1395978.8579999984, 1659357.8830000008, 1714563.2589999991, 1380621.456, 6968816.132000002, 1387911.7620000006, 1507664.862, 1419863.3330000006, 1421453.3090000025, 1969585.5860000015, 3610952.6350000007, 1592522.1670000001, 1493959.4880000001, 6182367.800000024, 1817646.8379999993, 1627006.5810000012, 1645161.6860000016, 5004995.1499999855, 1649039.2520000003, 1434059.6080000019, 3249876.8370000017, 1775928.8559999992, 1720974.2309999994, 4903745.851000003, 1652246.8730000027, 1617371.239, 1410139.898000001, 1847409.503000001, 1471809.0679999993, 1717470.9779999994, 1685332.5339999993, 1468867.036, 1799474.0829999978, 1700009.679999998, 1692169.5289999996, 1490069.7390000024, 1523391.222000001, 1680268.056, 1339476.1450000019, 1717444.326000002, 6429190.093000004, 1706597.0710000005, 6393925.244000013, 1672207.3180000028, 1789604.6169999992, 1773335.9319999984, 1805104.2139999976, 1526196.8170000007, 6507973.155000015, 1648052.6640000006, 1823738.559999998, 1802833.2409999995, 1506651.169, 1532661.947000003, 1412512.7139999953, 1889892.9969999967, 3440419.9420000003, 1509710.883, 1431438.7799999972, 1407734.7449999982, 1262622.8269999977, 1608449.5050000013, 4859302.01, 1506692.4060000011, 1456433.7189999996, 1835385.0720000013, 1689762.092999997, 1697290.209999999], "episode_lengths": [220, 220, 269, 269, 246, 211, 706, 249, 279, 677, 234, 266, 536, 270, 238, 229, 253, 1205, 227, 205, 284, 211, 539, 260, 253, 507, 254, 208, 208, 217, 257, 228, 228, 271, 288, 229, 1166, 237, 254, 237, 237, 320, 580, 260, 254, 1035, 307, 268, 268, 831, 272, 234, 519, 285, 278, 814, 282, 271, 231, 290, 247, 279, 279, 247, 293, 286, 286, 261, 261, 266, 223, 283, 1059, 282, 1034, 266, 283, 283, 286, 257, 1062, 265, 291, 291, 253, 256, 233, 301, 553, 252, 238, 238, 207, 269, 802, 247, 237, 301, 275, 279], "policy_shared_policy_reward": [146106.818, 351913.07699999976, 321306.787, 314674.16000000003, 161876.92700000003, 144481.7529999999, 361148.714, 323125.61499999993, 318492.05799999996, 160594.91099999993, 181146.85799999983, 411894.29199999967, 409502.46400000015, 399363.69399999996, 194196.05200000008, 180434.56500000018, 415886.74600000016, 409495.62899999943, 409596.8179999999, 196596.199, 156719.789, 384155.34800000035, 368573.7589999998, 363199.97200000007, 189102.49900000013, 139304.42299999995, 334491.0169999999, 309151.3829999999, 307008.2230000002, 159267.82200000004, 468593.17100000003, 1117838.099, 1053845.9729999993, 1045894.1299999986, 531557.9290000007, 168973.85200000007, 383420.8870000001, 376462.4210000004, 363091.38899999997, 182110.86600000007, 180539.21499999997, 426122.317, 415782.84099999984, 420137.42400000023, 212921.54800000007, 452378.7339999999, 1050400.7850000001, 1021914.5190000002, 991664.4929999999, 507990.1259999998, 161894.602, 369533.60099999973, 363580.9169999999, 362327.8709999998, 185464.98200000005, 179417.04899999997, 425795.4040000001, 409846.2219999997, 399693.60899999976, 201256.46299999996, 359733.6279999998, 845150.4609999999, 811512.7980000001, 801235.422999999, 407594.2619999998, 190088.52899999986, 433451.94299999997, 417568.16399999964, 423489.36699999997, 217234.7670000001, 156453.60999999996, 365086.10800000024, 359207.9290000001, 351597.7179999997, 177279.91100000002, 155249.94299999997, 357901.0470000001, 343083.1990000001, 330875.96699999995, 167004.63900000002, 173964.05200000008, 398329.289, 386559.47600000014, 392303.28900000005, 198393.30700000015, 822186.3560000004, 1884721.6909999985, 1819564.909000001, 1804816.7189999984, 908223.5730000004, 163035.39400000017, 369964.5040000003, 353651.4140000001, 337202.16000000003, 169889.18200000003, 137217.75500000003, 331620.223, 307788.1179999997, 296839.992, 152504.04100000006, 177587.624, 429757.497, 426695.5580000002, 413272.8170000001, 211586.50300000014, 145067.31900000008, 335109.40599999984, 322519.4699999999, 315513.82299999986, 162468.88400000002, 350387.87299999985, 819172.2820000007, 789134.3299999997, 790284.6540000006, 393792.8979999998, 167601.51900000012, 394771.11199999996, 379939.8569999998, 366951.8460000002, 186898.8359999999, 169966.87199999994, 407759.73100000015, 382112.2260000002, 382171.9790000002, 198128.33000000002, 329439.4110000002, 786230.5789999998, 755826.2369999996, 755379.7759999997, 380804.44700000045, 161714.068, 379596.84700000007, 367852.81299999997, 367694.00199999975, 184651.9400000001, 125820.46299999997, 309906.2769999999, 300523.5370000003, 286229.3899999999, 139522.44799999997, 130654.21399999999, 329360.698, 318783.0310000002, 297721.07800000004, 145535.37700000004, 149997.904, 351813.22599999997, 334628.2919999999, 329694.9659999999, 169465.92600000012, 169015.0439999999, 405722.8960000002, 382782.7680000001, 382205.8599999999, 190998.14500000008, 163629.034, 379837.359, 339486.0139999999, 334209.97899999993, 174359.83700000003, 165091.87600000002, 378493.52799999993, 340487.7629999999, 336452.91700000013, 175452.7739999999, 189920.448, 436498.53700000007, 420163.18399999995, 408590.5050000002, 204185.209, 196451.14900000012, 441417.88399999996, 430161.1470000001, 434043.3159999999, 212489.7630000002, 158607.584, 369654.76000000024, 342623.74199999997, 337145.94799999974, 172589.42200000005, 770619.5350000004, 1835807.8819999986, 1757405.5189999987, 1726534.7710000034, 878448.4249999995, 150850.45399999994, 362303.8590000001, 353530.0099999998, 348352.95099999954, 172874.48799999995, 171764.09499999994, 406256.4200000003, 375242.16899999994, 370827.09599999984, 183575.08199999997, 153696.58200000017, 363010.5949999999, 364570.577, 359822.46100000007, 178763.11800000013, 154027.20299999998, 364933.6189999998, 362160.81600000034, 357585.8370000001, 182745.83399999997, 222225.77999999985, 512622.576, 493783.58400000044, 491357.8840000001, 249595.76200000025, 411988.21599999984, 935256.7830000003, 911911.1859999998, 899947.8180000002, 451848.63199999975, 182386.0600000002, 414803.85699999996, 405899.51399999997, 391162.28400000004, 198270.45199999984, 170320.13200000013, 393282.48000000033, 388108.18399999995, 361526.48400000005, 180722.2080000001, 697884.725, 1618851.7209999955, 1565216.3459999994, 1537612.2219999991, 762802.7860000002, 209523.202, 472945.8010000001, 453936.3870000001, 457350.39900000044, 223891.04899999997, 187497.21500000023, 415152.28900000005, 408369.995, 411573.45600000024, 204413.626, 189091.51899999997, 423488.4849999997, 414339.148, 412256.0610000003, 205986.473, 556949.724, 1300316.8050000006, 1272795.0389999975, 1243717.884, 631215.6980000001, 175943.106, 429939.98799999984, 412477.0200000002, 417293.2700000001, 213385.86800000002, 157430.09799999997, 369346.9770000002, 367120.459, 356025.638, 184136.4359999999, 357791.68299999984, 836719.1590000001, 828364.9330000004, 814060.2109999997, 412940.8510000003, 199356.7570000001, 456591.6379999998, 457232.3630000002, 440295.2400000002, 222452.85800000007, 197887.4789999999, 444561.89499999996, 432909.60400000017, 431457.666, 214157.58699999994, 546467.8269999993, 1285815.6340000003, 1225850.9799999977, 1233826.0680000007, 611785.342, 175228.57500000007, 430726.11099999986, 408624.6570000002, 426992.94399999996, 210674.58600000004, 187174.654, 425566.4620000002, 407257.972, 393317.14599999966, 204055.0050000001, 156532.4579999999, 363673.79499999987, 358673.20600000006, 351250.6509999997, 180009.78800000006, 206006.51300000027, 475028.10400000005, 459724.32199999987, 466727.21900000045, 239923.34500000006, 164205.603, 383795.55300000036, 375041.76300000027, 365752.3659999999, 183013.78299999997, 200867.155, 455181.01300000015, 431334.856, 424920.7210000002, 205167.23299999998, 197404.5900000001, 443196.44099999976, 423637.3650000001, 418832.6229999996, 202261.51500000004, 172543.991, 393249.38200000004, 374991.31000000023, 352585.80899999983, 175496.54400000005, 206889.27100000007, 462268.8969999999, 453374.56599999947, 449668.97599999997, 227272.373, 188502.2089999999, 450000.221, 430349.5070000001, 417763.94800000003, 213393.795, 187815.7319999999, 453141.58900000004, 426618.721, 414362.8269999998, 210230.66000000003, 157046.66599999997, 403623.98600000003, 372200.3850000001, 373888.082, 183310.62000000017, 159529.3299999999, 407554.2059999999, 379184.3889999998, 386079.69999999995, 191043.59699999998, 199591.58700000017, 431621.628, 429052.64000000036, 416572.34300000005, 203429.8580000001, 142818.37300000008, 353628.9630000001, 346055.9470000001, 325795.732, 171177.13, 197993.96799999988, 448676.105, 443416.25299999997, 419371.40300000017, 207986.59700000024, 727851.8619999993, 1685555.0599999987, 1639589.3539999996, 1576433.3029999998, 799760.5139999988, 192329.91500000012, 442009.4649999998, 434933.7869999998, 422934.23800000007, 214389.66599999982, 720980.1440000007, 1651992.6430000009, 1613823.9320000012, 1598052.8320000023, 809075.6930000001, 196871.48600000003, 433941.891, 419309.30700000015, 414492.69100000034, 207591.94300000003, 193190.31699999992, 456390.0230000002, 450368.8530000002, 458040.9659999999, 231614.45799999993, 191580.596, 457961.80000000005, 444140.37200000003, 449890.121, 229763.043, 198561.28799999994, 473900.0540000004, 446885.7440000002, 459295.97099999984, 226461.15700000006, 166546.50599999988, 412170.8770000003, 388071.73700000014, 371606.9359999999, 187800.76100000006, 735767.3230000007, 1724811.7769999977, 1646047.1899999976, 1597505.503000001, 803841.3620000002, 186413.18700000012, 433961.55900000007, 417324.83400000003, 404798.5770000002, 205554.50699999993, 210734.14200000008, 479847.2490000001, 457831.29200000013, 449220.62000000005, 226105.25700000004, 207507.6780000003, 473564.05900000024, 455497.4549999999, 441601.2700000002, 224662.77900000027, 168087.88600000003, 401194.26100000023, 376509.90800000005, 373046.834, 187812.28000000003, 183292.1009999999, 409697.83799999976, 382500.3249999998, 373254.5989999997, 183917.08399999994, 155742.42100000003, 372726.468, 363408.46400000027, 346835.5890000002, 173799.77199999994, 220160.49300000013, 495742.3160000004, 467191.7589999997, 473955.7180000002, 232842.71099999995, 385877.0810000001, 912499.2320000008, 856736.3399999999, 863610.9949999993, 421696.2939999999, 162601.96500000005, 401501.8319999997, 383592.93399999983, 379330.50000000023, 182683.652, 165914.75099999993, 384215.38200000016, 358270.7799999999, 345890.626, 177147.24100000013, 162178.27299999996, 381480.0119999999, 351098.78500000003, 340948.8239999999, 172028.8509999999, 140717.82299999992, 343843.03299999976, 322871.1509999999, 305683.8690000002, 149506.95100000012, 178192.24699999997, 430558.45499999984, 403184.85499999986, 398366.78, 198147.168, 535808.7850000001, 1280494.401999999, 1224366.0119999985, 1212341.7490000008, 606291.0619999999, 164560.265, 392574.455, 380102.4149999998, 374036.5940000001, 195418.67700000003, 168084.24000000005, 385933.7900000002, 364266.5999999999, 357576.56, 180572.52900000004, 208294.29100000006, 480507.0130000001, 457776.3979999999, 459110.8799999999, 229696.49000000008, 191781.47199999995, 459379.5609999998, 412723.5790000004, 413451.86500000005, 212425.61599999995, 189357.28100000008, 446776.32, 428002.486, 424544.9510000001, 208609.1720000002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.066135021016045, "mean_inference_ms": 1.8052173405933873, "mean_action_processing_ms": 1.348522666198003, "mean_env_wait_ms": 510.57765444619895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12102699279785156, "StateBufferConnector_ms": 0.01900768280029297, "ViewRequirementAgentConnector_ms": 0.4477968215942383}, "num_episodes": 16, "episode_return_max": 7239513.248000013, "episode_return_min": 1162002.1150000005, "episode_return_mean": 2115353.0507100006, "episodes_this_iter": 16}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_env_steps_sampled_this_iter": 6000, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 12.295948021549902, "num_env_steps_trained_throughput_per_sec": 12.295948021549902, "timesteps_total": 90000, "num_env_steps_sampled_lifetime": 90000, "num_agent_steps_sampled_lifetime": 450000, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 450000, "timers": {"training_iteration_time_ms": 466372.355, "restore_workers_time_ms": 0.0, "training_step_time_ms": 466372.355, "sample_time_ms": 437200.405, "learn_time_ms": 29157.052, "learn_throughput": 205.782, "synch_weights_time_ms": 10.908}, "counters": {"num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000}, "done": false, "training_iteration": 15, "trial_id": "a5bb6_00000", "date": "2025-01-21_11-06-11", "timestamp": 1737486371, "time_this_iter_s": 487.97062969207764, "time_total_s": 6901.002154588699, "pid": 61756, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'environments.trafficEnv.TrafficLightMAEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 20000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 6000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function my_policy_mapping at 0x00000177903D92D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, "Dict('local_state': Dict('current_phase': Discrete(3), 'queue_length': Box(0.0, 100.0, (4,), float32), 'waiting_time': Box(0.0, 1000000.0, (4,), float32)), 'neighbor_info': Box(0.0, 100.0, (4,), float32))", "Dict('duration': Box(5.0, 60.0, (1,), float32), 'phase': Discrete(3))", {"model": {"custom_model": "my_traffic_model"}}]}, "callbacks": "<class 'config.trainingConfig.MetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6901.002154588699, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 4.648325358851674, "ram_util_percent": 51.99872408293461, "gpu_util_percent0": 0.029712918660287087, "vram_util_percent0": 0.12932942708333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6489253445254994, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.0002999999999999999, "total_loss": 9.945619160266633, "policy_loss": 8.450912311673164e-05, "vf_loss": 9.966730502919948, "vf_explained_var": -1.253472997787151e-06, "kl": 0.008058467278501307, "entropy": 2.142251970514338, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 36425.5, "diff_num_grad_updates_vs_sampler_policy": 1174.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 8648426.860000007, "episode_reward_min": 1162002.1150000005, "episode_reward_mean": 2165218.6889900006, "episode_len_mean": 357.39, "episode_media": {}, "episodes_timesteps_total": 35739, "policy_reward_min": {"shared_policy": 125820.46299999997}, "policy_reward_max": {"shared_policy": 2289907.694000001}, "policy_reward_mean": {"shared_policy": 433043.737798}, "custom_metrics": {"mean_queue_length": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "mean_waiting_time": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "mean_throughput": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "hist_stats": {"episode_reward": [1549549.4129999985, 7239513.248000013, 1393742.6539999982, 1225970.1290000004, 1658899.9990000024, 1280678.9019999995, 3142772.036999994, 1496163.169999995, 1540139.1380000014, 3007680.450000001, 1461509.6700000004, 1162002.1150000005, 1222054.398, 1335600.314, 1530724.7129999963, 1391522.2230000016, 1395978.8579999984, 1659357.8830000008, 1714563.2589999991, 1380621.456, 6968816.132000002, 1387911.7620000006, 1507664.862, 1419863.3330000006, 1421453.3090000025, 1969585.5860000015, 3610952.6350000007, 1592522.1670000001, 1493959.4880000001, 6182367.800000024, 1817646.8379999993, 1627006.5810000012, 1645161.6860000016, 5004995.1499999855, 1649039.2520000003, 1434059.6080000019, 3249876.8370000017, 1775928.8559999992, 1720974.2309999994, 4903745.851000003, 1652246.8730000027, 1617371.239, 1410139.898000001, 1847409.503000001, 1471809.0679999993, 1717470.9779999994, 1685332.5339999993, 1468867.036, 1799474.0829999978, 1700009.679999998, 1692169.5289999996, 1490069.7390000024, 1523391.222000001, 1680268.056, 1339476.1450000019, 1717444.326000002, 6429190.093000004, 1706597.0710000005, 6393925.244000013, 1672207.3180000028, 1789604.6169999992, 1773335.9319999984, 1805104.2139999976, 1526196.8170000007, 6507973.155000015, 1648052.6640000006, 1823738.559999998, 1802833.2409999995, 1506651.169, 1532661.947000003, 1412512.7139999953, 1889892.9969999967, 3440419.9420000003, 1509710.883, 1431438.7799999972, 1407734.7449999982, 1262622.8269999977, 1608449.5050000013, 4859302.01, 1506692.4060000011, 1456433.7189999996, 1835385.0720000013, 1689762.092999997, 1697290.209999999, 1334551.329999999, 1505501.7989999985, 1632404.6309999968, 1446410.9959999998, 3986694.151999992, 1278356.1149999998, 1709619.9459999998, 1700355.5979999986, 2870689.595999994, 1403085.685, 1645690.0170000007, 1347021.1039999998, 1725172.8910000003, 8648426.860000007, 1575369.3190000008, 1801273.0129999984], "episode_lengths": [253, 1205, 227, 205, 284, 211, 539, 260, 253, 507, 254, 208, 208, 217, 257, 228, 228, 271, 288, 229, 1166, 237, 254, 237, 237, 320, 580, 260, 254, 1035, 307, 268, 268, 831, 272, 234, 519, 285, 278, 814, 282, 271, 231, 290, 247, 279, 279, 247, 293, 286, 286, 261, 261, 266, 223, 283, 1059, 282, 1034, 266, 283, 283, 286, 257, 1062, 265, 291, 291, 253, 256, 233, 301, 553, 252, 238, 238, 207, 269, 802, 247, 237, 301, 275, 279, 227, 249, 271, 243, 669, 219, 277, 277, 478, 241, 261, 220, 279, 1401, 267, 287], "policy_shared_policy_reward": [173964.05200000008, 398329.289, 386559.47600000014, 392303.28900000005, 198393.30700000015, 822186.3560000004, 1884721.6909999985, 1819564.909000001, 1804816.7189999984, 908223.5730000004, 163035.39400000017, 369964.5040000003, 353651.4140000001, 337202.16000000003, 169889.18200000003, 137217.75500000003, 331620.223, 307788.1179999997, 296839.992, 152504.04100000006, 177587.624, 429757.497, 426695.5580000002, 413272.8170000001, 211586.50300000014, 145067.31900000008, 335109.40599999984, 322519.4699999999, 315513.82299999986, 162468.88400000002, 350387.87299999985, 819172.2820000007, 789134.3299999997, 790284.6540000006, 393792.8979999998, 167601.51900000012, 394771.11199999996, 379939.8569999998, 366951.8460000002, 186898.8359999999, 169966.87199999994, 407759.73100000015, 382112.2260000002, 382171.9790000002, 198128.33000000002, 329439.4110000002, 786230.5789999998, 755826.2369999996, 755379.7759999997, 380804.44700000045, 161714.068, 379596.84700000007, 367852.81299999997, 367694.00199999975, 184651.9400000001, 125820.46299999997, 309906.2769999999, 300523.5370000003, 286229.3899999999, 139522.44799999997, 130654.21399999999, 329360.698, 318783.0310000002, 297721.07800000004, 145535.37700000004, 149997.904, 351813.22599999997, 334628.2919999999, 329694.9659999999, 169465.92600000012, 169015.0439999999, 405722.8960000002, 382782.7680000001, 382205.8599999999, 190998.14500000008, 163629.034, 379837.359, 339486.0139999999, 334209.97899999993, 174359.83700000003, 165091.87600000002, 378493.52799999993, 340487.7629999999, 336452.91700000013, 175452.7739999999, 189920.448, 436498.53700000007, 420163.18399999995, 408590.5050000002, 204185.209, 196451.14900000012, 441417.88399999996, 430161.1470000001, 434043.3159999999, 212489.7630000002, 158607.584, 369654.76000000024, 342623.74199999997, 337145.94799999974, 172589.42200000005, 770619.5350000004, 1835807.8819999986, 1757405.5189999987, 1726534.7710000034, 878448.4249999995, 150850.45399999994, 362303.8590000001, 353530.0099999998, 348352.95099999954, 172874.48799999995, 171764.09499999994, 406256.4200000003, 375242.16899999994, 370827.09599999984, 183575.08199999997, 153696.58200000017, 363010.5949999999, 364570.577, 359822.46100000007, 178763.11800000013, 154027.20299999998, 364933.6189999998, 362160.81600000034, 357585.8370000001, 182745.83399999997, 222225.77999999985, 512622.576, 493783.58400000044, 491357.8840000001, 249595.76200000025, 411988.21599999984, 935256.7830000003, 911911.1859999998, 899947.8180000002, 451848.63199999975, 182386.0600000002, 414803.85699999996, 405899.51399999997, 391162.28400000004, 198270.45199999984, 170320.13200000013, 393282.48000000033, 388108.18399999995, 361526.48400000005, 180722.2080000001, 697884.725, 1618851.7209999955, 1565216.3459999994, 1537612.2219999991, 762802.7860000002, 209523.202, 472945.8010000001, 453936.3870000001, 457350.39900000044, 223891.04899999997, 187497.21500000023, 415152.28900000005, 408369.995, 411573.45600000024, 204413.626, 189091.51899999997, 423488.4849999997, 414339.148, 412256.0610000003, 205986.473, 556949.724, 1300316.8050000006, 1272795.0389999975, 1243717.884, 631215.6980000001, 175943.106, 429939.98799999984, 412477.0200000002, 417293.2700000001, 213385.86800000002, 157430.09799999997, 369346.9770000002, 367120.459, 356025.638, 184136.4359999999, 357791.68299999984, 836719.1590000001, 828364.9330000004, 814060.2109999997, 412940.8510000003, 199356.7570000001, 456591.6379999998, 457232.3630000002, 440295.2400000002, 222452.85800000007, 197887.4789999999, 444561.89499999996, 432909.60400000017, 431457.666, 214157.58699999994, 546467.8269999993, 1285815.6340000003, 1225850.9799999977, 1233826.0680000007, 611785.342, 175228.57500000007, 430726.11099999986, 408624.6570000002, 426992.94399999996, 210674.58600000004, 187174.654, 425566.4620000002, 407257.972, 393317.14599999966, 204055.0050000001, 156532.4579999999, 363673.79499999987, 358673.20600000006, 351250.6509999997, 180009.78800000006, 206006.51300000027, 475028.10400000005, 459724.32199999987, 466727.21900000045, 239923.34500000006, 164205.603, 383795.55300000036, 375041.76300000027, 365752.3659999999, 183013.78299999997, 200867.155, 455181.01300000015, 431334.856, 424920.7210000002, 205167.23299999998, 197404.5900000001, 443196.44099999976, 423637.3650000001, 418832.6229999996, 202261.51500000004, 172543.991, 393249.38200000004, 374991.31000000023, 352585.80899999983, 175496.54400000005, 206889.27100000007, 462268.8969999999, 453374.56599999947, 449668.97599999997, 227272.373, 188502.2089999999, 450000.221, 430349.5070000001, 417763.94800000003, 213393.795, 187815.7319999999, 453141.58900000004, 426618.721, 414362.8269999998, 210230.66000000003, 157046.66599999997, 403623.98600000003, 372200.3850000001, 373888.082, 183310.62000000017, 159529.3299999999, 407554.2059999999, 379184.3889999998, 386079.69999999995, 191043.59699999998, 199591.58700000017, 431621.628, 429052.64000000036, 416572.34300000005, 203429.8580000001, 142818.37300000008, 353628.9630000001, 346055.9470000001, 325795.732, 171177.13, 197993.96799999988, 448676.105, 443416.25299999997, 419371.40300000017, 207986.59700000024, 727851.8619999993, 1685555.0599999987, 1639589.3539999996, 1576433.3029999998, 799760.5139999988, 192329.91500000012, 442009.4649999998, 434933.7869999998, 422934.23800000007, 214389.66599999982, 720980.1440000007, 1651992.6430000009, 1613823.9320000012, 1598052.8320000023, 809075.6930000001, 196871.48600000003, 433941.891, 419309.30700000015, 414492.69100000034, 207591.94300000003, 193190.31699999992, 456390.0230000002, 450368.8530000002, 458040.9659999999, 231614.45799999993, 191580.596, 457961.80000000005, 444140.37200000003, 449890.121, 229763.043, 198561.28799999994, 473900.0540000004, 446885.7440000002, 459295.97099999984, 226461.15700000006, 166546.50599999988, 412170.8770000003, 388071.73700000014, 371606.9359999999, 187800.76100000006, 735767.3230000007, 1724811.7769999977, 1646047.1899999976, 1597505.503000001, 803841.3620000002, 186413.18700000012, 433961.55900000007, 417324.83400000003, 404798.5770000002, 205554.50699999993, 210734.14200000008, 479847.2490000001, 457831.29200000013, 449220.62000000005, 226105.25700000004, 207507.6780000003, 473564.05900000024, 455497.4549999999, 441601.2700000002, 224662.77900000027, 168087.88600000003, 401194.26100000023, 376509.90800000005, 373046.834, 187812.28000000003, 183292.1009999999, 409697.83799999976, 382500.3249999998, 373254.5989999997, 183917.08399999994, 155742.42100000003, 372726.468, 363408.46400000027, 346835.5890000002, 173799.77199999994, 220160.49300000013, 495742.3160000004, 467191.7589999997, 473955.7180000002, 232842.71099999995, 385877.0810000001, 912499.2320000008, 856736.3399999999, 863610.9949999993, 421696.2939999999, 162601.96500000005, 401501.8319999997, 383592.93399999983, 379330.50000000023, 182683.652, 165914.75099999993, 384215.38200000016, 358270.7799999999, 345890.626, 177147.24100000013, 162178.27299999996, 381480.0119999999, 351098.78500000003, 340948.8239999999, 172028.8509999999, 140717.82299999992, 343843.03299999976, 322871.1509999999, 305683.8690000002, 149506.95100000012, 178192.24699999997, 430558.45499999984, 403184.85499999986, 398366.78, 198147.168, 535808.7850000001, 1280494.401999999, 1224366.0119999985, 1212341.7490000008, 606291.0619999999, 164560.265, 392574.455, 380102.4149999998, 374036.5940000001, 195418.67700000003, 168084.24000000005, 385933.7900000002, 364266.5999999999, 357576.56, 180572.52900000004, 208294.29100000006, 480507.0130000001, 457776.3979999999, 459110.8799999999, 229696.49000000008, 191781.47199999995, 459379.5609999998, 412723.5790000004, 413451.86500000005, 212425.61599999995, 189357.28100000008, 446776.32, 428002.486, 424544.9510000001, 208609.1720000002, 146775.5980000001, 357649.6789999998, 346031.7370000003, 326097.29599999986, 157997.02000000008, 166436.65200000003, 398547.76200000034, 382997.8430000001, 373889.45799999987, 183630.084, 176509.954, 437796.592, 410577.0309999995, 405722.07200000016, 201798.982, 155314.88900000017, 393392.3660000001, 369166.61900000006, 355318.0189999997, 173219.1029999999, 429986.1319999999, 1094945.0249999983, 1005025.8599999998, 977448.064, 479289.0709999996, 139416.315, 345192.2049999998, 317276.5610000004, 319899.047, 156571.98699999996, 189532.84999999995, 450939.7530000002, 427887.85600000015, 426889.6049999999, 214369.88200000007, 188038.22600000002, 454164.91100000014, 414640.54000000004, 428832.16099999973, 214679.7600000001, 326038.40900000033, 767184.3540000007, 726426.5560000003, 703912.0640000002, 347128.2129999996, 155919.53499999992, 378503.13100000017, 354565.31399999995, 345449.7549999999, 168647.95000000004, 180597.997, 425587.578, 419472.43699999986, 413279.0190000001, 206752.9859999997, 153468.98499999993, 351060.0110000003, 342799.1089999999, 331744.1910000001, 167948.80799999993, 191001.97400000016, 458264.4920000004, 435149.8529999999, 428086.98800000054, 212669.5839999999, 964366.0059999992, 2289907.694000001, 2182701.010999999, 2139902.826999999, 1071549.3219999988, 166128.3769999999, 420416.2739999998, 411456.0540000002, 388277.5690000001, 189091.04499999995, 200826.842, 468044.5310000001, 455629.2940000002, 452965.7800000001, 223806.56599999993]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.047842879133344, "mean_inference_ms": 1.8060377135445953, "mean_action_processing_ms": 1.3492228435486948, "mean_env_wait_ms": 513.6815490244936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12383627891540527, "StateBufferConnector_ms": 0.018008708953857422, "ViewRequirementAgentConnector_ms": 0.4558074474334717}, "num_episodes": 16, "episode_return_max": 8648426.860000007, "episode_return_min": 1162002.1150000005, "episode_return_mean": 2165218.6889900006, "episodes_this_iter": 16}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 6000, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 11.63879067161377, "num_env_steps_trained_throughput_per_sec": 11.63879067161377, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 473782.466, "restore_workers_time_ms": 0.0, "training_step_time_ms": 473782.466, "sample_time_ms": 444432.446, "learn_time_ms": 29335.022, "learn_throughput": 204.534, "synch_weights_time_ms": 11.008}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 16, "trial_id": "a5bb6_00000", "date": "2025-01-21_11-14-46", "timestamp": 1737486886, "time_this_iter_s": 515.5224776268005, "time_total_s": 7416.5246322155, "pid": 61756, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'environments.trafficEnv.TrafficLightMAEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 20000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 6000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function my_policy_mapping at 0x00000177903D92D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, "Dict('local_state': Dict('current_phase': Discrete(3), 'queue_length': Box(0.0, 100.0, (4,), float32), 'waiting_time': Box(0.0, 1000000.0, (4,), float32)), 'neighbor_info': Box(0.0, 100.0, (4,), float32))", "Dict('duration': Box(5.0, 60.0, (1,), float32), 'phase': Discrete(3))", {"model": {"custom_model": "my_traffic_model"}}]}, "callbacks": "<class 'config.trainingConfig.MetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7416.5246322155, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 6.3159090909090905, "ram_util_percent": 55.3209090909091, "gpu_util_percent0": 0.04939393939393939, "vram_util_percent0": 0.1312942412405303}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6624177350389195, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.0002999999999999999, "total_loss": 9.943852744406842, "policy_loss": 7.323450389060568e-05, "vf_loss": 9.965678019016346, "vf_explained_var": -8.396214627205057e-06, "kl": 0.007131689464257125, "entropy": 2.209909749487613, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 38775.5, "diff_num_grad_updates_vs_sampler_policy": 1174.5}}, "num_env_steps_sampled": 102000, "num_env_steps_trained": 102000, "num_agent_steps_sampled": 510000, "num_agent_steps_trained": 510000}, "env_runners": {"episode_reward_max": 12241841.639999913, "episode_reward_min": 1112391.605, "episode_reward_mean": 2157819.3937799996, "episode_len_mean": 354.61, "episode_media": {}, "episodes_timesteps_total": 35461, "policy_reward_min": {"shared_policy": 123551.58600000002}, "policy_reward_max": {"shared_policy": 3253731.6589999967}, "policy_reward_mean": {"shared_policy": 431563.87875599996}, "custom_metrics": {"mean_queue_length": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "mean_waiting_time": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "mean_throughput": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "hist_stats": {"episode_reward": [1387911.7620000006, 1507664.862, 1419863.3330000006, 1421453.3090000025, 1969585.5860000015, 3610952.6350000007, 1592522.1670000001, 1493959.4880000001, 6182367.800000024, 1817646.8379999993, 1627006.5810000012, 1645161.6860000016, 5004995.1499999855, 1649039.2520000003, 1434059.6080000019, 3249876.8370000017, 1775928.8559999992, 1720974.2309999994, 4903745.851000003, 1652246.8730000027, 1617371.239, 1410139.898000001, 1847409.503000001, 1471809.0679999993, 1717470.9779999994, 1685332.5339999993, 1468867.036, 1799474.0829999978, 1700009.679999998, 1692169.5289999996, 1490069.7390000024, 1523391.222000001, 1680268.056, 1339476.1450000019, 1717444.326000002, 6429190.093000004, 1706597.0710000005, 6393925.244000013, 1672207.3180000028, 1789604.6169999992, 1773335.9319999984, 1805104.2139999976, 1526196.8170000007, 6507973.155000015, 1648052.6640000006, 1823738.559999998, 1802833.2409999995, 1506651.169, 1532661.947000003, 1412512.7139999953, 1889892.9969999967, 3440419.9420000003, 1509710.883, 1431438.7799999972, 1407734.7449999982, 1262622.8269999977, 1608449.5050000013, 4859302.01, 1506692.4060000011, 1456433.7189999996, 1835385.0720000013, 1689762.092999997, 1697290.209999999, 1334551.329999999, 1505501.7989999985, 1632404.6309999968, 1446410.9959999998, 3986694.151999992, 1278356.1149999998, 1709619.9459999998, 1700355.5979999986, 2870689.595999994, 1403085.685, 1645690.0170000007, 1347021.1039999998, 1725172.8910000003, 8648426.860000007, 1575369.3190000008, 1801273.0129999984, 12241841.639999913, 1497758.9620000012, 1670991.281999998, 3166605.2310000006, 1476355.9719999984, 1112391.605, 1139358.1680000003, 1412488.8109999984, 1286687.7699999989, 1510490.2680000013, 1347331.5400000012, 1354650.9660000005, 1525617.7510000004, 1578033.7430000002, 3071489.402999996, 1302933.625999999, 1196022.717999999, 1182245.125000001, 1172866.1019999988, 2451694.7189999986, 1320075.2380000006], "episode_lengths": [237, 254, 237, 237, 320, 580, 260, 254, 1035, 307, 268, 268, 831, 272, 234, 519, 285, 278, 814, 282, 271, 231, 290, 247, 279, 279, 247, 293, 286, 286, 261, 261, 266, 223, 283, 1059, 282, 1034, 266, 283, 283, 286, 257, 1062, 265, 291, 291, 253, 256, 233, 301, 553, 252, 238, 238, 207, 269, 802, 247, 237, 301, 275, 279, 227, 249, 271, 243, 669, 219, 277, 277, 478, 241, 261, 220, 279, 1401, 267, 287, 2005, 250, 259, 502, 243, 195, 195, 224, 219, 245, 226, 228, 244, 258, 499, 212, 200, 200, 194, 408, 214], "policy_shared_policy_reward": [150850.45399999994, 362303.8590000001, 353530.0099999998, 348352.95099999954, 172874.48799999995, 171764.09499999994, 406256.4200000003, 375242.16899999994, 370827.09599999984, 183575.08199999997, 153696.58200000017, 363010.5949999999, 364570.577, 359822.46100000007, 178763.11800000013, 154027.20299999998, 364933.6189999998, 362160.81600000034, 357585.8370000001, 182745.83399999997, 222225.77999999985, 512622.576, 493783.58400000044, 491357.8840000001, 249595.76200000025, 411988.21599999984, 935256.7830000003, 911911.1859999998, 899947.8180000002, 451848.63199999975, 182386.0600000002, 414803.85699999996, 405899.51399999997, 391162.28400000004, 198270.45199999984, 170320.13200000013, 393282.48000000033, 388108.18399999995, 361526.48400000005, 180722.2080000001, 697884.725, 1618851.7209999955, 1565216.3459999994, 1537612.2219999991, 762802.7860000002, 209523.202, 472945.8010000001, 453936.3870000001, 457350.39900000044, 223891.04899999997, 187497.21500000023, 415152.28900000005, 408369.995, 411573.45600000024, 204413.626, 189091.51899999997, 423488.4849999997, 414339.148, 412256.0610000003, 205986.473, 556949.724, 1300316.8050000006, 1272795.0389999975, 1243717.884, 631215.6980000001, 175943.106, 429939.98799999984, 412477.0200000002, 417293.2700000001, 213385.86800000002, 157430.09799999997, 369346.9770000002, 367120.459, 356025.638, 184136.4359999999, 357791.68299999984, 836719.1590000001, 828364.9330000004, 814060.2109999997, 412940.8510000003, 199356.7570000001, 456591.6379999998, 457232.3630000002, 440295.2400000002, 222452.85800000007, 197887.4789999999, 444561.89499999996, 432909.60400000017, 431457.666, 214157.58699999994, 546467.8269999993, 1285815.6340000003, 1225850.9799999977, 1233826.0680000007, 611785.342, 175228.57500000007, 430726.11099999986, 408624.6570000002, 426992.94399999996, 210674.58600000004, 187174.654, 425566.4620000002, 407257.972, 393317.14599999966, 204055.0050000001, 156532.4579999999, 363673.79499999987, 358673.20600000006, 351250.6509999997, 180009.78800000006, 206006.51300000027, 475028.10400000005, 459724.32199999987, 466727.21900000045, 239923.34500000006, 164205.603, 383795.55300000036, 375041.76300000027, 365752.3659999999, 183013.78299999997, 200867.155, 455181.01300000015, 431334.856, 424920.7210000002, 205167.23299999998, 197404.5900000001, 443196.44099999976, 423637.3650000001, 418832.6229999996, 202261.51500000004, 172543.991, 393249.38200000004, 374991.31000000023, 352585.80899999983, 175496.54400000005, 206889.27100000007, 462268.8969999999, 453374.56599999947, 449668.97599999997, 227272.373, 188502.2089999999, 450000.221, 430349.5070000001, 417763.94800000003, 213393.795, 187815.7319999999, 453141.58900000004, 426618.721, 414362.8269999998, 210230.66000000003, 157046.66599999997, 403623.98600000003, 372200.3850000001, 373888.082, 183310.62000000017, 159529.3299999999, 407554.2059999999, 379184.3889999998, 386079.69999999995, 191043.59699999998, 199591.58700000017, 431621.628, 429052.64000000036, 416572.34300000005, 203429.8580000001, 142818.37300000008, 353628.9630000001, 346055.9470000001, 325795.732, 171177.13, 197993.96799999988, 448676.105, 443416.25299999997, 419371.40300000017, 207986.59700000024, 727851.8619999993, 1685555.0599999987, 1639589.3539999996, 1576433.3029999998, 799760.5139999988, 192329.91500000012, 442009.4649999998, 434933.7869999998, 422934.23800000007, 214389.66599999982, 720980.1440000007, 1651992.6430000009, 1613823.9320000012, 1598052.8320000023, 809075.6930000001, 196871.48600000003, 433941.891, 419309.30700000015, 414492.69100000034, 207591.94300000003, 193190.31699999992, 456390.0230000002, 450368.8530000002, 458040.9659999999, 231614.45799999993, 191580.596, 457961.80000000005, 444140.37200000003, 449890.121, 229763.043, 198561.28799999994, 473900.0540000004, 446885.7440000002, 459295.97099999984, 226461.15700000006, 166546.50599999988, 412170.8770000003, 388071.73700000014, 371606.9359999999, 187800.76100000006, 735767.3230000007, 1724811.7769999977, 1646047.1899999976, 1597505.503000001, 803841.3620000002, 186413.18700000012, 433961.55900000007, 417324.83400000003, 404798.5770000002, 205554.50699999993, 210734.14200000008, 479847.2490000001, 457831.29200000013, 449220.62000000005, 226105.25700000004, 207507.6780000003, 473564.05900000024, 455497.4549999999, 441601.2700000002, 224662.77900000027, 168087.88600000003, 401194.26100000023, 376509.90800000005, 373046.834, 187812.28000000003, 183292.1009999999, 409697.83799999976, 382500.3249999998, 373254.5989999997, 183917.08399999994, 155742.42100000003, 372726.468, 363408.46400000027, 346835.5890000002, 173799.77199999994, 220160.49300000013, 495742.3160000004, 467191.7589999997, 473955.7180000002, 232842.71099999995, 385877.0810000001, 912499.2320000008, 856736.3399999999, 863610.9949999993, 421696.2939999999, 162601.96500000005, 401501.8319999997, 383592.93399999983, 379330.50000000023, 182683.652, 165914.75099999993, 384215.38200000016, 358270.7799999999, 345890.626, 177147.24100000013, 162178.27299999996, 381480.0119999999, 351098.78500000003, 340948.8239999999, 172028.8509999999, 140717.82299999992, 343843.03299999976, 322871.1509999999, 305683.8690000002, 149506.95100000012, 178192.24699999997, 430558.45499999984, 403184.85499999986, 398366.78, 198147.168, 535808.7850000001, 1280494.401999999, 1224366.0119999985, 1212341.7490000008, 606291.0619999999, 164560.265, 392574.455, 380102.4149999998, 374036.5940000001, 195418.67700000003, 168084.24000000005, 385933.7900000002, 364266.5999999999, 357576.56, 180572.52900000004, 208294.29100000006, 480507.0130000001, 457776.3979999999, 459110.8799999999, 229696.49000000008, 191781.47199999995, 459379.5609999998, 412723.5790000004, 413451.86500000005, 212425.61599999995, 189357.28100000008, 446776.32, 428002.486, 424544.9510000001, 208609.1720000002, 146775.5980000001, 357649.6789999998, 346031.7370000003, 326097.29599999986, 157997.02000000008, 166436.65200000003, 398547.76200000034, 382997.8430000001, 373889.45799999987, 183630.084, 176509.954, 437796.592, 410577.0309999995, 405722.07200000016, 201798.982, 155314.88900000017, 393392.3660000001, 369166.61900000006, 355318.0189999997, 173219.1029999999, 429986.1319999999, 1094945.0249999983, 1005025.8599999998, 977448.064, 479289.0709999996, 139416.315, 345192.2049999998, 317276.5610000004, 319899.047, 156571.98699999996, 189532.84999999995, 450939.7530000002, 427887.85600000015, 426889.6049999999, 214369.88200000007, 188038.22600000002, 454164.91100000014, 414640.54000000004, 428832.16099999973, 214679.7600000001, 326038.40900000033, 767184.3540000007, 726426.5560000003, 703912.0640000002, 347128.2129999996, 155919.53499999992, 378503.13100000017, 354565.31399999995, 345449.7549999999, 168647.95000000004, 180597.997, 425587.578, 419472.43699999986, 413279.0190000001, 206752.9859999997, 153468.98499999993, 351060.0110000003, 342799.1089999999, 331744.1910000001, 167948.80799999993, 191001.97400000016, 458264.4920000004, 435149.8529999999, 428086.98800000054, 212669.5839999999, 964366.0059999992, 2289907.694000001, 2182701.010999999, 2139902.826999999, 1071549.3219999988, 166128.3769999999, 420416.2739999998, 411456.0540000002, 388277.5690000001, 189091.04499999995, 200826.842, 468044.5310000001, 455629.2940000002, 452965.7800000001, 223806.56599999993, 1377272.5440000005, 3253731.6589999967, 3095311.1959999935, 3018446.0569999986, 1497080.1839999964, 171028.54200000013, 398367.45400000026, 378457.2260000002, 368054.17300000024, 181851.5669999998, 191004.30700000018, 431815.2460000003, 415480.87800000014, 418892.03300000005, 213798.818, 349506.6440000001, 832609.4619999994, 792844.9299999999, 792756.3489999996, 398887.8459999997, 156785.76400000002, 387090.0000000001, 377301.46999999986, 368096.04300000006, 187082.69499999995, 124568.97099999999, 306922.72900000005, 279255.3659999999, 264739.55100000015, 136904.98799999995, 127302.66399999993, 310104.082, 289235.6279999999, 271439.22000000026, 141276.57399999996, 155028.53499999992, 370990.15599999984, 354831.7240000001, 359044.93900000013, 172593.45699999994, 138342.65199999994, 349386.4230000002, 318789.2749999997, 317781.4610000001, 162387.95900000003, 167083.14600000007, 400210.85999999987, 379135.227, 373279.91899999994, 190781.11599999995, 150950.92300000007, 351123.1909999997, 339554.61699999997, 340609.671, 165093.138, 150318.015, 367808.78100000025, 345242.09399999987, 333622.15199999994, 157659.92399999997, 169256.02100000007, 400398.4699999999, 379569.72899999993, 379751.5649999998, 196641.96599999993, 172706.435, 416439.94600000005, 398917.1090000002, 394546.06599999993, 195424.18700000006, 348238.19099999993, 808927.4039999993, 769277.9169999999, 765692.8889999999, 379353.0019999998, 148927.17600000015, 343458.53700000024, 328790.236, 320985.42300000007, 160772.25400000004, 135863.26199999996, 317710.7540000002, 301942.2620000002, 292384.523, 148121.91699999984, 134531.98099999997, 316979.298, 296884.56999999995, 289330.0909999999, 144519.18500000003, 123551.58600000002, 305558.9239999998, 308854.6850000002, 290849.3679999999, 144051.53899999996, 267266.3700000002, 658340.8209999996, 627634.4229999994, 599747.8940000002, 298705.2109999998, 149113.29799999995, 355730.666, 333439.00200000015, 322043.956, 159748.31599999996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.044535629808995, "mean_inference_ms": 1.808076377949078, "mean_action_processing_ms": 1.3516792534486965, "mean_env_wait_ms": 518.1035029336384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11882495880126953, "StateBufferConnector_ms": 0.0180051326751709, "ViewRequirementAgentConnector_ms": 0.45931100845336914}, "num_episodes": 21, "episode_return_max": 12241841.639999913, "episode_return_min": 1112391.605, "episode_return_mean": 2157819.3937799996, "episodes_this_iter": 21}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 510000, "num_agent_steps_trained": 510000, "num_env_steps_sampled": 102000, "num_env_steps_trained": 102000, "num_env_steps_sampled_this_iter": 6000, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 11.214054893330543, "num_env_steps_trained_throughput_per_sec": 11.214054893330543, "timesteps_total": 102000, "num_env_steps_sampled_lifetime": 102000, "num_agent_steps_sampled_lifetime": 510000, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 510000, "timers": {"training_iteration_time_ms": 483375.56, "restore_workers_time_ms": 0.0, "training_step_time_ms": 483375.56, "sample_time_ms": 453800.684, "learn_time_ms": 29559.878, "learn_throughput": 202.978, "synch_weights_time_ms": 10.908}, "counters": {"num_env_steps_sampled": 102000, "num_env_steps_trained": 102000, "num_agent_steps_sampled": 510000, "num_agent_steps_trained": 510000}, "done": false, "training_iteration": 17, "trial_id": "a5bb6_00000", "date": "2025-01-21_11-23-41", "timestamp": 1737487421, "time_this_iter_s": 535.047858953476, "time_total_s": 7951.572491168976, "pid": 61756, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'environments.trafficEnv.TrafficLightMAEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 20000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 6000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function my_policy_mapping at 0x00000177903D92D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, "Dict('local_state': Dict('current_phase': Discrete(3), 'queue_length': Box(0.0, 100.0, (4,), float32), 'waiting_time': Box(0.0, 1000000.0, (4,), float32)), 'neighbor_info': Box(0.0, 100.0, (4,), float32))", "Dict('duration': Box(5.0, 60.0, (1,), float32), 'phase': Discrete(3))", {"model": {"custom_model": "my_traffic_model"}}]}, "callbacks": "<class 'config.trainingConfig.MetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7951.572491168976, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 6.970588235294118, "ram_util_percent": 58.82205882352941, "gpu_util_percent0": 0.05285294117647058, "vram_util_percent0": 0.13348776424632355}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6008534751039871, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.0002999999999999999, "total_loss": 9.938582338373712, "policy_loss": -6.040153291789775e-05, "vf_loss": 9.960137687845434, "vf_explained_var": -2.8686827801643536e-06, "kl": 0.007635810150372497, "entropy": 2.170970620956827, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 41125.5, "diff_num_grad_updates_vs_sampler_policy": 1174.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "env_runners": {"episode_reward_max": 12241841.639999913, "episode_reward_min": 1112391.605, "episode_reward_mean": 2146334.6102299993, "episode_len_mean": 351.76, "episode_media": {}, "episodes_timesteps_total": 35176, "policy_reward_min": {"shared_policy": 123551.58600000002}, "policy_reward_max": {"shared_policy": 3253731.6589999967}, "policy_reward_mean": {"shared_policy": 429266.92204599996}, "custom_metrics": {"mean_queue_length": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "mean_waiting_time": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "mean_throughput": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "hist_stats": {"episode_reward": [1617371.239, 1410139.898000001, 1847409.503000001, 1471809.0679999993, 1717470.9779999994, 1685332.5339999993, 1468867.036, 1799474.0829999978, 1700009.679999998, 1692169.5289999996, 1490069.7390000024, 1523391.222000001, 1680268.056, 1339476.1450000019, 1717444.326000002, 6429190.093000004, 1706597.0710000005, 6393925.244000013, 1672207.3180000028, 1789604.6169999992, 1773335.9319999984, 1805104.2139999976, 1526196.8170000007, 6507973.155000015, 1648052.6640000006, 1823738.559999998, 1802833.2409999995, 1506651.169, 1532661.947000003, 1412512.7139999953, 1889892.9969999967, 3440419.9420000003, 1509710.883, 1431438.7799999972, 1407734.7449999982, 1262622.8269999977, 1608449.5050000013, 4859302.01, 1506692.4060000011, 1456433.7189999996, 1835385.0720000013, 1689762.092999997, 1697290.209999999, 1334551.329999999, 1505501.7989999985, 1632404.6309999968, 1446410.9959999998, 3986694.151999992, 1278356.1149999998, 1709619.9459999998, 1700355.5979999986, 2870689.595999994, 1403085.685, 1645690.0170000007, 1347021.1039999998, 1725172.8910000003, 8648426.860000007, 1575369.3190000008, 1801273.0129999984, 12241841.639999913, 1497758.9620000012, 1670991.281999998, 3166605.2310000006, 1476355.9719999984, 1112391.605, 1139358.1680000003, 1412488.8109999984, 1286687.7699999989, 1510490.2680000013, 1347331.5400000012, 1354650.9660000005, 1525617.7510000004, 1578033.7430000002, 3071489.402999996, 1302933.625999999, 1196022.717999999, 1182245.125000001, 1172866.1019999988, 2451694.7189999986, 1320075.2380000006, 1973641.5939999984, 1939049.3169999984, 1717410.3320000002, 1740094.5990000041, 1297176.6239999977, 1305216.869999999, 5491930.299000001, 1282717.9580000013, 1609004.9079999996, 1621072.8800000004, 1651164.9680000008, 1627495.1020000014, 1562274.1430000016, 11843713.500999985, 1526797.3140000002, 1683639.69, 1691421.4100000027, 1473456.8860000002, 1457783.3669999992, 1423422.587999998], "episode_lengths": [271, 231, 290, 247, 279, 279, 247, 293, 286, 286, 261, 261, 266, 223, 283, 1059, 282, 1034, 266, 283, 283, 286, 257, 1062, 265, 291, 291, 253, 256, 233, 301, 553, 252, 238, 238, 207, 269, 802, 247, 237, 301, 275, 279, 227, 249, 271, 243, 669, 219, 277, 277, 478, 241, 261, 220, 279, 1401, 267, 287, 2005, 250, 259, 502, 243, 195, 195, 224, 219, 245, 226, 228, 244, 258, 499, 212, 200, 200, 194, 408, 214, 305, 305, 282, 282, 216, 216, 904, 216, 262, 262, 260, 260, 255, 1946, 254, 270, 270, 247, 242, 233], "policy_shared_policy_reward": [187174.654, 425566.4620000002, 407257.972, 393317.14599999966, 204055.0050000001, 156532.4579999999, 363673.79499999987, 358673.20600000006, 351250.6509999997, 180009.78800000006, 206006.51300000027, 475028.10400000005, 459724.32199999987, 466727.21900000045, 239923.34500000006, 164205.603, 383795.55300000036, 375041.76300000027, 365752.3659999999, 183013.78299999997, 200867.155, 455181.01300000015, 431334.856, 424920.7210000002, 205167.23299999998, 197404.5900000001, 443196.44099999976, 423637.3650000001, 418832.6229999996, 202261.51500000004, 172543.991, 393249.38200000004, 374991.31000000023, 352585.80899999983, 175496.54400000005, 206889.27100000007, 462268.8969999999, 453374.56599999947, 449668.97599999997, 227272.373, 188502.2089999999, 450000.221, 430349.5070000001, 417763.94800000003, 213393.795, 187815.7319999999, 453141.58900000004, 426618.721, 414362.8269999998, 210230.66000000003, 157046.66599999997, 403623.98600000003, 372200.3850000001, 373888.082, 183310.62000000017, 159529.3299999999, 407554.2059999999, 379184.3889999998, 386079.69999999995, 191043.59699999998, 199591.58700000017, 431621.628, 429052.64000000036, 416572.34300000005, 203429.8580000001, 142818.37300000008, 353628.9630000001, 346055.9470000001, 325795.732, 171177.13, 197993.96799999988, 448676.105, 443416.25299999997, 419371.40300000017, 207986.59700000024, 727851.8619999993, 1685555.0599999987, 1639589.3539999996, 1576433.3029999998, 799760.5139999988, 192329.91500000012, 442009.4649999998, 434933.7869999998, 422934.23800000007, 214389.66599999982, 720980.1440000007, 1651992.6430000009, 1613823.9320000012, 1598052.8320000023, 809075.6930000001, 196871.48600000003, 433941.891, 419309.30700000015, 414492.69100000034, 207591.94300000003, 193190.31699999992, 456390.0230000002, 450368.8530000002, 458040.9659999999, 231614.45799999993, 191580.596, 457961.80000000005, 444140.37200000003, 449890.121, 229763.043, 198561.28799999994, 473900.0540000004, 446885.7440000002, 459295.97099999984, 226461.15700000006, 166546.50599999988, 412170.8770000003, 388071.73700000014, 371606.9359999999, 187800.76100000006, 735767.3230000007, 1724811.7769999977, 1646047.1899999976, 1597505.503000001, 803841.3620000002, 186413.18700000012, 433961.55900000007, 417324.83400000003, 404798.5770000002, 205554.50699999993, 210734.14200000008, 479847.2490000001, 457831.29200000013, 449220.62000000005, 226105.25700000004, 207507.6780000003, 473564.05900000024, 455497.4549999999, 441601.2700000002, 224662.77900000027, 168087.88600000003, 401194.26100000023, 376509.90800000005, 373046.834, 187812.28000000003, 183292.1009999999, 409697.83799999976, 382500.3249999998, 373254.5989999997, 183917.08399999994, 155742.42100000003, 372726.468, 363408.46400000027, 346835.5890000002, 173799.77199999994, 220160.49300000013, 495742.3160000004, 467191.7589999997, 473955.7180000002, 232842.71099999995, 385877.0810000001, 912499.2320000008, 856736.3399999999, 863610.9949999993, 421696.2939999999, 162601.96500000005, 401501.8319999997, 383592.93399999983, 379330.50000000023, 182683.652, 165914.75099999993, 384215.38200000016, 358270.7799999999, 345890.626, 177147.24100000013, 162178.27299999996, 381480.0119999999, 351098.78500000003, 340948.8239999999, 172028.8509999999, 140717.82299999992, 343843.03299999976, 322871.1509999999, 305683.8690000002, 149506.95100000012, 178192.24699999997, 430558.45499999984, 403184.85499999986, 398366.78, 198147.168, 535808.7850000001, 1280494.401999999, 1224366.0119999985, 1212341.7490000008, 606291.0619999999, 164560.265, 392574.455, 380102.4149999998, 374036.5940000001, 195418.67700000003, 168084.24000000005, 385933.7900000002, 364266.5999999999, 357576.56, 180572.52900000004, 208294.29100000006, 480507.0130000001, 457776.3979999999, 459110.8799999999, 229696.49000000008, 191781.47199999995, 459379.5609999998, 412723.5790000004, 413451.86500000005, 212425.61599999995, 189357.28100000008, 446776.32, 428002.486, 424544.9510000001, 208609.1720000002, 146775.5980000001, 357649.6789999998, 346031.7370000003, 326097.29599999986, 157997.02000000008, 166436.65200000003, 398547.76200000034, 382997.8430000001, 373889.45799999987, 183630.084, 176509.954, 437796.592, 410577.0309999995, 405722.07200000016, 201798.982, 155314.88900000017, 393392.3660000001, 369166.61900000006, 355318.0189999997, 173219.1029999999, 429986.1319999999, 1094945.0249999983, 1005025.8599999998, 977448.064, 479289.0709999996, 139416.315, 345192.2049999998, 317276.5610000004, 319899.047, 156571.98699999996, 189532.84999999995, 450939.7530000002, 427887.85600000015, 426889.6049999999, 214369.88200000007, 188038.22600000002, 454164.91100000014, 414640.54000000004, 428832.16099999973, 214679.7600000001, 326038.40900000033, 767184.3540000007, 726426.5560000003, 703912.0640000002, 347128.2129999996, 155919.53499999992, 378503.13100000017, 354565.31399999995, 345449.7549999999, 168647.95000000004, 180597.997, 425587.578, 419472.43699999986, 413279.0190000001, 206752.9859999997, 153468.98499999993, 351060.0110000003, 342799.1089999999, 331744.1910000001, 167948.80799999993, 191001.97400000016, 458264.4920000004, 435149.8529999999, 428086.98800000054, 212669.5839999999, 964366.0059999992, 2289907.694000001, 2182701.010999999, 2139902.826999999, 1071549.3219999988, 166128.3769999999, 420416.2739999998, 411456.0540000002, 388277.5690000001, 189091.04499999995, 200826.842, 468044.5310000001, 455629.2940000002, 452965.7800000001, 223806.56599999993, 1377272.5440000005, 3253731.6589999967, 3095311.1959999935, 3018446.0569999986, 1497080.1839999964, 171028.54200000013, 398367.45400000026, 378457.2260000002, 368054.17300000024, 181851.5669999998, 191004.30700000018, 431815.2460000003, 415480.87800000014, 418892.03300000005, 213798.818, 349506.6440000001, 832609.4619999994, 792844.9299999999, 792756.3489999996, 398887.8459999997, 156785.76400000002, 387090.0000000001, 377301.46999999986, 368096.04300000006, 187082.69499999995, 124568.97099999999, 306922.72900000005, 279255.3659999999, 264739.55100000015, 136904.98799999995, 127302.66399999993, 310104.082, 289235.6279999999, 271439.22000000026, 141276.57399999996, 155028.53499999992, 370990.15599999984, 354831.7240000001, 359044.93900000013, 172593.45699999994, 138342.65199999994, 349386.4230000002, 318789.2749999997, 317781.4610000001, 162387.95900000003, 167083.14600000007, 400210.85999999987, 379135.227, 373279.91899999994, 190781.11599999995, 150950.92300000007, 351123.1909999997, 339554.61699999997, 340609.671, 165093.138, 150318.015, 367808.78100000025, 345242.09399999987, 333622.15199999994, 157659.92399999997, 169256.02100000007, 400398.4699999999, 379569.72899999993, 379751.5649999998, 196641.96599999993, 172706.435, 416439.94600000005, 398917.1090000002, 394546.06599999993, 195424.18700000006, 348238.19099999993, 808927.4039999993, 769277.9169999999, 765692.8889999999, 379353.0019999998, 148927.17600000015, 343458.53700000024, 328790.236, 320985.42300000007, 160772.25400000004, 135863.26199999996, 317710.7540000002, 301942.2620000002, 292384.523, 148121.91699999984, 134531.98099999997, 316979.298, 296884.56999999995, 289330.0909999999, 144519.18500000003, 123551.58600000002, 305558.9239999998, 308854.6850000002, 290849.3679999999, 144051.53899999996, 267266.3700000002, 658340.8209999996, 627634.4229999994, 599747.8940000002, 298705.2109999998, 149113.29799999995, 355730.666, 333439.00200000015, 322043.956, 159748.31599999996, 217657.02600000004, 508730.5519999999, 493554.1100000001, 507572.1499999999, 246127.7559999998, 212609.35900000003, 502692.97400000016, 485860.6940000002, 494981.6040000001, 242904.686, 194101.19200000004, 446536.70699999976, 440868.05399999995, 427097.741, 208806.63799999998, 195508.51700000008, 454084.83300000016, 444459.441, 435477.3480000001, 210564.46000000002, 140940.054, 347076.6200000002, 329574.3769999999, 317446.6479999999, 162138.9249999998, 144468.989, 351359.01100000035, 329787.22299999977, 319651.5879999999, 159950.059, 604085.4019999995, 1461529.1430000004, 1366819.9979999973, 1373105.5900000003, 686390.1660000008, 143260.09900000002, 343816.63499999995, 315092.1699999998, 319176.96700000006, 161372.08700000017, 181061.4, 413214.97000000015, 410156.2639999998, 399637.1450000003, 204935.12900000016, 185299.45999999985, 413365.9839999999, 411462.8540000004, 404751.9110000001, 206192.67100000006, 187123.11399999988, 425534.99500000005, 413072.71500000026, 416335.2749999996, 209098.86899999992, 182823.89100000015, 424755.09799999977, 405531.08900000027, 408923.2519999999, 205461.77199999997, 165227.16999999995, 405457.7649999999, 400487.04400000005, 391073.5730000001, 200028.59100000001, 1307214.2090000003, 3119121.9929999975, 2990725.4020000035, 2959364.3669999978, 1467287.5299999984, 165464.699, 406523.0649999998, 381924.88099999994, 387073.51399999973, 185811.155, 188017.86700000003, 449213.2640000002, 425803.9139999997, 416187.83699999965, 204416.80800000005, 191132.15099999993, 451854.5839999999, 427924.8989999997, 417837.66199999995, 202672.11400000003, 166960.21000000005, 392925.43700000003, 374043.698, 361612.27599999995, 177915.26499999998, 157802.682, 388423.40699999983, 363312.63099999994, 365736.72000000015, 182507.92699999994, 154987.2659999999, 377808.04200000013, 349886.161, 363798.4839999999, 176942.63499999995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.041600765136061, "mean_inference_ms": 1.8126165686455458, "mean_action_processing_ms": 1.3554969237017602, "mean_env_wait_ms": 522.8676260590895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10585379600524902, "StateBufferConnector_ms": 0.022992372512817383, "ViewRequirementAgentConnector_ms": 0.4857172966003418}, "num_episodes": 20, "episode_return_max": 12241841.639999913, "episode_return_min": 1112391.605, "episode_return_mean": 2146334.6102299993, "episodes_this_iter": 20}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 6000, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 10.898382766255633, "num_env_steps_trained_throughput_per_sec": 10.898382766255633, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 540000, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 492100.789, "restore_workers_time_ms": 0.0, "training_step_time_ms": 492100.789, "sample_time_ms": 462512.345, "learn_time_ms": 29573.346, "learn_throughput": 202.885, "synch_weights_time_ms": 11.008}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "training_iteration": 18, "trial_id": "a5bb6_00000", "date": "2025-01-21_11-32-52", "timestamp": 1737487972, "time_this_iter_s": 550.5463988780975, "time_total_s": 8502.118890047073, "pid": 61756, "hostname": "DESKTOP-VFPH8OE", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'environments.trafficEnv.TrafficLightMAEnv'>", "env_config": {"num_lights": 5, "sumo_cfg": "C:\\Users\\pc\\Documents\\Trafic\\data\\sumo\\simulation.sumocfg", "max_steps": 20000}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 180, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 6000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function my_policy_mapping at 0x00000177903D92D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": {"type": "ray.tune.logger.TBXLogger", "logdir": "./logs", "log_metrics_tables": true}, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, "Dict('local_state': Dict('current_phase': Discrete(3), 'queue_length': Box(0.0, 100.0, (4,), float32), 'waiting_time': Box(0.0, 1000000.0, (4,), float32)), 'neighbor_info': Box(0.0, 100.0, (4,), float32))", "Dict('duration': Box(5.0, 60.0, (1,), float32), 'phase': Discrete(3))", {"model": {"custom_model": "my_traffic_model"}}]}, "callbacks": "<class 'config.trainingConfig.MetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8502.118890047073, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 6.220227920227919, "ram_util_percent": 59.88290598290599, "gpu_util_percent0": 0.0500997150997151, "vram_util_percent0": 0.1360725772346866}}
